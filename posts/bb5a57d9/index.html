<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Dota_128px_1143945_easyicon.net.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mamor5409.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>

  <meta property="og:type" content="article">
<meta property="og:title" content="NSSCTF Crypto 01">
<meta property="og:url" content="http://mamor5409.github.io/posts/bb5a57d9/index.html">
<meta property="og:site_name" content="Mamor&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/1.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/2.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/3.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/4.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/5.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/6.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/7.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/8.png">
<meta property="og:image" content="http://mamor5409.github.io/posts/bb5a57d9/9.png">
<meta property="article:published_time" content="2024-01-23T03:59:22.000Z">
<meta property="article:modified_time" content="2024-02-04T05:50:27.195Z">
<meta property="article:author" content="Mamor">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://mamor5409.github.io/posts/bb5a57d9/1.png">

<link rel="canonical" href="http://mamor5409.github.io/posts/bb5a57d9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>NSSCTF Crypto 01 | Mamor's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Mamor's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mamor's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mamor5409.github.io/posts/bb5a57d9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kabi.jpg">
      <meta itemprop="name" content="Mamor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mamor's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          NSSCTF Crypto 01
        </h1>

        <div class="post-meta">

			
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-23 11:59:22" itemprop="dateCreated datePublished" datetime="2024-01-23T11:59:22+08:00">2024-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-02-04 13:50:27" itemprop="dateModified" datetime="2024-02-04T13:50:27+08:00">2024-02-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>48k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>44 分钟</span>
            </span>
            <div class="post-description"> </div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>记录下近期在NSSCTF Crypto的刷题记录  …. 密码学新手菜鸡简单记录。数学基础不是很好 还在慢慢补……</p>
<h2 id="SWPUCTF-2021-新生赛-crypto1-共模攻击"><a href="#SWPUCTF-2021-新生赛-crypto1-共模攻击" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto1 共模攻击"></a>[SWPUCTF 2021 新生赛]crypto1 共模攻击</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;****************************&#x27;</span></span><br><span class="line">flag = &#123;<span class="string">&quot;asfajgfbiagbwe&quot;</span>&#125;</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">e1e2 = <span class="number">3087</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line"><span class="comment">#flag2= 130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line"><span class="comment">#n= 609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>题目分析：</p>
<p>1.e1*e2=3087 尝试分解e1 e2</p>
<p>2.flag1 flag2【c1 c2】 公用同一个模进行加密【共模攻击】</p>
<p>利用前提： RSA在生成密钥过程中使用相同的模数 n</p>
<p>已知 n c1 c2 e1 e2 求m 【在不知d1 d2情况下得到m】</p>
<p><img src="/posts/bb5a57d9/1.png"></p>
<p>WP:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知c1 c2 n  分解e1e2得到e1\e2  使用共模攻击</span></span><br><span class="line">c1= <span class="number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line">c2= <span class="number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line">n= <span class="number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line">e1e2 = <span class="number">3087</span></span><br><span class="line"><span class="comment"># factordb 可以将e1e2分解成  3^2*7^3</span></span><br><span class="line"><span class="comment"># 相比与爆破 2~3087 效率会高很多</span></span><br><span class="line">fac = [<span class="number">3</span>,<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>,<span class="number">3</span>*<span class="number">7</span>,<span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span>,<span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>*<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>]</span><br><span class="line"><span class="comment"># print(len(fac))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e1 <span class="keyword">in</span> fac:</span><br><span class="line">    <span class="keyword">if</span> e1e2 % e1 == <span class="number">0</span>:</span><br><span class="line">        e2 = e1e2 // e1</span><br><span class="line">        <span class="comment"># 欧几里得拓展  e1*s1+e2*s2=1</span></span><br><span class="line">        s0,s1,s2 = gmpy2.gcdext(e1,e2)</span><br><span class="line">        <span class="comment"># print(s0,s1,s2)</span></span><br><span class="line">        <span class="comment"># # 共模攻击</span></span><br><span class="line">        m_s0 = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line">        m = long_to_bytes(gmpy2.iroot(m_s0,s0)[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;d64dba66-b608-4255-b888-0b0f25c2f90e&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-crypto2-共模攻击"><a href="#SWPUCTF-2021-新生赛-crypto2-共模攻击" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto2 共模攻击"></a>[SWPUCTF 2021 新生赛]crypto2 共模攻击</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;***************&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e1 = getPrime(<span class="number">32</span>)</span><br><span class="line">e2 = getPrime(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e1= &#x27;</span> +<span class="built_in">str</span>(e1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e2= &#x27;</span>+<span class="built_in">str</span>(e2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span></span><br><span class="line"><span class="comment">#flag2= 86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span></span><br><span class="line"><span class="comment">#e1= 3247473589</span></span><br><span class="line"><span class="comment">#e2= 3698409173</span></span><br><span class="line"><span class="comment">#n= 103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>WP：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_gong_N_def</span>(<span class="params">e1,e2,c1,c2,n</span>): <span class="comment">#共模攻击函数</span></span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"></span><br><span class="line">c1= <span class="number">100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span></span><br><span class="line">c2= <span class="number">86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span></span><br><span class="line">e1= <span class="number">3247473589</span></span><br><span class="line">e2= <span class="number">3698409173</span></span><br><span class="line">n= <span class="number">103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span></span><br><span class="line"></span><br><span class="line">m = rsa_gong_N_def(e1,e2,c1,c2,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-crypto3"><a href="#SWPUCTF-2021-新生赛-crypto3" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto3 [-]"></a>[SWPUCTF 2021 新生赛]crypto3 [-]</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;******************&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,p,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,q,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span></span><br><span class="line"><span class="comment">#flag2= 95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span></span><br><span class="line"><span class="comment">#n= 140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>共模n  已知c1 c2 但是e1 e2未知</p>
<h2 id="SWPUCTF-2021-新生赛-crypto4-素数分解"><a href="#SWPUCTF-2021-新生赛-crypto4-素数分解" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto4 素数分解"></a>[SWPUCTF 2021 新生赛]crypto4 素数分解</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;**********&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line">flag= <span class="number">10227915341268619536932290456122384969242151167487654201363877568935534996454863939953106193665663567559506242151019201314446286458150141991211233219320700112533775367958964780047682920839507351492644735811096995884754664899221842470772096509258104067131614630939533042322095150722344048082688772981180270243</span></span><br><span class="line">n= <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c= <span class="number">10227915341268619536932290456122384969242151167487654201363877568935534996454863939953106193665663567559506242151019201314446286458150141991211233219320700112533775367958964780047682920839507351492644735811096995884754664899221842470772096509258104067131614630939533042322095150722344048082688772981180270243</span></span><br><span class="line">n= <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"><span class="comment"># factordb 分解素数n</span></span><br><span class="line">p = <span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421</span></span><br><span class="line">q = <span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</span></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;no_why&#125;&#x27;</span></span><br></pre></td></tr></table></figure>





<h2 id="SWPUCTF-2021-新生赛-crypto5-低指数e攻击"><a href="#SWPUCTF-2021-新生赛-crypto5-低指数e攻击" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto5 低指数e攻击"></a>[SWPUCTF 2021 新生赛]crypto5 低指数e攻击</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flag= <span class="number">25166751653530941364839663846806543387720865339263370907985655775152187319464715737116599171477207047430065345882626259880756839094179627032623895330242655333</span></span><br><span class="line">n= <span class="number">134109481482703713214838023035418052567000870587160796935708584694132507394211363652420160931185332280406437290210512090663977634730864032370977407179731940068634536079284528020739988665713200815021342700369922518406968356455736393738946128013973643235228327971170711979683931964854563904980669850660628561419</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>下载附件后 只得到了 n c</p>
<p>没有其他条件 就只能先考虑低指数e去试了 e 1~3</p>
<p>e=3 可直接得到flag 套代码即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">25166751653530941364839663846806543387720865339263370907985655775152187319464715737116599171477207047430065345882626259880756839094179627032623895330242655333</span></span><br><span class="line">n = <span class="number">134109481482703713214838023035418052567000870587160796935708584694132507394211363652420160931185332280406437290210512090663977634730864032370977407179731940068634536079284528020739988665713200815021342700369922518406968356455736393738946128013973643235228327971170711979683931964854563904980669850660628561419</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = gmpy2.iroot(c+k*n,e)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>])))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k = k+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;because_i_like&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-crypto6-base"><a href="#SWPUCTF-2021-新生赛-crypto6-base" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto6 base"></a>[SWPUCTF 2021 新生赛]crypto6 base</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var=<span class="string">&quot;************************************&quot;</span></span><br><span class="line">flag=<span class="string">&#x27;NSSCTF&#123;&#x27;</span> + base64.b16encode(base64.b32encode(base64.b64encode(var.encode()))) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">小明不小心泄露了源码，输出结果为：4A5A4C564B36434E4B5241544B5432454E4E32465552324E47424758534D44594C4657564336534D4B5241584F574C4B4B463245365643424F35485649534C584A5A56454B4D4B5049354E47593D3D3D，你能还原出var的正确结果吗？</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>已知密文 分别进行了 b16 b32 b64加密</p>
<p>对应 b64 b32 b16解密即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag=&#x27;NSSCTF&#123;&#x27; + base64.b16encode(base64.b32encode(base64.b64encode(var.encode()))) + &#x27;&#125;&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;4A5A4C564B36434E4B5241544B5432454E4E32465552324E47424758534D44594C4657564336534D4B5241584F574C4B4B463245365643424F35485649534C584A5A56454B4D4B5049354E47593D3D3D&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;NSSCTF&#123;&#x27;</span>+base64.b64decode(base64.b32decode(base64.b16decode(c))) +<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;5e110989-dc43-1bd3-00b4-9009206158fe&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-crypto7-md5"><a href="#SWPUCTF-2021-新生赛-crypto7-md5" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto7 md5"></a>[SWPUCTF 2021 新生赛]crypto7 md5</h2><p>题目：</p>
<p>69f7906323b4f7d1e4e972acf4abfbfc ,得到的结果用NSSCTF{}包裹。</p>
<p>md5直接解密即可</p>
<p><img src="/posts/bb5a57d9/2.png"></p>
<h2 id="SWPUCTF-2021-新生赛-crypto8-UUencode"><a href="#SWPUCTF-2021-新生赛-crypto8-UUencode" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto8  UUencode"></a>[SWPUCTF 2021 新生赛]crypto8  UUencode</h2><p>题目：</p>
<p>73E-30U1&amp;&gt;V-H965S95]I&lt;U]P;W=E&lt;GT`</p>
<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/uu.html">http://www.hiencode.com/uu.html</a> UUencode解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;cheese_is_power&#125;</span><br></pre></td></tr></table></figure>



<p>UUencode【Unix-to-Unix encoding】编码特征：</p>
<p>编码时将 <strong>3个字符</strong> 顺序放入一个24位的缓冲区，缺字符的地方补零，然后将缓冲区截断成为4个部分，高位在先，每个部分6位，用下面的64个字符重新表示</p>
<p>3个字符 24bit 6bit为一组分成4组，每组以十进制表示出现的字节数值，数值在0~63之间，然后加上32 得到ascii对应字符</p>
<p>64个字符【对应ascii码32(空格) - 95(_)】</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!”#$%&amp;’()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_</span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-crypto9"><a href="#SWPUCTF-2021-新生赛-crypto9" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto9"></a>[SWPUCTF 2021 新生赛]crypto9</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">AKKPLX&#123;qv5x0021-7n8w-wr05-x25w-7882ntu5q984&#125;</span><br><span class="line">脚本给你了，去解吧</span><br><span class="line"></span><br><span class="line">letter_list = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>  <span class="comment"># 字母表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据输入的key生成key列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_KeyList</span>(<span class="params">key</span>):</span><br><span class="line">    key_list = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> key:</span><br><span class="line">        key_list.append(<span class="built_in">ord</span>(ch.upper()) - <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key_list</span>):</span><br><span class="line">    ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:  <span class="comment"># 遍历明文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 明文是否为字母,如果是,则判断大小写,分别进行加密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> + key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> + key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到密文字符串里</span></span><br><span class="line">            ciphertext += ch</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ciphertext:  <span class="comment"># 遍历密文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 密文为否为字母,如果是,则判断大小写,分别进行解密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> - key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> - key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到明文字符串里</span></span><br><span class="line">            plaintext += ch</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加密请按D,解密请按E:&quot;</span>)</span><br><span class="line">    user_input = <span class="built_in">input</span>();</span><br><span class="line">    <span class="keyword">while</span> (user_input != <span class="string">&#x27;D&#x27;</span> <span class="keyword">and</span> user_input != <span class="string">&#x27;E&#x27;</span>):  <span class="comment"># 输入合法性判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入有误!请重新输入:&quot;</span>)</span><br><span class="line">        user_input = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请输入密钥:&quot;</span>)</span><br><span class="line">    key = <span class="built_in">input</span>()</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">False</span> == key.isalpha()):  <span class="comment"># 输入合法性判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入有误!密钥为字母,请重新输入:&quot;</span>)</span><br><span class="line">        key = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    key_list = Get_KeyList(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_input == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="comment"># 加密</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入明文:&quot;</span>)</span><br><span class="line">        plaintext = <span class="built_in">input</span>()</span><br><span class="line">        ciphertext = Encrypt(plaintext, key_list)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密文为:\n%s&quot;</span> % ciphertext)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 解密</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入密文:&quot;</span>)</span><br><span class="line">        ciphertext = <span class="built_in">input</span>()</span><br><span class="line">        plaintext = Decrypt(ciphertext, key_list)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;明文为:\n%s&quot;</span> % plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>WP key尝试遍历3位</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">letter_list = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>  <span class="comment"># 字母表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据输入的key生成key列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_KeyList</span>(<span class="params">key</span>):</span><br><span class="line">    key_list = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> key:</span><br><span class="line">        key_list.append(<span class="built_in">ord</span>(ch.upper()) - <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key_list</span>):</span><br><span class="line">    ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:  <span class="comment"># 遍历明文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 明文是否为字母,如果是,则判断大小写,分别进行加密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> + key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> + key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到密文字符串里</span></span><br><span class="line">            ciphertext += ch</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ciphertext:  <span class="comment"># 遍历密文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 密文为否为字母,如果是,则判断大小写,分别进行解密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> - key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> - key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到明文字符串里</span></span><br><span class="line">            plaintext += ch</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(letter_list)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(letter_list)):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(letter_list)):</span><br><span class="line">                key_list = [i,j,k]</span><br><span class="line">                ciphertext = <span class="string">&#x27;AKKPLX&#123;qv5x0021-7n8w-wr05-x25w-7882ntu5q984&#125;&#x27;</span></span><br><span class="line">                plaintext = Decrypt(ciphertext, key_list)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;NSSCTF&quot;</span> <span class="keyword">in</span> plaintext:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;明文为:\n%s&quot;</span> % plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;dd5f0021-7a8e-ee05-f25e-7882abc5d984&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>AKKPLX{qv5x0021-7n8w-wr05-x25w-7882ntu5q984} -》 NSSCTF{ 像凯撒变种</p>
<p>维吉尼亚加密 利用网站 <a target="_blank" rel="noopener" href="https://www.dcode.fr/vigenere-cipher">https://www.dcode.fr/vigenere-cipher</a> 爆破 NSSCTF{dd5f0021-7a8e-ee05-f25e-7882abc5d984}</p>
<p><img src="/posts/bb5a57d9/3.png"></p>
<h2 id="SWPUCTF-2021-新生赛-crypto10-维吉尼亚"><a href="#SWPUCTF-2021-新生赛-crypto10-维吉尼亚" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto10 [维吉尼亚]"></a>[SWPUCTF 2021 新生赛]crypto10 [维吉尼亚]</h2><p>AFFPGS{pbatenghyngvbaf!!!},建议直接秒了 维吉尼亚直接爆破  NSSCTF{congratulations!!!}</p>
<p><img src="/posts/bb5a57d9/4.png"></p>
<h2 id="SWPUCTF-2021-新生赛-pigpig-猪圈"><a href="#SWPUCTF-2021-新生赛-pigpig-猪圈" class="headerlink" title="[SWPUCTF 2021 新生赛]pigpig [猪圈]"></a>[SWPUCTF 2021 新生赛]pigpig [猪圈]</h2><p>猪圈密码 <a target="_blank" rel="noopener" href="http://www.hiencode.com/pigpen.html">http://www.hiencode.com/pigpen.html</a></p>
<p>w h e n t h e p i g w a n t t o e a t</p>
<p><img src="/posts/bb5a57d9/5.png"></p>
<h2 id="SWPUCTF-2022-新生赛-小明文"><a href="#SWPUCTF-2022-新生赛-小明文" class="headerlink" title="[SWPUCTF 2022 新生赛]小明文"></a>[SWPUCTF 2022 新生赛]小明文</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phiN = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phiN)</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="comment">#c=128198926274489803523728445192921664</span></span><br><span class="line"><span class="comment">#flag=NSSCTF&#123;c&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>c = k*n + m^e → m</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">128198926274489803523728445192921664</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = <span class="number">504229359204</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = gmpy2.iroot(c+k*n,e)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>])))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k = k+<span class="number">1</span></span><br><span class="line"><span class="comment">#c=128198926274489803523728445192921664</span></span><br><span class="line"><span class="comment">#flag=NSSCTF&#123;c&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;ufind&#x27;</span></span><br></pre></td></tr></table></figure>





<h2 id="SWPUCTF-2022-新生赛-爆破MD5"><a href="#SWPUCTF-2022-新生赛-爆破MD5" class="headerlink" title="[SWPUCTF 2022 新生赛]爆破MD5"></a>[SWPUCTF 2022 新生赛]爆破MD5</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&#x27;Boom_MD5****&#x27;</span></span><br><span class="line">flag=MD5(data)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0618ac93d4631df725bceea74d0*****</span></span><br></pre></td></tr></table></figure>

<p>刚开始只跑了大小写+数字 没加符号没跑出来</p>
<p>随后加了符号 然后就是漫长的等待……</p>
<p>但是没跑出来 。 。 脚本好像有问题  额 。。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># data=&#x27;Boom_MD5****&#x27;</span></span><br><span class="line"><span class="comment"># flag=MD5(data)</span></span><br><span class="line"><span class="comment"># print(flag)</span></span><br><span class="line"><span class="comment">#0618ac93d4631df725bceea74d0*****</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_encrypt</span>(<span class="params">input_string</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 创建 MD5 加密对象</span></span><br><span class="line">        md5 = hashlib.md5()</span><br><span class="line">        <span class="comment"># 将输入字符串编码为字节</span></span><br><span class="line">        input_bytes = input_string.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment"># 更新 MD5 对象</span></span><br><span class="line">        md5.update(input_bytes)</span><br><span class="line">        <span class="comment"># 获取 MD5 加密结果</span></span><br><span class="line">        encrypted_string = md5.hexdigest()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encrypted_string</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;加密失败: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">additional_chars = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>, <span class="number">128</span>)])</span><br><span class="line"></span><br><span class="line">all_letters_and_digits = string.ascii_letters + string.digits + additional_chars</span><br><span class="line"><span class="comment"># string.ascii_uppercase 大写字母</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> all_letters_and_digits:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> all_letters_and_digits:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> all_letters_and_digits:</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> all_letters_and_digits:</span><br><span class="line">                <span class="built_in">str</span> = <span class="string">&quot;Boom_MD5&quot;</span> + i + j + k + m</span><br><span class="line">                md5str = md5_encrypt(<span class="built_in">str</span>).lower()</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>,md5str)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;0618ac93d4631df725bceea74d0&quot;</span> <span class="keyword">in</span> md5str:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line">                    <span class="built_in">print</span>(md5str)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2022-新生赛-yafu分解"><a href="#SWPUCTF-2022-新生赛-yafu分解" class="headerlink" title="[SWPUCTF 2022 新生赛]yafu分解"></a>[SWPUCTF 2022 新生赛]yafu分解</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">140</span>)</span><br><span class="line">q = getPrime(<span class="number">140</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phiN = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phiN)</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="comment">#n=1851012829537540993346897265450988006921329733937556249710137670254755668838970157221</span></span><br><span class="line"><span class="comment">#c=1165608868963663237838494928147497339359377331987999335624507621030816298293537918937</span></span><br></pre></td></tr></table></figure>

<p>p q不是很大 yafu去分解素数</p>
<p>C:\Users\test\Desktop\yafu-1.34&gt;yafu-Win32.exe “factor(1851012829537540993346897265450988006921329733937556249710137670254755668838970157221)”</p>
<p>分解得到</p>
<p>P43 = 1362310363870711901033415700690289289304517</p>
<p>P43 = 1358730637766188714476624560503309609820513</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">1362310363870711901033415700690289289304517</span></span><br><span class="line">q = <span class="number">1358730637766188714476624560503309609820513</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">1851012829537540993346897265450988006921329733937556249710137670254755668838970157221</span></span><br><span class="line">c = <span class="number">1165608868963663237838494928147497339359377331987999335624507621030816298293537918937</span></span><br><span class="line"></span><br><span class="line">phi_n = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;AFFPGS&#123;snzv1l_ov9_gur_g0_Jr1p0zr&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后凯撒解密  NSSCTF{fami1y_bi9_the_t0_We1c0me}</p>
<p><img src="/posts/bb5a57d9/6.png"></p>
<h2 id="SWPUCTF-2022-新生赛-AES"><a href="#SWPUCTF-2022-新生赛-AES" class="headerlink" title="[SWPUCTF 2022 新生赛]AES"></a>[SWPUCTF 2022 新生赛]AES</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> getflag</span><br><span class="line">iv = <span class="string">&#x27;1229002635654321&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;nssctfneedcrypto&#x27;</span></span><br><span class="line">data = getflag()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 位数不足十六位用空格填充</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">data</span>):</span><br><span class="line">    pad_data = data</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span> - <span class="built_in">len</span>(data)):</span><br><span class="line">        pad_data = pad_data + <span class="string">&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> pad_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_en</span>(<span class="params">key, data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) &lt; <span class="number">16</span>:</span><br><span class="line">        data = pad(data)</span><br><span class="line">    AES_obj = AES.new(key.encode(<span class="string">&quot;utf-8&quot;</span>), AES.MODE_CBC, iv.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    AES_en_str = AES_obj.encrypt(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    AES_en_str = base64.b64encode(AES_en_str)</span><br><span class="line">    AES_en_str = AES_en_str.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> AES_en_str</span><br><span class="line"></span><br><span class="line">data = AES_en(key, data)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#data=862EoKZMO3sqpNlzyvIW5G/8MFeAI/zgGXcgi5eNOL8=</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>WP</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># 位数不足十六位用空格填充</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">data</span>):</span><br><span class="line">    pad_data = data</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span> - <span class="built_in">len</span>(data)):</span><br><span class="line">        pad_data = pad_data + <span class="string">&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> pad_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_en</span>(<span class="params">key, data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) &lt; <span class="number">16</span>:</span><br><span class="line">        data = pad(data)</span><br><span class="line">    AES_obj = AES.new(key.encode(<span class="string">&quot;utf-8&quot;</span>), AES.MODE_CBC, iv.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    <span class="comment"># AES后 进行utf8加密 base64编码 utf8解密</span></span><br><span class="line">    AES_en_str = AES_obj.encrypt(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    AES_en_str = base64.b64encode(AES_en_str)</span><br><span class="line">    AES_en_str = AES_en_str.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> AES_en_str</span><br><span class="line"></span><br><span class="line">iv = <span class="string">&#x27;1229002635654321&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;nssctfneedcrypto&#x27;</span></span><br><span class="line">data= <span class="string">&quot;862EoKZMO3sqpNlzyvIW5G/8MFeAI/zgGXcgi5eNOL8=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_de</span>(<span class="params">key, data</span>):</span><br><span class="line">    cipher = AES.new(key.encode(<span class="string">&quot;utf-8&quot;</span>), AES.MODE_CBC, iv.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    data = data.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line">    data = cipher.decrypt(data)</span><br><span class="line">    data = data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">AES_de(key,data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;NSS_CRYPTO_NEED_YOU_0000&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2023-新生赛-EasyRSA"><a href="#SWPUCTF-2023-新生赛-EasyRSA" class="headerlink" title="[SWPUCTF 2023 新生赛]EasyRSA"></a>[SWPUCTF 2023 新生赛]EasyRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum  </span><br><span class="line">  </span><br><span class="line">p=libnum.generate_prime(<span class="number">1024</span>)  </span><br><span class="line">q=libnum.generate_prime(<span class="number">1024</span>)  </span><br><span class="line">e=<span class="number">65537</span>  </span><br><span class="line">m=<span class="string">&quot;NSSCTF&#123;*******************&#125;&quot;</span>  </span><br><span class="line">m=libnum.s2n(m)  </span><br><span class="line">n=p*q  </span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)  </span><br><span class="line">d=libnum.invmod(e,phi_n)  </span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)    </span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;e=&quot;</span>,e)  </span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p= 122912801126049869009003839542545176400185213365268209105714006257803073428638629824801261702125287814910668428403367391355051987389837804474055637991864563803834741161217607848968821280710324766558457056004037592628178078680121173634128054936108782807954132605887275556228703383455969903056759874047110115433</span></span><br><span class="line"><span class="comment">#q= 120790113700754477830062212762518406876786376726996249661848284428829412089402183812692045970711341815805796005449714738748110749559462448861357011272792817313060401380148108517705435100103533857957024851181447994572972501120774586405811257420853542417275740953525627232008812587423053626515513859653865873671</span></span><br><span class="line"><span class="comment">#e= 65537</span></span><br><span class="line"><span class="comment">#c= 7094224488947659163318199615533819770556597977720767621640224798887506152292861133457571683713587909779712343346370719403811813233693263526316785431883833118583425528830238629831001255198236686372518770451273159769779374149881346761523688131115323441973953523582174059584087249568245044443295176738493785560215046375056269378223045128094953923926250055718405799885041115025529297362914403732661935017257507786348635366480744933193471899621592092711962814949533564454932121056035003021428158830645604347966849572981124877683317022116903132719663958775850982016292384237647664448371811915879714093710876989697939277005</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p= <span class="number">122912801126049869009003839542545176400185213365268209105714006257803073428638629824801261702125287814910668428403367391355051987389837804474055637991864563803834741161217607848968821280710324766558457056004037592628178078680121173634128054936108782807954132605887275556228703383455969903056759874047110115433</span></span><br><span class="line">q= <span class="number">120790113700754477830062212762518406876786376726996249661848284428829412089402183812692045970711341815805796005449714738748110749559462448861357011272792817313060401380148108517705435100103533857957024851181447994572972501120774586405811257420853542417275740953525627232008812587423053626515513859653865873671</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">7094224488947659163318199615533819770556597977720767621640224798887506152292861133457571683713587909779712343346370719403811813233693263526316785431883833118583425528830238629831001255198236686372518770451273159769779374149881346761523688131115323441973953523582174059584087249568245044443295176738493785560215046375056269378223045128094953923926250055718405799885041115025529297362914403732661935017257507786348635366480744933193471899621592092711962814949533564454932121056035003021428158830645604347966849572981124877683317022116903132719663958775850982016292384237647664448371811915879714093710876989697939277005</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;RSA_1s_so_ea3y_and_interest1ng!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>





<h2 id="NSSRound-4-SWPU-ezcrypto-LCG"><a href="#NSSRound-4-SWPU-ezcrypto-LCG" class="headerlink" title="[NSSRound#4 SWPU]ezcrypto LCG"></a>[NSSRound#4 SWPU]ezcrypto LCG</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Symbol</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.alpha = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.beta = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.n = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.alpha * self.seed + self.beta) % self.n</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;alpha = &#123;&#125;\nbeta = &#123;&#125;\nn = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.alpha, self.beta, self.n))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;res1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;res2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line">symbol = Symbol()</span><br><span class="line">symbol.output()</span><br><span class="line">c = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="built_in">ord</span>(flag[i]) ^ (symbol.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(c))</span><br><span class="line"></span><br><span class="line">alpha = <span class="number">2659869614</span></span><br><span class="line">beta = <span class="number">3138014669</span></span><br><span class="line">n = <span class="number">2171187379</span></span><br><span class="line">res1 = <span class="number">32421</span></span><br><span class="line">res2 = <span class="number">32382</span></span><br><span class="line"><span class="number">628427670713408045832213770914678202267468957347245535228951062583137095137644250375583786099578</span></span><br></pre></td></tr></table></figure>

<p>alpha beta seed 32位随机整数</p>
<p>n 32位素数</p>
<p>seed =(a * seed + b ) mod n</p>
<p>已知前两个连续的res值 res = seed &gt;&gt; 16</p>
<p>c[i] = flag[i] ^ ( ((a*seed+b)mod n )&gt;&gt;16 )%10</p>
<p>flag 前几位是 NSSCTF 为默认已知条件</p>
<p>X0 = c[0]^N</p>
<p>seed =(a * seed + b ) mod n</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">alpha = <span class="number">2659869614</span></span><br><span class="line">beta = <span class="number">3138014669</span></span><br><span class="line">n = <span class="number">2171187379</span></span><br><span class="line">res1 = <span class="number">32421</span></span><br><span class="line">res2 = <span class="number">32382</span></span><br><span class="line">c = <span class="number">628427670713408045832213770914678202267468957347245535228951062583137095137644250375583786099578</span></span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(c[0]^ord(&#x27;N&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要转成二进制在左移 十进制不行</span></span><br><span class="line"><span class="comment"># for i in range(32421,32421&lt;&lt;16):</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0b111111010100101</span> &lt;&lt; <span class="number">16</span>, (<span class="number">0b111111010100101</span> &lt;&lt; <span class="number">16</span>) + <span class="number">2</span> ** <span class="number">16</span>)):</span><br><span class="line"></span><br><span class="line">    x = (alpha*i + beta)%n</span><br><span class="line">    <span class="keyword">if</span> x &gt;&gt; <span class="number">16</span> == res2:</span><br><span class="line">        y = (alpha*x + beta)%n</span><br><span class="line">        <span class="keyword">if</span> (y &gt;&gt; <span class="number">16</span> )%<span class="number">10</span> == c[<span class="number">0</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;N&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(i,x)</span><br><span class="line">			<span class="comment"># 2124788500 2122226329</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">res1=<span class="number">2124788500</span></span><br><span class="line">res2=<span class="number">2122226329</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    x = (a*b+c)%n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c :</span><br><span class="line">    res2 = lcg(res2,alpha,beta)</span><br><span class="line">    <span class="built_in">print</span>(  <span class="built_in">chr</span>(((res2&gt;&gt;<span class="number">16</span>)%<span class="number">10</span>)^i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2023-秋季新生赛-小明文？"><a href="#SWPUCTF-2023-秋季新生赛-小明文？" class="headerlink" title="[SWPUCTF 2023 秋季新生赛]小明文？"></a>[SWPUCTF 2023 秋季新生赛]小明文？</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">m1=flag = <span class="string">b&#x27;NSSCTF&#123;*******&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m1</span>):</span><br><span class="line">    p = getPrime(<span class="number">700</span>)</span><br><span class="line">    q = getPrime(<span class="number">700</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    a = getPrime(<span class="number">128</span>)</span><br><span class="line">    b = getPrime(<span class="number">128</span>)</span><br><span class="line">    m1 = bytes_to_long(m1)</span><br><span class="line">    mm1 = a * m1 + b</span><br><span class="line"></span><br><span class="line">    c1 = <span class="built_in">pow</span>(m1, e, n)</span><br><span class="line">    c2 = <span class="built_in">pow</span>(mm1, e, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 13026126941826887019162872735099540876106694302074884925200107036130428843197729140372377590706535217469477301361486550282890330093772372813532795303163348233096919179478061917423707929667355386062657434467799360617526194768968700908096844475960205671302377364202483195391706116078632202015938962280529309403244885363904094804118278167720593581764017089021116316636464533785051436622916960956665030100255641288863474938703</span></span><br><span class="line"><span class="comment"># a = 280807370135687531454416708417179457159</span></span><br><span class="line"><span class="comment"># b = 210598260561987226227971066630761929397</span></span><br><span class="line"><span class="comment"># c1 = 5484670538103757119990644460454986219076673914082966464351809153114702100411054106785392646801736865489738145857425179185164710603704198643749378051371008266521829572436350080663825339915763509501690398283916091505443322384568973565599179112299853287766734493187659418383619877040013434926843623979979122417950089001830664273269598688130410251828579862218274297572192961909808728768317567218412746711665911495028223620671</span></span><br><span class="line"><span class="comment"># c2 = 249587944874112168607313602465869274336587750392364868939732783502223999305089384749508572630699199927194600499968110646290832205640569694933539973256281796631433129626712361622584048439446364992886884217198680921278383770604919381329363647924261642857483728973331091285820401689502291336332199019252649615680893389557508558362194551939434128389351824194393680744241807605416750291337127085044177563509645273228457253193</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Related Message Attack：</p>
<p>利用条件：</p>
<p>如果两个信息之间M1 M2只存在已知的固定差异【线性关系】，并且使用相同的模数N下进行RSA加密</p>
<p>具体原理不看了【详细可看这里<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/#related-message-attack%E3%80%91">https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/#related-message-attack】</a></p>
<p><img src="/posts/bb5a57d9/7.png"></p>
<p>最终可推出如下式子</p>
<p><img src="/posts/bb5a57d9/8.png"></p>
<p>题目已知条件 c1 c2 a b，M2=aM1+b 线性关系，所以可以求出M2</p>
<p>直接套轮子[sage看不懂 直接拿过来了]</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n = <span class="number">13026126941826887019162872735099540876106694302074884925200107036130428843197729140372377590706535217469477301361486550282890330093772372813532795303163348233096919179478061917423707929667355386062657434467799360617526194768968700908096844475960205671302377364202483195391706116078632202015938962280529309403244885363904094804118278167720593581764017089021116316636464533785051436622916960956665030100255641288863474938703</span></span><br><span class="line">a = <span class="number">280807370135687531454416708417179457159</span></span><br><span class="line">b = <span class="number">210598260561987226227971066630761929397</span></span><br><span class="line">c1 = <span class="number">5484670538103757119990644460454986219076673914082966464351809153114702100411054106785392646801736865489738145857425179185164710603704198643749378051371008266521829572436350080663825339915763509501690398283916091505443322384568973565599179112299853287766734493187659418383619877040013434926843623979979122417950089001830664273269598688130410251828579862218274297572192961909808728768317567218412746711665911495028223620671</span></span><br><span class="line">c2 = <span class="number">249587944874112168607313602465869274336587750392364868939732783502223999305089384749508572630699199927194600499968110646290832205640569694933539973256281796631433129626712361622584048439446364992886884217198680921278383770604919381329363647924261642857483728973331091285820401689502291336332199019252649615680893389557508558362194551939434128389351824194393680744241807605416750291337127085044177563509645273228457253193</span></span><br><span class="line">e=<span class="number">5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2,a,b</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (x)^e - c1</span><br><span class="line">    g2 = (a*x+b)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic() <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m=franklinReiter(n,e,c1,c2,a,b)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;89c507f3-4a21-11ee-a71e-c03c59457d4d&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/posts/bb5a57d9/9.png"></p>
<h2 id="SWPUCTF-2022-新生赛-Phishing【没做出来-后面在研究下】"><a href="#SWPUCTF-2022-新生赛-Phishing【没做出来-后面在研究下】" class="headerlink" title="[SWPUCTF 2022 新生赛]Phishing【没做出来 后面在研究下】"></a>[SWPUCTF 2022 新生赛]Phishing【没做出来 后面在研究下】</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">eAlice = <span class="number">0x10001</span></span><br><span class="line">eBob = <span class="number">0x10003</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chatEncrypt</span>(<span class="params">pepole, message</span>):</span><br><span class="line">    <span class="keyword">if</span> pepole == <span class="string">&#x27;Alice&#x27;</span>:</span><br><span class="line">        sender = hashlib.sha256(<span class="built_in">str</span>(pepole).encode()).hexdigest()</span><br><span class="line">        sign = hashlib.sha256(<span class="built_in">str</span>(message).encode()).hexdigest()</span><br><span class="line">        encryptMessage = <span class="built_in">hex</span>(<span class="built_in">pow</span>(bytes_to_long(message), eAlice, n))</span><br><span class="line">        <span class="keyword">return</span> sender, encryptMessage, sign</span><br><span class="line">    <span class="keyword">elif</span> pepole == <span class="string">&#x27;Bob&#x27;</span>:</span><br><span class="line">        sender = hashlib.sha256(<span class="built_in">str</span>(pepole).encode()).hexdigest()</span><br><span class="line">        sign = hashlib.sha256(<span class="built_in">str</span>(message).encode()).hexdigest()</span><br><span class="line">        encryptMessage = <span class="built_in">hex</span>(<span class="built_in">pow</span>(bytes_to_long(message), eBob, n))</span><br><span class="line">        <span class="keyword">return</span> sender, encryptMessage, sign</span><br><span class="line"></span><br><span class="line">chatLog = <span class="built_in">open</span>(<span class="string">&quot;Chatting.log&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">encryptedChatLog = <span class="built_in">open</span>(<span class="string">&quot;ChatEncrypted.log&quot;</span>, <span class="string">&quot;w+&quot;</span>)</span><br><span class="line">log = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> chatLog:</span><br><span class="line">    log.append(line)</span><br><span class="line">chatLog.close()</span><br><span class="line"></span><br><span class="line">encryptedChatLog.write(<span class="built_in">hex</span>(n)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(log)/<span class="number">2</span>)):</span><br><span class="line">    <span class="keyword">if</span> log[i*<span class="number">2</span>] == <span class="string">b&#x27;Alice\r\n&#x27;</span>:</span><br><span class="line">        encryptedChatLog.write(<span class="built_in">str</span>(chatEncrypt(<span class="string">&#x27;Alice&#x27;</span>, log[i*<span class="number">2</span>+<span class="number">1</span>]))+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(chatEncrypt(<span class="string">&#x27;Alice&#x27;</span>, log[i*<span class="number">2</span>+<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">elif</span> log[i*<span class="number">2</span>] == <span class="string">b&#x27;Bob\r\n&#x27;</span>:</span><br><span class="line">        encryptedChatLog.write(<span class="built_in">str</span>(chatEncrypt(<span class="string">&#x27;Bob&#x27;</span>, log[i*<span class="number">2</span>+<span class="number">1</span>]))+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(chatEncrypt(<span class="string">&#x27;Bob&#x27;</span>, log[i*<span class="number">2</span>+<span class="number">1</span>]))</span><br><span class="line">encryptedChatLog.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>已知 eAlice = 0x10001、eBob = 0x10003</p>
<p>c = pow(m,e,n)</p>
<p>输出文件中包含 hex(n) 及 十六组 str(chatEncrypt(‘Alice’, log[i*2+1])) ，其中sender和sign sha256加密 密文未加密</p>
<p>所以已知内容为 n 和16组c</p>
<p>使用同一个模数n进行加密 优先考虑共模攻击</p>
<p>n = 0x63651c7146a0e7b724297d4212b5128ede8631b886179f7c7770877317d0d7d91d74aa9a8763ef0b8640f0d3ec80ae2581af3bec1928a308d6e220e2b7bc7dbee675445c7503b8469ccb3b6d36b69a19e67aad605e83886f274308904e5cd660fb627899075dca6ba585001d4e0c4b496c79ea1952d961421eeda77b80ed3716d6eaba40de17848499adbf098b85e6807ee4fdea7059d5faf3b2b58d1e17322ce6f3747f1cd138db0593d630e97573bd42c8b02bac2d780b8b0b6ac915cb18f082af21c3c5a4849b6e8e19862b1160888bb069adb8bcbcf93693ea8993bc26c1321d36b137a215bf56dfe9af8ba511f5d89b016a68ca03d9bd14091c04027b01</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">0x44e199407b72439f4fad42a3a13ff31fe22daacd0b1ec17f34f260ffa8a7be74b75ac624ab147b8342b0cd97024b1d7d40d5071bc65d62377b3eb2b718e086096084219360d7bf967ba961afa05054d968d8b3493870831e92622ead173ba41e3d345e068cc7640bb43f3ff9654ab48183f6dbe752ee26b9c908d4b31fcb8e445963ef261e99bc238441a2c0e82fdf07359702d0ab664ab216995c7e27d91e885a5ee37ae1f6895a7d38155edcd8990c36fa2ac6d7e14abec471cc96a8ba34497f3073e0906f683145e03fc38c8fa40ba4250d2d907f3071c3db30d941b321c349d9d800bed6be61b00a3797aef85f7fb2cc36413556f6438fae3b9476adab6e</span><br><span class="line">0x10cde6bdf0ac17952be139709d97fa574bfbeffd22e9a0c0fde85811797decfd4b8c669df862a476c66ae47e2831d23f1dde85290a58489a8cabf9f8bf4e94c80009634ee2deb13391c1ede5005a4fd3a58b08b185eb4d10081f34676c3bf546ae641141e63bab05ca9e40bdd5c9422857f5da5a3f3f14f87a2235196dad758065d0108b8a450939fe5084cea40d8ab8e1f5b87df21def507285464cb26e2cc5ad3ade03d83ac74557ec51c4eb2422dc45b7022cca62a4d1896bf13fef9bb38f5dc44d2ce6ab28222655ed27104b1e18f2baaa9bbc4200e8cf531cda25c9ae4f07e79885efc7b7fb3dcad0f07de66a1a1708f6bc96906a184caea4d23d1af4cf</span><br><span class="line">0x31d25cdd014ad6ccef4e417ee1a1a59ebff514979887b9e05bda8a577dd8f3b62fa4ef09780b96d5878957a2ab11116b3a1d77e26cc4a0510f83fb86247170798aa0470215ea0cf1646291ee111e70fb83094a73d6f4540957ac428094c806ed2a6fb68db8c47170ae747375277deda72aaf887c09c06e372c62af6ee559f96e13b9f2d4f7a72df4b4d9bfb8975510ae165da5d0ed9727c9168669d2bc762cd49bcf316d3bc4d29e9429016f4ba5f1b12390c433248cb443c97df5fe6992016543054150af623edaf29ef81b231491bafbbbe0f607dd754f5d6d702a44a9b99533174a6c4bb6e727683c05a908bffdfdb629972f51f4ef698bbffebed566a0c5</span><br><span class="line">0x7b1ef6b4cb43ca5747d17ebf5a42d49b0f24b65a13101dfeb995a9cf753f45afd65c93d908629c008ea8d6577cb6c32960486b838d335974ab15a58d38a39a8d8f6b16a0369da059d2a5298bc4efb6491ef4537e958e693c17acdded7fd527548a0800f6f1a79ba484f2c4b15662b2bee4e5286b1972b3fd78b2d9ba5b5b1c58cb6e226fb55f4e6c266ef69aff05971a9594fc9f96ffbb98022fb744c3e081e59afccaf9258f6f5921765c5324b2ff3dc3d64c6164d2f26cbaadec66669e8e77b9f9196cfa46e68cb3f5f53435e016297f9d0ce9131d9dbaee616b34eb5ebd871d50226dae36e648a3e351cb9e46969ad7d578d367ca546d062f3ab0313eb9b</span><br><span class="line">0x401156c77529718d7a5fff5889703d9d000f1e8324d76eb05728fe83b3a9f9a689abd4b01af9c036c35025c21603d4256b5edd12803192030ca198be70ead4f6113b147e8e3f0d3743cf3e7aebf22151b468ccacd681989158afdfc61dbd46d8d67e85d09491217a065ec04d4b12f2e31098802e1094f06aaa8a8c43785496243e881f81fb90254dd3342699e6c433f8f603c00605d6b34c6ec3117cf78fcb1a72a9bab83e05d1b489148a90f7816fa5f84fde195ba1bcddb26df6b78ceb09d919807b7bb7b7cce257b23fb34508d1ffaaec17cf5e1f66ea31e692d077859ca16ee24cd2d6923744c98cafbf39c41c0bbf68a6c086b62614792e23038643c955</span><br><span class="line">0x469ff6f3649b902be1e3b59aa68eee1b10a1056e109872b42c00a3d574ab13337e4b09d094e1a43b16d4c5ebd266266e2564cf3b630a3d3207b5aacfa7f50ab621034a7dfcd231ed3247e74093c4836bfefc6af53857ee09d242bcd346bcb9e6e1cfae3c38fcee9f3cc22fe51d7a9ac96f914a0f0985639c8aeafd254f0c6304398138c256c1c80e4969d7d3d4ce2e8885608bc2d8d83bf7a218aaae015341bbf7d873d54a4ec0afce0b6a7898df840b4b682276c394ca3a38e688b8aeea675ede5d28908a89d59c98321b3c14900d4a89249784a12066d385312ae307a8438c8e49b42b1d234546e46c1536ae0b5178abc609d9061b5a8711ae6c2a7140a23e</span><br><span class="line">0x1c39de925a76c7207714684fc339567cd439a106ee1b2c09232652f899f798c459629de9d4ba464666d1a050642964d446762b9be80bb417aa411ae81d30751acdda9d914581fb8715853aaa8869bcf6050c0a9f6a0060a888f3353298e5617f0c1807a711418ef91d7662864187c360c48a6988a7004e6a786a3071bebfb1198456f7fa5a2a651fa31cd8b0c1e9fbb515a37977dccfce79784617e83c760d6bba6e65cc566e96a01143c9ee7dfca95bae3a4af0f30eb579a0ad8a8be453bbcf147dc9c2a048d877621e507d208e6105929d5beb28bc86e58570b8e2d32927d7d7f65dc4ee929abb85a7cc73194ebb4f4ff84213f28dabfd81eaac5c8ad9ab5</span><br><span class="line">0x256996daa2c9dae14a986ff70f0f453b1b12bcbbce4232380e4145e141684fbbe91ab67c524159487ca26726690f8da588cc7af61801ab3065290bfa4d440b85803fc3b9d010d346c7b4f7f2b8f0b3253102f10e6812592bac933712b71baf0cf470d0b782894693dd256c2ead766c3c271fb45d65008316511710d22ea318cef51731c598314101846a7f9674fba6adbddffa16bb15ea03021c54038e46c7a4846f45211ba17e733577153a78a7ec1d463d07e7e7c1ac8cfe06625ff3aac27d2f651ef04618ec6107652b0627528748640b0c9e7a446e5cdece79080b0009eab5ba41e0db367049ce69687ba2cae8481761b87fd0e6a7ba5e84ac55a5231d0f</span><br><span class="line"></span><br><span class="line">0x5a045180ce4cbcdb8d4f48ae4fafb4dab8b3a1a829afd15f3aa5afa90c03aca9eb6b1dec208594580fba45b8af15cf7ac60031cb9c28e402a0a563fcf9feeed7c05de10104560fb1e66463be3573fc98d7b4178fb1d9c99af7cbc4da65fbb40b5fe26bd78bb83e94236136e0ab86f9228963b90d926abb8002f9e6a8ad695a826c12454e6bf6d44624188d8454e4afa133ed9cffcf504239bc2df4eddb0910f47047858da710dd1ef7b96b2430b69fc78b3a8e4d19657b4fb2fbcbac656e851d86fee14f487a4e4fcca93fef24eb9e3f72ee3aebe0aa27e14a2889c13410a22a4ff99802729a1e802b1e343abe51f99f9b131e6e932ef6336cb2539befc7ad2b</span><br><span class="line">0x2ca6110b03ecad45d9f8969c6a47e4e434708288bb35738f4e1974647ae4ac5782377117bf96a25936c5f049ce5fb89aeb9022c99f1eb2085f0a2e9e06f5bdd7c512dea7fa839ae55eb78d95f8ed9a34e35fe901cd499efe116142976e6170c85987cb1355ddf1d7cf6e66120a355ae02cce4ccef86ae27860f55c61249cf5b6daf728c570bfeb8f03f6dfab1cf168ab16e7e1efe1582f9717d449984184c604ec5af6070837b1350dfaf188b6bb76ad81f5c70804fa7a79d2c1c5f8de9b5cb9ed859bf75f912c445fed04252edfa590e2354b72d08331ab631b9d59835435e6c0e80e418ba6c2e1655ca7ef19555b792f768c2d07bc7deabfc8c06a9061d987</span><br><span class="line">0x148dce72b5b82bcc8bda6d5d2aa0ef4c665b647edb4e588058519c9b4fd3c25fc24f73569bdf14491d5a6ecc01aa6ee797711e612b7e271f2f551407b7f73c2b5fe9bba6168777bd82a4ef3c5ac46bdb339a43ccdea2ca913141eb909ae7e03cba79331556f3111679878748819175f921a114c57c001d22fe4ef26bed7c56725fd982d4fa356b2e25e962a88471feef63e82c9640b0293b98e1971ab78111e76fd485dc6c53ec656266759c2c9b4a2465ad1618fa7d89454161b1d799c90af1d055d9749a49c8aa9a1d956683841c234641e0ca30d97865355da3c5879db378ef9c44e78320c4f97ae50c385cb1e4877c2ec2c1fa64915625654ba0c8c01efa</span><br><span class="line">0x4449cb7346cd8bc4c4fc0e0c492cc40a1b4f1a3f93815eb19353fb82a3c34cfdfe91bc01a80f779998185a6a36cf68094641367fd912f146d9ec793bf88d2fea7f793375ea4d79e95c8c18e8dc83e0d7590fe007862024e82786e11754ecb4b93c19c01550631196fcaa34b73646125b1baa8fd8726d99f9752abad9a5e2136e0a909700a0423fbd97865b87790c6e16b85a51aa7dd987e84cc7a8f4617a0de31f4d1c538587a8fd8b91b50f8551c306c3240339c8d89f9a6842f65f59db0ac935640f998e705ec6dad8b5403e786bcbc901b9cdaa671fe5d05707d637772199779bce17e7942eb185aa86ce668863261f85539696b5a5835826f67cd25acd49</span><br><span class="line">0x2197e3bc7c4bc600dac76f2b4dce190bba84f5a2df71e086efa5d9e1891d93ef7a722a8912c65c71a39fd495da83078ba4ecfae537e7cce6ca4cc2621e6f019fc10a322fffc66d4a2f9d0674c300df5c5cb290d8ad0228b5a22d86a4e99c171ce2d29f0ad52fa07b17fb6accfba6e78af4c3c1f5f578c7b496df797cc38b9c8a61b6b1fdc5648291753283d6dc3dc11e10ad5513bbb4b579a0b1c07c92fdb59df8a4f036e050e4d4668586f16685810f2e8cf62763d1d17fc493ad04ded7fd64e09b8299eeb5aa51b2e4287bec9b042285e49e04adfee80235eea001b3443976e460dd87710343c503129924e8cbb5b71849f3cb07fe9d7956c688e7521cbbae</span><br><span class="line">0x224fda6f7940f6a120d586691428da3a93baec1d4be63ddad058b00a78d311a111aaf3174d6ab8bffb5403c8b721cd64d5440da5607d7d8729ee732fd86e2407c2fdc8ad3bba763e856c2a517cafeae8465952ff0854d712fdbb410f924e5bac561411beaaddf5c02536f273704a14b5de13c51cba3dc029bd2c7250f972b1679e1f21acdc27cda6c33b72a4258f68d00395e82c2f0d92c153ad5240b26ef581e0b5ba78c0c9409a5fb02f4d49707e9b941e0ad37e22ef9c42a568a10b000e91059650b620fd69552c4d267ed1b479378e60870cfd2026d248d32b9600f3b8ba2c7d05c6872847e43760d51d3b69e85449d21a3eb5eeef82d450a803b4500b79</span><br><span class="line">0x32b9ecdea94109ebb2fac3a1bbc8605a2e7f3622a2559e1e0811921881b736de43771ba97d0c071ea05caa613c84f4f3b8f553f2ca2eccc1c3c8708ded528a7fc34881530a95d95dae4bdd27967f0b8b706530725d62447d732615825aadd901fa86675431e245aa1c3937d5f4d76f06a52caa8ca2100a9568c1817f14c6e6bb01f7d4543bd0d985ad2e1ee4310db1eafa37ae90b38582ef6212552e8bf6c6cbd483ae580a65b4171dd6bb767b3ae50d6a0f8bc9d45ca7d2ec12bea582b7aa39c3df3e20c2de9851456f111719b4ea6fe2d9c3ada0787ec83e4a7e5a2348b58526d4d267db693e508599f9cd31729a36d510aec40c756974a6f1e825fbcfc1d1</span><br><span class="line">0x1ceec14e3fea63e688f500df76526d391cb411aba993a7407671e234698441e4c3c80efdf0092f0f7af0e14cedde5efe144ee8db2b5a0e7f8f300ca49f81dd189a83527f0c846ac1cbed4ba909f8df04efdeacaa616c005a609f43cdafac49ce49b482a5e244e1cd96fb4643066887d8d858314e816dd08df711b46fded216c4b8bee5a24379522e73a84e53ae0d778e47e7c5e96869a1666d90abea5638719932baf857745e50d3f32933d62d9bbffdc8d6b1ca6232e2bca8533afdd5b4175ed61db1e604d9645594b3dcf89e0550175bbb6d3de99598c665911c26e824f36b277681cfa802989c8b010d2143fe94ebef8dee4da4e5a4f097fb3a22b1242c52</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="SWPUCTF-2023-秋季新生赛-dpdp-【dp泄露】"><a href="#SWPUCTF-2023-秋季新生赛-dpdp-【dp泄露】" class="headerlink" title="[SWPUCTF 2023 秋季新生赛]dpdp 【dp泄露】"></a>[SWPUCTF 2023 秋季新生赛]dpdp 【dp泄露】</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span> + <span class="string">b&#x27;1010101010101010101010101010101010101010100010101010101010101010101101&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d % (p-<span class="number">1</span>)</span><br><span class="line">m = s2n(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dp = <span class="subst">&#123;dp&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">62950660589752377241535942010457460675378335694404721223426371627802159493655570041534480026979837056215567303530448462076388942749116962945931432723672826148999814815864738069663127706046027850586024555861960247057288826014343547293035737544457656904257388300461848219257240252715837662741274235378360898441</span></span><br><span class="line">c = <span class="number">26392919777656338278184497106215581599692023606797351841011065350738534402079717897589592521000832026751736045905247050532819571969784687491977953157313304550096179520376626220816081159472339787295872214912587497324709488986746768994907107727184468228540635002062232484115731701648311946527233449512543132274</span></span><br><span class="line">dp = <span class="number">7088497034630351463006975624795947102639056977565074157092915907376477955247769847204254053775159112398217033648894620506901638351932922911273150932128973</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>dp泄露 可用下面这个板子</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">62950660589752377241535942010457460675378335694404721223426371627802159493655570041534480026979837056215567303530448462076388942749116962945931432723672826148999814815864738069663127706046027850586024555861960247057288826014343547293035737544457656904257388300461848219257240252715837662741274235378360898441</span></span><br><span class="line">c = <span class="number">26392919777656338278184497106215581599692023606797351841011065350738534402079717897589592521000832026751736045905247050532819571969784687491977953157313304550096179520376626220816081159472339787295872214912587497324709488986746768994907107727184468228540635002062232484115731701648311946527233449512543132274</span></span><br><span class="line">dp = <span class="number">7088497034630351463006975624795947102639056977565074157092915907376477955247769847204254053775159112398217033648894620506901638351932922911273150932128973</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):  <span class="comment"># 在范围(1,e)之间进行遍历</span></span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>) == <span class="number">0</span>:  <span class="comment"># 存在p，使得n能被p整除</span></span><br><span class="line">            p = ((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span></span><br><span class="line">            q = n // (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>)</span><br><span class="line">            phi = (q - <span class="number">1</span>) * (p - <span class="number">1</span>)  <span class="comment"># 欧拉定理</span></span><br><span class="line">            d = gmpy2.invert(e, phi)  <span class="comment"># 求模逆</span></span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)  <span class="comment"># 快速求幂取模运算</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;NSSCTF&#123;CTFCTFNSSNSS&#125;1010101010101010101010101010101010101010100010101010101010101010101101&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2023-秋季新生赛-dpdpdpdp-还没做"><a href="#SWPUCTF-2023-秋季新生赛-dpdpdpdp-还没做" class="headerlink" title="[SWPUCTF 2023 秋季新生赛]dpdpdpdp [还没做]"></a>[SWPUCTF 2023 秋季新生赛]dpdpdpdp [还没做]</h2><p>和上面题相比 e变得很大 所以无法用之前遍历的方式</p>
<p>可以使用维纳攻击</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d % (p-<span class="number">1</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dp = <span class="subst">&#123;dp&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">92288362151232755164303382554034496430634785857894506752180261103500715219090974532177552845107426542175470207920267802066773828210866572070045093611090322738109527534622730588618668861998969946471756352024368486322527057077613762697792913167023012077178671066981439295386486943067698150993422039585259179729</span></span><br><span class="line">e = <span class="number">229991316986730339421575788374847647237</span></span><br><span class="line">c = <span class="number">66178170892880340054212366602556925884485962775832591797127163461420023986798822926684824340567060840259672460835004142425374706821346941926520921852009455818529825976414766339170445233789109526300838535719649346266975388774091834431039678689254534566870194580604694419819400454951059125553501095973278807456</span></span><br><span class="line">dp = <span class="number">8987556601717285362487353965045062789633142861774364363374961991445049127918653163458814169532860957264061203394944931114888144611267605606197232438332289</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>






    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


<div>

  <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">------------- 💖 🌞 本 文 结 束 😚 感 谢 您 的 阅 读 🌞 💖 -------------</div>
    
</div>

</div>

<div>
      
        
      
</div>

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Crypto/" rel="tag"></i><i class="fa fa-tag"></i> Crypto</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/b9d99e81/" rel="prev" title="Diffie-Hellman算法">
      <i class="fa fa-chevron-left"></i> Diffie-Hellman算法
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/64eed679/" rel="next" title="DES加密">
      DES加密 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto1-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="nav-number">1.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto1 共模攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto2-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="nav-number">2.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto2 共模攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto3"><span class="nav-number">3.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto3 [-]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto4-%E7%B4%A0%E6%95%B0%E5%88%86%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto4 素数分解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto5-%E4%BD%8E%E6%8C%87%E6%95%B0e%E6%94%BB%E5%87%BB"><span class="nav-number">5.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto5 低指数e攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto6-base"><span class="nav-number">6.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto6 base</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto7-md5"><span class="nav-number">7.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto7 md5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto8-UUencode"><span class="nav-number">8.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto8  UUencode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto9"><span class="nav-number">9.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto9</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto10-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A"><span class="nav-number">10.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]crypto10 [维吉尼亚]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-pigpig-%E7%8C%AA%E5%9C%88"><span class="nav-number">11.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]pigpig [猪圈]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E5%B0%8F%E6%98%8E%E6%96%87"><span class="nav-number">12.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]小明文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E7%88%86%E7%A0%B4MD5"><span class="nav-number">13.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]爆破MD5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-yafu%E5%88%86%E8%A7%A3"><span class="nav-number">14.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]yafu分解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-AES"><span class="nav-number">15.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]AES</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2023-%E6%96%B0%E7%94%9F%E8%B5%9B-EasyRSA"><span class="nav-number">16.</span> <span class="nav-text">[SWPUCTF 2023 新生赛]EasyRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NSSRound-4-SWPU-ezcrypto-LCG"><span class="nav-number">17.</span> <span class="nav-text">[NSSRound#4 SWPU]ezcrypto LCG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-%E5%B0%8F%E6%98%8E%E6%96%87%EF%BC%9F"><span class="nav-number">18.</span> <span class="nav-text">[SWPUCTF 2023 秋季新生赛]小明文？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-Phishing%E3%80%90%E6%B2%A1%E5%81%9A%E5%87%BA%E6%9D%A5-%E5%90%8E%E9%9D%A2%E5%9C%A8%E7%A0%94%E7%A9%B6%E4%B8%8B%E3%80%91"><span class="nav-number">19.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]Phishing【没做出来 后面在研究下】</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-dpdp-%E3%80%90dp%E6%B3%84%E9%9C%B2%E3%80%91"><span class="nav-number">20.</span> <span class="nav-text">[SWPUCTF 2023 秋季新生赛]dpdp 【dp泄露】</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-dpdpdpdp-%E8%BF%98%E6%B2%A1%E5%81%9A"><span class="nav-number">21.</span> <span class="nav-text">[SWPUCTF 2023 秋季新生赛]dpdpdpdp [还没做]</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mamor"
      src="/images/kabi.jpg">
  <p class="site-author-name" itemprop="name">Mamor</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">178</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Mamor5409" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Mamor5409" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.yuque.com/mamor" title="Yuque → https:&#x2F;&#x2F;www.yuque.com&#x2F;mamor" rel="noopener" target="_blank"><i class="yuque fa-fw"></i>Yuque</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mamor</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16:22</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

<!--
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共227.2k字</span>
</div>
-->
        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

    </div>


<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
<!--单击显示文字-->
<script type="text/javascript" src="/js/ClickShowText.js"></script>

<script type="text/javascript">
var windowWidth = $(window).width();
if (windowWidth > 768) {
    document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
}
</script>






  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>


<a href="https://mamor5409.github.io/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>



<!--崩溃欺骗-->
<script type="text/javascript" src="/js/src/crash_cheat.js"></script>

</html>

